
window.bubble_environment = "prod";

window.bubble_cluster = "main";

window.bubble_hostname_modifier = "";
/*! jQuery v3.1.1 | (c) jQuery Foundation | jquery.org/license */
!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c=[],d=a.document,e=Object.getPrototypeOf,f=c.slice,g=c.concat,h=c.push,i=c.indexOf,j={},k=j.toString,l=j.hasOwnProperty,m=l.toString,n=m.call(Object),o={};function p(a,b){b=b||d;var c=b.createElement("script");c.text=a,b.head.appendChild(c).parentNode.removeChild(c)}var q="3.1.1",r=function(a,b){return new r.fn.init(a,b)},s=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,t=/^-ms-/,u=/-([a-z])/g,v=function(a,b){return b.toUpperCase()};r.fn=r.prototype={jquery:q,constructor:r,length:0,toArray:function(){return f.call(this)},get:function(a){return null==a?f.call(this):a<0?this[a+this.length]:this[a]},pushStack:function(a){var b=r.merge(this.constructor(),a);return b.prevObject=this,b},each:function(a){return r.each(this,a)},map:function(a){return this.pushStack(r.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:c.sort,splice:c.splice},r.extend=r.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||r.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(r.isPlainObject(d)||(e=r.isArray(d)))?(e?(e=!1,f=c&&r.isArray(c)?c:[]):f=c&&r.isPlainObject(c)?c:{},g[b]=r.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},r.extend({expando:"jQuery"+(q+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===r.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=r.type(a);return("number"===b||"string"===b)&&!isNaN(a-parseFloat(a))},isPlainObject:function(a){var b,c;return!(!a||"[object Object]"!==k.call(a))&&(!(b=e(a))||(c=l.call(b,"constructor")&&b.constructor,"function"==typeof c&&m.call(c)===n))},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?j[k.call(a)]||"object":typeof a},globalEval:function(a){p(a)},camelCase:function(a){return a.replace(t,"ms-").replace(u,v)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var c,d=0;if(w(a)){for(c=a.length;d<c;d++)if(b.call(a[d],d,a[d])===!1)break}else for(d in a)if(b.call(a[d],d,a[d])===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(s,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(w(Object(a))?r.merge(c,"string"==typeof a?[a]:a):h.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:i.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;f<g;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,e,f=0,h=[];if(w(a))for(d=a.length;f<d;f++)e=b(a[f],f,c),null!=e&&h.push(e);else for(f in a)e=b(a[f],f,c),null!=e&&h.push(e);return g.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(c=a[b],b=a,a=c),r.isFunction(a))return d=f.call(arguments,2),e=function(){return a.apply(b||this,d.concat(f.call(arguments)))},e.guid=a.guid=a.guid||r.guid++,e},now:Date.now,support:o}),"function"==typeof Symbol&&(r.fn[Symbol.iterator]=c[Symbol.iterator]),r.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){j["[object "+b+"]"]=b.toLowerCase()});function w(a){var b=!!a&&"length"in a&&a.length,c=r.type(a);return"function"!==c&&!r.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}var x=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",L="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",M="\\["+K+"*("+L+")(?:"+K+"*([*^$|!~]?=)"+K+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+L+"))|)"+K+"*\\]",N=":("+L+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+M+")*)|.*)\\)|)",O=new RegExp(K+"+","g"),P=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),Q=new RegExp("^"+K+"*,"+K+"*"),R=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),S=new RegExp("="+K+"*([^\\]'\"]*?)"+K+"*\\]","g"),T=new RegExp(N),U=new RegExp("^"+L+"$"),V={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L+"|[*])"),ATTR:new RegExp("^"+M),PSEUDO:new RegExp("^"+N),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,_=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),aa=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ba=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ca=function(a,b){return b?"\0"===a?"\ufffd":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a},da=function(){m()},ea=ta(function(a){return a.disabled===!0&&("form"in a||"label"in a)},{dir:"parentNode",next:"legend"});try{G.apply(D=H.call(v.childNodes),v.childNodes),D[v.childNodes.length].nodeType}catch(fa){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s=b&&b.ownerDocument,w=b?b.nodeType:9;if(d=d||[],"string"!=typeof a||!a||1!==w&&9!==w&&11!==w)return d;if(!e&&((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,p)){if(11!==w&&(l=Z.exec(a)))if(f=l[1]){if(9===w){if(!(j=b.getElementById(f)))return d;if(j.id===f)return d.push(j),d}else if(s&&(j=s.getElementById(f))&&t(b,j)&&j.id===f)return d.push(j),d}else{if(l[2])return G.apply(d,b.getElementsByTagName(a)),d;if((f=l[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(f)),d}if(c.qsa&&!A[a+" "]&&(!q||!q.test(a))){if(1!==w)s=b,r=a;else if("object"!==b.nodeName.toLowerCase()){(k=b.getAttribute("id"))?k=k.replace(ba,ca):b.setAttribute("id",k=u),o=g(a),h=o.length;while(h--)o[h]="#"+k+" "+sa(o[h]);r=o.join(","),s=$.test(a)&&qa(b.parentNode)||b}if(r)try{return G.apply(d,s.querySelectorAll(r)),d}catch(x){}finally{k===u&&b.removeAttribute("id")}}}return i(a.replace(P,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("fieldset");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=c.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return function(b){return"form"in b?b.parentNode&&b.disabled===!1?"label"in b?"label"in b.parentNode?b.parentNode.disabled===a:b.disabled===a:b.isDisabled===a||b.isDisabled!==!a&&ea(b)===a:b.disabled===a:"label"in b&&b.disabled===a}}function pa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function qa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=n.documentElement,p=!f(n),v!==n&&(e=n.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",da,!1):e.attachEvent&&e.attachEvent("onunload",da)),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(n.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Y.test(n.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!n.getElementsByName||!n.getElementsByName(u).length}),c.getById?(d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){return a.getAttribute("id")===b}},d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c?[c]:[]}}):(d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}},d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c,d,e,f=b.getElementById(a);if(f){if(c=f.getAttributeNode("id"),c&&c.value===a)return[f];e=b.getElementsByName(a),d=0;while(f=e[d++])if(c=f.getAttributeNode("id"),c&&c.value===a)return[f]}return[]}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){if("undefined"!=typeof b.getElementsByClassName&&p)return b.getElementsByClassName(a)},r=[],q=[],(c.qsa=Y.test(n.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+K+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+K+"*(?:value|"+J+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){a.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var b=n.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+K+"*[*^$|!~]?="),2!==a.querySelectorAll(":enabled").length&&q.push(":enabled",":disabled"),o.appendChild(a).disabled=!0,2!==a.querySelectorAll(":disabled").length&&q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=Y.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"*"),s.call(a,"[s!='']:x"),r.push("!=",N)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=Y.test(o.compareDocumentPosition),t=b||Y.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===n||a.ownerDocument===v&&t(v,a)?-1:b===n||b.ownerDocument===v&&t(v,b)?1:k?I(k,a)-I(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,g=[a],h=[b];if(!e||!f)return a===n?-1:b===n?1:e?-1:f?1:k?I(k,a)-I(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)g.unshift(c);c=b;while(c=c.parentNode)h.unshift(c);while(g[d]===h[d])d++;return d?la(g[d],h[d]):g[d]===v?-1:h[d]===v?1:0},n):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(S,"='$1']"),c.matchesSelector&&p&&!A[b+" "]&&(!r||!r.test(b))&&(!q||!q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.escape=function(a){return(a+"").replace(ba,ca)},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(_,aa),a[3]=(a[3]||a[4]||a[5]||"").replace(_,aa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return V.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&T.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(_,aa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+K+")"+a+"("+K+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(O," ")+" ").indexOf(c)>-1:"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){while(p){m=b;while(m=m[p])if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){m=q,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n&&j[2],m=n&&q.childNodes[n];while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if(1===m.nodeType&&++t&&m===b){k[a]=[w,n,t];break}}else if(s&&(m=b,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n),t===!1)while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if((h?m.nodeName.toLowerCase()===r:1===m.nodeType)&&++t&&(s&&(l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[w,t]),m===b))break;return t-=e,t===d||t%d===0&&t/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(P,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(_,aa),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return U.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(_,aa).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:oa(!1),disabled:oa(!0),checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:pa(function(){return[0]}),last:pa(function(a,b){return[b-1]}),eq:pa(function(a,b,c){return[c<0?c+b:c]}),even:pa(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:pa(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:pa(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:pa(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function ra(){}ra.prototype=d.filters=d.pseudos,d.setFilters=new ra,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){c&&!(e=Q.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P," ")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function sa(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function ta(a,b,c){var d=b.dir,e=b.next,f=e||d,g=c&&"parentNode"===f,h=x++;return b.first?function(b,c,e){while(b=b[d])if(1===b.nodeType||g)return a(b,c,e);return!1}:function(b,c,i){var j,k,l,m=[w,h];if(i){while(b=b[d])if((1===b.nodeType||g)&&a(b,c,i))return!0}else while(b=b[d])if(1===b.nodeType||g)if(l=b[u]||(b[u]={}),k=l[b.uniqueID]||(l[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((j=k[f])&&j[0]===w&&j[1]===h)return m[2]=j[2];if(k[f]=m,m[2]=a(b,c,i))return!0}return!1}}function ua(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function va(a,b,c){for(var d=0,e=b.length;d<e;d++)ga(a,b[d],c);return c}function wa(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function xa(a,b,c,d,e,f){return d&&!d[u]&&(d=xa(d)),e&&!e[u]&&(e=xa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||va(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:wa(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=wa(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=wa(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ya(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=ta(function(a){return a===b},h,!0),l=ta(function(a){return I(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];i<f;i++)if(c=d.relative[a[i].type])m=[ta(ua(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;e<f;e++)if(d.relative[a[e].type])break;return xa(i>1&&ua(m),i>1&&sa(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(P,"$1"),c,i<e&&ya(a.slice(i,e)),e<f&&ya(a=a.slice(e)),e<f&&sa(a))}m.push(c)}return ua(m)}function za(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,o,q,r=0,s="0",t=f&&[],u=[],v=j,x=f||e&&d.find.TAG("*",k),y=w+=null==v?1:Math.random()||.1,z=x.length;for(k&&(j=g===n||g||k);s!==z&&null!=(l=x[s]);s++){if(e&&l){o=0,g||l.ownerDocument===n||(m(l),h=!p);while(q=a[o++])if(q(l,g||n,h)){i.push(l);break}k&&(w=y)}c&&((l=!q&&l)&&r--,f&&t.push(l))}if(r+=s,c&&s!==r){o=0;while(q=b[o++])q(t,u,g,h);if(f){if(r>0)while(s--)t[s]||u[s]||(u[s]=E.call(i));u=wa(u)}G.apply(i,u),k&&!f&&u.length>0&&r+b.length>1&&ga.uniqueSort(i)}return k&&(w=y,j=v),t};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=ya(b[c]),f[u]?d.push(f):e.push(f);f=A(a,za(e,d)),f.selector=a}return f},i=ga.select=function(a,b,c,e){var f,i,j,k,l,m="function"==typeof a&&a,n=!e&&g(a=m.selector||a);if(c=c||[],1===n.length){if(i=n[0]=n[0].slice(0),i.length>2&&"ID"===(j=i[0]).type&&9===b.nodeType&&p&&d.relative[i[1].type]){if(b=(d.find.ID(j.matches[0].replace(_,aa),b)||[])[0],!b)return c;m&&(b=b.parentNode),a=a.slice(i.shift().value.length)}f=V.needsContext.test(a)?0:i.length;while(f--){if(j=i[f],d.relative[k=j.type])break;if((l=d.find[k])&&(e=l(j.matches[0].replace(_,aa),$.test(i[0].type)&&qa(b.parentNode)||b))){if(i.splice(f,1),a=e.length&&sa(i),!a)return G.apply(c,e),c;break}}}return(m||h(a,n))(e,b,!p,c,!b||$.test(a)&&qa(b.parentNode)||b),c},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("fieldset"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(J,function(a,b,c){var d;if(!c)return a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);r.find=x,r.expr=x.selectors,r.expr[":"]=r.expr.pseudos,r.uniqueSort=r.unique=x.uniqueSort,r.text=x.getText,r.isXMLDoc=x.isXML,r.contains=x.contains,r.escapeSelector=x.escape;var y=function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&r(a).is(c))break;d.push(a)}return d},z=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},A=r.expr.match.needsContext,B=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,C=/^.[^:#\[\.,]*$/;function D(a,b,c){return r.isFunction(b)?r.grep(a,function(a,d){return!!b.call(a,d,a)!==c}):b.nodeType?r.grep(a,function(a){return a===b!==c}):"string"!=typeof b?r.grep(a,function(a){return i.call(b,a)>-1!==c}):C.test(b)?r.filter(b,a,c):(b=r.filter(b,a),r.grep(a,function(a){return i.call(b,a)>-1!==c&&1===a.nodeType}))}r.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?r.find.matchesSelector(d,a)?[d]:[]:r.find.matches(a,r.grep(b,function(a){return 1===a.nodeType}))},r.fn.extend({find:function(a){var b,c,d=this.length,e=this;if("string"!=typeof a)return this.pushStack(r(a).filter(function(){for(b=0;b<d;b++)if(r.contains(e[b],this))return!0}));for(c=this.pushStack([]),b=0;b<d;b++)r.find(a,e[b],c);return d>1?r.uniqueSort(c):c},filter:function(a){return this.pushStack(D(this,a||[],!1))},not:function(a){return this.pushStack(D(this,a||[],!0))},is:function(a){return!!D(this,"string"==typeof a&&A.test(a)?r(a):a||[],!1).length}});var E,F=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,G=r.fn.init=function(a,b,c){var e,f;if(!a)return this;if(c=c||E,"string"==typeof a){if(e="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:F.exec(a),!e||!e[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(e[1]){if(b=b instanceof r?b[0]:b,r.merge(this,r.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:d,!0)),B.test(e[1])&&r.isPlainObject(b))for(e in b)r.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e]);return this}return f=d.getElementById(e[2]),f&&(this[0]=f,this.length=1),this}return a.nodeType?(this[0]=a,this.length=1,this):r.isFunction(a)?void 0!==c.ready?c.ready(a):a(r):r.makeArray(a,this)};G.prototype=r.fn,E=r(d);var H=/^(?:parents|prev(?:Until|All))/,I={children:!0,contents:!0,next:!0,prev:!0};r.fn.extend({has:function(a){var b=r(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(r.contains(this,b[a]))return!0})},closest:function(a,b){var c,d=0,e=this.length,f=[],g="string"!=typeof a&&r(a);if(!A.test(a))for(;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&r.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?r.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?i.call(r(a),this[0]):i.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(r.uniqueSort(r.merge(this.get(),r(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function J(a,b){while((a=a[b])&&1!==a.nodeType);return a}r.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return y(a,"parentNode")},parentsUntil:function(a,b,c){return y(a,"parentNode",c)},next:function(a){return J(a,"nextSibling")},prev:function(a){return J(a,"previousSibling")},nextAll:function(a){return y(a,"nextSibling")},prevAll:function(a){return y(a,"previousSibling")},nextUntil:function(a,b,c){return y(a,"nextSibling",c)},prevUntil:function(a,b,c){return y(a,"previousSibling",c)},siblings:function(a){return z((a.parentNode||{}).firstChild,a)},children:function(a){return z(a.firstChild)},contents:function(a){return a.contentDocument||r.merge([],a.childNodes)}},function(a,b){r.fn[a]=function(c,d){var e=r.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=r.filter(d,e)),this.length>1&&(I[a]||r.uniqueSort(e),H.test(a)&&e.reverse()),this.pushStack(e)}});var K=/[^\x20\t\r\n\f]+/g;function L(a){var b={};return r.each(a.match(K)||[],function(a,c){b[c]=!0}),b}r.Callbacks=function(a){a="string"==typeof a?L(a):r.extend({},a);var b,c,d,e,f=[],g=[],h=-1,i=function(){for(e=a.once,d=b=!0;g.length;h=-1){c=g.shift();while(++h<f.length)f[h].apply(c[0],c[1])===!1&&a.stopOnFalse&&(h=f.length,c=!1)}a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},j={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function d(b){r.each(b,function(b,c){r.isFunction(c)?a.unique&&j.has(c)||f.push(c):c&&c.length&&"string"!==r.type(c)&&d(c)})}(arguments),c&&!b&&i()),this},remove:function(){return r.each(arguments,function(a,b){var c;while((c=r.inArray(b,f,c))>-1)f.splice(c,1),c<=h&&h--}),this},has:function(a){return a?r.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=g=[],c||b||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return j.fireWith(this,arguments),this},fired:function(){return!!d}};return j};function M(a){return a}function N(a){throw a}function O(a,b,c){var d;try{a&&r.isFunction(d=a.promise)?d.call(a).done(b).fail(c):a&&r.isFunction(d=a.then)?d.call(a,b,c):b.call(void 0,a)}catch(a){c.call(void 0,a)}}r.extend({Deferred:function(b){var c=[["notify","progress",r.Callbacks("memory"),r.Callbacks("memory"),2],["resolve","done",r.Callbacks("once memory"),r.Callbacks("once memory"),0,"resolved"],["reject","fail",r.Callbacks("once memory"),r.Callbacks("once memory"),1,"rejected"]],d="pending",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),this},"catch":function(a){return e.then(null,a)},pipe:function(){var a=arguments;return r.Deferred(function(b){r.each(c,function(c,d){var e=r.isFunction(a[d[4]])&&a[d[4]];f[d[1]](function(){var a=e&&e.apply(this,arguments);a&&r.isFunction(a.promise)?a.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[d[0]+"With"](this,e?[a]:arguments)})}),a=null}).promise()},then:function(b,d,e){var f=0;function g(b,c,d,e){return function(){var h=this,i=arguments,j=function(){var a,j;if(!(b<f)){if(a=d.apply(h,i),a===c.promise())throw new TypeError("Thenable self-resolution");j=a&&("object"==typeof a||"function"==typeof a)&&a.then,r.isFunction(j)?e?j.call(a,g(f,c,M,e),g(f,c,N,e)):(f++,j.call(a,g(f,c,M,e),g(f,c,N,e),g(f,c,M,c.notifyWith))):(d!==M&&(h=void 0,i=[a]),(e||c.resolveWith)(h,i))}},k=e?j:function(){try{j()}catch(a){r.Deferred.exceptionHook&&r.Deferred.exceptionHook(a,k.stackTrace),b+1>=f&&(d!==N&&(h=void 0,i=[a]),c.rejectWith(h,i))}};b?k():(r.Deferred.getStackHook&&(k.stackTrace=r.Deferred.getStackHook()),a.setTimeout(k))}}return r.Deferred(function(a){c[0][3].add(g(0,a,r.isFunction(e)?e:M,a.notifyWith)),c[1][3].add(g(0,a,r.isFunction(b)?b:M)),c[2][3].add(g(0,a,r.isFunction(d)?d:N))}).promise()},promise:function(a){return null!=a?r.extend(a,e):e}},f={};return r.each(c,function(a,b){var g=b[2],h=b[5];e[b[1]]=g.add,h&&g.add(function(){d=h},c[3-a][2].disable,c[0][2].lock),g.add(b[3].fire),f[b[0]]=function(){return f[b[0]+"With"](this===f?void 0:this,arguments),this},f[b[0]+"With"]=g.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(a){var b=arguments.length,c=b,d=Array(c),e=f.call(arguments),g=r.Deferred(),h=function(a){return function(c){d[a]=this,e[a]=arguments.length>1?f.call(arguments):c,--b||g.resolveWith(d,e)}};if(b<=1&&(O(a,g.done(h(c)).resolve,g.reject),"pending"===g.state()||r.isFunction(e[c]&&e[c].then)))return g.then();while(c--)O(e[c],h(c),g.reject);return g.promise()}});var P=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;r.Deferred.exceptionHook=function(b,c){a.console&&a.console.warn&&b&&P.test(b.name)&&a.console.warn("jQuery.Deferred exception: "+b.message,b.stack,c)},r.readyException=function(b){a.setTimeout(function(){throw b})};var Q=r.Deferred();r.fn.ready=function(a){return Q.then(a)["catch"](function(a){r.readyException(a)}),this},r.extend({isReady:!1,readyWait:1,holdReady:function(a){a?r.readyWait++:r.ready(!0)},ready:function(a){(a===!0?--r.readyWait:r.isReady)||(r.isReady=!0,a!==!0&&--r.readyWait>0||Q.resolveWith(d,[r]))}}),r.ready.then=Q.then;function R(){d.removeEventListener("DOMContentLoaded",R),
a.removeEventListener("load",R),r.ready()}"complete"===d.readyState||"loading"!==d.readyState&&!d.documentElement.doScroll?a.setTimeout(r.ready):(d.addEventListener("DOMContentLoaded",R),a.addEventListener("load",R));var S=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===r.type(c)){e=!0;for(h in c)S(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,r.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(r(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},T=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function U(){this.expando=r.expando+U.uid++}U.uid=1,U.prototype={cache:function(a){var b=a[this.expando];return b||(b={},T(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[r.camelCase(b)]=c;else for(d in b)e[r.camelCase(d)]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][r.camelCase(b)]},access:function(a,b,c){return void 0===b||b&&"string"==typeof b&&void 0===c?this.get(a,b):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d=a[this.expando];if(void 0!==d){if(void 0!==b){r.isArray(b)?b=b.map(r.camelCase):(b=r.camelCase(b),b=b in d?[b]:b.match(K)||[]),c=b.length;while(c--)delete d[b[c]]}(void 0===b||r.isEmptyObject(d))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!r.isEmptyObject(b)}};var V=new U,W=new U,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Y=/[A-Z]/g;function Z(a){return"true"===a||"false"!==a&&("null"===a?null:a===+a+""?+a:X.test(a)?JSON.parse(a):a)}function $(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Y,"-$&").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c=Z(c)}catch(e){}W.set(a,b,c)}else c=void 0;return c}r.extend({hasData:function(a){return W.hasData(a)||V.hasData(a)},data:function(a,b,c){return W.access(a,b,c)},removeData:function(a,b){W.remove(a,b)},_data:function(a,b,c){return V.access(a,b,c)},_removeData:function(a,b){V.remove(a,b)}}),r.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=W.get(f),1===f.nodeType&&!V.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=r.camelCase(d.slice(5)),$(f,d,e[d])));V.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){W.set(this,a)}):S(this,function(b){var c;if(f&&void 0===b){if(c=W.get(f,a),void 0!==c)return c;if(c=$(f,a),void 0!==c)return c}else this.each(function(){W.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){W.remove(this,a)})}}),r.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=V.get(a,b),c&&(!d||r.isArray(c)?d=V.access(a,b,r.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=r.queue(a,b),d=c.length,e=c.shift(),f=r._queueHooks(a,b),g=function(){r.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return V.get(a,c)||V.access(a,c,{empty:r.Callbacks("once memory").add(function(){V.remove(a,[b+"queue",c])})})}}),r.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?r.queue(this[0],a):void 0===b?this:this.each(function(){var c=r.queue(this,a,b);r._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&r.dequeue(this,a)})},dequeue:function(a){return this.each(function(){r.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=r.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=V.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var _=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,aa=new RegExp("^(?:([+-])=|)("+_+")([a-z%]*)$","i"),ba=["Top","Right","Bottom","Left"],ca=function(a,b){return a=b||a,"none"===a.style.display||""===a.style.display&&r.contains(a.ownerDocument,a)&&"none"===r.css(a,"display")},da=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};function ea(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return r.css(a,b,"")},i=h(),j=c&&c[3]||(r.cssNumber[b]?"":"px"),k=(r.cssNumber[b]||"px"!==j&&+i)&&aa.exec(r.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do f=f||".5",k/=f,r.style(a,b,k+j);while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}var fa={};function ga(a){var b,c=a.ownerDocument,d=a.nodeName,e=fa[d];return e?e:(b=c.body.appendChild(c.createElement(d)),e=r.css(b,"display"),b.parentNode.removeChild(b),"none"===e&&(e="block"),fa[d]=e,e)}function ha(a,b){for(var c,d,e=[],f=0,g=a.length;f<g;f++)d=a[f],d.style&&(c=d.style.display,b?("none"===c&&(e[f]=V.get(d,"display")||null,e[f]||(d.style.display="")),""===d.style.display&&ca(d)&&(e[f]=ga(d))):"none"!==c&&(e[f]="none",V.set(d,"display",c)));for(f=0;f<g;f++)null!=e[f]&&(a[f].style.display=e[f]);return a}r.fn.extend({show:function(){return ha(this,!0)},hide:function(){return ha(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){ca(this)?r(this).show():r(this).hide()})}});var ia=/^(?:checkbox|radio)$/i,ja=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ka=/^$|\/(?:java|ecma)script/i,la={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};la.optgroup=la.option,la.tbody=la.tfoot=la.colgroup=la.caption=la.thead,la.th=la.td;function ma(a,b){var c;return c="undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName(b||"*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll(b||"*"):[],void 0===b||b&&r.nodeName(a,b)?r.merge([a],c):c}function na(a,b){for(var c=0,d=a.length;c<d;c++)V.set(a[c],"globalEval",!b||V.get(b[c],"globalEval"))}var oa=/<|&#?\w+;/;function pa(a,b,c,d,e){for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],n=0,o=a.length;n<o;n++)if(f=a[n],f||0===f)if("object"===r.type(f))r.merge(m,f.nodeType?[f]:f);else if(oa.test(f)){g=g||l.appendChild(b.createElement("div")),h=(ja.exec(f)||["",""])[1].toLowerCase(),i=la[h]||la._default,g.innerHTML=i[1]+r.htmlPrefilter(f)+i[2],k=i[0];while(k--)g=g.lastChild;r.merge(m,g.childNodes),g=l.firstChild,g.textContent=""}else m.push(b.createTextNode(f));l.textContent="",n=0;while(f=m[n++])if(d&&r.inArray(f,d)>-1)e&&e.push(f);else if(j=r.contains(f.ownerDocument,f),g=ma(l.appendChild(f),"script"),j&&na(g),c){k=0;while(f=g[k++])ka.test(f.type||"")&&c.push(f)}return l}!function(){var a=d.createDocumentFragment(),b=a.appendChild(d.createElement("div")),c=d.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),o.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",o.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var qa=d.documentElement,ra=/^key/,sa=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ta=/^([^.]*)(?:\.(.+)|)/;function ua(){return!0}function va(){return!1}function wa(){try{return d.activeElement}catch(a){}}function xa(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)xa(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),e===!1)e=va;else if(!e)return a;return 1===f&&(g=e,e=function(a){return r().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=r.guid++)),a.each(function(){r.event.add(this,b,e,d,c)})}r.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=V.get(a);if(q){c.handler&&(f=c,c=f.handler,e=f.selector),e&&r.find.matchesSelector(qa,e),c.guid||(c.guid=r.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return"undefined"!=typeof r&&r.event.triggered!==b.type?r.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(K)||[""],j=b.length;while(j--)h=ta.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=r.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=r.event.special[n]||{},k=r.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&r.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),r.event.global[n]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=V.hasData(a)&&V.get(a);if(q&&(i=q.events)){b=(b||"").match(K)||[""],j=b.length;while(j--)if(h=ta.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){l=r.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||r.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)r.event.remove(a,n+b[j],c,d,!0);r.isEmptyObject(i)&&V.remove(a,"handle events")}},dispatch:function(a){var b=r.event.fix(a),c,d,e,f,g,h,i=new Array(arguments.length),j=(V.get(this,"events")||{})[b.type]||[],k=r.event.special[b.type]||{};for(i[0]=b,c=1;c<arguments.length;c++)i[c]=arguments[c];if(b.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,b)!==!1){h=r.event.handlers.call(this,b,j),c=0;while((f=h[c++])&&!b.isPropagationStopped()){b.currentTarget=f.elem,d=0;while((g=f.handlers[d++])&&!b.isImmediatePropagationStopped())b.rnamespace&&!b.rnamespace.test(g.namespace)||(b.handleObj=g,b.data=g.data,e=((r.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(b.result=e)===!1&&(b.preventDefault(),b.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,b),b.result}},handlers:function(a,b){var c,d,e,f,g,h=[],i=b.delegateCount,j=a.target;if(i&&j.nodeType&&!("click"===a.type&&a.button>=1))for(;j!==this;j=j.parentNode||this)if(1===j.nodeType&&("click"!==a.type||j.disabled!==!0)){for(f=[],g={},c=0;c<i;c++)d=b[c],e=d.selector+" ",void 0===g[e]&&(g[e]=d.needsContext?r(e,this).index(j)>-1:r.find(e,this,null,[j]).length),g[e]&&f.push(d);f.length&&h.push({elem:j,handlers:f})}return j=this,i<b.length&&h.push({elem:j,handlers:b.slice(i)}),h},addProp:function(a,b){Object.defineProperty(r.Event.prototype,a,{enumerable:!0,configurable:!0,get:r.isFunction(b)?function(){if(this.originalEvent)return b(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[a]},set:function(b){Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(a){return a[r.expando]?a:new r.Event(a)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==wa()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===wa()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&r.nodeName(this,"input"))return this.click(),!1},_default:function(a){return r.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},r.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},r.Event=function(a,b){return this instanceof r.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?ua:va,this.target=a.target&&3===a.target.nodeType?a.target.parentNode:a.target,this.currentTarget=a.currentTarget,this.relatedTarget=a.relatedTarget):this.type=a,b&&r.extend(this,b),this.timeStamp=a&&a.timeStamp||r.now(),void(this[r.expando]=!0)):new r.Event(a,b)},r.Event.prototype={constructor:r.Event,isDefaultPrevented:va,isPropagationStopped:va,isImmediatePropagationStopped:va,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ua,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ua,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ua,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},r.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(a){var b=a.button;return null==a.which&&ra.test(a.type)?null!=a.charCode?a.charCode:a.keyCode:!a.which&&void 0!==b&&sa.test(a.type)?1&b?1:2&b?3:4&b?2:0:a.which}},r.event.addProp),r.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){r.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||r.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),r.fn.extend({on:function(a,b,c,d){return xa(this,a,b,c,d)},one:function(a,b,c,d){return xa(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,r(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&"function"!=typeof b||(c=b,b=void 0),c===!1&&(c=va),this.each(function(){r.event.remove(this,a,c,b)})}});var ya=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,za=/<script|<style|<link/i,Aa=/checked\s*(?:[^=]|=\s*.checked.)/i,Ba=/^true\/(.*)/,Ca=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Da(a,b){return r.nodeName(a,"table")&&r.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a:a}function Ea(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function Fa(a){var b=Ba.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function Ga(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(V.hasData(a)&&(f=V.access(a),g=V.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)r.event.add(b,e,j[e][c])}W.hasData(a)&&(h=W.access(a),i=r.extend({},h),W.set(b,i))}}function Ha(a,b){var c=b.nodeName.toLowerCase();"input"===c&&ia.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function Ia(a,b,c,d){b=g.apply([],b);var e,f,h,i,j,k,l=0,m=a.length,n=m-1,q=b[0],s=r.isFunction(q);if(s||m>1&&"string"==typeof q&&!o.checkClone&&Aa.test(q))return a.each(function(e){var f=a.eq(e);s&&(b[0]=q.call(this,e,f.html())),Ia(f,b,c,d)});if(m&&(e=pa(b,a[0].ownerDocument,!1,a,d),f=e.firstChild,1===e.childNodes.length&&(e=f),f||d)){for(h=r.map(ma(e,"script"),Ea),i=h.length;l<m;l++)j=e,l!==n&&(j=r.clone(j,!0,!0),i&&r.merge(h,ma(j,"script"))),c.call(a[l],j,l);if(i)for(k=h[h.length-1].ownerDocument,r.map(h,Fa),l=0;l<i;l++)j=h[l],ka.test(j.type||"")&&!V.access(j,"globalEval")&&r.contains(k,j)&&(j.src?r._evalUrl&&r._evalUrl(j.src):p(j.textContent.replace(Ca,""),k))}return a}function Ja(a,b,c){for(var d,e=b?r.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||r.cleanData(ma(d)),d.parentNode&&(c&&r.contains(d.ownerDocument,d)&&na(ma(d,"script")),d.parentNode.removeChild(d));return a}r.extend({htmlPrefilter:function(a){return a.replace(ya,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=r.contains(a.ownerDocument,a);if(!(o.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||r.isXMLDoc(a)))for(g=ma(h),f=ma(a),d=0,e=f.length;d<e;d++)Ha(f[d],g[d]);if(b)if(c)for(f=f||ma(a),g=g||ma(h),d=0,e=f.length;d<e;d++)Ga(f[d],g[d]);else Ga(a,h);return g=ma(h,"script"),g.length>0&&na(g,!i&&ma(a,"script")),h},cleanData:function(a){for(var b,c,d,e=r.event.special,f=0;void 0!==(c=a[f]);f++)if(T(c)){if(b=c[V.expando]){if(b.events)for(d in b.events)e[d]?r.event.remove(c,d):r.removeEvent(c,d,b.handle);c[V.expando]=void 0}c[W.expando]&&(c[W.expando]=void 0)}}}),r.fn.extend({detach:function(a){return Ja(this,a,!0)},remove:function(a){return Ja(this,a)},text:function(a){return S(this,function(a){return void 0===a?r.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return Ia(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Da(this,a);b.appendChild(a)}})},prepend:function(){return Ia(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Da(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return Ia(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return Ia(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(r.cleanData(ma(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return r.clone(this,a,b)})},html:function(a){return S(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!za.test(a)&&!la[(ja.exec(a)||["",""])[1].toLowerCase()]){a=r.htmlPrefilter(a);try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(r.cleanData(ma(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return Ia(this,arguments,function(b){var c=this.parentNode;r.inArray(this,a)<0&&(r.cleanData(ma(this)),c&&c.replaceChild(b,this))},a)}}),r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){r.fn[a]=function(a){for(var c,d=[],e=r(a),f=e.length-1,g=0;g<=f;g++)c=g===f?this:this.clone(!0),r(e[g])[b](c),h.apply(d,c.get());return this.pushStack(d)}});var Ka=/^margin/,La=new RegExp("^("+_+")(?!px)[a-z%]+$","i"),Ma=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)};!function(){function b(){if(i){i.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",i.innerHTML="",qa.appendChild(h);var b=a.getComputedStyle(i);c="1%"!==b.top,g="2px"===b.marginLeft,e="4px"===b.width,i.style.marginRight="50%",f="4px"===b.marginRight,qa.removeChild(h),i=null}}var c,e,f,g,h=d.createElement("div"),i=d.createElement("div");i.style&&(i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",o.clearCloneStyle="content-box"===i.style.backgroundClip,h.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",h.appendChild(i),r.extend(o,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return b(),e},pixelMarginRight:function(){return b(),f},reliableMarginLeft:function(){return b(),g}}))}();function Na(a,b,c){var d,e,f,g,h=a.style;return c=c||Ma(a),c&&(g=c.getPropertyValue(b)||c[b],""!==g||r.contains(a.ownerDocument,a)||(g=r.style(a,b)),!o.pixelMarginRight()&&La.test(g)&&Ka.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function Oa(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}var Pa=/^(none|table(?!-c[ea]).+)/,Qa={position:"absolute",visibility:"hidden",display:"block"},Ra={letterSpacing:"0",fontWeight:"400"},Sa=["Webkit","Moz","ms"],Ta=d.createElement("div").style;function Ua(a){if(a in Ta)return a;var b=a[0].toUpperCase()+a.slice(1),c=Sa.length;while(c--)if(a=Sa[c]+b,a in Ta)return a}function Va(a,b,c){var d=aa.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function Wa(a,b,c,d,e){var f,g=0;for(f=c===(d?"border":"content")?4:"width"===b?1:0;f<4;f+=2)"margin"===c&&(g+=r.css(a,c+ba[f],!0,e)),d?("content"===c&&(g-=r.css(a,"padding"+ba[f],!0,e)),"margin"!==c&&(g-=r.css(a,"border"+ba[f]+"Width",!0,e))):(g+=r.css(a,"padding"+ba[f],!0,e),"padding"!==c&&(g+=r.css(a,"border"+ba[f]+"Width",!0,e)));return g}function Xa(a,b,c){var d,e=!0,f=Ma(a),g="border-box"===r.css(a,"boxSizing",!1,f);if(a.getClientRects().length&&(d=a.getBoundingClientRect()[b]),d<=0||null==d){if(d=Na(a,b,f),(d<0||null==d)&&(d=a.style[b]),La.test(d))return d;e=g&&(o.boxSizingReliable()||d===a.style[b]),d=parseFloat(d)||0}return d+Wa(a,b,c||(g?"border":"content"),e,f)+"px"}r.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Na(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=r.camelCase(b),i=a.style;return b=r.cssProps[h]||(r.cssProps[h]=Ua(h)||h),g=r.cssHooks[b]||r.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=aa.exec(c))&&e[1]&&(c=ea(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(r.cssNumber[h]?"":"px")),o.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=r.camelCase(b);return b=r.cssProps[h]||(r.cssProps[h]=Ua(h)||h),g=r.cssHooks[b]||r.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=Na(a,b,d)),"normal"===e&&b in Ra&&(e=Ra[b]),""===c||c?(f=parseFloat(e),c===!0||isFinite(f)?f||0:e):e}}),r.each(["height","width"],function(a,b){r.cssHooks[b]={get:function(a,c,d){if(c)return!Pa.test(r.css(a,"display"))||a.getClientRects().length&&a.getBoundingClientRect().width?Xa(a,b,d):da(a,Qa,function(){return Xa(a,b,d)})},set:function(a,c,d){var e,f=d&&Ma(a),g=d&&Wa(a,b,d,"border-box"===r.css(a,"boxSizing",!1,f),f);return g&&(e=aa.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=r.css(a,b)),Va(a,c,g)}}}),r.cssHooks.marginLeft=Oa(o.reliableMarginLeft,function(a,b){if(b)return(parseFloat(Na(a,"marginLeft"))||a.getBoundingClientRect().left-da(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px"}),r.each({margin:"",padding:"",border:"Width"},function(a,b){r.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+ba[d]+b]=f[d]||f[d-2]||f[0];return e}},Ka.test(a)||(r.cssHooks[a+b].set=Va)}),r.fn.extend({css:function(a,b){return S(this,function(a,b,c){var d,e,f={},g=0;if(r.isArray(b)){for(d=Ma(a),e=b.length;g<e;g++)f[b[g]]=r.css(a,b[g],!1,d);return f}return void 0!==c?r.style(a,b,c):r.css(a,b)},a,b,arguments.length>1)}});function Ya(a,b,c,d,e){return new Ya.prototype.init(a,b,c,d,e)}r.Tween=Ya,Ya.prototype={constructor:Ya,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||r.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(r.cssNumber[c]?"":"px")},cur:function(){var a=Ya.propHooks[this.prop];return a&&a.get?a.get(this):Ya.propHooks._default.get(this)},run:function(a){var b,c=Ya.propHooks[this.prop];return this.options.duration?this.pos=b=r.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Ya.propHooks._default.set(this),this}},Ya.prototype.init.prototype=Ya.prototype,Ya.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=r.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){r.fx.step[a.prop]?r.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[r.cssProps[a.prop]]&&!r.cssHooks[a.prop]?a.elem[a.prop]=a.now:r.style(a.elem,a.prop,a.now+a.unit)}}},Ya.propHooks.scrollTop=Ya.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},r.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},r.fx=Ya.prototype.init,r.fx.step={};var Za,$a,_a=/^(?:toggle|show|hide)$/,ab=/queueHooks$/;function bb(){$a&&(a.requestAnimationFrame(bb),r.fx.tick())}function cb(){return a.setTimeout(function(){Za=void 0}),Za=r.now()}function db(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=ba[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function eb(a,b,c){for(var d,e=(hb.tweeners[b]||[]).concat(hb.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function fb(a,b,c){var d,e,f,g,h,i,j,k,l="width"in b||"height"in b,m=this,n={},o=a.style,p=a.nodeType&&ca(a),q=V.get(a,"fxshow");c.queue||(g=r._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,m.always(function(){m.always(function(){g.unqueued--,r.queue(a,"fx").length||g.empty.fire()})}));for(d in b)if(e=b[d],_a.test(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}n[d]=q&&q[d]||r.style(a,d)}if(i=!r.isEmptyObject(b),i||!r.isEmptyObject(n)){l&&1===a.nodeType&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=q&&q.display,null==j&&(j=V.get(a,"display")),k=r.css(a,"display"),"none"===k&&(j?k=j:(ha([a],!0),j=a.style.display||j,k=r.css(a,"display"),ha([a]))),("inline"===k||"inline-block"===k&&null!=j)&&"none"===r.css(a,"float")&&(i||(m.done(function(){o.display=j}),null==j&&(k=o.display,j="none"===k?"":k)),o.display="inline-block")),c.overflow&&(o.overflow="hidden",m.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]})),i=!1;for(d in n)i||(q?"hidden"in q&&(p=q.hidden):q=V.access(a,"fxshow",{display:j}),f&&(q.hidden=!p),p&&ha([a],!0),m.done(function(){p||ha([a]),V.remove(a,"fxshow");for(d in n)r.style(a,d,n[d])})),i=eb(p?q[d]:0,d,m),d in q||(q[d]=i.start,p&&(i.end=i.start,i.start=0))}}function gb(a,b){var c,d,e,f,g;for(c in a)if(d=r.camelCase(c),e=b[d],f=a[c],r.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=r.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function hb(a,b,c){var d,e,f=0,g=hb.prefilters.length,h=r.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Za||cb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:r.extend({},b),opts:r.extend(!0,{specialEasing:{},easing:r.easing._default},c),originalProperties:b,originalOptions:c,startTime:Za||cb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=r.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(gb(k,j.opts.specialEasing);f<g;f++)if(d=hb.prefilters[f].call(j,a,k,j.opts))return r.isFunction(d.stop)&&(r._queueHooks(j.elem,j.opts.queue).stop=r.proxy(d.stop,d)),d;return r.map(k,eb,j),r.isFunction(j.opts.start)&&j.opts.start.call(a,j),r.fx.timer(r.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}r.Animation=r.extend(hb,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return ea(c.elem,a,aa.exec(b),c),c}]},tweener:function(a,b){r.isFunction(a)?(b=a,a=["*"]):a=a.match(K);for(var c,d=0,e=a.length;d<e;d++)c=a[d],hb.tweeners[c]=hb.tweeners[c]||[],hb.tweeners[c].unshift(b)},prefilters:[fb],prefilter:function(a,b){b?hb.prefilters.unshift(a):hb.prefilters.push(a)}}),r.speed=function(a,b,c){var e=a&&"object"==typeof a?r.extend({},a):{complete:c||!c&&b||r.isFunction(a)&&a,duration:a,easing:c&&b||b&&!r.isFunction(b)&&b};return r.fx.off||d.hidden?e.duration=0:"number"!=typeof e.duration&&(e.duration in r.fx.speeds?e.duration=r.fx.speeds[e.duration]:e.duration=r.fx.speeds._default),null!=e.queue&&e.queue!==!0||(e.queue="fx"),e.old=e.complete,e.complete=function(){r.isFunction(e.old)&&e.old.call(this),e.queue&&r.dequeue(this,e.queue)},e},r.fn.extend({fadeTo:function(a,b,c,d){return this.filter(ca).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=r.isEmptyObject(a),f=r.speed(b,c,d),g=function(){var b=hb(this,r.extend({},a),f);(e||V.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=r.timers,g=V.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&ab.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||r.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=V.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=r.timers,g=d?d.length:0;for(c.finish=!0,r.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),r.each(["toggle","show","hide"],function(a,b){var c=r.fn[b];r.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(db(b,!0),a,d,e)}}),r.each({slideDown:db("show"),slideUp:db("hide"),slideToggle:db("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){r.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),r.timers=[],r.fx.tick=function(){var a,b=0,c=r.timers;for(Za=r.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||r.fx.stop(),Za=void 0},r.fx.timer=function(a){r.timers.push(a),a()?r.fx.start():r.timers.pop()},r.fx.interval=13,r.fx.start=function(){$a||($a=a.requestAnimationFrame?a.requestAnimationFrame(bb):a.setInterval(r.fx.tick,r.fx.interval))},r.fx.stop=function(){a.cancelAnimationFrame?a.cancelAnimationFrame($a):a.clearInterval($a),$a=null},r.fx.speeds={slow:600,fast:200,_default:400},r.fn.delay=function(b,c){return b=r.fx?r.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=d.createElement("input"),b=d.createElement("select"),c=b.appendChild(d.createElement("option"));a.type="checkbox",o.checkOn=""!==a.value,o.optSelected=c.selected,a=d.createElement("input"),a.value="t",a.type="radio",o.radioValue="t"===a.value}();var ib,jb=r.expr.attrHandle;r.fn.extend({attr:function(a,b){return S(this,r.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){r.removeAttr(this,a)})}}),r.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return"undefined"==typeof a.getAttribute?r.prop(a,b,c):(1===f&&r.isXMLDoc(a)||(e=r.attrHooks[b.toLowerCase()]||(r.expr.match.bool.test(b)?ib:void 0)),
void 0!==c?null===c?void r.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=r.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!o.radioValue&&"radio"===b&&r.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d=0,e=b&&b.match(K);if(e&&1===a.nodeType)while(c=e[d++])a.removeAttribute(c)}}),ib={set:function(a,b,c){return b===!1?r.removeAttr(a,c):a.setAttribute(c,c),c}},r.each(r.expr.match.bool.source.match(/\w+/g),function(a,b){var c=jb[b]||r.find.attr;jb[b]=function(a,b,d){var e,f,g=b.toLowerCase();return d||(f=jb[g],jb[g]=e,e=null!=c(a,b,d)?g:null,jb[g]=f),e}});var kb=/^(?:input|select|textarea|button)$/i,lb=/^(?:a|area)$/i;r.fn.extend({prop:function(a,b){return S(this,r.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[r.propFix[a]||a]})}}),r.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&r.isXMLDoc(a)||(b=r.propFix[b]||b,e=r.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=r.find.attr(a,"tabindex");return b?parseInt(b,10):kb.test(a.nodeName)||lb.test(a.nodeName)&&a.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),o.optSelected||(r.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),r.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){r.propFix[this.toLowerCase()]=this});function mb(a){var b=a.match(K)||[];return b.join(" ")}function nb(a){return a.getAttribute&&a.getAttribute("class")||""}r.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).addClass(a.call(this,b,nb(this)))});if("string"==typeof a&&a){b=a.match(K)||[];while(c=this[i++])if(e=nb(c),d=1===c.nodeType&&" "+mb(e)+" "){g=0;while(f=b[g++])d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=mb(d),e!==h&&c.setAttribute("class",h)}}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).removeClass(a.call(this,b,nb(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a){b=a.match(K)||[];while(c=this[i++])if(e=nb(c),d=1===c.nodeType&&" "+mb(e)+" "){g=0;while(f=b[g++])while(d.indexOf(" "+f+" ")>-1)d=d.replace(" "+f+" "," ");h=mb(d),e!==h&&c.setAttribute("class",h)}}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):r.isFunction(a)?this.each(function(c){r(this).toggleClass(a.call(this,c,nb(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c){d=0,e=r(this),f=a.match(K)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else void 0!==a&&"boolean"!==c||(b=nb(this),b&&V.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||a===!1?"":V.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;b=" "+a+" ";while(c=this[d++])if(1===c.nodeType&&(" "+mb(nb(c))+" ").indexOf(b)>-1)return!0;return!1}});var ob=/\r/g;r.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=r.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,r(this).val()):a,null==e?e="":"number"==typeof e?e+="":r.isArray(e)&&(e=r.map(e,function(a){return null==a?"":a+""})),b=r.valHooks[this.type]||r.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=r.valHooks[e.type]||r.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(ob,""):null==c?"":c)}}}),r.extend({valHooks:{option:{get:function(a){var b=r.find.attr(a,"value");return null!=b?b:mb(r.text(a))}},select:{get:function(a){var b,c,d,e=a.options,f=a.selectedIndex,g="select-one"===a.type,h=g?null:[],i=g?f+1:e.length;for(d=f<0?i:g?f:0;d<i;d++)if(c=e[d],(c.selected||d===f)&&!c.disabled&&(!c.parentNode.disabled||!r.nodeName(c.parentNode,"optgroup"))){if(b=r(c).val(),g)return b;h.push(b)}return h},set:function(a,b){var c,d,e=a.options,f=r.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=r.inArray(r.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),r.each(["radio","checkbox"],function(){r.valHooks[this]={set:function(a,b){if(r.isArray(b))return a.checked=r.inArray(r(a).val(),b)>-1}},o.checkOn||(r.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var pb=/^(?:focusinfocus|focusoutblur)$/;r.extend(r.event,{trigger:function(b,c,e,f){var g,h,i,j,k,m,n,o=[e||d],p=l.call(b,"type")?b.type:b,q=l.call(b,"namespace")?b.namespace.split("."):[];if(h=i=e=e||d,3!==e.nodeType&&8!==e.nodeType&&!pb.test(p+r.event.triggered)&&(p.indexOf(".")>-1&&(q=p.split("."),p=q.shift(),q.sort()),k=p.indexOf(":")<0&&"on"+p,b=b[r.expando]?b:new r.Event(p,"object"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=q.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=e),c=null==c?[b]:r.makeArray(c,[b]),n=r.event.special[p]||{},f||!n.trigger||n.trigger.apply(e,c)!==!1)){if(!f&&!n.noBubble&&!r.isWindow(e)){for(j=n.delegateType||p,pb.test(j+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),i=h;i===(e.ownerDocument||d)&&o.push(i.defaultView||i.parentWindow||a)}g=0;while((h=o[g++])&&!b.isPropagationStopped())b.type=g>1?j:n.bindType||p,m=(V.get(h,"events")||{})[b.type]&&V.get(h,"handle"),m&&m.apply(h,c),m=k&&h[k],m&&m.apply&&T(h)&&(b.result=m.apply(h,c),b.result===!1&&b.preventDefault());return b.type=p,f||b.isDefaultPrevented()||n._default&&n._default.apply(o.pop(),c)!==!1||!T(e)||k&&r.isFunction(e[p])&&!r.isWindow(e)&&(i=e[k],i&&(e[k]=null),r.event.triggered=p,e[p](),r.event.triggered=void 0,i&&(e[k]=i)),b.result}},simulate:function(a,b,c){var d=r.extend(new r.Event,c,{type:a,isSimulated:!0});r.event.trigger(d,null,b)}}),r.fn.extend({trigger:function(a,b){return this.each(function(){r.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return r.event.trigger(a,b,c,!0)}}),r.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(a,b){r.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),r.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),o.focusin="onfocusin"in a,o.focusin||r.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){r.event.simulate(b,a.target,r.event.fix(a))};r.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=V.access(d,b);e||d.addEventListener(a,c,!0),V.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=V.access(d,b)-1;e?V.access(d,b,e):(d.removeEventListener(a,c,!0),V.remove(d,b))}}});var qb=a.location,rb=r.now(),sb=/\?/;r.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(d){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||r.error("Invalid XML: "+b),c};var tb=/\[\]$/,ub=/\r?\n/g,vb=/^(?:submit|button|image|reset|file)$/i,wb=/^(?:input|select|textarea|keygen)/i;function xb(a,b,c,d){var e;if(r.isArray(b))r.each(b,function(b,e){c||tb.test(a)?d(a,e):xb(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==r.type(b))d(a,b);else for(e in b)xb(a+"["+e+"]",b[e],c,d)}r.param=function(a,b){var c,d=[],e=function(a,b){var c=r.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(null==c?"":c)};if(r.isArray(a)||a.jquery&&!r.isPlainObject(a))r.each(a,function(){e(this.name,this.value)});else for(c in a)xb(c,a[c],b,e);return d.join("&")},r.fn.extend({serialize:function(){return r.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=r.prop(this,"elements");return a?r.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!r(this).is(":disabled")&&wb.test(this.nodeName)&&!vb.test(a)&&(this.checked||!ia.test(a))}).map(function(a,b){var c=r(this).val();return null==c?null:r.isArray(c)?r.map(c,function(a){return{name:b.name,value:a.replace(ub,"\r\n")}}):{name:b.name,value:c.replace(ub,"\r\n")}}).get()}});var yb=/%20/g,zb=/#.*$/,Ab=/([?&])_=[^&]*/,Bb=/^(.*?):[ \t]*([^\r\n]*)$/gm,Cb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Db=/^(?:GET|HEAD)$/,Eb=/^\/\//,Fb={},Gb={},Hb="*/".concat("*"),Ib=d.createElement("a");Ib.href=qb.href;function Jb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(K)||[];if(r.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Kb(a,b,c,d){var e={},f=a===Gb;function g(h){var i;return e[h]=!0,r.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Lb(a,b){var c,d,e=r.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&r.extend(!0,a,d),a}function Mb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function Nb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}r.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:qb.href,type:"GET",isLocal:Cb.test(qb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Hb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":r.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Lb(Lb(a,r.ajaxSettings),b):Lb(r.ajaxSettings,a)},ajaxPrefilter:Jb(Fb),ajaxTransport:Jb(Gb),ajax:function(b,c){"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m,n,o=r.ajaxSetup({},c),p=o.context||o,q=o.context&&(p.nodeType||p.jquery)?r(p):r.event,s=r.Deferred(),t=r.Callbacks("once memory"),u=o.statusCode||{},v={},w={},x="canceled",y={readyState:0,getResponseHeader:function(a){var b;if(k){if(!h){h={};while(b=Bb.exec(g))h[b[1].toLowerCase()]=b[2]}b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return k?g:null},setRequestHeader:function(a,b){return null==k&&(a=w[a.toLowerCase()]=w[a.toLowerCase()]||a,v[a]=b),this},overrideMimeType:function(a){return null==k&&(o.mimeType=a),this},statusCode:function(a){var b;if(a)if(k)y.always(a[y.status]);else for(b in a)u[b]=[u[b],a[b]];return this},abort:function(a){var b=a||x;return e&&e.abort(b),A(0,b),this}};if(s.promise(y),o.url=((b||o.url||qb.href)+"").replace(Eb,qb.protocol+"//"),o.type=c.method||c.type||o.method||o.type,o.dataTypes=(o.dataType||"*").toLowerCase().match(K)||[""],null==o.crossDomain){j=d.createElement("a");try{j.href=o.url,j.href=j.href,o.crossDomain=Ib.protocol+"//"+Ib.host!=j.protocol+"//"+j.host}catch(z){o.crossDomain=!0}}if(o.data&&o.processData&&"string"!=typeof o.data&&(o.data=r.param(o.data,o.traditional)),Kb(Fb,o,c,y),k)return y;l=r.event&&o.global,l&&0===r.active++&&r.event.trigger("ajaxStart"),o.type=o.type.toUpperCase(),o.hasContent=!Db.test(o.type),f=o.url.replace(zb,""),o.hasContent?o.data&&o.processData&&0===(o.contentType||"").indexOf("application/x-www-form-urlencoded")&&(o.data=o.data.replace(yb,"+")):(n=o.url.slice(f.length),o.data&&(f+=(sb.test(f)?"&":"?")+o.data,delete o.data),o.cache===!1&&(f=f.replace(Ab,"$1"),n=(sb.test(f)?"&":"?")+"_="+rb++ +n),o.url=f+n),o.ifModified&&(r.lastModified[f]&&y.setRequestHeader("If-Modified-Since",r.lastModified[f]),r.etag[f]&&y.setRequestHeader("If-None-Match",r.etag[f])),(o.data&&o.hasContent&&o.contentType!==!1||c.contentType)&&y.setRequestHeader("Content-Type",o.contentType),y.setRequestHeader("Accept",o.dataTypes[0]&&o.accepts[o.dataTypes[0]]?o.accepts[o.dataTypes[0]]+("*"!==o.dataTypes[0]?", "+Hb+"; q=0.01":""):o.accepts["*"]);for(m in o.headers)y.setRequestHeader(m,o.headers[m]);if(o.beforeSend&&(o.beforeSend.call(p,y,o)===!1||k))return y.abort();if(x="abort",t.add(o.complete),y.done(o.success),y.fail(o.error),e=Kb(Gb,o,c,y)){if(y.readyState=1,l&&q.trigger("ajaxSend",[y,o]),k)return y;o.async&&o.timeout>0&&(i=a.setTimeout(function(){y.abort("timeout")},o.timeout));try{k=!1,e.send(v,A)}catch(z){if(k)throw z;A(-1,z)}}else A(-1,"No Transport");function A(b,c,d,h){var j,m,n,v,w,x=c;k||(k=!0,i&&a.clearTimeout(i),e=void 0,g=h||"",y.readyState=b>0?4:0,j=b>=200&&b<300||304===b,d&&(v=Mb(o,y,d)),v=Nb(o,v,y,j),j?(o.ifModified&&(w=y.getResponseHeader("Last-Modified"),w&&(r.lastModified[f]=w),w=y.getResponseHeader("etag"),w&&(r.etag[f]=w)),204===b||"HEAD"===o.type?x="nocontent":304===b?x="notmodified":(x=v.state,m=v.data,n=v.error,j=!n)):(n=x,!b&&x||(x="error",b<0&&(b=0))),y.status=b,y.statusText=(c||x)+"",j?s.resolveWith(p,[m,x,y]):s.rejectWith(p,[y,x,n]),y.statusCode(u),u=void 0,l&&q.trigger(j?"ajaxSuccess":"ajaxError",[y,o,j?m:n]),t.fireWith(p,[y,x]),l&&(q.trigger("ajaxComplete",[y,o]),--r.active||r.event.trigger("ajaxStop")))}return y},getJSON:function(a,b,c){return r.get(a,b,c,"json")},getScript:function(a,b){return r.get(a,void 0,b,"script")}}),r.each(["get","post"],function(a,b){r[b]=function(a,c,d,e){return r.isFunction(c)&&(e=e||d,d=c,c=void 0),r.ajax(r.extend({url:a,type:b,dataType:e,data:c,success:d},r.isPlainObject(a)&&a))}}),r._evalUrl=function(a){return r.ajax({url:a,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},r.fn.extend({wrapAll:function(a){var b;return this[0]&&(r.isFunction(a)&&(a=a.call(this[0])),b=r(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this},wrapInner:function(a){return r.isFunction(a)?this.each(function(b){r(this).wrapInner(a.call(this,b))}):this.each(function(){var b=r(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=r.isFunction(a);return this.each(function(c){r(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(a){return this.parent(a).not("body").each(function(){r(this).replaceWith(this.childNodes)}),this}}),r.expr.pseudos.hidden=function(a){return!r.expr.pseudos.visible(a)},r.expr.pseudos.visible=function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},r.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Ob={0:200,1223:204},Pb=r.ajaxSettings.xhr();o.cors=!!Pb&&"withCredentials"in Pb,o.ajax=Pb=!!Pb,r.ajaxTransport(function(b){var c,d;if(o.cors||Pb&&!b.crossDomain)return{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Ob[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}}),r.ajaxPrefilter(function(a){a.crossDomain&&(a.contents.script=!1)}),r.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return r.globalEval(a),a}}}),r.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),r.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(e,f){b=r("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&f("error"===a.type?404:200,a.type)}),d.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Qb=[],Rb=/(=)\?(?=&|$)|\?\?/;r.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Qb.pop()||r.expando+"_"+rb++;return this[a]=!0,a}}),r.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Rb.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Rb.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=r.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Rb,"$1"+e):b.jsonp!==!1&&(b.url+=(sb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||r.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?r(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Qb.push(e)),g&&r.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),o.createHTMLDocument=function(){var a=d.implementation.createHTMLDocument("").body;return a.innerHTML="<form></form><form></form>",2===a.childNodes.length}(),r.parseHTML=function(a,b,c){if("string"!=typeof a)return[];"boolean"==typeof b&&(c=b,b=!1);var e,f,g;return b||(o.createHTMLDocument?(b=d.implementation.createHTMLDocument(""),e=b.createElement("base"),e.href=d.location.href,b.head.appendChild(e)):b=d),f=B.exec(a),g=!c&&[],f?[b.createElement(f[1])]:(f=pa([a],b,g),g&&g.length&&r(g).remove(),r.merge([],f.childNodes))},r.fn.load=function(a,b,c){var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=mb(a.slice(h)),a=a.slice(0,h)),r.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&r.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?r("<div>").append(r.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},r.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){r.fn[b]=function(a){return this.on(b,a)}}),r.expr.pseudos.animated=function(a){return r.grep(r.timers,function(b){return a===b.elem}).length};function Sb(a){return r.isWindow(a)?a:9===a.nodeType&&a.defaultView}r.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=r.css(a,"position"),l=r(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=r.css(a,"top"),i=r.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),r.isFunction(b)&&(b=b.call(a,c,r.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},r.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){r.offset.setOffset(this,a,b)});var b,c,d,e,f=this[0];if(f)return f.getClientRects().length?(d=f.getBoundingClientRect(),d.width||d.height?(e=f.ownerDocument,c=Sb(e),b=e.documentElement,{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}):d):{top:0,left:0}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===r.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),r.nodeName(a[0],"html")||(d=a.offset()),d={top:d.top+r.css(a[0],"borderTopWidth",!0),left:d.left+r.css(a[0],"borderLeftWidth",!0)}),{top:b.top-d.top-r.css(c,"marginTop",!0),left:b.left-d.left-r.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent;while(a&&"static"===r.css(a,"position"))a=a.offsetParent;return a||qa})}}),r.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;r.fn[a]=function(d){return S(this,function(a,d,e){var f=Sb(a);return void 0===e?f?f[b]:a[d]:void(f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e)},a,d,arguments.length)}}),r.each(["top","left"],function(a,b){r.cssHooks[b]=Oa(o.pixelPosition,function(a,c){if(c)return c=Na(a,b),La.test(c)?r(a).position()[b]+"px":c})}),r.each({Height:"height",Width:"width"},function(a,b){r.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){r.fn[d]=function(e,f){var g=arguments.length&&(c||"boolean"!=typeof e),h=c||(e===!0||f===!0?"margin":"border");return S(this,function(b,c,e){var f;return r.isWindow(b)?0===d.indexOf("outer")?b["inner"+a]:b.document.documentElement["client"+a]:9===b.nodeType?(f=b.documentElement,Math.max(b.body["scroll"+a],f["scroll"+a],b.body["offset"+a],f["offset"+a],f["client"+a])):void 0===e?r.css(b,c,h):r.style(b,c,e,h)},b,g?e:void 0,g)}})}),r.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}}),r.parseJSON=JSON.parse,"function"==typeof define&&define.amd&&define("jquery",[],function(){return r});var Tb=a.jQuery,Ub=a.$;return r.noConflict=function(b){return a.$===r&&(a.$=Ub),b&&a.jQuery===r&&(a.jQuery=Tb),r},b||(a.jQuery=a.$=r),r});

/*! jQuery Migrate v3.0.0 | (c) jQuery Foundation and other contributors | jquery.org/license */
"undefined"==typeof jQuery.migrateMute&&(jQuery.migrateMute=!0),function(a,b){"use strict";function c(c){var d=b.console;e[c]||(e[c]=!0,a.migrateWarnings.push(c),d&&d.warn&&!a.migrateMute&&(d.warn("JQMIGRATE: "+c),a.migrateTrace&&d.trace&&d.trace()))}function d(a,b,d,e){Object.defineProperty(a,b,{configurable:!0,enumerable:!0,get:function(){return c(e),d}})}a.migrateVersion="3.0.0",function(){var c=b.console&&b.console.log&&function(){b.console.log.apply(b.console,arguments)},d=/^[12]\./;c&&(a&&!d.test(a.fn.jquery)||c("JQMIGRATE: jQuery 3.0.0+ REQUIRED"),a.migrateWarnings&&c("JQMIGRATE: Migrate plugin loaded multiple times"),c("JQMIGRATE: Migrate is installed"+(a.migrateMute?"":" with logging active")+", version "+a.migrateVersion))}();var e={};a.migrateWarnings=[],void 0===a.migrateTrace&&(a.migrateTrace=!0),a.migrateReset=function(){e={},a.migrateWarnings.length=0},"BackCompat"===document.compatMode&&c("jQuery is not compatible with Quirks Mode");var f=a.fn.init,g=a.isNumeric,h=a.find,i=/\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/,j=/\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/g;a.fn.init=function(a){var b=Array.prototype.slice.call(arguments);return"string"==typeof a&&"#"===a&&(c("jQuery( '#' ) is not a valid selector"),b[0]=[]),f.apply(this,b)},a.fn.init.prototype=a.fn,a.find=function(a){var b=Array.prototype.slice.call(arguments);if("string"==typeof a&&i.test(a))try{document.querySelector(a)}catch(d){a=a.replace(j,function(a,b,c,d){return"["+b+c+'"'+d+'"]'});try{document.querySelector(a),c("Attribute selector with '#' must be quoted: "+b[0]),b[0]=a}catch(e){c("Attribute selector with '#' was not fixed: "+b[0])}}return h.apply(this,b)};var k;for(k in h)Object.prototype.hasOwnProperty.call(h,k)&&(a.find[k]=h[k]);a.fn.size=function(){return c("jQuery.fn.size() is deprecated; use the .length property"),this.length},a.parseJSON=function(){return c("jQuery.parseJSON is deprecated; use JSON.parse"),JSON.parse.apply(null,arguments)},a.isNumeric=function(b){function d(b){var c=b&&b.toString();return!a.isArray(b)&&c-parseFloat(c)+1>=0}var e=g(b),f=d(b);return e!==f&&c("jQuery.isNumeric() should not be called on constructed objects"),f},d(a,"unique",a.uniqueSort,"jQuery.unique is deprecated, use jQuery.uniqueSort"),d(a.expr,"filters",a.expr.pseudos,"jQuery.expr.filters is now jQuery.expr.pseudos"),d(a.expr,":",a.expr.pseudos,'jQuery.expr[":"] is now jQuery.expr.pseudos');var l=a.ajax;a.ajax=function(){var a=l.apply(this,arguments);return a.promise&&(d(a,"success",a.done,"jQXHR.success is deprecated and removed"),d(a,"error",a.fail,"jQXHR.error is deprecated and removed"),d(a,"complete",a.always,"jQXHR.complete is deprecated and removed")),a};var m=a.fn.removeAttr,n=a.fn.toggleClass,o=/\S+/g;a.fn.removeAttr=function(b){var d=this;return a.each(b.match(o),function(b,e){a.expr.match.bool.test(e)&&(c("jQuery.fn.removeAttr no longer sets boolean properties: "+e),d.prop(e,!1))}),m.apply(this,arguments)},a.fn.toggleClass=function(b){return void 0!==b&&"boolean"!=typeof b?n.apply(this,arguments):(c("jQuery.fn.toggleClass( boolean ) is deprecated"),this.each(function(){var c=this.getAttribute&&this.getAttribute("class")||"";c&&a.data(this,"__className__",c),this.setAttribute&&this.setAttribute("class",c||b===!1?"":a.data(this,"__className__")||"")}))};var p=!1;a.swap&&a.each(["height","width","reliableMarginRight"],function(b,c){var d=a.cssHooks[c]&&a.cssHooks[c].get;d&&(a.cssHooks[c].get=function(){var a;return p=!0,a=d.apply(this,arguments),p=!1,a})}),a.swap=function(a,b,d,e){var f,g,h={};p||c("jQuery.swap() is undocumented and deprecated");for(g in b)h[g]=a.style[g],a.style[g]=b[g];f=d.apply(a,e||[]);for(g in b)a.style[g]=h[g];return f};var q=a.data;a.data=function(b,d,e){var f;return d&&d!==a.camelCase(d)&&(f=a.hasData(b)&&q.call(this,b),f&&d in f)?(c("jQuery.data() always sets/gets camelCased names: "+d),arguments.length>2&&(f[d]=e),f[d]):q.apply(this,arguments)};var r=a.Tween.prototype.run;a.Tween.prototype.run=function(b){a.easing[this.easing].length>1&&(c('easing function "jQuery.easing.'+this.easing.toString()+'" should use only first argument'),a.easing[this.easing]=a.easing[this.easing].bind(a.easing,b,this.options.duration*b,0,1,this.options.duration)),r.apply(this,arguments)};var s=a.fn.load,t=a.event.fix;a.event.props=[],a.event.fixHooks={},a.event.fix=function(b){var d,e=b.type,f=this.fixHooks[e],g=a.event.props;if(g.length)for(c("jQuery.event.props are deprecated and removed: "+g.join());g.length;)a.event.addProp(g.pop());if(f&&!f._migrated_&&(f._migrated_=!0,c("jQuery.event.fixHooks are deprecated and removed: "+e),(g=f.props)&&g.length))for(;g.length;)a.event.addProp(g.pop());return d=t.call(this,b),f&&f.filter?f.filter(d,b):d},a.each(["load","unload","error"],function(b,d){a.fn[d]=function(){var a=Array.prototype.slice.call(arguments,0);return"load"===d&&"string"==typeof a[0]?s.apply(this,a):(c("jQuery.fn."+d+"() is deprecated"),a.splice(0,0,d),arguments.length?this.on.apply(this,a):(this.triggerHandler.apply(this,a),this))}}),a(function(){a(document).triggerHandler("ready")}),a.event.special.ready={setup:function(){this===document&&c("'ready' event is deprecated")}},a.fn.extend({bind:function(a,b,d){return c("jQuery.fn.bind() is deprecated"),this.on(a,null,b,d)},unbind:function(a,b){return c("jQuery.fn.unbind() is deprecated"),this.off(a,null,b)},delegate:function(a,b,d,e){return c("jQuery.fn.delegate() is deprecated"),this.on(b,a,d,e)},undelegate:function(a,b,d){return c("jQuery.fn.undelegate() is deprecated"),1===arguments.length?this.off(a,"**"):this.off(b,a||"**",d)}});var u=a.fn.offset;a.fn.offset=function(){var b,d=this[0],e={top:0,left:0};return d&&d.nodeType?(b=(d.ownerDocument||document).documentElement,a.contains(b,d)?u.apply(this,arguments):(c("jQuery.fn.offset() requires an element connected to a document"),e)):(c("jQuery.fn.offset() requires a valid DOM element"),e)};var v=a.param;a.param=function(b,d){var e=a.ajaxSettings&&a.ajaxSettings.traditional;return void 0===d&&e&&(c("jQuery.param() no longer uses jQuery.ajaxSettings.traditional"),d=e),v.call(this,b,d)};var w=a.fn.andSelf||a.fn.addBack;a.fn.andSelf=function(){return c("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),w.apply(this,arguments)};var x=a.Deferred,y=[["resolve","done",a.Callbacks("once memory"),a.Callbacks("once memory"),"resolved"],["reject","fail",a.Callbacks("once memory"),a.Callbacks("once memory"),"rejected"],["notify","progress",a.Callbacks("memory"),a.Callbacks("memory")]];a.Deferred=function(b){var d=x(),e=d.promise();return d.pipe=e.pipe=function(){var b=arguments;return c("deferred.pipe() is deprecated"),a.Deferred(function(c){a.each(y,function(f,g){var h=a.isFunction(b[f])&&b[f];d[g[1]](function(){var b=h&&h.apply(this,arguments);b&&a.isFunction(b.promise)?b.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[g[0]+"With"](this===e?c.promise():this,h?[b]:arguments)})}),b=null}).promise()},b&&b.call(d,d),d}}(jQuery,window);
/*
Copyright Bubble Group, Inc.
*/

/*build id: 637fc50a1a40dad5a5f07b62480b8980869ce14050f5aceb5c5ab9510df02e3b */ 
(function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var u=typeof require=="function"&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<r.length;a++)i(r[a]);return i})({1:[function(e,t,n){(function(){var t,n,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w;v=e("./u");t=e("./lib");a=e("./client_config");w=e("./webfonts");y=e("url");d=e("./locations");n=e("./client/locationservice");r=e("./client/userservice");o=e("./db/client_db");u=e("./db/db");l=e("./default_lib");_=e("./client/oauth");s=e("./core/core_elements");g=e("./client/seo_runner");f=e("./client/elementservice");b=e("./lang/values");e("./box");i=e("./lang/appquery");h=e("./client/page_load");m=e("./tests/testing");if(typeof document!=="undefined"&&document!==null){window.document_ready_key=v.MakeKey(null,"window.document_ready_key");$(document).ready(function(){return window.document_ready_key.turn()})}if(typeof window!=="undefined"&&window!==null){p=v.json_parse(window._p);window.display_page=function(e,s){var u,d;h.render_start();if(a.env!=="local"){jQuery.migrateMute=true}if(v.on_phonegap()){if(!window.web_url_equivalent_for_phonegap){throw v.error("missing web_url_equivalent_for_phonegap for phonegap app. Should be set in index.html when generating the phonegap build")}d=new n(window.web_url_equivalent_for_phonegap)}else{d=new n(document.location.href)}window.Lib=t;u=l.get();v.extend(u,{app:i.make_run_app(e),is_edit_mode:false,appname:function(){return e._id},app_version:function(){return e.app_version},db_instance:o.instance,current_user:o.current_user,location:d,user:new r,element:new f.ElementService,ignore_privacy_rules:function(){return false},values:b,app_plan:function(){return p},show_error_to_user:function(e){var n,r,i,o;if(t().workflow["debugger"]){return(r=t().workflow["debugger"])!=null?r.report_error(e):void 0}else{if((i=e.instance)!=null?i.element_id:void 0){n="Element "+e.instance.element_id()}else if(e.event){n="Event "+e.event.id()}else if(e.instance){n="Action "+e.instance}else if(e.type==="general"){n="General error"}return console.log("%c"+"Error - "+n+" - "+((o=e.prop_name)!=null?o:"")+" "+e.error.message,"color: red;")}}});t.set_global_lib(u);return v.WaitFor(window.document_ready_key,function(){if(!window.dont_call_page_display){c(s)}v.stop_count();h.render_end();if(a.page_speed_metrics_on){return t().element.on_page_done_loading(false,function(){return h.fully_loaded()})}})}}c=function(e){var n,r,o,l=this;o=new Date;n=i.get_page_by_name(e);v.WaitFor(w.active_key,function(){var e;return(e=window.performance)!=null?typeof e.mark==="function"?e.mark("webfonts active"):void 0:void 0});if(y.parse(document.location.href,true).query.debug_mode){if(window.start_debugger!=null){window.start_debugger()}else{r=y.parse(document.location.href,true);delete r.query.debug_mode;delete r.search;window.history.replaceState(null,null,y.format(r))}}v.createCookie(u.get_page_cookie(),v.LUID(),1);t().element.display(n);return _.onload(function(){var n,o,u;t().workflow.initialize();t().location.load();m.initialize();if((u=t().appname())==="test_app"||u==="test_app2"){o=t().load_plugin("Module:runmode_tests");o.initialize()}t().user.on_page_load_for_confirmation_email();r=y.parse(document.location.href,true);n=r.pathname.split("/");if(v.readCookie("temp_db")){if(r.host==="bubble.is"){v.eraseCookie("temp_db")}else{console.log("TEMP DB IS SET!!!")}}v.run_once(30,function(){i.app().get_public_setting("status_bar_color");return i.app().get_public_setting("spinner_color")},function(){});return v.WaitFor(t().user.ready_key,w.active_key,function(){return setTimeout(function(){v.page_is_loaded();setTimeout(function(){return window.onpopstate=function(){return t().pageparam.invalidate()}},1500);setTimeout(function(){return s.load_all_page_images(e)},2e3);setTimeout(function(){if(!(i.app_plan().no_branding&&i.get_public_setting("remove_bubble_console"))||i.app_plan().force_branding_live){return v.console_with_styling("This web application is entirely built without code on Bubble https://bubble.is")}},500);if((!i.app_plan().no_branding&&!a.is_dedicated||i.app_version()==="live"&&i.app_plan().force_branding_live)&&!v.is_debug_mode()){setTimeout(function(){var e,t,n,r,i,o,a;t=function(){var e,t,n,r;t=Math.floor(Math.random()*3+1);r=[];for(e=n=0;0<=t?n<=t:n>=t;e=0<=t?++n:--n){r.push($("body").append($("<div></div>")))}return r};t();n=$('<div style="width: 100%; position: fixed; bottom: 0; height: 50px; background: rgba(29, 140, 204, 1); background: -webkit-linear-gradient(left, rgb(29, 140, 204) 0%, rgb(96, 185, 240) 100%); background: -moz-linear-gradient(left, rgba(29, 140, 204, 1) 0%, rgba(96, 185, 240, 1) 100%); background: -o-linear-gradient(left, rgba(29, 140, 204, 1) 0%, rgba(96, 185, 240, 1) 100%); background: -ms-linear-gradient(left, rgba(29, 140, 204, 1) 0%, rgba(96, 185, 240, 1) 100%); background: linear-gradient(left, rgba(29, 140, 204, 1) 0%, rgba(96, 185, 240, 1) 100%); z-index: 100000000000;"></div>');a=$('<div style="position: absolute;"></div>');r=$('<a target="_blank" style="width: 100%; height: 100%; position: absolute;"></a>');i=$('<div style=""></div>');i.append($('<img src="//dd7tel2830j4w.cloudfront.net/f1412177849691x849826261401176500/bubble_logo__2.png" style="width: 102px; margin-top: 11px; float: left;"></img>'));o=$('<div style="color: white; font-size: 14px; font-family: SANS-SERIF; margin-top: 19px; float: left; margin-left: 20px;"></div>');i.append(o);n.append(a.append(i));n.append(r);r.attr("href","https://bubble.is?utm_source=app_mention&num="+Math.floor(Math.random()*100));$("body").append(n);t();e=function(){if($(window).width()>=1300){a[0].style["left"]="50%";a[0].style["transform"]="translate(-50%,0)";return o.text("This web app is built without code on Bubble. Build your own at bubble.is.")}else if($(window).width()>=1050){a[0].style["left"]="39%";a[0].style["transform"]="translate(-30%,0)";return o.text("This web app is built without code on Bubble. Build your own at bubble.is.")}else if($(window).width()>=850){a[0].style["left"]="17%";a[0].style["transform"]="translate(0%,0)";return o.text("This web app is built without code on Bubble. Build your own at bubble.is.")}else if($(window).width()>=750){a[0].style["left"]="12%";a[0].style["transform"]="translate(0%,0)";return o.text("This web app is built without code on Bubble. Build your own at bubble.is.")}else if($(window).width()>=650){a[0].style["left"]="13%";a[0].style["transform"]="translate(0%,0)";return o.text("This web app is built without code on Bubble.")}else if($(window).width()>=515){a[0].style["left"]="10%";a[0].style["transform"]="translate(0%,0)";return o.text("This web app is built without code on Bubble.")}else if($(window).width()>=350){a[0].style["left"]="7%";a[0].style["transform"]="translate(0%,0)";return o.text("Build a web app without code.")}else{a[0].style["left"]="0%";a[0].style["transform"]="translate(0%,0)";return o.text("Build a web app without code.")}};$(window).on("resize",e);return e()},100)}return g.do_it()},200)})})}}).call(this)},{"./box":6,"./client/elementservice":7,"./client/locationservice":8,"./client/oauth":9,"./client/page_load":10,"./client/seo_runner":12,"./client/userservice":14,"./client_config":16,"./core/core_elements":19,"./db/client_db":27,"./db/db":28,"./default_lib":33,"./lang/appquery":51,"./lang/values":62,"./lib":65,"./locations":66,"./tests/testing":71,"./u":72,"./webfonts":76,url:299}],2:[function(e,t,n){(function(){var t,r,i,o,a,s=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};a=n;i=e("./../lib/client_config");o=e("url");r={};t=".amazonaws.com";a.is_on_amazon=function(e){var n;if(e==null){e=""}n=e.indexOf(t);return n!==-1&&n+t.length===e.length};a.get_meta_hostname_for_app=function(e){if(i.is_dedicated){return i.dedicated_subdomain}else{return i.PROD_DOMAINS.main}};a.is_meta_hostname=function(e){var t,n,r;r=e.indexOf(".local");if(r!==-1&&r+".local".length===e.length){return true}if(i.is_dedicated&&e===i.dedicated_subdomain){return true}if(a.is_on_amazon(e)){return true}if(s.call(function(){var e,r;e=i.PROD_DOMAINS;r=[];for(t in e){n=e[t];r.push(n)}return r}(),e)>=0){return true}if(e===i.LOCAL_DOMAIN){return true}return false};a.get_meta_hostname=function(e){if(e==null){e=""}if(i.echo_hostname){if(a.is_meta_hostname(e)){return e}}if(i.env===i.PROD_ENV){if(i.is_dedicated){return i.dedicated_subdomain}return i.PROD_DOMAINS[i.cluster]}else{return i.LOCAL_DOMAIN}};if(typeof window!=="undefined"&&window!==null){$(document).ready(function(){if(typeof mixpanel!=="undefined"&&mixpanel!==null){if(a.is_on_amazon(o.parse(window.location.href).hostname)){mixpanel.register({$ignore:"true"});return console.log("turning off mixpanel because we are testing")}}})}}).call(this)},{"./../lib/client_config":16,url:299}],3:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B={}.hasOwnProperty,N=function(e,t){for(var n in t){if(B.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e},L=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};_=n;S=e("./u");S.safe_register("./apiconnectorbase",_);y=e("./external");E=e("./lang/values");d=e("./lib");m=e("./db/db");A=e("url");p=e("./lang/appquery");x=e("./services");v=e("./default_lib");w=e;if(S.on_server()){M=w("xml2js");c=w("./fileupload")}_.user_friendly_parameter_names={headers:"(header)",params:"(parameter)",url_params:"(path)",body_params:"(body)",shared_headers:"(shared headers)",shared_params:"(shared parameters)"};k=function(e){var t,n,r;if(Array.isArray(e)){if(e.length===1){return k(e[0])}return function(){var t,n,i;i=[];for(t=0,n=e.length;t<n;t++){r=e[t];i.push(k(r))}return i}()}else if(e&&typeof e==="object"){n={};for(t in e){r=e[t];if(t!=="$"){n[t]=k(r)}}return n}else{return e}};h=/\[([^\]]+)]/g;b=/<[^>]+>/g;_.find_between_characters=function(e,t){var n,r,i,o,a,s,u,l,c,f,d,_;o=[];if(!e){return o}switch(t){case"bracket":a=h;r="[";break;case"less_than":a=b;r="<";break;default:r=t;d=["\\",".","^","$","*","+","?"];for(u=0,c=d.length;u<c;u++){s=d[u];t=t.split(s).join("\\"+s)}a=new RegExp(t+"(.*?)"+t,"g")}i=e.match(a);_=i!=null?i:[];for(l=0,f=_.length;l<f;l++){n=_[l];if(t==="bracket"||t==="less_than"){if(n.slice(1).indexOf(r)===-1){o.push(n.slice(1,-1))}}else{o.push(n.slice(r.length,-r.length))}}return o};T=function(e){var t;t=S.Block("xml_to_json");M.parseString(e,function(n,r){if(n){return t.fail(S.error({statusCode:400,message:"Unable to parse response: "+e}))}else{return t.success(r)}});return k(t.wait())};_.validate_header_name=function(e){var t,n,r,i;if(typeof e!=="string"||!(e!=null?e.length:void 0)){return false}for(n=r=0,i=e.length;0<=i?r<i:r>i;n=0<=i?++r:--r){t=e.charCodeAt(n);if(t>=65&&t<=90){continue}if(t>=97&&t<=122){continue}if(t===94||t===95||t===96||t===124||t===126){continue}if(t===48||t===57){continue}if(t>=33&&t<=46){if(t===34||t===40||t===41||t===44){return false}continue}return false}return true};_.validate_header_value=function(e){var t,n,r,i;if(e==null){return false}e=""+e;if(!e.length){return false}for(n=r=0,i=e.length;0<=i?r<i:r>i;n=0<=i?++r:--r){t=e.charCodeAt(n);if(t===9){continue}if(t<=31||t>255||t===127){return false}}return true};_.add_shared_params_and_headers=function(e,t,n,r,i){var o,a,s,u,l,c,f,d,p,h;if(e.shared_headers!=null){if(t.headers==null){t.headers={}}f=e.shared_headers;for(a in f){o=f[a];if(!(t.headers[o.key]==null&&o.key)){continue}if(!_.validate_header_name(o.key)){throw S.error({statusCode:400,message:n+" error: this header name is not correct "+o.key})}l=r(a,o);if(!_.validate_header_value(l)){throw S.error({statusCode:400,message:n+" error: this header value for "+o.key+" is not correct "+l})}t.headers[o.key]=l}}if(e.shared_params!=null){c=(d=t.data)!=null?d:t.body;if(c==null){c={}}p=e.shared_params;for(u in p){s=p[u];if(!(c[s.key]==null&&s.key)){continue}l=i(u,s);c[s.key]=l}if(((h=t.data)!=null?h:t.body)==null){return t.body=c}}};C=function(e,t){var n;if(!e){return}if(p.app_version()==="test"){return(n=e[t+"_test"])!=null?n:e[t]}else{return e[t]}};_.get_values_from_call=function(e,t,n){var r,i,o,a,s,l,c,d;c=t.calls;d=[];for(l in c){r=c[l];d.push(function(){var e,t,l,c;t=r.types;c=[];for(s in t){a=t[s];l=a.fields;e=function(e){var t;if((t=e.ret_value)===null||t===void 0||t===f){return delete a.fields[o]}else{return e.post_call_processing=function(t){var n,r;if((r=e.ret_value)==="geographic_address"||r==="date"){if(e.ret_value==="date"){if(typeof t==="number"&&String(t).length<10){t=t*1e3}}n=E.get(e.ret_value);return n.V.cast(t)}else{return t}}}};for(o in l){i=l[o];e(i)}c.push(n[s]=new u(a.caption,a.fields,{storable:true}))}return c}())}return d};_.get_call_from_raw=function(e,t,n,r){var i,o,a,s,u,l,f,d,p,h,m,v,b;if(!r){u=e}else{u=t.api_id+"."+e}l={};if((!t.url_params||S.is_empty(t.url_params))&&!t.url_private&&r&&!t.url_cant_be_private){l.url={display:"Call endpoint - URL",editor:"LongText",no_enter:true,no_rich_text_editing:true,"default":t.url}}a=function(e){var n,i,o,a,s,u;o=t[e];u=[];for(a in o){i=o[a];if(i!=null?i.key:void 0){if(r&&!i["private"]||!r&&((s=i.visibility)===void 0||s==="public")){if(t.body_type==="form_data"&&i.binary_file){n="DynamicFile"}else{if(i.long_text){n="LongText"}else{n="ShortText"}}u.push(l[S.encode_key(e+"_"+i.key)]={display:_.user_friendly_parameter_names[e]+" "+i.key,editor:n,"default":i.value,optional:i.optional})}else{u.push(void 0)}}}return u};h=["url_params","headers","params","shared_headers","shared_params"];for(d=0,p=h.length;d<p;d++){s=h[d];a(s)}if(t.body&&y.method_uses_body(t.method)){if(!t.body_params||S.is_empty(t.body_params)){l.body={display:"Body (JSON object)",editor:"LongText",no_rich_text_editing:true,"default":t.body}}else{a("body_params")}}if(!t.no_types){if((m=E.get(t.ret_value).V)!=null?m.is_simple:void 0){f=t.ret_value}else{if(r){f="api."+r+"."+u}else{f="api."+t.api_id+".plugin_api."+u}}}else if((v=t.data_type)==="image"||v==="text"||v==="number"){f=t.data_type}if(!r){o=function(e){}}i=g["apiconnectorbase_"+u]=function(i){N(o,i);function o(){b=o.__super__.constructor.apply(this,arguments);return b}o.prototype.human=t.api_human+" - "+t.name;o.prototype._must_proxy=true;o.prototype.value_id=f;o.prototype.doc_link=t.doc_link;o.prototype.is_list=t.is_list;o.prototype.category="plugins";o.prototype.parameters=l;o.prototype.get_headers=t.get_headers;o.prototype.get_authenticator=function(){return this.service().get_authenticator(t.api_id)};o.prototype.return_type=t.no_types||t.data_type==="XML"?"raw":"json";o.prototype.build=function(i,o){var a=this;return _.generate_request_from_call_data(t,o,n,function(t,n){if(r){return}if(n==="shared_headers"||n==="shared_params"){return a.get_key(n+"_"+t)}else{return a.get_key(e+"_"+n+"_"+t)}})};o.prototype.post_processing=function(e){var n,r,i,o,a,s,u;if(e){if(t.data_type==="XML"){try{return T((o=typeof e.toString==="function"?e.toString():void 0)!=null?o:e)}catch(l){n=l;throw S.error({statusCode:400,message:"There was an issue parsing the XML body for the call "+t.api_human+" - "+t.name})}}else if(t.data_type==="image"){i=(a=typeof e.toString==="function"?e.toString():void 0)!=null?a:e;try{JSON.parse(i);r=true}catch(l){n=l}if(r){throw S.error({statusCode:400,message:"There was an issue getting the image for the call "+t.api_human+" - "+t.name+". See the response "+i})}else{return(new c).save_to_s3(e,"image.png")}}else if((s=t.data_type)==="text"||s==="number"){return(u=typeof e.toString==="function"?e.toString():void 0)!=null?u:e}}return e};return o}(y.Call);return i};_.generate_request_from_call_data=function(e,t,n,r){var i,o,a,s,u,l,c,f,p,h,g,m,v,b,w,x,k,E,M,T,C,j,D,O,I,P,R,z,B,N,q,U,F,W,G,V,Y,H;if(t==null){t={}}b=y.methods[e.method];E=(P=t.url)!=null?P:e.url;f=function(e,n,i){var o,a;if(i.optional&&t&&!S.is_empty(t)){return t[S.encode_key(e+"_"+i.key)]}return(o=(a=t[S.encode_key(e+"_"+i.key)])!=null?a:i.value)!=null?o:typeof r==="function"?r(n,e):void 0};if(e.url_params){I=_.find_between_characters(E,"bracket");R=e.url_params;for(k in R){O=R[k];if(q=O.key,L.call(I,q)>=0){E=E.replace("["+O.key+"]",f("url_params",k,O))}}}U=A.parse(E),m=U.hostname,M=U.protocol;if(!m||!M){throw S.error({statusCode:400,message:n+" error: this URL is not correct "+E})}if(e.headers!=null){g={};F=e.headers;for(h in F){p=F[h];if(!_.validate_header_name(p.key)){throw S.error({statusCode:400,message:n+" error: this header name is not correct "+p.key})}j=f("headers",h,p);if(!p.optional||p.optional&&(j!==null&&j!==void 0&&j!=="")){if(!_.validate_header_value(j)){throw S.error({statusCode:400,message:n+" error: this header value for "+p.key+" is not correct "+j})}g[p.key.trim()]=j}if(!p.optional&&(j===null||j===void 0||j==="")){return{dont_do_call:true,message:n+" error: the header "+p.key+" is empty and is mandatory"}}}}if(e.body_type!=="form_data"&&((W=(G=e.body)!=null?G.trim():void 0)!==null&&W!==void 0&&W!=="")&&y.method_uses_body(e.method)){i=(V=t.body)!=null?V:e.body;if(e.body_params){if(e.data_type==="XML"){a=_.find_between_characters(i,"_*_");Y=e.body_params;for(k in Y){o=Y[k];if(H=o.key,L.call(a,H)>=0){i=i.replace("_*_"+o.key+"_*_",f("body_params",k,o))}}}else{a=_.find_between_characters(i,"less_than");z=e.body_params;for(k in z){o=z[k];if(B=o.key,L.call(a,B)>=0){i=i.replace("<"+o.key+">",f("body_params",k,o))}}}}}if(e.params!=null){s={};T={};N=e.params;for(k in N){x=N[k];if(!(x.key!=null)){continue}j=f("params",k,x);v=x.key.trim();if(x.querystring&&e.body_type!=="form_data"){if(!x.optional||x.optional&&(j!==null&&j!==void 0&&j!=="")){T[v]=j}}else{if(!x.optional||x.optional&&(j!==null&&j!==void 0&&j!=="")){if(x.binary_file){if(j===null||j===void 0||j===""){return{dont_do_call:true,message:n+" error: the parameter "+v+" cannot be empty"}}if(j.slice(0,2)==="//"){j="http:"+j}c=decodeURIComponent(j.split("/").pop());C=d().http_request({uri:j,encoding:null}).block();if(C.statusCode!==200){return{dont_do_call:true,message:n+" error: the parameter "+v+" is not a valid file"}}s[v]={value:C.body,options:{filename:c}}}else{s[v]=j}}}if(!x.optional&&(j===null||j===void 0||j==="")){return{dont_do_call:true,message:n+" error: the parameter "+v+" is empty and is mandatory"}}}if(T!=null&&S.is_empty(T)){T=void 0}if(s!=null){if(S.is_empty(s)){s=void 0}else if(i!=null){try{i=S.json_parse(i)}catch($){l=$;throw S.error({statusCode:400,message:n+" error: this body could not be parsed as JSON "+i})}S.extend(i,s);s=void 0}}}if(e.data_type==="image"){u=null}D=6e4;w={method:b,path:E,headers:g,encoding:u,timeout:D};if(e.body_type==="form_data"){w.formData=s}else{w.body=i;w.data=s;w.qs=T}return w};_.APIConnectorBasePrivateKey=a=function(e){N(t,e);function t(e){var t;this.params=e;t=this._get_api();if(!this.params.token_param_name){if(t.auth==="private_key_url"){this.params.token_param_name="private_key"}else if(t.auth==="private_key_header"){this.params.token_param_name="Authorization"}}}t.prototype.get_secret_key=function(){return C(this._get_api(),"private_key")};return t}(y.PrivateKey);_.APIConnectorBasicAuth=s=function(e){N(t,e);function t(){j=t.__super__.constructor.apply(this,arguments);return j}t.prototype.get_secret_key=function(){var e;return(e=this._get_api())!=null?e.password:void 0};t.prototype.get_public_key=function(){var e;return(e=this._get_api())!=null?e.username:void 0};return t}(y.BasicAuth);_.APIConnectorBaseOauth2PWFlow=o=function(e){N(t,e);function t(){D=t.__super__.constructor.apply(this,arguments);return D}t.prototype.get_secret_key=function(){var e;return(e=this._get_api())!=null?e.password:void 0};t.prototype.get_public_key=function(){var e;return(e=this._get_api())!=null?e.username:void 0};return t}(y.Oauth2PWFlow);_.APIConnectorBaseOauth2Custom=i=function(e){N(t,e);function t(){O=t.__super__.constructor.apply(this,arguments);return O}t.prototype._get_token_request=function(){return this.service().get_call(this.params.call_id+".token_call").build()};return t}(y.Oauth2Custom);_.APIConnectorBaseJWT=t=function(e){N(t,e);function t(){I=t.__super__.constructor.apply(this,arguments);return I}t.prototype.get_key=function(e){var t;if(e==="iss"){return this.get_property("iss")}return(t=this._get_api())!=null?t[e]:void 0};return t}(y.JWT);_.APIConnectorBaseOauth2=r=function(e){N(t,e);function t(){P=t.__super__.constructor.apply(this,arguments);return P}t.prototype.get_secret_key=function(){return C(this._get_api(),"appsecret")};t.prototype.get_public_key=function(){return C(this._get_api(),"appid")};t.prototype.get_oauth_user_data_call=function(){return this.service().get_call(this.params.api_id+"_oauth_user_data_call")};t.prototype.get_user_authentication_node=function(e){if(d().is_edit_mode()){return new m.StaticNode(this.get_owner_token_data())}else{return t.__super__.get_user_authentication_node.call(this,e)}};t.prototype.is_still_valid=function(e){var n;try{n=t.__super__.is_still_valid.call(this,e)}catch(r){return false}return n};t.prototype.tested=function(){return this._get_api().tested};t.prototype.has_token_data=function(){return this._get_api().has_token_data};t.prototype.get_owner_token_data=function(){return this._get_api().token_data};return t}(y.Oauth2);_.get_private_key_auth_params=function(e){return{token_param_name:e.token_param_name,add_to_header:e.auth==="private_key_header",add_to_url:e.auth==="private_key_url"}};_.get_oauth2_user_auth_params=function(e){var t;return{token_param_name:(t=e.token_param_name)!=null?t:"access_token",header_key:e.header_key,scope:e.scope,authentication_url:e.authentication_url,generate_token_from_code_uri:e.generate_token_from_code_uri,add_to_header:e.add_to_header,add_to_url:!e.add_to_header,add_basic_authentication:e.add_basic_authentication,data_type:e.token_data_type?"querystring":void 0,access_type:e.add_offline?"offline":void 0,prompt:e.add_offline?"consent":void 0}};_.get_oauth2_pw_auth_params=function(e){return{generate_token_from_code_uri:e.token_endpoint,grant_type:"password",use_username_password:true}};_.get_jwt_auth_params=function(e){return{iss:e.iss,scope:e.scope,generate_token_from_code_uri:e.generate_token_from_code_uri}};f="_ignore";u=function(e){N(t,e);function t(){R=t.__super__.constructor.apply(this,arguments);return R}t.prototype.get_message_names=function(){var e,t,n,r;n=this._fields();r=[];for(e in n){t=n[e];if(t.ret_value!==f){r.push(e)}}return r};t.prototype.flatten_raw=function(e){var t,n,r,i,o,a,s,u,l,c,f,d;if(!e){return{}}a={};c=this._fields();for(r in c){i=c[r];if(i.extract){u=i.extract(e)}else if(i.no_key){u=e}else{o=(f=i.path)!=null?f:[r];u=S.extract_from_object(e,o)}if(i.post_call_processing){u=i.post_call_processing(u)}if(u!=null){if(i.ret_value){s=E.get(i.ret_value);if(i.ret_value.indexOf("list.")===0&&Array.isArray(u)){n=s.inner();if(n.V==null){throw S.error({statusCode:400,message:"Issue with the call "+this.human+". Please initialize it again"})}u=function(){var e,r,i,o,a;a=[];for(r=0,i=u.length;r<i;r++){t=u[r];a.push((o=typeof(e=n.V).extract==="function"?e.extract(t):void 0)!=null?o:t)}return a}()}else{if(s.V==null){throw S.error({statusCode:400,message:"Issue with the call "+this.human+". Please initialize it again"})}u=(d=typeof(l=s.V).extract==="function"?l.extract(u):void 0)!=null?d:u}}a[r]=u}}return a};t.prototype.convert_to_bubble_instance=function(e){var n,r,i,o,a,s,u,l,c,f;if(Array.isArray(e)){o=[];a=E.get(this.full_name);if(a.V.convert_to_bubble_instance){for(u=0,l=e.length;u<l;u++){w=e[u];o.push(a.V.convert_to_bubble_instance(w))}return new m.StaticList(o,void 0,this.full_name)}else{return new m.StaticList(e,void 0,this.full_name)}}else if(e!=null&&typeof e==="object"){o={};c=this._fields();for(r in c){i=c[r];a=E.get(i.ret_value);if(i.ret_value.indexOf("list.")===0&&Array.isArray(e[r])){n=a.inner();if(n.V instanceof t){o[r]=n.V.convert_to_bubble_instance(e[r])}else{o[r]=e[r]}}else{o[r]=(f=typeof(s=a.V).convert_to_bubble_instance==="function"?s.convert_to_bubble_instance(e[r]):void 0)!=null?f:e[r]}}o._id=e._id;return new m.StaticObject(o,void 0,this.full_name)}else{return e}};return t}(y.StructValue);_.handle_request_failures=function(e){var t;t=String(e.message);if(t.indexOf("ENOTFOUND")!==-1){return S.error({statusCode:400,message:"Could not find domain:"+t.replace("ENOTFOUND","")})}else if(t.indexOf("Failed to establish a connection after")!==-1){return S.error({statusCode:400,message:t})}else if(t.indexOf("ESOCKETTIMEDOUT")!==-1||t.indexOf("ETIMEDOUT")!==-1){return S.error({statusCode:400,message:"Could not connect to remote server"})}else if(t.indexOf("certificate not trusted")!==-1){return S.error({statusCode:400,message:"There is an issue with the remote server's SSL certificate"})}else if(t.indexOf("Hostname/IP doesn't match certificate's altnames")!==-1){return S.error({statusCode:400,message:t})}else if(v.is_retryable(e)){return S.error({statusCode:400,message:"Could not connect to the remote server"})}else{return e}};_.get_error_message=function(e,t){var n,r,i,o;n=(r=t!=null?typeof t.display==="function"?t.display():void 0:void 0)!=null?r:"this service";if(400<=(i=e.statusCode)&&i<=499){return"Raw error from "+n+": "+e.body}else if(500<=(o=e.statusCode)&&o<=599){return"Temporary error connecting to "+n+" (raw message: "+e.body+")"}};g={};_.BaseAPIConnector=l=function(e){N(t,e);function t(){z=t.__super__.constructor.apply(this,arguments);return z}t.prototype.dynamic_calls=true;t.prototype.handle_request_failures=_.handle_request_failures;t.prototype.public_values=S.autorun_cache(function(){var e,t,n,r,i,o,a,s,u,l;i=[];s=this.get_all_apis();for(t in s){e=s[t];u=e.calls;for(r in u){n=u[r];if(!n.initialized){continue}if(n.no_types){continue}l=n.types;for(o in l){a=l[o];i.push(o)}}}return i});t.prototype.values=S.autorun_cache(function(){var e,t,n,r;n={};r=this.get_all_apis();for(t in r){e=r[t];if(e.auth==="oauth2_user"){n[t+"_oauth_profile"]=new y.StructValue("Profile "+e.human,{id:{path:e.id_path!=null?e.id_path.split("."):void 0},email:{path:e.email_path!=null?e.email_path.split("."):void 0}})}_.get_values_from_call(t,e,n)}return n});t.prototype._get_sorted_list=function(e){var t,n,r,i,o,a,s,u,l;a=[];w=0;s=this.get_all_apis();for(r in s){n=s[r];u=n.calls;for(o in u){i=u[o];if(!(i.publish_as===e&&i.initialized)){continue}a.push({id:r+"."+o,rank:(l=i.rank)!=null?l:w});w++}}a.sort(function(e,t){if(e.rank<t.rank){return-1}else{return 1}});return function(){var e,n,r;r=[];for(e=0,n=a.length;e<n;e++){t=a[e];r.push(t.id)}return r}()};t.prototype.public_calls=S.autorun_cache(function(){return this._get_sorted_list("data")});t.prototype.action_calls=S.autorun_cache(function(){return this._get_sorted_list("action")});t.prototype.user_calls=S.autorun_cache(function(){var e,t,n,r;n=[];r=this.get_all_apis();for(t in r){e=r[t];if(e.auth==="oauth2_user"){n.push(t+"_oauth_user_data_call")}}return n});t.prototype.oauth_providers=S.autorun_cache(function(){var e,t,n,r;n=[];r=this.get_all_apis();for(t in r){e=r[t];if(e.auth==="oauth2_user"){n.push({id:this.BASE+x.PLUGIN_SEPERATOR+t,display:"API - "+e.human})}}return n});t.prototype.keys={};t.prototype.base_url=function(){return""};t.prototype.response_to_data=function(e,n,r,i){var o,a;if(r==null){r="json"}o=t.__super__.response_to_data.call(this,e,n,r,i);if(i!=null?i.get_headers:void 0){a=n.headers;return{body:o,headers:a}}return o};t.prototype.get_error_message=_.get_error_message;t.prototype.get_call_class=S.autorun_cache(function(e){var t;t=this.calls()[e];if(t==null){return}if(e.indexOf("_oauth_user_data_call")!==-1||e==="TestAPICall"){return t}else{return _.get_call_from_raw(e.split(".")[1],t,this.plugin_name,this.BASE)}});t.prototype.get_call=S.autorun_cache(function(e){var t;t=this._intanciate_call(e,this.get_call_class(e));if(!t&&!d().is_edit_mode()){throw S.error({statusCode:400,message:this.plugin_name+" error: the call "+e+" is missing, please reinitialize your calls."})}return t});t.prototype.calls=S.autorun_cache(function(){var e,t,n,r,i,o,a,s,u;i={};e=this.BASE;o=this.plugin_name;s=this.get_all_apis();a=function(t,n){var r,o,a,s,u,l;if(n.auth==="oauth2_user"){a=t+"_oauth_user_data_call";i[a]=g[a]=function(r){N(i,r);function i(){s=i.__super__.constructor.apply(this,arguments);return s}i.prototype.human=n.human;i.prototype._must_proxy=true;i.prototype.value_id="api."+e+"."+t+"_oauth_profile";i.prototype.build=function(e,t){var r;r=n.oauth_user_data_call;return{path:r}};i.prototype.get_authenticator=function(){return this.service().get_authenticator(t)};return i}(y.Call)}u=n.calls;l=[];for(o in u){r=u[o];r.api_human=n.human;r.api_id=t;l.push(i[t+"."+o]=r)}return l};for(r in s){n=s[r];a(r,n)}i["TestAPICall"]=t=function(e){N(t,e);function t(){u=t.__super__.constructor.apply(this,arguments);return u}t.prototype._must_proxy=true;t.prototype.build=function(e,t,n){var r,i,a;i=t.call_id,r=t.api_obj;a=r.calls[i];return _.generate_request_from_call_data(a,void 0,o)};t.prototype.execute=function(e,n,i){var o=this;return d.extend({appname:n.appname,app_version:n.app_version,is_edit_mode:function(){return true}},function(){var a,s,u,l,f,_,p,h,g,m,v,y;if(S.on_client()){return t.__super__.execute.call(o,e,n,i)}u=n.call_id,a=n.api_obj,r=n.api_id;l=a.calls[u];o.get_authenticator=function(){return this.service().get_authenticator(r,a)};try{v=o.build_request(e,n,i)}catch(b){_=b;if(_.message.indexOf(o.service().plugin_name)!==-1){throw S.error(_)}else{throw S.error({statusCode:400,message:_.message})}}if(v.dont_do_call){throw{message:v.message,statusCode:400}}try{y=d().http_request(v).block()}catch(b){_=b;h="Raw error for the API \n"+S.json_stringify(_,true);throw{message:h,statusCode:400}}if(y.statusCode>299||y.statusCode<200){g=S.json_stringify(y.body,true);if(g===null||g===void 0||g===""){g=y.statusMessage}throw S.error({statusCode:400,message:"Raw response for the API \n"+g})}if(l.data_type==="XML"){try{y.body=S.json_stringify(T(y.body));y.headers["content-type"]="application/json";delete y.headers["content-length"]}catch(b){f=b;throw S.error({statusCode:400,message:"There was an issue parsing the XML body"})}}else if(l.data_type==="image"){m=S.new_buffer(y.body,"base64");y=(new c).save_to_s3(m,"image",y.headers["content-type"])}else if(l.data_type==="JSON"){if(!y.body&&!l.get_headers){throw S.error({statusCode:400,message:"The API call returns an empty body and you picked JSON. Please check."})}}if(y.body||l.get_headers){s=S.json_parse(y.body,true);if(l.get_headers){p=y.headers;if(s){return{body:s,headers:p}}else{return{headers:p}}}return s}else{return y}})};return t}(y.Call);return i});return t}(y.Service)}).call(this)},{"./db/db":28,"./default_lib":33,"./external":40,"./lang/appquery":51,"./lang/values":62,"./lib":65,"./services":70,"./u":72,url:299}],4:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};o=n;x=e("./u");c=e("./client_config");k=e("./util");g=e("./locations");i=e("./lang/shrink").S;x.safe_register("./app_lib",o);o.simplify_data=function(e,t,n){var r,i,a,s;if(t==null){t=""}if(e==null){return null}if(typeof e==="number"&&isNaN(e)){return null}if(typeof e==="function"){return null}if(typeof e==="object"){r=false;a={};for(i in e){s=e[i];if(x.firebase_illegal(i)){if(n||x.is_plugin_edit_mode()){if(!x.is_plugin_edit_mode()){x.warn("illegal key",{k:i,path:t})}}else{throw x.error("illegal key",{k:i,path:t})}}s=o.simplify_data(s,t?t+"."+i:i,n);if(s!=null){r=true;a[i]=s}}if(r){return a}else{return null}}return e};o.delete_key=function(e,t){if(Array.isArray(e)){t=parseInt(t);return e.splice(t,1)}else{return delete e[t]}};o.fetch_node=_=function(e,t){return x.Promise(e).then(function(e){var n;n=x.Promise(null,"fetching "+(e!=null?e.toString():void 0));
n.prefetching=o.is_caching(e);if(!t){o.ensure_caching(e)}e.once("value",function(e){return n.resolve(e.val())},function(t){console.log("cannot access: "+e.toString());if(t.code==="PERMISSION_DENIED"){return n.reject({statusCode:401,message:"Sorry, you don't have permission to view this page"})}else{return n.reject(x.error("Error loading from firebase: "+x.nice_print_error(t)))}});return n})};o.write_node=E=function(e,t,n){return x.Promise(e).then(function(e){return x.Promise(t).then(function(t){var r,i;i=x.Promise(null,"writing to "+e.toString());r=function(e){if(e){return i.reject(x.error("Error writing to firebase: "+x.nice_print_error(e)))}else{return i.resolve()}};f.record_firebase_write(e,t);if(n!=null){e.setWithPriority(o.simplify_data(t),n,r)}else{e.set(o.simplify_data(t),r)}return i})})};t="app_storage";o.MAIN_VERSION=g.DEFAULT_VERSION;o.TEST_VERSION=g.TEST_VERSION;o.OKAY_VERSIONS=[o.MAIN_VERSION,o.TEST_VERSION,"old"];o.get_firebase=function(){var e;if(c.main_firebase_off){throw x.error("main firebase is off")}e=x.Promise(null,"client firebase ready key");x.WaitFor(l.firebase_ready_key(),function(){return e.resolve(l.firebase())});return e};o.should_cache=function(e){return e.length>1};o.should_not_group=function(e){var t,n;if(e.length===0){return false}return e.length<3&&((t=e[0])===i.element_definitions||t===i.pages||t==="_index")||e.length<3&&((n=e[0])==="styles"||n==="user_types")};o.get_uid_node=function(e){return A.get_root().then(function(t){return t.child("app_uid_generator").child(e)})};(function(){var e,t,n;e={};n=false;o.is_caching=function(t){var n;return(n=e[t.toString()])!=null?n.start:void 0};o.ensure_caching=function(r,i){var o,a,s;if(i==null){i=5*60*1e3}if(r.hardcode){return}a=r.toString();o=Date.now()+i;if(e[a]){e[a].expires=o}else{s=r.on("value",function(){});e[a]={expires:o,node:r,nothing_cb:s,start:Date.now()}}if(!n){n=true;return setTimeout(t,30*1e3)}};return t=function(){var n,r,i,o,a;if(x.shutting_down_process){return}i={};o=Date.now();a=null;for(r in e){n=e[r];if(o>n.expires){n.node.off("value",n.nothing_cb)}else{i[r]=n}}e=i;return setTimeout(t,30*1e3)}})();o.is_hardcode=function(e,t){return M.call(c.hard_code,e)>=0&&(t!=null?t.indexOf(c.private_version_prefix):void 0)!==0};o.safe_domain_name=b=function(e){return e.replace(/\./g,"&")};o.child_node=u=function(e,t){return x.Promise(e).then(function(e){return e.child(t)})};p=function(e){if(e){return"app_status_"+f.id_safe(o.live_key()+"-")}else{return"app_status_general-"}};o.get_last_change_topic=function(e,t){var n;n=o.is_hardcode(e,t);if(n){t="live"}return p(n)+"-last-change-"+e+"-"+t};o.get_breaking_revision_topic=function(){return p(true)+"breaking_revision"};o.is_test_app=function(e,t,n){if(t.indexOf(c.private_version_prefix)===0){return x.Promise(true)}if(n!=null){return x.Promise(n)}if(x.on_client()){throw x.error("must pass test_app_field on client")}return a.get_last_change(e,t).then(function(n){return a.get_app_data(e,t,["test_app"],n)})};o.live_key=function(){var e;return window.bubble_environment+" "+k.get_meta_hostname()+" "+((e=window.bubble_hostname_modifier)!=null?e:"")};o.make_setting_storage=function(e){var t,n,i;i=null;t=x.Box();n=function(e){t(e);if(i==null){i=x.MakeKey(null,"loading")}return i.turn()};return function(o){if(o===void 0){if(!i){i=x.MakeKey(30,"loading "+e);r().location.get("server://appeditor/app_setting/"+s.appname()+"/"+e).done(function(e){return n(e)})}x.ensure_ready(i);return t()}else{n(o);return r().location.post("server://appeditor/app_setting/"+s.appname()+"/"+e,o).done()}}};v=function(e,t,n){return function(i,o,a,s,u,l){var f,d,_,p,h;if(l==null){l=Math.floor(Date.now()/1e3)}h=l-o;if(o<=86400){p=1800}else{p=3600}if(typeof a==="function"){a()}_=function(t,n,o){var a,s;s={url:""+e+"?start_time="+t+"&end_time="+n+"&resolution="+p+"&sources%5B%5D="+i,headers:{Authorization:"Basic "+x.base64(c.librato_email+":"+c.librato_public_token)},dataType:"json"};return a=r().http_request(s).callback(function(e,t){var n;if(e){x.warn(e);if(typeof u==="function"){u()}return}n=x.json_parse(t.body);return o(n)})};f=[];d=function(e){var r,o,a,u,c,h;f.push.apply(f,(u=(c=e.measurements)!=null?c[i]:void 0)!=null?u:[]);if(!((h=e.query)!=null?h.next_time:void 0)){e=0;for(o=0,a=f.length;o<a;o++){r=f[o];e+=t(r,p)}return s(n(e))}else{return _(e.query.next_time,l,d)}};return _(h,l,d)}};o.get_maxed_out_time=v("https://metrics.librato.com/metrics-api/v1/metrics/maxed_out_time",function(e,t){return e.value*t},function(e){return Math.ceil(e/60)});o.get_page_views=v("https://metrics.librato.com/metrics-api/v1/metrics/page_views",function(e,t){return e.count},function(e){return e});f=e("./db/db");l=e("./db/client_db");S=e("./version");s=e("./lang/appquery");r=e("./lib");A=e("./db/workflow_firebase");h=e("./lang/lang");d=e;if(x.on_server()){d("./server_app_lib");w=d("./configuration");m=d("./logger");y=d("./performance");a=d("./app_server")}else{m={debug:function(){},info:function(e){return console.info(e)}}}}).call(this)},{"./client_config":16,"./db/client_db":27,"./db/db":28,"./db/workflow_firebase":32,"./lang/appquery":51,"./lang/lang":57,"./lang/shrink":61,"./lib":65,"./locations":66,"./u":72,"./util":74,"./version":75}],5:[function(e,t,n){(function(){/**
 * Adapted from SCEditor BBCode Plugin
 * http://www.sceditor.com/
 *
 * Copyright (C) 2011-2013, Sam Clarke (samclarke.com)
 *
 * SCEditor is licensed under the MIT license:
 *	http://www.opensource.org/licenses/mit-license.php
 *
 * @fileoverview SCEditor BBCode Plugin
 * @author Sam Clarke
*/
var e;var t=true,r=false,i=false,t=false,o=true,a=true,s=true;var u={always:1,never:2,auto:3};var l=function(e){return e?e.replace(/\\(.)/g,"$1").replace(/^(["'])(.*?)\1$/,"$2"):e};var c=function(){var e=arguments;return e[0].replace(/\{(\d+)\}/g,function(t,n){return typeof e[n-0+1]!=="undefined"?e[n-0+1]:"{"+n+"}"})};var f=function(e){var t,n;n=function(e){e=parseInt(e,10);if(isNaN(e))return"00";e=Math.max(0,Math.min(e,255)).toString(16);return e.length<2?"0"+e:e};e=e||"#000";if(t=e.match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i))return"#"+n(t[1])+n(t[2]-0)+n(t[3]-0);if(t=e.match(/#([0-f])([0-f])([0-f])\s*?$/i))return"#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3];return e};var d=function(e){if(!e)return e;return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ {2}/g," &nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />")};var _=function(e,t){var n=b(m(e));if(o)M(n);if(a)T(n);if(s)C(n);A(n,null,t);if(a)T(n);return n};var p={open:"open",content:"content",newline:"newline",close:"close"};var h=function(e,t,n){var r=n.length;while(r--)if(n[r].type===t&&n[r].name===e)return true;return false};var g=function(e,t,n,r,i,o){var a=this;a.type=e;a.name=t;a.val=n;a.attrs=r||{};a.children=i||[];a.closing=o||null};g.prototype={clone:function(e){var t=this;return new g(t.type,t.name,t.val,t.attrs,e?t.children:[],t.closing?t.closing.clone():null)},splitAt:function(e){var t,n=this,r=0,i=n.children.length;if(typeof object!=="number")e=n.children.indexOf(e);if(e<0||e>i)return null;while(i--){if(i>=e)r++;else i=0}t=n.clone();t.children=n.children.splice(e,r);return t}};var m=function(e){var t,n,r,i=[],o=[{type:"close",regex:/^\[\/[^\[\]]+\]/},{type:"open",regex:/^\[[^\[\]]+\]/},{type:"newline",regex:/^(\r\n|\r|\n)/},{type:"content",regex:/^([^\[\r\n]+|\[)/}];o.reverse();e:while(e.length){r=o.length;while(r--){n=o[r].type;if(!(t=e.match(o[r].regex))||!t[0])continue;i.push(v(n,t[0]));e=e.substr(t[0].length);continue e}if(e.length)i.push(v(p.content,e));e=""}return i};var v=function(e,t){var n,r,i;if(e==="open"&&(n=t.match(/\[([^\]\s=]+)(?:([^\]]+))?\]/))){i=S(n[1]);if(n[2]&&(n[2]=n[2].replace(/^\s\s*/,"").replace(/\s\s*$/,"")))r=y(n[2])}else if(e==="close"&&(n=t.match(/\[\/([^\[\]]+)\]/)))i=S(n[1]);else if(e==="newline")i="#newline";if(!i||(e==="open"||e==="close")&&!D[i]){e="content";i="#"}return new g(e,i,t,r)};var y=function(e){var t,n=/([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g,r=l,i={};if(e.charAt(0)==="="&&e.indexOf("=",1)<0)i.defaultattr=r(e.substr(1));else{if(e.charAt(0)==="=")e="defaultattr"+e;while(t=n.exec(e))i[S(t[1])]=r(t[3])||t[4]}return i};var b=function(e){var n,r,i,o,a,s,u,l=[],c=[],f=[],d=function(){return k(f)},_=function(e){if(d())d().children.push(e);else c.push(e)},g=function(e){return d()&&(r=D[d().name])&&r.closedBy&&r.closedBy.indexOf(e)>-1};while(n=e.shift()){u=e[0];switch(n.type){case p.open:if(g(n.name))f.pop();_(n);r=D[n.name];if((!r||!r.isSelfClosing)&&(r.closedBy||h(n.name,p.close,e)))f.push(n);else if(!r||!r.isSelfClosing)n.type=p.content;break;case p.close:if(d()&&n.name!==d().name&&g("/"+n.name))f.pop();if(d()&&n.name===d().name){d().closing=n;f.pop()}else if(h(n.name,p.open,f)){while(i=f.pop()){if(i.name===n.name){i.closing=n;break}o=i.clone();if(l.length>1)o.children.push(k(l));l.push(o)}_(k(l));a=l.length;while(a--)f.push(l[a]);l.length=0}else{n.type=p.content;_(n)}break;case p.newline:if(d()&&u&&g((u.type===p.close?"/":"")+u.name)){if(!(u.type===p.close&&u.name===d().name)){r=D[d().name];if(r&&r.breakAfter)f.pop();else if(r&&r.isInline===false&&t&&r.breakAfter!==false)f.pop()}}_(n);break;default:_(n);break}s=n}return c};var w={always:1,never:2,auto:3};var x=function(e,t,n){var r=/\s|=/.test(e);if(typeof t=="function")return t(e,n);if(t===w.never||t===w.auto&&!r)return e;return'"'+e.replace("\\","\\\\").replace('"','\\"')+'"'};var k=function(e){if(e.length)return e[e.length-1];return null};var S=function(e){return e.toLowerCase()};var A=function(e,n,o){var a,s,u,l,c,f,d,_,h=e.length,g=h;if(n)l=D[n.name];while(g--){if(!(a=e[g]))continue;if(a.type===p.newline){s=g>0?e[g-1]:null;u=g<h-1?e[g+1]:null;_=false;if(!o&&l&&l.isSelfClosing!==true){if(!s){if(l.isInline===false&&r&&l.breakStart!==false)_=true;if(l.breakStart)_=true}else if(!f&&!u){if(l.isInline===false&&i&&l.breakEnd!==false)_=true;if(l.breakEnd)_=true;f=_}}if(s&&s.type===p.open){if(c=D[s.name]){if(!o){if(c.isInline===false&&t&&c.breakAfter!==false)_=true;if(c.breakAfter)_=true}else if(c.isInline===false)_=true}}if(!o&&!d&&u&&u.type===p.open){if(c=D[u.name]){if(c.isInline===false&&false&&c.breakBefore!==false)_=true;if(c.breakBefore)_=true;d=_;if(_){e.splice(g,1);continue}}}if(_)e.splice(g,1);d=false}else if(a.type===p.open)A(a.children,a,o)}};var E=function(t,n){var r,i,o,a,s,u,l,f,_=[];l=function(e){return(!e||(typeof e.isHtmlInline!=="undefined"?e.isHtmlInline:e.isInline))!==false};while(t.length>0){if(!(r=t.shift()))continue;if(r.type===p.open){f=r.children[r.children.length-1]||{};i=D[r.name];s=n&&l(i);o=E(r.children,false);if(i&&i.html){if(!l(i)&&l(D[f.name])&&!i.isPreFormatted&&!i.skipLastLineBreak){if(!e)o+="<br />"}if(typeof i.html=="function")a=i.html(r,r.attrs,o);else a=c(i.html,o)}else a=r.val+o+(r.closing?r.closing.val:"")}else if(r.type===p.newline){if(n&&u==false){_.push("<br />");continue}if(!u){_.push("<div>");if(e<8)_.push(" ")}_.push("</div>\n");u=false;continue}else{s=n;a=d(r.val)}if(s&&!u){_.push("<div>");u=true}else if(!s&&u){_.push("</div>\n");u=false}_.push(a)}if(u)_.push("</div>\n");return _.join("")};var M=function(e,t){var n,r,i=e.length;while(i--){if(!(n=e[i]))continue;if(!j(t,n)){n.name=null;n.type=p.content;if(j(t,n)){r=[i+1,0].concat(n.children);if(n.closing){n.closing.name=null;n.closing.type=p.content;r.push(n.closing)}i+=r.length-1;Array.prototype.splice.apply(e,r)}else t.children.splice(i,1)}if(n.type===p.open)M(n.children,n)}};var T=function(e){var t,n,r,i=e.length;r=function(e){var t=e.length;while(t--){if(e[t].type===p.open)return false;if(e[t].type===p.close)return false;if(e[t].type===p.content&&e[t].val&&/\S|\u00A0/.test(e[t].val))return false}return true};while(i--){if(!(t=e[i])||t.type!==p.open)continue;n=D[t.name];T(t.children);if(r(t.children)&&n&&!n.isSelfClosing&&!n.allowsEmpty)e.splice.apply(e,[i,1].concat(t.children))}};var C=function(e,t,n,r){var i,o,a,s,u,l,c=function(e){var t=D[e.name];return!t||t.isInline!==false};t=t||[];r=r||e;for(o=0;o<e.length;o++){if(!(i=e[o])||i.type!==p.open)continue;if(!c(i)&&n){a=k(t);l=a.splitAt(i);u=t.length>1?t[t.length-2].children:r;if((s=u.indexOf(a))>-1){l.children.splice(l.children.indexOf(i),1);u.splice(s+1,0,i,l);return}}t.push(i);C(i.children,t,n||c(i),r);t.pop(i)}};var j=function(e,t){var n=e?D[e.name]:null,r=n?n.allowedChildren:null;if(!o||!r)return true;if(r&&r.indexOf(t.name||"#")<0)return false;return true};var D={b:{tags:{b:null,strong:null},styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},em:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},font:{tags:{font:{face:null}},styles:{"font-family":null},quoteType:u.never,format:function(e,t){var n;if(e[0].nodeName.toLowerCase()!=="font"||!(n=e.attr("face")))n=e.css("font-family");return"[font="+l(n)+"]"+t+"[/font]"},html:function(e,t,n){return'<font face="'+t.defaultattr+'">'+n+"</font>"}},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(e,t){var n=e.attr("size"),r=1;if(!n)n=e.css("fontSize");if(n.indexOf("px")>-1){n=n.replace("px","")-0;if(n>12)r=2;if(n>15)r=3;if(n>17)r=4;if(n>23)r=5;if(n>31)r=6;if(n>47)r=7}else r=n;return"[size="+r+"]"+t+"[/size]"},html:function(e,t,n){return'<font size="'+t.defaultattr+'">'+n+"</font>"}},color:{tags:{font:{color:null}},styles:{color:null},quoteType:u.never,html:function(e,t,n){return'<font color="'+f(t.defaultattr)+'">'+n+"</font>"}},ul:{tags:{ul:null},breakStart:true,isInline:false,skipLastLineBreak:true,html:"<ul>{0}</ul>"},list:{breakStart:true,isInline:false,skipLastLineBreak:true,html:"<ul>{0}</ul>"},ol:{tags:{ol:null},breakStart:true,isInline:false,skipLastLineBreak:true,html:"<ol>{0}</ol>"},li:{tags:{li:null},isInline:false,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},"*":{isInline:false,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},table:{tags:{table:null},isInline:false,isHtmlInline:true,skipLastLineBreak:true,html:"<table>{0}</table>"},tr:{tags:{tr:null},isInline:false,skipLastLineBreak:true,html:"<tr>{0}</tr>"},th:{tags:{th:null},allowsEmpty:true,isInline:false,html:"<th>{0}</th>"},td:{tags:{td:null},allowsEmpty:true,isInline:false,html:"<td>{0}</td>"},emoticon:{allowsEmpty:true,tags:{img:{src:null,"data-sceditor-emoticon":null}},html:"{0}"},hr:{tags:{hr:null},allowsEmpty:true,isSelfClosing:true,isInline:false,html:"<hr />"},img:{allowsEmpty:true,tags:{img:{src:null}},quoteType:u.never,html:function(e,t,n){var r,i="";if(typeof t.width!=="undefined")i+=' width="'+t.width+'"';if(typeof t.height!=="undefined")i+=' height="'+t.height+'"';if(t.defaultattr){r=t.defaultattr.split(/x/i);i=' width="'+r[0]+'"'+' height="'+(r.length===2?r[1]:r[0])+'"'}if(n.indexOf("http:")===-1){n="http:"+n}return"<img"+i+' src="'+n+'" />'}},link:{allowsEmpty:true,tags:{a:{href:null}},quoteType:u.never,html:function(e,t,n){return'<a href="'+encodeURI(t.defaultattr||n)+'" target="_blank">'+n+"</a>"}},url:{allowsEmpty:true,tags:{a:{href:null}},quoteType:u.never,html:function(e,t,n){var r;if(typeof t.target=="undefined")r="_blank";else r=t.target;return'<a href="'+(t.defaultattr||n)+'" target='+r+">"+n+"</a>"}},email:{quoteType:u.never,html:function(e,t,n){return'<a href="mailto:'+(t.defaultattr||n)+'" target = "_blank">'+n+"</a>"}},quote:{tags:{blockquote:null},isInline:false,quoteType:u.never,html:function(e,t,n){if(t.defaultattr)n="<cite>"+t.defaultattr+"</cite>"+n;return"<blockquote>"+n+"</blockquote>"}},code:{tags:{code:null},isInline:false,allowedChildren:["#","#newline"],html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isInline:false,html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isInline:false,html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isInline:false,html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isInline:false,html:'<div align="justify">{0}</div>'},youtube:{allowsEmpty:true,tags:{iframe:{"data-youtube-id":null}},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}?wmode=opaque'+'" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'},rtl:{styles:{direction:["rtl"]},html:'<div style="direction: rtl">{0}</div>'},ltr:{styles:{direction:["ltr"]},html:'<div style="direction: ltr">{0}</div>'},fa:{quoteType:u.never,html:function(e,t,n){return'<div class="fa fa-'+(t.defaultattr||n)+'"></div>'}},ignore:{}};var O=function(e){var t,n,r,i=$("<div />").hide().appendTo(document.body),o=i[0];r=function(e,t){if(e.childNodes.length!==1||!$(e.firstChild).is("br")){while(n=e.firstChild)o.insertBefore(n,e)}if(t){var r=o.lastChild;if(e!==r&&$(r).is("div")&&e.nextSibling===r)o.insertBefore(document.createElement("br"),e)}o.removeChild(e)};o.innerHTML=e.replace(/<\/div>\n/g,"</div>");if((t=o.firstChild)&&$(t).is("div"))r(t,true);if((t=o.lastChild)&&$(t).is("div"))r(t);o=o.innerHTML;i.remove();return o};var I=function(e,t){return E(_(e,t),true)};var P=I;n.fromBB_to_HTML=function(t,n,r){e=n;return P(t,true)}}).call(this)},{}],6:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p;i=n;d=e("./u");d.safe_register("./box",i);i.left=function(e,t){return l(e,"left",t)};i.top=function(e,t){return l(e,"top",t)};i.offset_left=function(e){return e.offset().left};i.offset_top=function(e){return e.offset().top};i.right=function(e){return i.left(e)+i.width(e)};i.bottom=function(e){return i.top(e)+i.height(e)};i.width=function(e,t){return l(e,"width",t)};i.height=function(e,t){return l(e,"height",t)};i.inner_left=function(e){return i.left(e)+l(e,"border-left-width")};i.inner_top=function(e){return i.top(e)+l(e,"border-top-width")};i.inner_right=function(e){return i.right(e)-l(e,"border-right-width")};i.inner_bottom=function(e){return i.bottom(e)-l(e,"border-bottom-width")};i.inner_width=function(e){return i.inner_right(e)-i.inner_left(e)};i.inner_height=function(e){return i.inner_bottom(e)-i.inner_top(e)};i.offset_bottom=function(e){return i.offset_top(e)+i.height(e)};i.offset_right=function(e){return i.offset_left(e)+i.width(e)};i.min_width=function(e){return l(e,"border-left-width")+l(e,"border-right-width")+l(e,"padding-left")+l(e,"padding-right")};i.min_height=function(e){return l(e,"border-top-width")+l(e,"border-bottom-width")+l(e,"padding-top")+l(e,"padding-bottom")};i.get=function(e,t){return n[t](e)};i.set=function(e,t,r){return n[t](e,r)};i.get_dim=function(e){var t;t=c[a(e)];if(!t){throw d.error("unrecognized: "+a(e))}return t};i.dim_props=function(e){return u[e]};i.transform_dim=function(e,t){var n;n=d.extend({},u[e],t);return i.get_dim(n)};t=["width","left","right","inner_left","inner_right","inner_width","height","top","bottom","inner_top","inner_bottom","inner_height"];r=["axis","edge","rank"];u={};c={};a=function(e){return e.axis+e.type+e.edge+e.rank};f=function(e,t,n){if(!u[e]){u[e]={}}return u[e][t]=n};o=function(e,t){var n,r,i;for(r=0,i=t.length;r<i;r++){n=t[r];if(e.indexOf(n)!==-1){return true}}return false};for(_=0,p=t.length;_<p;_++){s=t[_];if(o(s,["width","left","right"])){f(s,"axis","x")}else{f(s,"axis","y")}if(o(s,["inner"])){f(s,"edge","inner")}else{f(s,"edge","outer")}if(o(s,["width","height"])){f(s,"rank","span")}else if(o(s,["left","top"])){f(s,"rank","near")}else{f(s,"rank","far")}c[a(u[s])]=s}l=function(e,t,n){if(n===void 0||n===null){n=parseInt(e.css(t));if(isNaN(n)){return 0}return n}else{return e.css(t,n+"px")}}}).call(this)},{"./u":72}],7:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d={}.hasOwnProperty,_=function(e,t){for(var n in t){if(d.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};f=e("./../u");u=e("events");s=n;i=function(){function e(e,t){var n;this.owner_instance=e;this.container_canvas=t;this.container_canvas.css("box-sizing","border-box");if(this.owner_instance){n=this.owner_instance.element;this.info=f.json_deep_copy(n.get_responsive_data())}if(this.info==null){this.info={}}this.is_initialized=f.MakeKey(null,"container initialized")}e.prototype.destroy=function(){var e;if((e=this.owner_instance)!=null){e.destroy()}return this.owner_instance=null};e.prototype.resize_width=function(){};e.prototype.add_to_instances=function(){};e.prototype.ready_key=function(){return this.is_initialized};e.prototype.get_canvas=function(){return this.container_canvas};e.prototype.get_owner=function(){return this.owner_instance};e.prototype.render=function(e){var t;t=$(e);t.addClass("bubble-element");return t};e.prototype.recalculate=function(e){var t,n,r,i,o;r=this.info[e];if(r.pushed_by==null){r.pushed_by=[]}t=function(){var e,t;e=r.pushed_by;t=[];for(n in e){o=e[n];t.push(this.info[o].height_delta+this.info[o].top_delta)}return t}.call(this);i=Math.max.apply(Math,t);if(i!==r.top_delta){r.top_delta=i;r.instance.canvas.css("top",r.top_delta+r.it);this.calculate_children(e);return this.recalculate_stripe(e)}};e.prototype.calculate_children=function(e){var t,n,r,i,o;r=this.info[e];if(r.pushes==null){r.pushes=[]}if(f.is_empty(r.pushes)){return this.recalculate_container(e)}else{i=r.pushes;o=[];for(n in i){t=i[n];o.push(this.recalculate(t))}return o}};e.prototype.recalculate_container=function(e){var t,n,r,i,o;i=void 0;o=this.info.container_bottoms;for(n in o){t=o[n];r=this.info[t];if(i==null){i=r.height_delta+r.top_delta}else{i=Math.max(i,r.height_delta+r.top_delta)}}if(this.owner_instance.supports_message("child_movement")){return this.owner_instance.message("child_movement",i)}};e.prototype.recalculate_stripe=function(e){var t,n,r,i,o;if(!this.owner_instance.supports_message("movement_in_stripe")||this.info[e].pushes_stripe==null){return}t=this.info[e].pushes_stripe;i=void 0;o=this.info;for(n in o){r=o[n];if(r.pushes_stripe===t){if(i==null){i=r.height_delta+r.top_delta}else{i=Math.max(i,r.height_delta+r.top_delta)}}}return this.owner_instance.message("movement_in_stripe",t,i)};e.prototype.set_height=function(e,t){var n=this;return f.WaitFor(this.is_initialized,function(){var r,i;i=e.element_id();if(n.info[i].current_height===t){return}n.info[i].current_height=t;e.canvas.css("height",t);r=t-n.info[i].ih;if(r===n.info[i].height_delta){return}n.info[i].height_delta=r;n.calculate_children(i);return n.recalculate_stripe(i)})};e.prototype.add=function(e,t){var n,r,i;n=e.element;r=n.id();i=this.info[r];if(i==null){if(t){e.wait_for_visible_lite(function(){var t;t=e.canvas[0].style;t.boxSizing="border-box";t.position="absolute";t.zIndex=e.element.get_zindex();t.left=e.element.get_left()+"px";t.top=e.element.get_top()+"px";t.width=e.element.get_width()+"px";return t.height=e.element.get_height()+"px"})}return}f.extend(i,{current_height:i.ih,top_delta:0,height_delta:0,instance:e});e.wait_for_visible_lite(function(){var t;t=e.canvas[0].style;t.boxSizing="border-box";t.position="absolute";t.zIndex=i.iz;t.left=i.il+"px";t.top=i.it+i.top_delta+"px";t.width=i.iw+"px";t.height=i.current_height+"px";return e.notify_width(i.iw)});return this.container_canvas.append(e.canvas)};e.prototype.create_child=function(n,r){var i;if(n.element.E.custom_definition&&n.element.E.custom_definition().use_responsive_algorithm()){i=new t(n,r,n.element.get_responsive_data());i.resize_width(f.real_inner_width(r));return i}else{return new e(n,r)}};e.prototype.initialize=function(){c.tab_container(this.owner_instance);return this.is_initialized.turn()};e.prototype.detach=function(e){return e.canvas.detach()};return e}();s.Container=t=function(e){_(t,e);function t(e,t,n,r){var i,o;this.owner_instance=e;this.container_canvas=t;this.owner=r;this.container_canvas[0].style["box-sizing"]="border-box";if(this.owner_instance){i=this.owner_instance.element;o=f.json_deep_copy(n!=null?n:{}),this.elements=o.elements,this.boxes=o.boxes,this.lines=o.lines,this.lines_length=o.lines_length}if(this.elements==null){this.elements={}}if(this.boxes==null){this.boxes={}}if(this.lines==null){this.lines={}}if(this.lines_length==null){this.lines_length=0}this.instances={};this.instances_keys={};if(this.lines==null){this.lines={}}this.child_containers=[];this.flow_created=f.MakeKey(null,"flow created")}t.prototype.destroy=function(){var e,t,n,r,i,o,a,s,u,l;this.destroyed=true;if((o=this.owner_instance)!=null){o.destroy()}this.owner_instance=null;s=(a=this.instances)!=null?a:{};for(n in s){t=s[n];t.destroy()}this.instances=null;l=(u=this.child_containers)!=null?u:[];for(r=0,i=l.length;r<i;r++){e=l[r];e.destroy()}return this.elements=this.boxes=this.lines=this.lines_length=this.instance_keys=this.flow_created=null};t.prototype.ready_key=function(){return this.flow_created};t.prototype.get_canvas=function(){return this.container_canvas};t.prototype.get_owner=function(){return this.owner_instance};t.prototype.render=function(e){var t;t=$(e);t.addClass("bubble-element");return t};t.prototype._show_line=function(e){var t,n;if(this._lines==null){this._lines={}}if((t=this._lines)[e]==null){t[e]=f.div("bubble-r-line",this.container_canvas)}this._lines[e].show();this._num_lines=Math.max((n=this._num_lines)!=null?n:0,parseInt(e)+1);return this._lines[e]};t.prototype._hide_lines=function(e){var t,n,r,i;this.last_display_line=e-1;i=[];for(t=n=e,r=this._num_lines;e<=r?n<r:n>r;t=e<=r?++n:--n){i.push(this._lines[t].hide())}return i};t.prototype._get_box=function(e){if(this._boxes==null){this._boxes={}}if(!this._boxes[e]){this._boxes[e]=f.div("bubble-r-box");this.recalculate_box_height(e);this._boxes[e][0].box_debugging_metadata=this.boxes[e]}return this._boxes[e]};t.prototype.recalculate_box_height=function(e){var t,n,r,i,o,a,s,u,l,c,f;t=this.boxes[e];s=null;l=t.bottoms;for(a in l){o=l[a];n=this.elements[o];i=this._get_height_delta(o)+((c=n.top_delta)!=null?c:0);if(s==null){s=i}else{s=Math.max(s,i)}}u=s+(t.ih-t.line_gap);if(u!==t.height){t.height=u;this._get_box(e)[0].style.height=u+"px";r=(f=this.box_to_display_line)!=null?f[e]:void 0;if(r){return this.update_display_line_height(r)}}};t.prototype.update_display_line_height=function(e){var t;return(t=this._lines[e.idx])!=null?t[0].style.height=this.get_display_line_height(e)+"px":void 0};t.prototype._update_instance=function(e,t){var n;if(this.instances[e]){return this.instances[e].wait_for_visible_lite(t)}else{if((n=this.instances_keys)[e]==null){n[e]=f.MakeKey(null,"waiting for instance for "+e)}return f.WaitFor(this.instances_keys[e],this._update_instance.bind(this,e,t))}};t.prototype._wait_for_instance_added=function(e,t){var n;if(this.instances[e]){return t()}else{if((n=this.instances_keys)[e]==null){n[e]=f.MakeKey(null,"waiting for instance for "+e)}return f.WaitFor(this.instances_keys[e],this._wait_for_instance_added.bind(this,e,t))}};t.prototype._set_element_width=function(e,t,n){var r,i=this;r=this.elements[e];r.width=t;r.left=n;return this._update_instance(e,function(){i.to_canvas(i.instances[e])[0].style.width=r.width+"px";i.to_canvas(i.instances[e])[0].style.left=r.left+"px";return i.instances[e].notify_width(r.width)})};t.prototype.get_display_line_top=function(e){var t,n,r,i,o;r=0;for(n=i=0,o=e.idx;0<=o?i<o:i>o;n=0<=o?++i:--i){t=this.display_lines[n];r+=t.top_margin;r+=this.get_display_line_height(t)}return r+e.top_margin};t.prototype.get_display_line_height=function(e){var t;return Math.max.apply(Math,function(){var n,r,i,o;i=e.boxes;o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push(t.height)}return o}())};t.prototype.get_hidden_elements=function(){var e,t,n;t=[].concat((n=this._visibility_rules)!=null?n:[]);return t.concat.apply(t,function(){var t,n,r,i;r=this.child_containers;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e.get_hidden_elements())}return i}.call(this))};t.prototype.get_all_instances=function(){var e,t,n,r,i,o,a,s;n=[];n.push.apply(n,function(){var e,n;e=this.instances;n=[];for(r in e){t=e[r];n.push(t)}return n}.call(this));s=(a=this.child_containers)!=null?a:[];for(i=0,o=s.length;i<o;i++){e=s[i];n.push.apply(n,e.get_all_instances())}return n};t.prototype.get_element_box=function(e,t){var n,r;r=this.search_for_element(e);if(!r){return null}if(t){return r.instances[e]}else{n=r.elements[e].box;return r.boxes[n]}};t.prototype.search_for_element=function(e){var t,n,r,i,o,a;if(this.destroyed){return null}if(!this.elements[e]){a=(o=this.child_containers)!=null?o:[];for(r=0,i=a.length;r<i;r++){t=a[r];n=t.search_for_element(e);if(n!=null){return n}}return null}return this};t.prototype.get_margin_info=function(e){var t,n,r;t=this.search_for_element(e);if(!t||t.elements[e].box==null){return null}if(((n=t.owner_instance)!=null?n.element.type():void 0)==="RepeatingGroup"){return(r=t.child_containers)!=null?r[0].get_margin_info(e):void 0}else{return t.margin_debugging[t.elements[e].box]}};t.prototype.resize_width=function(e){var t,n,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,$,K,J,X,Z,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce=this;if(this.container_width===e||this.destroyed){return}this.container_width=e;this._visibility_rules=[];this.margin_debugging={};p=function(e,t){var n,r;if(t===0){r=ce.lines[e.line_idx];n=ce.boxes[r.boxes[0]];ce.margin_debugging[e.box_id].left.from_element=n.leftmost;ce.margin_debugging[e.box_id].left.from_dir="left";ce.margin_debugging[e.box_id].left.original=n.left_margin;return n.left_margin}else{ce.margin_debugging[e.box_id].left.from_element=e.leftmost;ce.margin_debugging[e.box_id].left.from_dir="left";ce.margin_debugging[e.box_id].left.original=e.left_margin;return e.left_margin}};h=function(e){var t,n;n=ce.lines[e.line_idx];t=ce.boxes[n.boxes[n.boxes_length-1]];ce.margin_debugging[e.box_id].right.from_element=t.rightmost;ce.margin_debugging[e.box_id].right.from_dir="right";ce.margin_debugging[e.box_id].right.original=t.right_margin;return t.right_margin};B=function(t){if(t.rs==="<="&&e<=t.rsw){return false}else if(t.rs===">"&&e>t.rsw){return false}else{return true}};this.box_to_display_line={};this.display_lines=[];for(g=U=0,Q=this.lines_length;0<=Q?U<Q:U>Q;g=0<=Q?++U:--U){w=this.lines[g];if(!this.elements[this.boxes[w.boxes[0]].first].wtp){l=null}for(v=F=0,ee=w.boxes_length;0<=ee?F<ee:F>ee;v=0<=ee?++F:--F){r=w.boxes[v];n=this.boxes[r];i=0;T=-Infinity;_=false;ne=n.contains;for(v in ne){m=ne[v];if(B(this.elements[m])){_=true;i=Math.max(i,this.elements[m].mw);C=this.elements[m].maxw;if(C!=null){C=C/this.elements[m].iw*n.iw;T=Math.max(T,C)}else{T=Infinity}}}if(!_){this._get_box(n.box_id).hide();(re=this._visibility_rules).push.apply(re,function(){var e,t;e=n.contains;t=[];for(v in e){m=e[v];t.push(m)}return t}());continue}if(isFinite(T)){n.max_width=T}n.min_width=Math.min(e,i);D=(ie=l!=null?l.boxes.length:void 0)!=null?ie:0;R=n.min_width;this.margin_debugging[r]={right:{},left:{}};if(n.align!=="right"||D!==0&&l.boxes[D-1].align!=="left"){R+=p(n,D);this.margin_debugging[r].left.break_first=true}else{this.margin_debugging[r].left.break_first=false}if(n.align!=="left"){R+=h(n);this.margin_debugging[r].right.break_first=true}else{this.margin_debugging[r].right.break_first=false}if(l==null){l={boxes:[n],top_margin:w.top_margin,idx:this.display_lines.length,topmost:w.topmost};this.display_lines.push(l);j=0}else if(j+R<=e){l.boxes.push(n)}else{l={boxes:[n],top_margin:w.top_margin,idx:this.display_lines.length,topmost:w.topmost};this.display_lines.push(l);j=0;D=0}j+=n.min_width+p(n,D);this.box_to_display_line[r]=l}}ae=(oe=this.display_lines)!=null?oe:[];for(k=W=0,V=ae.length;W<V;k=++W){w=ae[k];I=0;d=0;M=0;S=0;t=0;if(w.boxes==null){w.boxes=[]}y=function(e,t){var n;if(e.align==="left"){ce.margin_debugging[e.box_id].left.fixed=e.contains[0];ce.margin_debugging[e.box_id].left.fixed_dir="left";return false}n=w.boxes[t-1];if((n!=null?n.align:void 0)==="right"){ce.margin_debugging[e.box_id].left.fixed=n.contains[0];ce.margin_debugging[e.box_id].left.fixed_dir="right";return false}ce.margin_debugging[e.box_id].left.fixed=null;return true};se=w.boxes;for(v=G=0,Y=se.length;G<Y;v=++G){n=se[v];d+=n.iw-n.min_width;if(n.max_width){M+=n.max_width-n.min_width}else{if(n.iw!==n.min_width){M=Infinity}}b=p(n,v);I+=n.iw+b;if(y(n,v)){S+=b;t++}if(v===w.boxes.length-1){z=h(n);I+=z;if(n.align!=="right"){this.margin_debugging[n.box_id].right.fixed=null;S+=z;t++}else{this.margin_debugging[n.box_id].right.fixed=n.contains[0];this.margin_debugging[n.box_id].right.fixed_dir="right"}}}N=I-e;if(d===0){L=1}else{if(w.boxes.length===1&&w.boxes[0].collapse_margin!=null&&w.boxes[0].collapse_margin>=e){u=true;N-=S}else{u=false}if(d>=N){if(d-N>M){L=M/d;N+=M-d}else{L=(d-N)/d;N=0}}else{L=0;N-=d}}if(S===0){E=1}else if(u){E=0}else{E=(S-N)/S;N=0}A=N/-t;s=new Array(w.boxes.length);c=0;P=0;ue=w.boxes;for(v=J=0,H=ue.length;J<H;v=++J){n=ue[v];a=n.min_width+(n.iw-n.min_width)*L;if(n.max_width&&a>n.max_width){c+=a-n.max_width;s[v]=n.max_width}else{P+=n.iw-n.min_width;s[v]=a}}while(c>0){O=0;f=0;le=w.boxes;for(v=X=0,$=le.length;X<$;v=++X){n=le[v];if(!n.max_width||s[v]<n.max_width){a=s[v]+c*(n.iw-n.min_width)/P;if(n.max_width&&a>n.max_width){f+=n.max_width-s[v];s[v]=n.max_width}else{f+=a-s[v];O+=n.iw-n.min_width;s[v]=a}}}c-=f;if(c<1){c=0}P=O}x=this._show_line(k);x[0].style["margin-top"]=w.top_margin+"px";o=0;te=w.boxes;q=function(t,n){var r,i,l,c,f,d,_;r=ce._get_box(t.box_id);r.show();x.append(r);if(y(t,n)){b=p(t,n)*E+A}else{b=p(t,n)}a=s[n];r.css("left",o+b);o+=b+a;r.css("width",a);i=a/t.iw;ce.margin_debugging[t.box_id].left.actual=b;if(n===w.boxes.length-1){ce.margin_debugging[t.box_id].right.actual=e-o}ce.margin_debugging[t.box_id].left.collapsed=u;ce.margin_debugging[t.box_id].right.collapsed=u;c=E>1||A>0;l=E<1||A<0;ce.margin_debugging[t.box_id].left.stretched=c;ce.margin_debugging[t.box_id].right.stretched=c;ce.margin_debugging[t.box_id].left.squeezed=l;ce.margin_debugging[t.box_id].right.squeezed=l;ce.margin_debugging[t.box_id].left.things_to_break=w.boxes.length>1;ce.margin_debugging[t.box_id].right.things_to_break=w.boxes.length>1;ce.margin_debugging[t.box_id].top={actual:w.top_margin,from_element:w.topmost};if(n>0){ce.margin_debugging[w.boxes[n-1].box_id].right=ce.margin_debugging[t.box_id].left}d=(f=t.contains)!=null?f:{};_=[];for(n in d){m=d[n];_.push(function(n,o){var s,u,l,c,f;j=Math.min(ce.elements[o].mw,e);s=Math.max(j,ce.elements[o].iw*i);if(ce.elements[o].maxw&&s>ce.elements[o].maxw){s=ce.elements[o].maxw}f=a-s;if(t.iw-ce.elements[o].iw===0){u=f/2}else{l=ce.elements[o].il/(t.iw-ce.elements[o].iw);u=l*f}c=B(ce.elements[o]);if(c&&!ce.elements[o].is_attached){ce.elements[o].is_attached=true;ce.calculate_children(o);ce._wait_for_instance_added(o,function(){return r.append(ce.to_canvas(ce.instances[o]))})}else if(ce.elements[o].is_attached&&!c){ce.elements[o].is_attached=false;ce.calculate_children(o);ce._wait_for_instance_added(o,function(){return ce.to_canvas(ce.instances[o]).detach()})}if(c){ce._set_element_width(o,s,u)}if(!ce.elements[o].is_attached){return ce._visibility_rules.push(o)}}(n,m))}return _};for(v=Z=0,K=te.length;Z<K;v=++Z){n=te[v];q(n,v)}this.update_display_line_height(w)}this._hide_lines(k);this.recalculate_container();this.flow_created.turn();return this.emit("resize_width",e)};t.prototype.recalculate_container=function(){var e=this;return f.WaitFor(this.flow_created,function(){var t,n,r,i,o,a,s,u,l,c,f,d,_;if(e.owner_instance.supports_message("child_movement")&&e.lines_length>0){r=e.lines[e.lines_length-1].bottom;a=0;d=(f=e.display_lines)!=null?f:[];for(s=0,l=d.length;s<l;s++){i=d[s];o=0;_=i.boxes;for(u=0,c=_.length;u<c;u++){t=_[u];o=Math.max(o,t.height)}a+=o+i.top_margin}n=a-r;return e.owner_instance.message("child_movement",n)}})};t.prototype.set_height=function(e,t){var n,r,i,o,a=this;i=e.element_id();n=(o=this.elements[i])!=null?o:{};if(n.height===t){return}n.height=t;this._update_instance(i,function(){return a.to_canvas(e)[0].style.height=n.height+"px"});r=t-n.ih;if(r===n.height_delta){return}n.height_delta=r;return this.calculate_children(i)};t.prototype.calculate_children=function(e){var t,n,r,i,o;n=this.elements[e];if(!n.pushes){this.recalculate_box_height(n.box);return this.recalculate_container()}else{i=n.pushes;o=[];for(r in i){t=i[r];o.push(this.recalculate(t))}return o}};t.prototype._get_height_delta=function(e){var t,n;if(this.elements[e].is_attached){return(t=this.elements[e].height_delta)!=null?t:0}else{return(n=-this.elements[e].ih)!=null?n:0}};t.prototype.recalculate=function(e){var t,n,r,i,o,a,s=this;t=this.elements[e];if(!t.pushed_by){o=0}else{n=function(){var e,n,i;e=t.pushed_by;i=[];for(r in e){a=e[r];i.push(this._get_height_delta(a)+((n=this.elements[a].top_delta)!=null?n:0))}return i}.call(this);o=Math.max.apply(Math,n)}if(o!==t.top_delta){t.top_delta=o;i=t.top_delta+t.it;if(t.top!==i){t.top=i;this._update_instance(e,function(){return s.to_canvas(s.instances[e])[0].style.top=t.top+"px"})}return this.calculate_children(e)}};t.prototype.to_canvas=function(e){return e.canvas};t.prototype.add_to_instances=function(e){var t,n;if((t=this.elements)[n=e.element_id()]==null){t[n]={}}return this.instances[e.element_id()]=e};t.prototype.add=function(e){
var t,n,r,i,o=this;r=e.element;t=this.to_canvas(e);if(r instanceof l.Root){this.container_canvas.append(t);t[0].style["z-index"]=2;t[0].style["position"]="absolute";return}i=r.id();n=this.elements[i];if(n==null){return}this.instances[i]=e;if(this.instances_keys[i]){this.instances_keys[i].turn();this.instances_keys[i]=null}return e.wait_for_visible_lite(function(){var e;e=t[0].style;e.position="absolute";e.boxSizing="border-box";e.zIndex=n.iz;if(n.height==null){n.height=n.ih;e.height=n.height+"px"}if(n.width==null){n.width=n.iw;e.width=n.width+"px"}if(n.left==null){n.left=n.il;e.left=n.left+"px"}if(n.top==null){n.top=n.it;return e.top=n.top+"px"}})};t.prototype.create_child=function(e,t){var n;if(e.element.E.custom_definition&&!e.element.E.custom_definition().use_responsive_algorithm()){n=new i(e,t)}else{n=new this.constructor(e,t,e.element.get_responsive_data(),this.owner);this.child_containers.push(n)}return n};t.prototype.initialize=function(){return c.tab_container(this.owner_instance)};t.prototype.detach=function(e){return this.to_canvas(e).detach()};return t}(u.EventEmitter);s.ElementService=r=function(e){_(n,e);function n(){this.ready_key=f.MakeKey(null,"ElementService ready")}n.prototype.display=function(e){var n;if(e.use_responsive_algorithm()){n=new t(null,$("body"))}else{n=new i(null,$("body"))}e=a.ElementInstance(e,n,"run");e.split_namespace();this._page=e;e.draw();return this.ready_key.turn()};n.prototype._loading_key=function(e){if(e){return"_page_done_loading_entire"}else{return"_page_done_loading"}};n.prototype.on_page_done_loading=function(e,t){var n,r=this;n=f.Watcher(function(){return r.page_done_loading(e)});return n.on_value(function(e){if(e){t();return n.destroy()}})};n.prototype.page_done_loading=function(e){var t;t=this._loading_key(e);if(!this[t]){this[t]=f.Box(false);this._check_if_page_is_done(e,true)}return this[t]()};n.prototype._check_if_page_is_done=function(e,t){var n,r,i=this;r=function(t){var n,i,o,a,s,u,l,c,f,d,_,p,h,g,m;n=t.get_canvas();if(n.css("display").indexOf("none")!==-1){return null}if(!e){if($(window).height()<n.offset().top){return null}}p=(_=t._watchers)!=null?_:{};for(s in p){c=p[s];h=c.get_current_status(),a=h[0],l=h[1],u=h[2];if(!a&&!l){return u}}o=t.get_children_drawn_key();if(!o.is_turned()){return o}m=(g=t.children)!=null?g:[];for(f=0,d=m.length;f<d;f++){i=m[f];u=r(i);if(u!=null){return u}}return null};n=function(){var t;t=r(i._page);if(t==null){return i[i._loading_key(e)](true)}else{return f.WaitFor(t,i._check_if_page_is_done.bind(i,e))}};if(t&&this.ready_key.is_turned()){return n()}else{return f.WaitFor(this.ready_key,function(){return setTimeout(function(){return n()},100)})}};n.prototype.get_page=function(){return this._page};return n}(u.EventEmitter);c=e("./tab");o=e("./../lang/appquery");a=e("./../lang/elements");l=e("./../lang/lang")}).call(this)},{"./../lang/appquery":51,"./../lang/elements":55,"./../lang/lang":57,"./../u":72,"./tab":13,events:276}],8:[function(e,t,n){(function(){var n,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v={}.hasOwnProperty,y=function(e,t){for(var n in t){if(v.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e},b=[].slice;_=e("./../u");u=e("./../locations");n=e("./../lib");s=e("./../core/core_events");d=e("querystring");p={};g={};h={};m=function(e){var t,n,r,i,o,a,s,u,l,c,f,d;if(_.on_phonegap()){n=e.getResponseHeader("Set-Cookie");if(n){a=[];u=n.split(",");r=u[0];i=0;while(r){r=u[i];if(r.indexOf("expires=")!==-1){r=r+","+u[i+1];i++}a.push(r);i++;r=u[i]}d=[];for(c=0,f=a.length;c<f;c++){t=a[c];s=t.split("=");o=s[0].trim();l=s[1].split(";")[0];d.push(_.createCookie(o,l))}return d}}};f={};c=function(e){var t;if(e.indexOf("appeditor/changes")!==-1){return"appeditor/changes"}if(e.indexOf("appeditor/load")!==-1){return"appeditor/load"}t=e.split("/");return t[t.length-1]};t.exports=r=function(e){y(t,e);function t(){var e;e=1<=arguments.length?b.call(arguments,0):[];t.__super__.constructor.apply(this,e);this.open_requests=_.MakeKeyList()}t.prototype.load=function(){var e;e=n();e.workflow.announce_event("PageLoaded");return n().user.ready()};t.prototype.change_page=function(e,t,n){return document.location.href=this.get_page_url(e,t,n)};t.prototype.reload_page=function(){return document.location.reload()};t.prototype.get=function(e,t){return this.request(e,"get",null,t)};t.prototype.post=function(e,t,n){return this.request(e,"post",t,n)};t.prototype.put=function(e,t,n){return this.request(e,"put",t,n)};t.prototype["delete"]=function(e,t){return this.request(e,"delete",null,t)};t.prototype.request=function(e,t,r,i,s,u,l){var d,p,h,g,v,y,b,w,x,k,S,A=this;if(s==null){s=500}if(u==null){u=_.UUID()}if(l==null){l=Date.now()}if(Date.now()-l>a.REQUEST_TTL*2/3){throw _.error({statusCode:400,message:"Could not reach server"})}y=_.Promise(null,t+" "+e);if(i){y.callback(i)}e=e.toLowerCase();if(e.indexOf("server://")!==-1){e=this.get_server_base()+e.split("server://")[1];p=true}else if(e.indexOf("meta://")!==-1){if(document.location.href.indexOf(n().location.get_base_for_meta())===0){v={}}else{v={protocol:"HTTPS:"}}e=this.get_base_for_meta(v)+"/"+e.split("meta://")[1];p=true;h=true}else{p=false}w={processData:false,type:t,dataType:"json"};if(h||_.on_phonegap()){if(w.xhrFields==null){w.xhrFields={}}w.xhrFields.withCredentials=true}if(_.on_phonegap()){if(r==null){r={}}r.headers_for_phonegap=n().location.base_url}if(t!=="get"&&t!=="delete"){try{w.data=JSON.stringify(r!=null?r:{})}catch(E){d=E;w.data={};S=r!=null?r:{};for(g in S){x=S[g];try{w.data[g]=JSON.stringify(x)}catch(E){d=E;true}}}w.contentType="application/json";w.headers={"cache-control":"no-cache"}}_.error_environment.total_open_requests++;b=$.ajax(e,w);k=setTimeout(function(){return f[u]=true},15*1e3);b.always(function(){clearTimeout(k);return _.error_environment.total_open_requests--});b.done(function(e){if(f[u]){delete f[u]}if(p){_.error_environment.cannot_connect=false}m(b);_.rebuild_cookies();return o.recheck_uid(function(){return y.resolve(e)})});b.fail(function(n,i,a){var h,g,v,x,k,S,E,M,T,C;m(b);_.rebuild_cookies();o.recheck_uid();f[u]=true;if(p){if(400<=(E=n.status)&&E<=599){_.error_environment.cannot_connect=false}else{_.error_environment.cannot_connect=true}}if(n.status>=400&&n.status<=499){if(n.responseText&&n.getResponseHeader("Content-Type")==="application/json"){try{S=_.json_parse(n.responseText);S._original_request={uri:e,request_data:w}}catch(j){d=j;S=n.responseText}delete f[u];S.stack="locationservice.coffee";y.reject(_.error(S))}}if((M=n.status)===503||M===0||M===12017||p&&((T=n.status)===502||T===504)){setTimeout(function(){return y.resolve(A.request(e,t,r,null,Math.min(s*2),u,l))},s);return}if(((C=n.responseText)!=null?typeof C.indexOf==="function"?C.indexOf("Chrome Data Compression Proxy"):void 0:void 0)!==-1||n.status===12019){if(s<2e3){setTimeout(function(){return y.resolve(A.request(e,t,r,null,s*2,u,l))},s);return}}v=n.responseText;if(n.getResponseHeader("Content-Type")==="application/json"){try{x=_.json_parse(n.responseText);v=x.message;h=x.code}catch(j){d=j;true}}g=n.getAllResponseHeaders();k=JSON.stringify(w!=null?w:null);d=_.error("LocationService: Error requesting "+c(e),{uri:e,xhr_status:n.status,text_status:i,err_string:a,message:v,headers_string:g,request_body:k});if(h){d.code=h}delete f[u];return y.reject(d)});this.open_requests.garbage_collect();this.open_requests.add_key(y.ready_key());return y};t.prototype.request_synchronous=function(e,t,n){var r,i;r=_.json_stringify({uri:e,method:t,data:n});if(!g[r]){g[r]=_.MakeKey(null,"request_synchronous "+e);i=this.request(e,t,n);i.then(function(e){p[r]=e;return g[r].turn()},function(e){h[r]=e;g[r].turn();return null})}_.ensure_ready(g[r]);if(h[r]){throw h[r]}else{return p[r]}};t.prototype.wipe_request_cache=function(e,t,n){var r;r=_.json_stringify({uri:e,method:t,data:n});delete g[r];delete p[r];return delete h[r]};return t}(u.Location);i=e("./../lang/appquery");o=e("./../db/client_db");l=e("./../lang/plugins");a=e("./../client_config")}).call(this)},{"./../client_config":16,"./../core/core_events":20,"./../db/client_db":27,"./../lang/appquery":51,"./../lang/plugins":60,"./../lib":65,"./../locations":66,"./../u":72,querystring:285}],9:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c;u=e("./../u");r=e("./../core/core_actions");c=function(e){var t;if(!e){return false}try{return u.json_parse(e).oauth_provider}catch(n){t=n;return false}};n.onload=function(e){var n,r,o,a,f,d,_,p,h,g,m,v,y,b,w,x;d=l.parse(document.location.href,true);p=d.query;f=u.json_deep_copy(p);if((b=p.state)!=null?b.replace:void 0){h=new RegExp("&#34;","g");p.state=p.state.replace(h,'"')}if(p.oauth_provider){r=u.json_deep_copy(p);m=r.run_id;delete p.oauth_provider;delete p.run_id}else if(c(p.state)){r=u.json_parse(p.state);if(r.code==null){r.code=p.code}delete p.state}else{if(typeof e==="function"){e()}return}n=s.get_oauth_authenticator(r.oauth_provider);if(n==null){window.alert(t().get_text("CORE","OAUTH_ISSUE"));if(typeof e==="function"){e()}return}x=(w=n.get_property("additional_query_url_to_delete"))!=null?w:[];for(v=0,y=x.length;v<y;v++){a=x[v];delete p[a]}delete p.code;delete p.resume_key;delete d.search;delete d.hash;window.history.replaceState({},document.title,l.format(d));if(m){g=u.local_storage_get(m);window.localStorage.removeItem(m)}else{g=r.resume_key}if(!r.code&&!r.oauth_token){u.warn("oauth login failed",{service_name:n.id(),original_query:f});window.alert(t().get_text("CORE","OAUTH_ISSUE")+n.id()+". "+t().get_text("CORE","TRY_AGAIN"));if(typeof e==="function"){e()}return}o=n.get_data_for_login(r);_=t().workflow.resume(g,o);return _.callback(function(o){var a;if(o){window.alert(u.human_friendly(o))}if(typeof e==="function"){e()}if(!o&&r.oauth_provider.indexOf("apiconnector")===0&&u.is_debug_mode()&&i.app_version()==="test"){if(!n.has_token_data()){a={api_id:r.oauth_provider,current_user_id:t().current_user()._id(),appname:i.appname(),plugin:r.oauth_provider.indexOf("apiconnector2")===0?"apiconnector2":"apiconnector"};return t().location.post("meta://appeditor/save_owner_oauth_token",a).callback(function(e,t){if(t!=null?t.result:void 0){return alert("You have successfully initialized the OAuth2 connection for "+n.display()+". You can go back to the Editor and keep building!")}})}}})};t=e("./../lib");s=e("./../services");i=e("./../lang/appquery");a=e("./../lang/dataops");o=e("./../db/client_db");l=e("url")}).call(this)},{"./../core/core_actions":18,"./../db/client_db":27,"./../lang/appquery":51,"./../lang/dataops":54,"./../lib":65,"./../services":70,"./../u":72,url:299}],10:[function(e,t,n){(function(){var t,r,i,o,a,s;o=n;o.can_use=function(){var e;return((e=window.performance)!=null?e.timing:void 0)!=null};s=null;o.render_start=function(){return s=Date.now()};a=null;o.render_end=function(){return a=Date.now()};i=null;o.fully_loaded=function(){var e,n,u,l,c,f,d,_;i=Date.now();u=r.global_data_items_loaded;if(o.can_use()){_=window.performance.timing.fetchStart;e=window.performance.timing.responseEnd;c=e-_;d=s-_;f=a-_;l=i-_;n={page_data:u,page_html:c,page_render_start:d,page_render:f,page_full:l};return t().location.post("server://user/m",{measures:n})}};t=e("./../lib");r=e("./../db/db")}).call(this)},{"./../db/db":28,"./../lib":65}],11:[function(e,t,n){(function(){var n,r,i,o,a;n=e("./../lib");a=e("./../u");o=e("./../db/db");i=e("./../db/client_db");t.exports=r=function(){function e(){this._dependency=a.Dependency()}e.prototype.invalidate=function(){if(!a.on_phonegap()){n().location.base_url=document.location.href}n().workflow.announce_event("PageLoaded");return this._dependency.invalidate()};e.prototype.get=function(){var e,t,r;if(n().location.get_page_thing_id()){this.exists=true}else{this.exists=false}this._dependency.register();if(!this.exists){if(((e=n().element)!=null?(t=e.get_page())!=null?(r=t.element)!=null?r.get_static_property("page_item_type"):void 0:void 0:void 0)!=null){console.log("warning: no id specified.  this page expects an id")}return null}else{return n().db_instance().get(n().location.get_page_thing_id())}};return e}()}).call(this)},{"./../db/client_db":27,"./../db/db":28,"./../lib":65,"./../u":72}],12:[function(e,t,n){(function(){var t,r,i,o,a;o=n;o.do_it=function(){if(!i.save_seo||a.on_phonegap()){return}return setTimeout(function(){var e=this;return a.run_once(30,function(){return t().current_user().is_logged_in()},function(e,n){var r;if(e){a.warn(e);return}if(!n){r=t().location.post("server://frg",{action:"ask",url:document.location.href});return r.then(function(e){var n,r,i,o;if(e){r=$("html").html();o=r.split('<meta charset="utf-8">'),n=o[0],i=o[1];r=n+'<script type="text/javascript">window.dont_call_page_display = true;</script>'+'<meta charset="utf-8">'+i;return t().location.post("server://frg",{action:"set",html:r,url:document.location.href})}})}})},15*1e3)};a=e("./../u");r=e("./../db/client_db");t=e("./../lib");i=e("./../client_config")}).call(this)},{"./../client_config":16,"./../db/client_db":27,"./../lib":65,"./../u":72}],13:[function(e,t,n){(function(){var t,r,i=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};r=e("./../u");t=1;n.tab_container=function(e){return e.wait_for_visible_lite(function(){var n,r,o,a,s,u,l,c,f,d,_,p,h,g,m,v;u=[];m=e.children;for(f=0,p=m.length;f<p;f++){r=m[f];if(i.call(r.element.get_messages(),"set_focus")>=0||r.element.get_related_workflows("ButtonClicked").length){u.push(r)}}o=function(){var e,t,n;n=[];for(e=0,t=u.length;e<t;e++){s=u[e];if(!s.canvas.attr("tabindex")){n.push(s)}}return n}();o.sort(function(e,t){return e.element.get_top()-t.element.get_top()});l=function(e,t){return Math.max.apply(Math,function(){var t,n,r;r=[];for(t=0,n=e.length;t<n;t++){s=e[t];r.push(s.element.get_top()+s.element.get_height())}return r}())>=t.element.get_top()};n=[];a=[];for(d=0,h=o.length;d<h;d++){r=o[d];if(a.length===0||l(a,r)){a.push(r)}else{n.push(a);a=[r]}}n.push(a);v=[];for(_=0,g=n.length;_<g;_++){c=n[_];c.sort(function(e,t){return e.element.get_left()-t.element.get_left()});v.push(function(){var e,n,i;i=[];for(e=0,n=c.length;e<n;e++){r=c[e];r.message("add_tab_index",t);i.push(t++)}return i}())}return v})}}).call(this)},{"./../u":72}],14:[function(e,t,n){(function(){var n,r,i,o,a,s,u,l,c={}.hasOwnProperty,f=function(e,t){for(var n in t){if(c.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};u=e("./../u");a=e("./../core/core_events");s=e("events");l=e("url");n=e("./../lib");o=e("./../lang/dataops");i=e("./../db/client_db");if(typeof window!=="undefined"&&window!==null){window.authenticate_as=function(e){return n().location.post("server://user/auth_as/"+e,{},function(e,t){if(e){return console.log("Authentication failed")}else{console.log("Authentication succeeded.  Refreshing...");return setTimeout(function(){return window.document.location.reload()},1e3)}})}}t.exports=r=function(e){f(t,e);function t(){var e,t=this;this.ready_key=u.MakeKey(null,"user_service");this.has_changed_flag=false;e=function(){return setTimeout(function(){return n().location.post("server://user/hi",null,function(t,n){if(t){u.error_environment.cannot_connect=true}else{u.error_environment.cannot_connect=false}return e()})},60*1e3)};e();u.WaitFor(this.ready_key,function(){var e;e=u.Watcher(function(){var e,t,r,o,a;o=i.current_user();t=o.is_logged_in();e=o._id();r=(a=n().pageparam.get())!=null?typeof a._id==="function"?a._id():void 0:void 0;return t+"_"+e+"_"+r});return e.on_value(function(e){var r,o;r=i.current_user().is_logged_in();o=n().location.get_query().on_login;if(r&&o){t.has_changed_flag=true;n().workflow.about_to_change_page=true;window.location.replace(o)}t.emit("user_changed");if(r){return n().workflow.announce_event("LoggedIn")}else{return n().workflow.announce_event("LoggedOut")}})})}t.prototype.has_changed=function(){if(n().current_user().is_logged_in()){return this.has_changed_flag}};t.prototype.ready=function(){return this.ready_key.turn()};t.prototype.login=function(e,t){var r;r=n().location.post("server://user/login",e);return r.then(t)};t.prototype.logout=function(e){var t;t=n().location.post("server://user/logout",{});return t.then(e)};t.prototype.add_learn_lesson_to_user=function(e,t){var r;r=n().location.post("server://user/add_learn_lesson_to_user",e);return r.then(t)};t.prototype.took_one_learn=function(e,t){var r;r=n().location.post("server://user/took_one_learn",e);return r.then(t)};t.prototype.on_page_load_for_confirmation_email=function(){return $(document).ready(function(){var e,t,r=this;t=l.parse(n().location.base_url,true).query;if(t.confirmation_email){e=n().location.post("server://user/confirm_email",{confirmation_email_id:t.confirmation_email});return e.then(null,function(e){return window.alert(u.human_friendly(e))})}})};return t}(s.EventEmitter)}).call(this)},{"./../core/core_events":20,"./../db/client_db":27,"./../lang/dataops":54,"./../lib":65,"./../u":72,events:276,url:299}],15:[function(e,t,n){(function(){var n,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};v=e("./../u");g=e("querystring");y=e("url");u=e("./../client_config");t.exports=i=function(){function t(){var t=this;this._global=new(e("events").EventEmitter);this._initialized=v.MakeKey(null,"workflow engine initialized");this.open_server_actions=[];this.all_sent_to_server=v.MakeKeyList();this.all_client_completed=v.MakeKeyList();this.all_server_completed=v.MakeKeyList();this.everything_completed=v.MakeKeyList([this.all_client_completed,this.all_server_completed]);this.debug_queue=[];this.about_to_change_page=false;if(!v.running_test()){setTimeout(function(){var e,r,i;if(n()&&!n().is_edit_mode()){if(typeof window!=="undefined"&&window!==null&&((i=n().appname())!=="tour"&&i!=="learn")){window.onbeforeunload=function(){if(!t.warn_on_page_change){return void 0}if(t.about_to_change_page){return void 0}if(t.can_change_page()){return void 0}return n().get_text("CORE","STILL_CHANGING")}}if(typeof window!=="undefined"&&window!==null){r=o.get_last_change_topic(n().appname(),n().app_version());e=o.get_breaking_revision_topic();h.on(r,function(e){if(e&&e!==a.last_change()){return t.show_bad_revision()}});return h.on(e,function(e){if(e&&e!==u.breaking_revision){return t.show_bad_revision()}})}}},1e3)}}t.prototype.everything_done_key=function(){return this.everything_completed};t.prototype.can_change_page=function(){return this.all_client_completed.is_turned()&&this.all_sent_to_server.is_turned()};t.prototype.show_bad_revision=function(){var e;if(this.bad_revision){return}this.bad_revision=true;e=v.div("bad-revision",$("body"));if(v.on_phonegap()||v.is_on_mobile_or_tablet()){e.html(n().get_text("CORE","BAD_REVISION_PHONE"));e.css("font-size","16px")}else{e.append(n().get_text("CORE","BAD_REVISION"))}return e.on("click",function(){if(v.on_phonegap()){navigator.splashscreen.show()}return window.location.reload(true)})};t.prototype.toggle=function(){return this.disabled=!this.disabled};t.prototype.set_debugger=function(e){this["debugger"]=e};t.prototype.debug=function(e,t,n){var r,i,o=this;if(this["debugger"]==null){return v.Promise(true)}i=v.Promise(null,"waiting for debugger to finish with "+e.id());r=function(){i.resolve();return o._debugger_send_next_item(true)};this.debug_queue.push({item:e,context:n,next:r,properties_promise:t});this._debugger_send_next_item();return i};t.prototype._debugger_send_next_item=function(e){var t,n,r,i,o,a,s,u,l,c=this;if(e){this._debugger_waiting=false}if(this._debugger_waiting){return}if(this._current_debug_run==null){r=this.debug_queue.shift()}else{r=null;l=this.debug_queue;for(s=0,u=l.length;s<u;s++){n=l[s];if(n.context.run_id===this._current_debug_run){r=n;v.array_remove(this.debug_queue,r);break}}}if(r!=null){this._debugger_waiting=true;this._was_debugging=true;i=r.item,t=r.context,o=r.next,a=r.properties_promise;this._current_debug_run=t.run_id;return a.callback(function(e,n){var r;if(e){c._debugger_waiting=false;return o()}else{r=_.make_partial_expression_evaluator(t);return c["debugger"].highlight(i,n,r,t,o)}})}};t.prototype.debug_done=function(e){var t=this;if(this._current_debug_run===e){this._current_debug_run=null}return setImmediate(function(){var e;if(t.debug_queue.length===0&&t._was_debugging&&!t._debugger_waiting){if((e=t["debugger"])!=null){e.all_finished()}return t._was_debugging=false}else{return t._debugger_send_next_item()}})};t.prototype.announce_event=function(e){return this._global.emit(e)};t.prototype.on_event=function(e,t){this._global.setMaxListeners(200);return this._global.on(e,t)};t.prototype.off_event=function(e,t){return this._global.removeListener(e,t)};t.prototype.abort_server_calls=function(){if(this.bad_revision){return v.error({statusCode:400,reason:"BAD_REVISION",already_reported:true})}if(!v.cookies_enabled()){return v.error({statusCode:400,message:"Oops! Your browser seems to have cookies disabled. Make sure cookies are enabled.",already_reported:true})}return null};t.prototype.run_workflows=function(e,t,n){var r,i,o,a,s=this;i=v.Promise(null,"running workflows");if(e.datasources==null){e.datasources=f.get_basic_datasources(e.element.element.root())}if(!e.element){throw v.error("context must contain an element")}if(!e.frozen_state){new f.FrozenState(e)}r=this.all_sent_to_server.make(30,"freezing workflows");a=this.all_client_completed.make(30,"starting workflows");if(n){this.warn_on_page_change=true;o=function(){if(s.can_change_page()){return s.warn_on_page_change=false}else{return v.WaitFor(s.all_client_completed,s.all_sent_to_server,function(){return setTimeout(o,100)})}};o()}e.frozen_state.freeze_workflows(t,function(n){var o,u;s.all_sent_to_server.garbage_collect();if(n){r.turn();a.turn();return i.reject(n)}else{u=function(){var n,r,i;i=[];for(n=0,r=t.length;n<r;n++){o=t[n];i.push({event:o,context:this.create_context(e,o)})}return i}.call(s);return i.resolve(s.should_events_run(u).then(function(e){return s.refreeze_states(e).then(function(e){var t,n,i,o,u;try{e=s.filter_invalid_states(e);s._start_workflows_on_server(e);r.turn();n=v.Promise(true);i=function(e){return n=n.then(function(){return s._run_workflow(e.context,e.event)})};for(o=0,u=e.length;o<u;o++){t=e[o];i(t)}s.all_client_completed.garbage_collect();return n.then(function(){return function(){var n,r,i;i=[];for(n=0,r=e.length;n<r;n++){t=e[n];i.push(t.event)}return i}()})}finally{r.turn();a.turn()}})},function(e){r.turn();return e}))}});return i};t.prototype.filter_invalid_states=function(e){var t,n,r,i,o,a,s;i=[];for(o=0,a=e.length;o<a;o++){s=e[o],r=s.event,t=s.context;if(t.frozen_state.has_invalid_state()){n=v.error({statusCode:400,message:"Cannot run workflow -- relies on invalid inputs"});this.report_error(n,t)}else{i.push({event:r,context:t})}}return i};t.prototype.refreeze_states=function(e){var t,n,r,i,o,a,s,u=this;r=[];i=function(e,t){var n;n=v.Promise(null,"refreezing");r.push(n);return t.frozen_state.freeze_workflows([e],function(r){if(r){return n.reject(r)}else{return n.resolve({event:e,context:t})}})};for(o=0,a=e.length;o<a;o++){s=e[o],n=s.event,t=s.context;i(n,t)}return v.promise_array(r)};t.prototype._start_workflows_on_server=function(e){var t,n,r,i,o,a,s;i=[];t=this.abort_server_calls();for(o=0,a=e.length;o<a;o++){s=e[o],n=s.context,r=s.event;if(this.uses_server(r)){if(t){throw t}i.push({context:n,item:r});n.is_running_on_server=true}else{n.server_completion_promise=v.Promise(true);n.server_initiation_promise=v.Promise(true)}}return this.start_server_call(i)};t.prototype.start_server_call=function(e){var t,r,i,o,s=this;if(e.length===0){return}for(i=0,o=e.length;i<o;i++){t=e[i];t.context.server_initiation_promise=v.Promise(null,"server call initiated for "+t.item.id());t.context.server_completion_promise=v.Promise(null,"server call completed for "+t.item.id());t.server_call_id=v.UUID();t.context.server_call_id=t.server_call_id;t.context.server_call_context="";t.context.server_initiation_promise.callback(function(e){if(e){return t.context.server_completion_promise.reject(e)}});this.all_server_completed.add_promise(t.context.server_completion_promise)}this.all_server_completed.garbage_collect();r=this.all_sent_to_server.make(30,"start_server_call");v.run_once(30,function(){var t,r,i,o,l,c,_,h,g,m,y,b,w;i={wait_for:v.json_deep_copy(s.open_server_actions),app_last_change:a.last_change(),client_breaking_revision:u.breaking_revision,calls:[],timezone_offset:(new Date).getTimezoneOffset(),timezone_string:p.tz.guess(),user_id:(g=n().current_user())!=null?g._id():void 0};for(_=0,h=e.length;_<h;_++){m=e[_],t=m.context,o=m.item,l=m.send_to_server,c=m.server_call_id;r=d.dehydrate_tree((y=(b=t.datasources)!=null?typeof b.current_workflow_item==="function"?b.current_workflow_item():void 0:void 0)!=null?y:null);i.calls.push({client_state:t.frozen_state.get_client_state(),run_id:t.run_id,server_call_id:c,item_id:o.id(),element_id:t.element.element_id(),additional_parameters:l,uid_generator:t.uid_generator,random_seed:t.random_seed,current_date_time:f.get_page_data("Current Date/Time",t).getTime(),current_workflow_item:r,current_workflow_item_value:(w=t.datasources)!=null?typeof w.current_workflow_item_value==="function"?w.current_workflow_item_value():void 0:void 0})}return i},function(t,i){var o,a,u,l,c,f,d,_,p;if(t){for(l=0,f=e.length;l<f;l++){o=e[l].context;o.server_completion_promise.reject(t);o.server_initiation_promise.reject(t)}r.turn();return}n().location.post("server://workflow/start",i).callback(function(t,r){var a,u,l,c,f,d;if(t){if(!v.is_human_friendly(t)){v.warn(t,{meta:"THROWN BY START_SERVER_CALL",call_data:i})}else if(t.reason==="BAD_REVISION"){s.show_bad_revision()}else{console.log(v.human_friendly(t))}}else{n().db_instance().ensure_object_updates(r.object_updates)}d=[];for(l=0,c=e.length;l<c;l++){f=e[l],o=f.context,u=f.server_call_id;if(t){d.push(o.server_completion_promise.reject(t))}else{a=r[u];if(!a){d.push(o.server_completion_promise.reject(v.error("missing outcome",{res:r,server_call_id:u})))}else if(a.outcome==="error"){d.push(o.server_completion_promise.reject(v.error(a.error)))}else if(a.outcome==="event_failed"){d.push(o.server_completion_promise.reject({statusCode:400,message:"We weren't able to complete your action.  Please try again..."}))}else if(a.outcome!=="success"){d.push(o.server_completion_promise.reject(v.error("non-success workflow outcome: "+JSON.stringify(a))))}else{d.push(o.server_completion_promise.resolve(a))}}}return d});setTimeout(function(){return r.turn()},200);p=[];for(c=0,d=e.length;c<d;c++){_=e[c],o=_.context,u=_.server_call_id,a=_.item;p.push(function(e){var t,n,r,i;t=e.context,i=e.server_call_id,r=e.item;t.server_initiation_promise.resolve();n=function(){var e;return s.open_server_actions=function(){var t,n,r,o;r=this.open_server_actions;o=[];for(t=0,n=r.length;t<n;t++){e=r[t];if(e.server_call_id!==i){o.push(e)}}return o}.call(s)};t.server_completion_promise.callback(n);return setTimeout(function(){var e,r,o,a;r=s.open_server_actions;n();if(r.length!==s.open_server_actions.length){o=t.server_completion_promise.inspect().state;a=function(){var t,n,i;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];if(b.call(this.open_server_actions,e)<0){i.push(e)}}return i}.call(s);return v.warn("MANUALLY REMOVING SERVER_CALL_ID",{server_call_id:i,removed:a,promise_state:o})}},5*60*1e3)}({context:o,server_call_id:u,item:a}))}return p})};t.prototype.should_events_run=function(e){var t,n,r,i,o,a,s,u=this;r=[];i=function(e){var t,n,i;n=e.event,t=e.context;i=v.Promise(null,"should event run: "+n.id());r.push(i);return v.run_once(30,function(){return u.should_workflow_run(t,n)},function(e,r){if(e){return i.reject(e)}else if(!r){return i.resolve(u.debug(n,v.Promise(null),t).then(function(){u.debug_done(t.run_id);return false}))}else{return i.resolve(true)}})};for(o=0,a=e.length;o<a;o++){s=e[o],n=s.event,t=s.context;i({event:n,context:t})}return v.promise_array(r).then(function(t){var n,r,i,o,a;n=[];for(r=o=0,a=t.length;o<a;r=++o){i=t[r];if(i){n.push(e[r])}}return n})};t.prototype._run_workflow=function(e,t){var n,r,i,o=this;if(this.disabled){r=v.Promise(true);return r}n=this.debug(t,v.Promise(null),e).then(function(){return o.run_subsequent_actions(e,t)});this.all_client_completed.add_promise(n);i=n.then(function(){return e.server_initiation_promise});this.add_error_handling(e,i);return i};t.prototype.add_logger=function(e){var t;t=[];e.log=function(e){return t.push(e)};return e.dump_log=function(){return t}};t.prototype.create_context=function(e,t){var r,i;r=v.extend({},e);delete r.frozen_state;e.frozen_state.clone(r);r.inputs_must_be_valid=true;if(r.datasources==null){r.datasources=f.get_basic_datasources(r.element.element.root())}r.event=t;i=v.get_random_seed();if(r.uid_generator==null){r.uid_generator={timestamp:Date.now(),seed:i}}r.UUID_SEED=v.UUID_SEED(r.uid_generator);if(r.random_seed==null){r.random_seed=i}r.random_generator=v.Random(r.random_seed);this.add_logger(r);if(r.run_id==null){r.run_id=v.UUID()}r.get_server_outcome=function(e,t){return r.server_completion_promise.callback(function(i,o){var a,s,u,l;r.server_workflow_completed=true;if(i){return t(i)}else{l=o.step_results[e.id()],u=l.return_value,s=l.random_interations,a=l.UUID_iterations;if(a&&a!==r.UUID_SEED.iterations){r.UUID_SEED=v.UUID_SEED({seed:r.UUID_SEED.seed,timestamp:r.UUID_SEED.timestamp,iterations:a})}if(s&&s!==r.random_generator.iterations){r.random_generator=v.Random(r.random_generator.seed,s)}return t(null,d.rehydrate_tree(n().db_instance(),u))}})};r.update_from_action=function(e,t,n){var r,i=this;if(((r=this.original_context)!=null?r:this).server_workflow_completed&&e.can_fall_back_to_server()){return this._fetch_updates(e).then(function(e){var t,n;for(t in e){n=e[t];if(n.x){i.frozen_state.clear(t)}else{i.frozen_state.set(t,n.v)}}return null})}else{return this.frozen_state.update_from_action(e,n,t,this)}};r._fetch_updates=function(e){return r.server_completion_promise.then(function(t){var r;return d.rehydrate_tree(n().db_instance(),(r=t.state_changes[e.id()])!=null?r:{})})};return r};t.prototype.resume_action=function(e,t){var n,r=this;n=v.Promise(null,"Resuming "+t.id());e.log("about to resume "+t.type()+" "+t.id());t.resume(e,function(i,o){var a;if(i){return n.reject(i)}else{e.log("successfully resumed "+t.type()+" with result "+o);a=t.evaluate_properties_client_side(e);return n.resolve(e.update_from_action(t,a,o).then(function(){return r.run_subsequent_actions(e,t)}))}});return n};t.prototype.run_subsequent_actions=function(e,t){var n,r,i=this;n=t.next();if(n==null){e.log("workflow is finished");return v.Promise(true)}r=n.evaluate_properties_client_side(e);return this.debug(n,r,e).then(function(){var t,o,a;t=v.Promise(null,(o="Running action "+(n!=null?n.id():void 0))!=null?o:"<done>");e.log("about to run "+n.type()+" "+n.id());if((a=n.type())==="TriggerCustomEvent"||a==="TriggerCustomEventFromReusable"){t.resolve(i.start_custom_workflow(e,n))}else{n.run(e,r,function(o,a){if(o){if(o==="aborted"){return t.resolve()}else{return t.reject(o)}}else{e.log("successfully ran "+n.type()+ +" "+n.id()+" with result "+a);return e.update_from_action(n,r,a).callback(function(r){var o;if(r){t.reject(r);return}if(n.requires_server()&&e.server_completion_promise.inspect().state==="pending"){if(!e.server_call_id){throw new Error("could not find our server call")}o=e.server_call_context+n.id();i.open_server_actions.push({server_call_id:e.server_call_id,action_id:o})}return t.resolve(i.run_subsequent_actions(e,n))})}})}return t})};t.prototype.start_custom_workflow=function(e,t){var n,r,i=this;r=a.event(t.get_static_property("custom_event"));n=function(){return i.run_subsequent_actions(e,t)};return t.evaluate_properties_promise(e).then(function(o){var a,s,u;if(!o.condition){s=v.Promise(false)}else{a=c.get_workflow_item_context(e,o.workflow_thing,r.get_static_property("custom_event_data_type"));if(e._previously_run_custom_events){
a._previously_run_custom_events=v.extend({},e._previously_run_custom_events)}else{a._previously_run_custom_events={}}if(a._previously_run_custom_events[t.id()]){throw v.error({statusCode:400,message:"Circular custom workflow -- custom workflows cannot call themselves (either directly or indirectly)"})}a._previously_run_custom_events[t.id()]=true;a.original_context=(u=e.original_context)!=null?u:e;if(t.type()==="TriggerCustomEventFromReusable"){a.element=e.element.find_instance_by_id(t.get_static_property("element_id"))}a.server_call_context+=t.id()+".";a.get_server_outcome=function(n,r){return e.get_server_outcome(t,function(t,i){var o,a,s,u;if(t){return r(t)}else{u=i[n.id()],s=u.return_value,a=u.random_interations,o=u.UUID_iterations;if(o&&o!==e.UUID_SEED.iterations){e.UUID_SEED=v.UUID_SEED({seed:e.UUID_SEED.seed,timestamp:e.UUID_SEED.timestamp,iterations:o})}if(a&&a!==e.random_generator.iterations){e.random_generator=v.Random(e.random_generator.seed,a)}return r(null,s)}})};a._fetch_updates=function(n){return e._fetch_updates(t).then(function(e){return e[n.id()]})};s=v.run_once(30,function(){return i.should_workflow_run(a,r)})}return s.then(function(e){if(!e){return n()}else{return i.run_subsequent_actions(a,r).then(n)}})})};t.prototype.uses_server=function(e){var t,n,r,i;i=e.actions();for(n=0,r=i.length;n<r;n++){t=i[n];if(t.requires_server()){return true}}return false};t.prototype.should_workflow_run=function(e,t){var n;if(typeof e.log==="function"){e.log("in should_workflow run for "+t.id())}n=t.check_condition(e);if(typeof e.log==="function"){e.log("should_workflow_run: "+n)}return n};t.prototype.add_error_handling=function(e,t){var n=this;return t.callback(function(t){n.debug_done(e.run_id);if(t){return n.report_error(t,e)}})};t.prototype.report_error=function(e,t){var r,i,o,a,s;if(v.is_human_friendly(e)){if((i=n()["debugger"])!=null){i.report_error({event:t.event,error:{message:v.human_friendly(e)},type:"workflow",instance:t!=null?t.element:void 0})}return}e=v.error(e);console.log("workflow error (original error follows):\n"+e.stack);console.log(e);e.already_reported=true;r={url:document.location.href,log:t!=null?t.dump_log():void 0,message:e!=null?(o=e!=null?e.message:void 0)!=null?o:"No err message, err object is "+String(e):"Err object is null / undefined",stack:(a=e!=null?e.stack:void 0)!=null?a:"(no error stack recovered)",error_args:e!=null?e.args:void 0,element:t!=null?(s=t.element)!=null?typeof s.toUniqueString==="function"?s.toUniqueString():void 0:void 0:void 0,server_stack_code:e.code,workflow:t.event.pretty_print(),environment:v.error_environment,run_id:t!=null?t.run_id:void 0};return n().location.post("server://bug/workflow_fail",r)};t.prototype.wait_for_server=function(e){var t=this;if(this.all_server_completed.is_turned()){return e()}else{return v.WaitFor(this.all_server_completed,function(){return setTimeout(function(){return t.wait_for_server(e)},10)})}};t.prototype.wait_for_safe=function(e,t){var n=this;this.debug_done(e.run_id);if(this.all_sent_to_server.is_turned()&&this.all_server_completed.is_turned()){this.about_to_change_page=true;return t()}else{return v.WaitFor(this.all_sent_to_server,this.all_server_completed,function(){return setTimeout(function(){return n.wait_for_safe(e,t)},100)})}};t.prototype.initialize=function(){var e,t,r,i,o,a;r=y.parse(n().location.base_url,true);i=r.query.resume;if(i){delete r.query.resume;e={};a=r.query;for(t in a){o=a[t];if(o!=null){e[t]=o}}r.query=e;delete r.search;window.history.replaceState({},document.title,y.format(r));this.resume(i)}return this._initialized.turn()};t.prototype.initialize_key=function(){return this._initialized};t.prototype.resume_uses_server=function(e,t){return t||e.terminate_server_workflow()};t.prototype.make_resume_key=function(e,t,n){var r,i,o,a;if(t.next()||this.resume_uses_server(t,n)){r={element_instance:e.element.dehydrate(),element_id:e.element.element_id(),custom_workflow:{value:(i=e.datasources)!=null?typeof i.current_workflow_item_value==="function"?i.current_workflow_item_value():void 0:void 0,item:(o=e.datasources)!=null?typeof o.current_workflow_item==="function"?(a=o.current_workflow_item())!=null?a.dehydrate():void 0:void 0:void 0},to_resume:t.id(),frozen_state:e.frozen_state.serialize(),run_id:e.run_id,server_workflow_terminated:n,uid_generator:e.uid_generator};if(r.uid_generator!=null){r.uid_generator.iterations=e.UUID_SEED.iterations}return v.local_data_store(r,true)}};t.prototype.resume=function(e,t){var i,o,s,u=this;o=v.local_data_retrieve(e);if(!o){v.warn("Could not resume workflow, was not able to retrieve data",{resume_key:e});return v.Promise(false)}s=a.action(o.to_resume);i=v.Promise(null,"finished resuming workflow");v.run_once(30,function(){return{element:d.rehydrate_tree(n().db_instance(),o.element_instance),workflow_item:d.rehydrate_tree(n().db_instance(),o.custom_workflow.item)}},function(e,n){var a,l,c,d,_;if(e){i.reject(e);return}c=n.element,_=n.workflow_item;if(!c){c=new r(o.element_instance,o.element_id)}l={element:c,run_id:o.run_id,uid_generator:o.uid_generator};d=f.deserialize_frozen_state(l,o.frozen_state);l.frozen_state=d;l=u.create_context(l,s.event());l.datasources.current_workflow_item_value=function(){return o.custom_workflow.value};l.datasources.current_workflow_item=function(){return o.custom_workflow.item};l.log("resuming workflow at action "+s.id()+" "+s.type());if(u.resume_uses_server(s,o.server_workflow_terminated)){u.start_server_call([{context:l,item:s,send_to_server:t}])}else{l.server_completion_promise=v.Promise(true);l.server_initiation_promise=v.Promise(true)}a=u.resume_action(l,s);i.resolve(a.then(function(){return l.server_initiation_promise}));return u.add_error_handling(l,i)});return i};return t}();r=function(){function e(e,t){this.instance_id=e;this._element_id=t;this.element=a.element(this._element_id)}e.prototype.dehydrate=function(){return this.instance_id};e.prototype.element_id=function(){return this._element_id};e.prototype.find_instance_by_id=function(e){return null};return e}();n=e("./../lib");a=e("./../lang/appquery");f=e("./../lang/dataops");d=e("./../db/db");s=e("./../db/client_db");o=e("./../app_lib");c=e("./../core/core_expressions");_=e("./../lang/expressions");p=e("./../jquery_plugins/moment.timezone.min.js");h=e("./../notifier_client")}).call(this)},{"./../app_lib":4,"./../client_config":16,"./../core/core_actions":18,"./../core/core_expressions":21,"./../db/client_db":27,"./../db/db":28,"./../jquery_plugins/moment.timezone.min.js":47,"./../lang/appquery":51,"./../lang/dataops":54,"./../lang/expressions":56,"./../lib":65,"./../notifier_client":67,"./../tests/testing":71,"./../u":72,events:276,querystring:285,url:299}],16:[function(e,t,n){t.exports={breaking_revision:4,hard_code_public:["cutepuppy","coffeesearcher","lostandfound","meta_public","findatrainer","launchpage","countrycity","itunessearcher","todomvcapp","microbloggingapp","learn","demo","test_app","tour","test_app2"],hard_code_private:["meta_dedicated","meta_ds","meta","template","template_live"],forkable_app:["cutepuppy","coffeesearcher","lostandfound","meta_public","findatrainer","launchpage","countrycity","itunessearcher","todomvcapp","microbloggingapp"],blocked_apps:["yelpclone","airbnbclonetemplate","trello","bubblewits1","bubblewits2","bubblewits3","spam"],let_user_make_local_edits:["cutepuppy","coffeesearcher","lostandfound","meta_public","findatrainer","launchpage","countrycity","itunessearcher","todomvcapp","microbloggingapp","tour","learn","demo"],hard_code:["cutepuppy","coffeesearcher","lostandfound","meta_public","findatrainer","launchpage","countrycity","itunessearcher","todomvcapp","microbloggingapp","learn","demo","test_app","tour","test_app2","meta_dedicated","meta_ds","meta","template","template_live"],private_version_prefix:"p_",PACKAGER_PATH:"package",illegal_page_names:["api","fileupload","static","appeditor","user","workflow","package","versioncontrol","bug","apiservice","","elasticsearch"],test_app_key:"test-app-234789asdfjl",old_test_app_key:"test_app_234789asdfjl",env:"prod",cluster:"main",no_issue_checker:["learn","demo","tour","g2_iphone_test","test_app","test_app2"],use_mixpanel:true,redirect_on_bad_cluster:true,save_seo:true,cdn_host:"dhtiece9044ep.cloudfront.net",mixpanel_key:"763a46ff30a690b748dc7a8208efde0f",googleanalytics_key:"UA-37718610-2",google_map_key:"AIzaSyDvSvB4bFOvqLeowszTlffGXXPPHBB0ebo",ADMIN_NO_REPLY:"admin-no-reply@bubble.is",firebase_root:"not-in-use",workflow_firebase_root:"https://bubble-workflow.firebaseio.com",user_file_bucket:"appforest_uf",user_file_url:"s3.amazonaws.com/appforest_uf/",user_file_cdn:"dd7tel2830j4w.cloudfront.net/",image_optimization_service:"d1muf25xaso8hp.cloudfront.net",meta_hostname:"not applicable, we override this",PROD_DOMAINS:{main:"bubble.is"},DEFAULT_CLUSTER:"main",LOCAL_DOMAIN:"local.bubble.is",PROD_ENV:"prod",DEV_ENV:"dev",paid_features:true,public_plugin_keys:{Blockspring:"c9bd6ed3acb3b7127eb425471fb42a79fa13f71680d6e7d1f433e7703f4388fa"},SUPPORT_EMAIL:"support@bubble.is",SUPPORT_NAME:"Bubble Support",hide_export_bulk_operation:true,ADMIN_EMAIL:"admin@bubble.is",apps_domain:"bubbleapps.io",MAX_LIST_LENGTH:1e4,MAX_CSV_UPLOAD_AT_ONCE:1,braintree_partner_code:"Bubble_SP",database_query_limit:200,bubble_private_path:"bubble_private",custom_action_definitions:{},main_firebase_off:true,notifier_host:"notify.bubble.is",notifier_domain:"main",environment_name:"main",plugins_live_here:true,MAX_ALLOWED_REQUEST:5e4,REQUEST_TTL:36e5,librato_email:"admin@bubble.is",librato_public_token:"8f023f218c0603231233b38040006a49d167697071a2aa97b51db7a90e946b19",a_record_ip:"54.69.164.32",max_new_list_length:100,page_speed_metrics_on:true,plugin_commission:.75,max_api_bulk_post:1e3};var r=e("./u");r.safe_register("./client_config",t.exports);r.safe_register("./../bubble_private/override_util",e("./../bubble_private/override_util"))},{"./../bubble_private/override_util":2,"./u":72}],17:[function(e,t,n){(function(){var t,r,i,o,a;t=n;a=e("./u");t.total_firebase_writes={};t.total_firebase_data={};o=e;if(a.on_server()){r=o("./configuration")}else{r=e("./client_config")}i=function(){var e,n,i,o;i=t.total_firebase_writes;for(e in i){n=i[e];if(typeof r.increment==="function"){r.increment(e,"firebase_write_count",n)}}o=t.total_firebase_data;for(e in o){n=o[e];if(typeof r.increment==="function"){r.increment(e,"firebase_write_data",n)}}t.total_firebase_writes={};return t.total_firebase_data={}};setInterval(function(){return i()},2e3)}).call(this)},{"./client_config":16,"./u":72}],18:[function(e,t,n){(function(t){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,K,J,X,Z,Q,ee,te,ne,re=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};Y=e("./../u");p=n;Y.safe_register("./core/core_actions",p);D=e("./../lang/lang");W=e("./../services");f=e("./../client_config");O=function(e){return function(t){var n,r,i,o,a;if(t[e]==null){t[e]=[]}o=t[e];for(i in o){r=o[i];if((a=r!=null?r.action:void 0)==="add_list"||a==="remove_list"||a==="set_list"){r.value=function(){var e,t,i,o,a,s,u;a=(i=(o=r.value)!=null?typeof o.all==="function"?o.all():void 0:void 0)!=null?i:[];u=[];for(e=0,t=a.length;e<t;e++){n=a[e];u.push((s=n!=null?typeof n.all==="function"?n.all():void 0:void 0)!=null?s:n)}return u}()}}return t}};B=O("changes");s=function(e){return function(t,n){var r,i,o,a,s,u,l,c,f,d,_,p;if(typeof t!=="string"){return n}try{i=X.get(t).custom_type()}catch(h){o=h;if(String(o!=null?o.message:void 0).indexOf(R.MISSING_PLUGIN)===-1){throw o}return n}u=[];f=n[e];for(s in f){r=f[s];if(r!=null?r.key:void 0){u.push(r.key)}}if(s==null){s=-1}_=(d=i!=null?i.fields():void 0)!=null?d:[];for(l=0,c=_.length;l<c;l++){a=_[l];if(!(!a.deleted()&&(p=a.name(),re.call(u,p)<0)&&a.default_val()!=null)){continue}s++;n[e][s]={key:a.name(),value:a.default_val()}}return n}};c={changes:{}};y=W.enter_your_api_key_button_field_names;S=function(){var e,t,n;if(Y.on_phonegap()){e=u.appname();if(f.apps_domain){t="https://"+e+"."+f.apps_domain}else{t=r().location.get_base_for_meta()+"/site/"+e}t+="/version-"+u.app_version()+"/user/hi";n=$('<iframe src="'+t+'"></iframe>');n.load(function(){return n.remove()});return $("body").append(n)}};L=function(){var e,t,n,i,o,a;t={};t[m.STATES.CurrentUser()]=null;e=r().current_user();t[m.STATES.Message(e,null,"email")]=null;a=u.get_oauth_providers();for(i=0,o=a.length;i<o;i++){n=a[i];t[m.STATES.Message(e,null,n)]=null}return t};p.get_remember_email_key=function(){return"_bubble_saved_email_"+r().appname()+"_"+r().app_version()};p.SignUp={field_names:Y.extend({email:{},password:{},password2:{},require_confirm:{},send_confirm_email:{},page:{},remember_email:{optional:true}},c),run:function(e,t,n,i){return n.get_server_outcome(e,function(e,n){S();if(e){i(e);return}r().current_user().flush();if(t.remember_email===true){Y.local_storage_put(p.get_remember_email_key(),{email:t.email})}return i(e,n)})},server_method:"sign_up",data_to_refresh:L,pre_evaluate_properties:function(e){e=B(e);e=s("changes")("user",e);return e}};p.OAuthLogin={field_names:Y.extend({oauth_provider:{}},y),not_api:true,run:function(e,t,n,r){return n.get_server_outcome(e,function(i,o){var a,s;if(i){r(i);return}s=t.oauth_provider;a=W.get_oauth_authenticator(s);if(!a||!a.login){if(!s){window.alert("Oops, please fill out the social network for this action")}else{window.alert("Undefined oauth provider: "+s)}r("aborted");return}return a.login(n,e,o,r)})},resume:function(e,t,n){return t.get_server_outcome(e,n)},check_for_errors:function(e,t){var n,r;r=e.get_static_property("oauth_provider");n=W.get_oauth_authenticator(r);if(n!=null?n.are_keys_missing():void 0){return t(this.display(e)+" - remember to fill your app id and secret for "+n.display())}},data_to_refresh:L,server_method:"oauth_login",server_method_resume:"oauth_login_resume"};p.LogIn={field_names:{email:{},password:{},stay_logged_in:{"default":true},remember_email:{optional:true}},run:function(e,t,n,r){return n.get_server_outcome(e,function(e,n){if(t.remember_email===true){Y.local_storage_put(p.get_remember_email_key(),{email:t.email})}S();return r(e,n)})},server_method:"log_in",data_to_refresh:L};p.LogOut={field_names:{},run:function(e,t,n,r){return n.get_server_outcome(e,function(e,t){S();return r(e,t)})},server_method:"log_out",data_to_refresh:L};p._apply_content_format_to_input=function(e,t){var n;n=u.element(e);if((n!=null?n.type():void 0)==="Input"&&n.get_static_property("content_format")!==t){n.set_property("content_format",t);return n.commit()}};p.UpdateCredentials={field_names:{old_password:{},change_email:{},email:{},change_password:{},password:{},require_confirm:{},password2:{},do_not_show_success_alert:{},send_confirm_email:{},page:{"default":"index"}},run:function(e,t,n,i){return n.get_server_outcome(e,function(e){r().current_user().flush();if(e){return i(e)}else{if(!t.do_not_show_success_alert){alert(r().get_text("CORE","UPDATE_CREDENTIAL_SUCCESS"))}return i()}})},server_method:"update_credentials",data_to_refresh:function(e,t,n){var i,o;i={};if(t.change_email){o=r().current_user();i[m.STATES.Message(o,null,"email")]=t.email}return i}};p.ChangeEmailForAnotherUser={field_names:{user:{},new_email:{}},run:function(e,t,n,r){return n.get_server_outcome(e,r)},server_method:"change_email_for_another_user",data_to_refresh:function(e,t,n){var r,i;r={};i=t.user;if(i!=null){r[m.STATES.Message(i,null,"email")]=t.new_email}return r}};p.MakeChangeCurrentUser={field_names:Y.extend({},c),run:function(e,t,n,i){var o,a;if(t.changes!=null&&!Y.is_empty(t.changes)){o=r().current_user();a=H(o,t.changes);return a.callback(i)}else{return i()}},data_to_refresh:function(e,t,n){return k(r().current_user(),t.changes)},return_value:function(){return null},server_method:"change_current_user",pre_evaluate_properties:B,fall_back_to_server:true};p.SendPasswordResetEmail={field_names:{to:{},subject:{"default":"Your password reset request"},body:{"default":"Hello,\n\n"+"Someone (hopefully you!) submitted a request to reset your password. If it wasn't you, "+"please ignore this message. If it was you, you can reset your password at the below link.\n\n"+"The Team\n\n"},just_make_token:{}},run:function(e,t,n,r){return n.get_server_outcome(e,r)},server_method:"send_password_reset_email",return_value:function(e){if(e.get_static_property("just_make_token")){return X.get("text")}else{return null}},data_to_refresh:null,do_not_send_result_to_client:true};p.SendConfirmationEmail={field_names:{page:{}},run:function(e,t,n,r){return n.get_server_outcome(e,r)},server_method:"send_confirmation_email",data_to_refresh:null};p.ResetPassword={field_names:{new_password:{},new_password_again:{}},run:function(e,t,n,r){return n.get_server_outcome(e,r)},server_method:"reset_password",data_to_refresh:null};p.CreateUserAccount={field_names:Y.extend({email:{},password:{},return_user_if_already_exists:{}},c),run:function(e,t,n,r){return n.get_server_outcome(e,r)},server_method:"create_user_account",data_to_refresh:null,return_value:function(){return X.get("user")},pre_evaluate_properties:function(e){var t;e=B(e);if(typeof e.email==="string"&&(!Y.on_server()||!J.get_user_by_email(typeof(t=e.email).toLowerCase==="function"?t.toLowerCase():void 0))){e=s("changes")("user",e)}return e}};p.CheckUserPassword={field_names:{password:{}},run:function(e,t,n,r){return n.get_server_outcome(e,r)},server_method:"check_user_password",data_to_refresh:null};p.SetTemporaryPassword={field_names:{user:{}},run:function(e,t,n,r){return n.get_server_outcome(e,r)},server_method:"set_temporary_password",data_to_refresh:null,return_value:function(){return X.get("text")}};P=75;p.get_data_to_send=function(e,t){var n,r,i,o,a,s,u,l;if(!e){return e}if(e instanceof v.StaticNode){return null}if(e._id){if(typeof e._id==="function"){r=e._id()}else{r=e.id}if(t&&typeof e.child==="function"){o=e.child(t).get()}if(o){a=o.split(" ");i=a[0];if(i.length>P){i=i.slice(0,+P+1||9e9)}else{l=a.slice(1);for(s=0,u=l.length;s<u;s++){n=l[s];if(i.length+n.length>P){break}i+=" "+n}}i=i.toLowerCase().replace(/\ /g,"-").replace(/[^\w-]+/g,"");return i+"-"+r}else{return r}}else{return e}};p.get_page=A=function(e){var t;t=u.page(e);if(t==null){t=u.get_page_by_name(e)}return t};p.ChangePage={field_names:{element_id:{},data_to_send:{},add_parameters:{},url_parameters:{},replace_history:{}},can_redirect:function(e){return e.element_id()!=null&&!e.property("data_to_send").exists()&&!e.property("url_parameters").exists()},server_side_redirect:function(e){var t;t=A(e.element_id());if(t){return t.name()}},run:function(e,t,n,i){var o;o=function(e,t,n,i){var o,a;o=A(t.element_id);if(!o){console.log("not changing page because page not found");i();return}if(Y.on_phonegap()){window.alert("Native apps should be built in a single page, you can't use a change action here");return}a=o.name();return Y.run_once(30,function(){return p.get_data_to_send(t.data_to_send,o.get_static_property("readable_field"))},function(s,u){var l,c,f,d,_,p,g,m;if(s){Y.warn(s);return}if(u){a+="/"+u}l={};if(Y.is_debug_mode()){l["debug_mode"]=true}if(t.add_parameters){g=t.url_parameters;for(p in g){m=g[p],c=m.key,_=m.value;if(re.call(h.forbidden_url_keys,c)<0){l[c]=_}}}if(o.name()===r().location.get_page()){f=r().location.get_page_url(a,l);if(f!==r().location.my_location()){if(t.replace_history){window.history.replaceState({},null,f)}else{window.history.pushState({},null,f)}r().pageparam.invalidate()}i();return}d=r().workflow.make_resume_key(n,e);if(d){l["resume"]=d}return r().workflow.wait_for_safe(n,function(){if(!d){i("aborted")}return r().location.change_page(a,l)})})};if(r().location.get_query().on_login!=null){return Y.run_once(15,function(){return r().user.has_changed()},function(r,a){if(a){}else{return o(e,t,n,i)}})}else{return o(e,t,n,i)}},check_for_errors:function(e,t,n){var r,i,o;if(!n){t(void 0,void 0,e.id());return true}if((r=e.root())!=null?r.get_static_property("native_app"):void 0){t(this.display(e)+" - Change page actions should not be used in a native app page")}else if(e.next()&&(typeof e.property==="function"?(i=e.property("condition"))!=null?(o=i.json)!=null?o.raw():void 0:void 0:void 0)==null){t(this.display(e)+" must be the last action in the workflow")}return h.check_parameters(e,t)},not_api:true,data_to_refresh:null};p.RefreshPage={field_names:{},run:function(e,t,n,i){return r().workflow.wait_for_safe(n,function(){return document.location.href=C(n,e)})},not_api:true,data_to_refresh:null};p.GoPrevious={field_names:{},run:function(e,t,n,i){return r().workflow.wait_for_safe(n,function(){window.history.back();return i()})},not_api:true,data_to_refresh:null};p.OpenURL={field_names:{url:{}},run:function(e,t,n,i){var o,a;o=t.url;if((o!=null?o.indexOf("//"):void 0)===-1&&(a=o.split(":")[0],re.call(h.href_attributes,a)<0)){o="//"+o}if(Y.on_phonegap()){window.open(o,"_blank","location=yes,enableViewportScale=yes");i();return}if(t.open_in_new_tab){window.open(o,"_blank");window.focus();return i()}else{return r().workflow.wait_for_safe(n,function(){return document.location.href=o})}},not_api:true,data_to_refresh:null,check_for_errors:function(e,t){if(e.next()&&!e.get_static_property("open_in_new_tab")){return t(this.display(e)+" must be the last action in the workflow")}}};p.ScrollToElement={field_names:{element_id:{},offset:{optional:true,"default":0}},run:function(e,t,n,r){return Y.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,n){var i;if(n){Y.velocity(n.get_canvas(),"scroll",{duration:300,offset:(i=t.offset)!=null?i:0})}return r()})},not_api:true,data_to_refresh:null};p.get_velocity_animation_duration=function(e){var t,n;return(t=(n=$("div").velocity)!=null?n.RegisterEffect.packagedEffects[e].defaultDuration:void 0)!=null?t:300};p.AnimateElement={field_names:{element_id:{},animation:{"default":"callout.bounce"},customize_duration:{},duration:{}},run:function(e,t,n,r){return Y.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,n){var i,o,a,s,u,l;if(n&&t.animation){i=n.get_canvas();if(t.customize_duration){o=(u=t.duration)!=null?u:p.get_velocity_animation_duration(t.animation)}else{o=p.get_velocity_animation_duration(t.animation)}a={duration:o};if(t.animation.indexOf("transition.")===0){clearTimeout(n.velocity_timeout);if(t.animation.indexOf("Out")!==-1){if(i.velocity!=null){s=(l=i.css("transform"))!=null?l:"none";a.complete_cb=function(){n.workflow_hide();if(i!=null){i.velocity("stop")}return n.velocity_timeout=setTimeout(function(){return i.css({opacity:1,transform:s})},100)}}else{n.workflow_hide()}}else if(t.animation.indexOf("In")!==-1){n.workflow_show();if(typeof i.css==="function"){i.css("opacity",0)}}}if(i!=null?i.velocity:void 0){setTimeout(function(){i.velocity("stop");return Y.velocity(i,t.animation,a)},20)}}return r()})},not_api:true,data_to_refresh:null};p.SetFocusToElement={field_names:{element_id:{}},run:function(e,t,n,r){return Y.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,t){if(t){t.wait_for_visible(function(){var e;e=t.get_canvas();if(!Y.isScrolledIntoView(e).status){Y.velocity(e,"scroll",{duration:300,offset:-100})}return t.message("set_focus")})}return r()})},not_api:true,data_to_refresh:null};p.update_thing=H=function(e,t){var n;n=Y.Promise(null,"updating "+(e!=null?typeof e._id==="function"?e._id():void 0:void 0));if(!e){console.log("trying to update something that does not exist.  this is likely an application error...");n.resolve();return n}if(typeof e.child!=="function"){console.log("trying to update something that doesn't look like a DB object.  This can legitimately happen        in preview mode, if the to_change expression isn't valid.");n.resolve();return n}n.resolve(Y.run_once(30,function(){return e._type()}).then(function(n){var r,i,o,a,s,u,l,c,f,d,_,p,h;i=X.get(n).custom_type();if(i!=null){Y.optional_pause();_=t!=null?t:{};for(a in _){o=_[a];if(o!=null&&o.key){if(!i.field(o.key).exists()){continue}if(!o.action){e.child(o.key).set(o.value)}else{r=function(t){return e.child(o.key).push(t)};u=function(t){return e.child(o.key).remove(t)};if(o.action==="add"){r(o.value)}else if(o.action==="remove"){u(o.value)}else if(o.action==="set_list"){e.child(o.key).set(o.value)}else if(o.action==="add_list"){p=o.value;for(a=l=0,f=p.length;l<f;a=++l){s=p[a];r(s);if(a%5===0){Y.optional_pause()}}}else if(o.action==="remove_list"){h=o.value;for(a=c=0,d=h.length;c<d;a=++c){s=h[a];u(s);if(a%5===0){Y.optional_pause()}}}else if(o.action==="clear_list"){e.child(o.key).set([])}else{throw Y.error("unrecognized action: "+o.action)}}}Y.optional_pause()}e.child("Modified Date").set(Y.timestamp())}return null}));return n};p.NewThing={field_names:{thing_type:{},initial_values:{}},run:function(e,t,n,i){var o,a;o=n.UUID_SEED.UUID();a=r().db_instance().create(t.thing_type,null,o);return H(a,t.initial_values).callback(function(e){return i(e,a)})},data_to_refresh:null,return_value:function(e){var t;return X.get((t=e.get_static_property("thing_type"))!=null?t:"null")},server_method:"new_thing",pre_evaluate_properties:function(e){e=O("initial_values")(e);e=s("initial_values")(e.thing_type,e);return e},fall_back_to_server:true};p.get_data_to_refresh_for_change_action=k=function(e,t){var n,r,i,o,a;o={};a=t!=null?t:{};for(r in a){n=a[r];if(n.key){i=m.STATES.Message(e,null,n.key);if(!n.action){o[i]=n.value}else{o[i]=null}}}o[m.STATES.Message(e,null,"Modified Date")]=null;return o};ne=function(e,t){var n;if(t.is_equal_to(e.property("changes"))){return[true,true]}else{n=t.parent_expression();if(n==null){return[false,true]}return ne(e,n)}};p.ChangeThing={field_names:Y.extend({to_change:{},create_if_missing:{}},c),run:function(e,t,n,i){var o,a,s,u,l,c;u=t.to_change;if(u!=null){s=H(u,t.changes);return s.callback(function(e){return i(e,u)})}else if(t.create_if_missing){o=n.UUID_SEED.UUID();l=(c=this._get_type(e))!=null?c.id():void 0;if(l){a=r().db_instance().create(l,null,o);return H(a,t.changes).callback(function(e){return i(e,a)})}else{return i()}}else{return i()}},use_injected_datasource:function(e,t){return ne(e,t)},_get_type:function(e){return e.property("to_change").get_eval_value()},get_injected_value:function(e,t){return this._get_type(e)},get_injected_display:function(e,t){var n;return"This "+((n=this._get_type(e))!=null?n.display():void 0)},server_method:"change_thing",data_to_refresh:function(e,t,n){return k(t.to_change,t.changes)},return_value:function(e){return this._get_type(e)},exclude_properties:["changes"],pre_evaluate_properties:function(e,t,n){var r,i,o,a;n=Y.extend({},n);o=(a=this._get_type(t))!=null?a.id():void 0;i=e.to_change;n.datasources.injected_value_value=function(){return o};n.datasources.injected_value=function(){return i};r=t.property("changes");e.changes=D.with_eval_node(r,function(){return D.evaluate_json(r.json,n,null,null)[0]});e=B(e);if(i==null&&e.create_if_missing){if(o){e=s("changes")(o,e)}}return e},fall_back_to_server:true};p.ChangeListOfThings={field_names:Y.extend({type_to_change:{},to_change:{}},c),use_injected_datasource:function(e,t){return ne(e,t)},get_injected_value:function(e,t){return e.get_static_property("type_to_change")},get_injected_display:function(e,t){return"This "+X.get(e.get_static_property("type_to_change")).display()},exclude_properties:["changes"],pre_evaluate_properties:function(e,t,n){var r,i,o,a;Y.optional_pause();n=Y.extend({},n);n.datasources.injected_value_value=function(){return e.type_to_change};o=(a=e.to_change)!=null?a:new v.StaticList([]);delete e.to_change;e.changes=[];i=t.property("changes");r=Y.on_server()?20:1e3;D.with_eval_node(i,function(){var t,a,s,u,l,c,f,d;a=0;while(true){t=function(){var e,t,n,i,u;i=(n=typeof o.get_children==="function"?o.get_children(a,r):void 0)!=null?n:[];u=[];for(e=0,t=i.length;e<t;e++){s=i[e];if((s!=null?s._id:void 0)!=null){u.push(s)}}return u}();for(l=0,f=t.length;l<f;l++){s=t[l];if(typeof s.precache==="function"){s.precache()}}a+=r;if(t.length===0){break}Y.optional_pause();u=function(t){var r;n.datasources.injected_value=function(){return t};r=D.evaluate_json(i.json,n,null,null)[0];e.changes.push(B({item:t,changes:r}));return Y.optional_pause()};for(c=0,d=t.length;c<d;c++){s=t[c];u(s)}}return Y.optional_pause()});return e},run:function(e,t,n,r){var i,o,a,s;o=Y.promise_array(function(){var e,n,r;e=t.changes;r=[];for(a in e){n=e[a],s=n.item,i=n.changes;r.push(H(s,i))}return r}());return o.callback(function(e){return r(e,new v.StaticList(function(){var e,n;e=t.changes;n=[];for(a in e){s=e[a].item;n.push(s)}return n}()))})},data_to_refresh:function(e,t,n){var r,i,o,a,s,u,l,c,f;s={};l=t.changes;for(i in l){c=l[i],o=c.item,r=c.changes;f=k(o,r);for(a in f){u=f[a];s[a]=u}}return s},return_value:function(e){var t;t=e.get_static_property("type_to_change");if(t){return"list."+t}else{return"null"}},server_method:"change_list_of_things",fall_back_to_server:true};p.DeleteThing={field_names:{to_delete:{}},run:function(e,t,n,r){var i,o;o=t.to_delete;i=o!=null?typeof o["delete"]==="function"?o["delete"]():void 0:void 0;return r()},data_to_refresh:null,return_value:function(e){return null},server_method:"delete_thing",fall_back_to_server:true};p.DeleteListOfThings={field_names:{type_to_delete:{},to_delete:{}},pre_evaluate_properties:function(e){var t,n;e.to_delete=(t=(n=e.to_delete)!=null?typeof n.all==="function"?n.all():void 0:void 0)!=null?t:[];return e},run:function(e,t,n,r){var i,o,a,s;o=function(){var e,n,r,o,a;o=(r=t.to_delete)!=null?r:[];a=[];for(e=0,n=o.length;e<n;e++){i=o[e];if((i!=null?i._id:void 0)!=null){a.push(i)}}return a}();for(a=0,s=o.length;a<s;a++){i=o[a];if(i!=null){if(typeof i["delete"]==="function"){i["delete"]()}}}return r()},data_to_refresh:null,return_value:function(e){return null},server_method:"delete_list_of_things",fall_back_to_server:true};p.prepare_raw_thing_to_copy=function(e){if(!e){return null}delete e["Created By"];delete e["Created Date"];delete e["Modified Date"];return e};p.CopyListOfThings={field_names:{type_to_copy:{},to_copy:{},information:{}},pre_evaluate_properties:function(e){var t,n,r;if(typeof((t=e.to_copy)!=null?t.length:void 0)!=="function"||e.to_copy.length()>f.max_new_list_length){return e.to_copy=[]}else{e.to_copy=(n=(r=e.to_copy)!=null?typeof r.all==="function"?r.all():void 0:void 0)!=null?n:[];return e}},run:function(e,t,n,i){var o,a;a=function(){var e,n,r,i,a;i=(r=t.to_copy)!=null?r:[];a=[];for(e=0,n=i.length;e<n;e++){o=i[e];if((o!=null?o._id:void 0)!=null){a.push(o)}}return a}();return Y.run_once(30,function(){var e,t,n;e=[];for(t=0,n=a.length;t<n;t++){o=a[t];e.push(o.raw())}return e},function(e,o){var a,s,u,l,c,f,d,_;if(e){Y.warn(e);return}l=[];u=function(){var e,t,r;r=[];for(e=0,t=o.length;e<t;e++){f=o[e];r.push(n.UUID_SEED.UUID())}return r}();for(a=d=0,_=o.length;d<_;a=++d){f=o[a];s=u[a];c=p.prepare_raw_thing_to_copy(f);l.push(r().db_instance().create(t.type_to_copy,c,s))}return i(void 0,new v.StaticList(l))})},data_to_refresh:null,return_value:function(e){var t;t=e.get_static_property("type_to_copy");if(t){return"list."+t}else{return"null"}},server_method:"copy_list_of_things",fall_back_to_server:true};p.sub_node_key_to_value=function(e,t){if(!e){return null}if(!t){return null}return e.get_message(t).ret_value()};p.get_printable_value=T=function(e,t,n){var r,i,o,a,s,u,l,c,f;if(t==null){return""}if(e.id().indexOf("list.")===0){s=X.get(e.id().split("list.")[1]);a=(f=t!=null?typeof t.all==="function"?t.all():void 0:void 0)!=null?f:[];i=[];for(l=0,c=a.length;l<c;l++){o=a[l];i.push(T(s,o))}r=function(){var e,t,n;n=[];for(e=0,t=i.length;e<t;e++){u=i[e];n.push(u)}return n}().join(" , ")}else if(e.id().indexOf("custom.")===0){r=e.get_message("_id").fn(t)}else if(e.id()==="user"){r=t!=null?t._id():void 0}else if(e.id()==="boolean"){r=t!=null?t:false}else if(e.id()==="date"){if(n==="universal"){r=new Date(t)}else if(n==="spreadsheet_compatible"){r=e.cast_to_string(t)}else{r=Y.format_date(t,n)}}else if(e.cast_to_string){
r=e.cast_to_string(t)}else{Y.warn("Tried to display a value in DownloadAsCSV "+e.id()+" but not cast_to_string for this value")}return r};p.get_printable_object=M=function(e,t,n,r,i){var o,a,s,u,l,c,f,d,_,p,h;if(r==null){r=[]}c=[];f=X.get(t);if(f.custom_type()){u=function(){var e,t,n,r;n=f.custom_type().fields();r=[];for(e=0,t=n.length;e<t;e++){s=n[e];if(!s.deleted()){r.push(s.name())}}return r}();u.push.apply(u,["Created Date","Modified Date","_id"]);if(t==="user"){u.push("email")}else{u.push("Created By")}}else{u=function(){var e,t,n,r;n=f.get_messages();r=[];for(e=0,t=n.length;e<t;e++){l=n[e];r.push(l.name())}return r}()}for(d=0,p=e.length;d<p;d++){a=e[d];o={};for(_=0,h=u.length;_<h;_++){s=u[_];if(re.call(r,s)<0){(function(e){var t,r,s,u,l,c;s=f.get_message(e);u=s.ret_value();l=s.fn(a);t=T(u,l,n);if(i){r=s.description(void 0,true)}else{r=s.name()}o[r]=t;if(e==="Created By"&&t){return o["Created By - email"]=(c=f.get_message("Created By").fn(a).get_email())!=null?c:""}})(s)}}c.push(o)}return c};p.csv_separator={comma:",",semicolon:";",tab:"tab",pipe:"|"};p.DownloadDataAsCSV={not_api:true,field_names:{data_type:{},data_source:{},file_name:{"default":"data_export.csv"},date_formatting:{"default":"spreadsheet_compatible"},custom_format:{"default":"ddd, m/dd/yy, mmmm (mmm) dS, yyyy, h:MM tt, HH:MM:ss.L"},separator:{"default":"comma"},show_labels:{"default":true},use_quotes:{"default":true},use_caption_labels:{"default":false},hide_some_fields:{optional:true}},run:function(e,t,n,i){var o,a,s,u,l;if(!r().app_plan().import_export_csv){return i(Y.error({statusCode:400,message:"Exporting CSV data is not possible under this plan."}))}if(t.separator==="tab"){s="	"}else{s=(u=p.csv_separator[t.separator])!=null?u:","}if(t.date_formatting==="custom"){a=t.custom_format}else{a=t.date_formatting}o=(l=t.data_source)!=null?l:new v.StaticList([]);return Y.run_once(120,function(){var e,n,r,i,s,u;o.all();n=o.length();e=100;i=[];s=function(n){return i.push(Y.run_once(10*60*1e3,function(){var r,i;r=o.get_children(n,e);return M(r,t.data_type,a,Y.json_parse((i=t.hide_some_fields)!=null?i:"[]"),t.use_caption_labels)}))};for(r=u=0;e>0?u<n:u>n;r=u+=e){s(r)}return i}).then(function(e){return Y.promise_array(e).callback(function(e,n){var r,o,a,u,l,c;a=t.file_name;if(a.indexOf(".csv")!==a.length-4){a=a+".csv"}if(e){Y.warn(e);r="Error exporting data... please try again in a bit"}else{o=[];for(l=0,c=n.length;l<c;l++){u=n[l];o=o.concat(u)}r=Y.json_to_csv(o,s,t.show_labels,t.use_quotes)}Y.csv_to_downloadable_file(a,r);return i(null,r)})})},data_to_refresh:null};p.UploadCSVData={not_api:true,field_names:{data_type:{},file:{},separator:{"default":"comma"}},run:function(e,t,n,r){return n.get_server_outcome(e,function(e,t){return r(e,t)})},data_to_refresh:null,return_value:function(e){var t;t=e.get_static_property("data_type");if(t){return"list."+t}else{return"null"}},server_method:"upload_csv_data"};p.APIReturnData={api_only:true,field_names:{return_plain_text:{},text:{},parameters_actions:{}},run:function(e,t,n,r){},server_method:"api_return_data",check_for_errors:function(e,t){var n,r,i,o,a,s;n=0;o=e.event().actions("APIReturnData");for(r=0,i=o.length;r<i;r++){e=o[r];if((typeof e.property==="function"?(a=e.property("condition"))!=null?(s=a.json)!=null?s.raw():void 0:void 0:void 0)==null){n++}}if(n>1){return t("You should use only one 'Return data from API' action per API workflow")}}};p.DeleteUploadedFile={field_names:{url_to_delete:{}},data_to_refresh:null,server_method:"delete_upload_file",run:function(e,t,n,r){return n.get_server_outcome(e,function(e,t){return r(e,t)})}};j=function(e,t,n){var r,i,o,a;a=e.get_static_property(t);r=false;o={};i=function(e){var s,l,c,f,d,_,p,h,g,m;c=[];for(d=0,p=n.length;d<p;d++){l=n[d];c.push.apply(c,(g=e!=null?typeof e.actions==="function"?e.actions(l).to_array():void 0:void 0)!=null?g:[])}m=[];for(_=0,h=c.length;_<h;_++){s=c[_];f=s.get_static_property(t);if(f===a){r=true;break}else if(!o[f]){o[f]=true;m.push(i(u.event(f)))}else{m.push(void 0)}}return m};i(u.event(a));return r};p.TriggerCustomEvent={field_names:{custom_event:{},workflow_thing:{}},check_for_errors:function(e,t,n){if(j(e,"custom_event",["TriggerCustomEvent","TriggerCustomEventFromReusable"])){return t(e.display()+" - is triggering a custom event that triggers itself (directly or indirectly)",e)}}};p.TriggerCustomEventFromReusable={field_names:{element_id:{},custom_event:{},workflow_thing:{}},not_api:true,check_for_errors:function(e,t,n){if(!n){t(void 0,void 0,e.id());return true}}};p.TriggerCustomOnChange={field_names:{custom_event:{},workflow_thing:{},field:{}},check_for_errors:function(e,t){var n,r,i;n=e.get_static_property("custom_event");if(n){r=(i=u.event(n))!=null?i.get_static_property("custom_event_data_type"):void 0;if(r==null){return t(this.display(e)+" - can only be used with custom events that take workflow data")}}},run:function(e,t,n,i){var o,a,s,l,c;l=t.workflow_thing;s=t.field;o=u.event(t.custom_event);if(!(l!=null&&s!=null&&(o!=null?o.exists():void 0))){console.log("Skipping trigger custom event on change, missing data");i();return}a=n.element;c=r().workflow;return Y.run_once(30,function(){if(s==="email_confirmed"){return X.get("user").get_message("email_confirmed").fn(l)}else{return l.child(s).get()}},function(e,t){var r,u;if(e){i(e);return}i();l.poll(5e3,600);u=false;r=Y.Watcher(function(){return l.child(s).get()});return r.on_value(function(e){if(u){return}if(!Y.compare(t,e)){u=true;r.destroy();n=g.get_workflow_item_context({element:a},l,o.get_static_property("custom_event_data_type"));return c.run_workflows(n,[o],true)}})})},not_api:true};te=0;p.ScheduleCustom={field_names:{custom_event:{},workflow_thing:{},delay:{}},run:function(e,t,n,i){var o,a,s,l,c,f,d,_,p,h,m,v;c=t.workflow_thing;o=u.event(t.custom_event);if(!(o!=null?o.exists():void 0)){console.log("Skipping trigger custom event on change, event does not exist");i();return}a=n.element;d=r().workflow;l=false;m=o.actions();for(p=0,h=m.length;p<h;p++){_=m[p];if(_.requires_server()){l=true;break}}s=0;if(l){te++;setTimeout(function(){return te--},30*1e3);if(te>10){s=(te-10)*30*1e3}}f=((v=t.delay)!=null?v:1)*1e3+s;if(f>2147483647){r().show_error_to_user({instance:e,error:{message:"The delay cannot exceed 2,147,483 seconds; the custom event will be run immediately in such case"},type:"action"})}setTimeout(function(){n=g.get_workflow_item_context({element:a},c,o.get_static_property("custom_event_data_type"));return d.run_workflows(n,[o],true)},f);return i()},not_api:true};p.APIEvent_param_prefix="_wf_param_";Z=function(e,t,n){if(!n){t(void 0,void 0,e.id());return true}if(f.max_scheduler_recursion_depth>0){return}if(j(e,"api_event",["ScheduleAPIEvent","ScheduleAPIEventOnList"])){return t(e.display()+" - is scheduling an API workflow that schedules itself (directly or indirectly)",e)}};p.ScheduleAPIEvent={field_names:D.DETECT_FIELD_NAMES,server_method:"schedule_api_event",check_for_errors:function(e,t,n){return Z(e,t,n)},return_value:function(){return X.get("text")}};p.ScheduleAPIEventOnList={field_names:D.DETECT_FIELD_NAMES,server_method:"schedule_api_event_on_list",use_injected_datasource:function(e,t){var n;if(t.node_name().indexOf(p.APIEvent_param_prefix)===0){return[true,true]}else{n=t.parent_expression();if(n==null){return[false,true]}return this.use_injected_datasource(e,n)}},get_injected_value:function(e,t){return e.get_static_property("type_of_list")},get_injected_display:function(e,t){return"This "+X.get(e.get_static_property("type_of_list")).display()},pre_evaluate_properties:function(e,t,n){var r,i,o,a,s,l,c,f,d,_,h,g,m,y,b,w;n=Y.extend({},n);n.datasources.injected_value_value=function(){return e.type_of_list};f=(b=e.data_source)!=null?b:new v.StaticList([]);delete e.data_source;e.to_run=[];r=u.workflow_item(e.api_event);c=(w=r!=null?typeof r.get_parameters==="function"?r.get_parameters():void 0:void 0)!=null?w:[];for(l in e){d=e[l];if(l.indexOf(p.APIEvent_param_prefix)===0){delete e[l]}}o=Y.on_server()?20:1e3;a=0;while(true){if(Y.on_server()){Y.optional_pause()}i=function(){var e,t,n,r,i;r=(n=typeof f.get_children==="function"?f.get_children(a,o):void 0)!=null?n:[];i=[];for(e=0,t=r.length;e<t;e++){s=r[e];i.push(s)}return i}();for(h=0,m=i.length;h<m;h++){s=i[h];if(typeof s.precache==="function"){s.precache()}}a+=o;if(i.length===0){break}_=function(r){var i,o,a,s,u;i={injected_value:r};n.datasources.injected_value=function(){return r};for(s=0,u=c.length;s<u;s++){o=c[s].key;a=t.property(p.APIEvent_param_prefix+o);D.with_eval_node(a,function(){return i[p.APIEvent_param_prefix+o]=D.evaluate_json(a.json,n,null,null)[0]})}return e.to_run.push(i)};for(g=0,y=i.length;g<y;g++){s=i[g];_(s)}}return e},check_for_errors:function(e,t,n){return Z(e,t,n)},return_value:function(){return X.get("list.text")}};p.TerminateWorkflow={field_names:{},handle_condition_internally:true,run:function(e,t,n,r){if(t.condition){return r("aborted")}else if(n.is_running_on_server){return n.get_server_outcome(e,function(e,t){if(e){return r(e)}else if(t==="aborted"){return r("aborted")}else{return r()}})}else{return r()}}};p.CancelScheduledAPIEvent={field_names:{scheduled_id:{}},server_method:"cancel_scheduled_api_event"};p.CancelListScheduledAPIEvent={field_names:{scheduled_ids:{}},server_method:"cancel_list_scheduled_api_events"};p.SetRecurringEvent={field_names:{recurring_event:{},workflow_thing:{},frequency:{},start_date:{}},server_method:"set_recurring_event"};p.PauseWFClient={field_names:{length:{"default":1e3},hide_status_bar:{}},run:function(e,t,n,r){if(!t.length||t.length<=0){t.length=0}if(t.hide_status_bar){setTimeout(G.hide_run_mode,100)}return setTimeout(function(){if(t.hide_status_bar){G.show_run_mode()}return r()},t.length)},not_api:true,data_to_refresh:null};p.SendEmail={field_names:{to:{},different_reply_to:{},replyTo:{},sender_name:{},cc:{},bcc:{},subject:{},body:{},ignore_template:{}},server_method:"send_email",data_to_refresh:null};p.SendICSFileEmail={field_names:{to:{},sender_name:{},start:{},end:{},specify_length:{},length:{},summary:{},event_description:{},location:{},change_body:{},body:{"default":"Open the attached ICS to put the appointment in your calendar."}},server_method:"send_ical_by_email",data_to_refresh:null};p.ResetInputs={not_api:true,field_names:{},run:function(e,t,n,r){return Y.run_once(30,function(){var t,r,i,o,a,s;r=e.event();a=Y.unique(r.find_expressions("GetElement").element_id());t=n.element.element_id();if(r.find_expressions("ThisElement").length&&re.call(a,t)<0){a.push(t)}a=function(){var e,t,r;r=[];for(e=0,t=a.length;e<t;e++){o=a[e];r.push(n.element.find_instance_by_id(o))}return r}();a=function(){var e,t,n;n=[];for(e=0,t=a.length;e<t;e++){i=a[e];if(i){n.push(i)}}return n}();s=function(){var e,t,n,r;r=[];for(e=0,t=a.length;e<t;e++){i=a[e];if((n=re.call(i!=null?i.get_messages():void 0,"reset_input")>=0)!=null?n:[]){r.push(i)}}return r}();return s},function(e,t){var n,i,o;if(e){return r(e)}else{for(i=0,o=t.length;i<o;i++){n=t[i];n.message("reset_input")}return r()}})},data_to_refresh:null};p.get_resume_url=C=function(e,t,n){var i,o;i=K.parse(document.location.href,true);delete i.search;o=r().workflow.make_resume_key(e,t,n);if(o){i.query.resume=o}return K.format(i)};t="All elements";o={ScrollToElement:[t],AnimateElement:[t],ShowElement:[t],HideElement:[t],ToggleElement:[t],SetCustomState:[t],SetFocusToElement:["Input","MultiLineInput","RichTextInput","Checkbox","Dropdown","AutocompleteDropdown","PictureInput","FileInput","DateInput","SliderInput"],ResetInputs:["Input","MultiLineInput","Checkbox","Dropdown","AutocompleteDropdown","SliderInput","DateInput","PictureInput","FileInput"],DisplayListData:["RepeatingGroup"],ListShowPrevious:["RepeatingGroup"],ListShowNext:["RepeatingGroup"],ListClear:["RepeatingGroup"],ScrollToListEntry:["RepeatingGroup"],ListGoToPage:["RepeatingGroup"],ResetGroup:["Group","FloatingGroup","Popup","CustomElement","CustomDefinition","GroupWithFocus"],DisplayGroupData:["Group","FloatingGroup","Popup","CustomElement","GroupWithFocus"],AlertShowMessage:["Alert"],DisplayMapMarkerData:["GoogleMap"],ClearMapMarkers:["GoogleMap"],MapAdjustZoom:["GoogleMap"]};p.action_element_mapping=o;w=function(e){var t,n,r;n=[];for(t in o){r=o[t];if(re.call(r,e)>=0){n.push(t)}}return n};p.get_element_actions=function(e,n){var r,i,a,s,u,l,c,f,d;u=[];if(!e){return u}if(e.is_api()){return u}s=e.find_elements();u.push.apply(u,w(t));a=Y.unique(function(){var e,t,n;n=[];for(e=0,t=s.length;e<t;e++){i=s[e];n.push(i.type())}return n}());if(e.is_custom_definition()){a.push("CustomDefinition")}for(f=0,d=a.length;f<d;f++){i=a[f];u.push.apply(u,w(i))}u=Y.unique(u);l=["ShowElement","HideElement","ToggleElement","AnimateElement","ScrollToElement","SetCustomState","SetFocusToElement","ResetInputs","DisplayGroupData","ResetGroup","DisplayListData","ListShowPrevious","ListShowNext","ListClear","ListGoToPage","ScrollToListEntry","AlertShowMessage","DisplayMapMarkerData","ClearMapMarkers","MapAdjustZoom"];c=Y.sort_array(u,l);if(c.length){return n["Element Actions"]=function(){var e,t,n;n=[];for(e=0,t=c.length;e<t;e++){r=c[e];n.push({type:r,element_type:o[r][0]})}return n}()}};E=function(){var e,t,n;t=[];if(u.app().plugin_special()==="meta"){n=r().load_plugin("Module:special_meta");t.push.apply(t,function(){var t,r,i,o;i=n.special_actions_list;o=[];for(t=0,r=i.length;t<r;t++){e=i[t];o.push({type:e})}return o}())}return t};p.init_plugin_actions=E;x=function(e){return Y.extend(e,Q)};p.CUSTOM_ACTION_PREFIX="custom-action-";p.get_root_actions=function(e){var t,n,r,i,o,s,u,l,c;n=Y.json_deep_copy(ee);if(e==null||e.get_name()==="reset_pw"){n["Account"].push({type:"ResetPassword"})}u=function(e,t){var n,r,i,o,s,u,l,c,f,d,_;r=e.toLowerCase();i=z.get_app_plugins_by_tags("action",r);for(u=0,c=i.length;u<c;u++){o=i[u];_=(d=typeof(s=o.get_service()).get_actions==="function"?s.get_actions():void 0)!=null?d:[];for(l=0,f=_.length;l<f;l++){n=_[l];if(p.get_action_object(n).category===r){t.push({type:n})}}}if(z.get_all_plugins_by_tags("action",r).length>i.length){return t.push({title:"Install more "+r+" actions...",fn:function(){return a.show(["action"],[r])}})}};for(r in n){o=n[r];u(r,o)}l=f.custom_action_definitions;for(t in l){i=l[t];n.Plugins.push({type:p.CUSTOM_ACTION_PREFIX+t})}s=E();if(s.length>0){(c=n.Plugins).push.apply(c,s)}return n};p.get_all_actions=function(e){var t,n;n=e.root();t=p.get_root_actions(n);p.get_element_actions(n,t);if(!(n!=null?n.is_api():void 0)||n.is_api()&&e.event().type()!=="CustomEvent"){x(t)}return t};p.get_full_list_actions=function(){var e,t,n;e=p.get_root_actions();e["Element Actions"]=function(){var e;e=[];for(t in o){n=o[t];e.push({type:t})}return e}();x(e);return e};p.get_action_object=function(e){var t,n,r,i;if(p[e]){return p[e]}else if((e!=null?typeof e.indexOf==="function"?e.indexOf(p.CUSTOM_ACTION_PREFIX):void 0:void 0)===0){return p.build_custom_action(e.slice(p.CUSTOM_ACTION_PREFIX.length))}else{r=W.get_service_and_type(e),n=r[0],t=r[1];return(i=W.get_service(n))!=null?i.get_action(e):void 0}};ee={Account:[{type:"SignUp"},{type:"LogIn"},{type:"OAuthLogin"},{type:"LogOut"},{type:"UpdateCredentials"},{type:"MakeChangeCurrentUser"},{type:"SendConfirmationEmail"},{type:"SendPasswordResetEmail"},{type:"CreateUserAccount"},{type:"CheckUserPassword"},{type:"SetTemporaryPassword"},{type:"ChangeEmailForAnotherUser"}],Navigation:[{type:"ChangePage"},{type:"RefreshPage"},{type:"GoPrevious"},{type:"OpenURL"},{type:"PauseWFClient"},{type:"TerminateWorkflow"}],"Data (Things)":[{type:"NewThing"},{type:"ChangeThing"},{type:"ChangeListOfThings"},{type:"DeleteThing"},{type:"DeleteListOfThings"},{type:"CopyListOfThings"},{type:"DownloadDataAsCSV"},{type:"UploadCSVData"},{type:"APIReturnData"},{type:"DeleteUploadedFile"}],Email:[{type:"SendEmail"},{type:"SendICSFileEmail"}],Payment:[],Analytics:[],"Element Actions":[],Plugins:[]};Q={"Custom Events":[{type:"TriggerCustomEvent"},{type:"ScheduleCustom"},{type:"TriggerCustomEventFromReusable"},{type:"TriggerCustomOnChange"},{type:"ScheduleAPIEvent"},{type:"ScheduleAPIEventOnList"},{type:"SetRecurringEvent"},{type:"CancelScheduledAPIEvent"},{type:"CancelListScheduledAPIEvent"}]};p.basic_actions=ee;p.map_custom_action_type=function(e){var t,n,r,i,o;switch(e.type){case"text":case"number":case"date":return e.type;case"boolean":return"sys.bool";case"custom":n=e.custom_type;o=u.custom_types();for(r=0,i=o.length;r<i;r++){t=o[r];if(t.display().toLowerCase()===n.toLowerCase()){return t.to_value()}}return"null";default:return"null"}};I=function(e){switch(e.type){case"text":return{editor:"LongText"};case"boolean":case"number":case"date":case"custom":return{editor:"Basic",value:p.map_custom_action_type(e)};default:return{}}};p.get_custom_action_value=function(e){var t,n,r,i,o;n=f.custom_action_definitions[e];i={};o=n.returned_fields;for(r in o){t=o[r];i[r]={ret_value:p.map_custom_action_type(t)}}return new b.StructValue(n.display,i)};p.build_custom_action=function(e){var t,n,r,i,o,a;t=f.custom_action_definitions[e];if(!t){return{display:function(){return"Missing: "+e},field_names:{},fields:function(){return[]}}}n={};a=(o=t.parameters)!=null?o:{};for(r in a){i=a[r];n[r]={optional:true,name:r}}return{display:function(){return t.display},field_names:n,fields:function(){var e,n,o,a;n=[];a=(o=t.parameters)!=null?o:{};for(r in a){i=a[r];e={name:r,type:p.map_custom_action_type(i),caption:r};Y.extend(e,I(i));n.push(e)}return n},return_value:function(){if(!t.returned_fields){return"null"}else if(t.returns_array){return"list.custom-action."+e}else{return"custom-action."+e}},run:function(e,t,n,r){return n.get_server_outcome(e,r)},server_method:"custom_action"}};r=e("./../lib");m=e("./../lang/dataops");u=e("./../lang/appquery");K=e("url");g=e("./core_expressions");h=e("./core_elements");v=e("./../db/db");z=e("./../lang/plugins");X=e("./../lang/values");a=e("./../editor/add_plugin");U=e("./../db/security");b=e("./../external");G=e("./status_bar");R=e("./../lang/plugin_loader");N=e;if(Y.on_server()){J=N("./../user_lib");Y.WaitFor(h.loaded,function(){var e;e=N("./../core/core_actions_fields");return e.add_fields_to_actions()})}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./../client/locationservice":8,"./../client_config":16,"./../db/db":28,"./../db/security":31,"./../editor/add_plugin":35,"./../external":40,"./../lang/appquery":51,"./../lang/dataops":54,"./../lang/lang":57,"./../lang/plugin_loader":59,"./../lang/plugins":60,"./../lang/values":62,"./../lib":65,"./../services":70,"./../tests/testing":71,"./../u":72,"./core_elements":19,"./core_expressions":21,"./status_bar":25,url:299}],19:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,K,J,X,Z,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,fe,de,_e,pe,he,ge,me,ve,ye,be,we,xe,ke,Se,Ae,Ee,Me,Te,Ce,je,De,Oe,Ie,Pe,Re,ze,Be,Ne,Le,qe,Ue,Fe,We,Ge,Ve,Ye,He,$e,Ke,Je,Xe,Ze,Qe,et,tt,nt,rt,it,ot,at,st,ut,lt,ct,ft,dt,_t,pt,ht,gt,mt,vt=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1},yt=this,bt={}.hasOwnProperty,wt=function(e,t){for(var n in t){if(bt.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};E=n;Ue=e("./../u");E.loaded=Ue.MakeKey(null,"core_elements.loaded");ve=e("./property_applications");A=e("./core_actions");T=e("./core_events");v=e("./../lang/appquery");le=e("./../lang/lang");L=e("./../lang/elements");D=e("./../editor/css");ce=e("./../languages");ye=e("querystring");_=e("./../lang/application");k=e("./../client_config");me=e("./../lang/plugins");je=e("./../services");Ue.safe_register("./core/core_elements",E);h=ve.apply_css_style;E.start_workflow_field_names=Re={start_workflow:{no_states:true},button_disabled:{}};E.visibility_property={name:"is_visible",caption:"This element is visible on page load",long_caption:"This element is visible",editor:"Checkbox",pretty:{section:"Position"}};E.visibility_field_names={is_visible:{"default":true}};E.elements_list={CustomElement:true};E.make_element=de=function(e,t,n){var r,i,o,a,s,u,l,c,f,d,_,p,h,g;o=E.transform_element(e,t);if(!n){E[e]=o}if((d=t.events)!=null?d.length:void 0){t.events=t.events.concat("OnError")}if((_=t.events)!=null?_.length:void 0){p=t.events;for(u=0,c=p.length;u<c;u++){i=p[u];if(T.event_element_mapping==null){T.event_element_mapping={}}if((a=T.event_element_mapping)[i]==null){a[i]=[]}if(vt.call(T.event_element_mapping[i],e)<0){T.event_element_mapping[i].push(e)}}}if((h=t.actions)!=null?h.length:void 0){g=t.actions;for(l=0,f=g.length;l<f;l++){r=g[l];if((s=A.action_element_mapping)[r]==null){s[r]=[]}if(vt.call(A.action_element_mapping[r],e)<0){A.action_element_mapping[r].push(e)}}}return E.elements_list[e]=true};E.reset_inputs_and_groups=function(e){var t,n,r,i,o,a;o=["reset_input","reset_group","clear_list"];a=[];for(r=0,i=o.length;r<i;r++){n=o[r];a.push(function(){var r,i,o,a,s;a=(o=e.children)!=null?o:[];s=[];for(r=0,i=a.length;r<i;r++){t=a[r];if(vt.call(t.element.get_messages(),n)>=0){s.push(t.message(n))}}return s}())}return a};E.get_full_list_elements=function(){var e,t,n,r,i,o,a,s,u,l,c,f;t=function(){var e;e=[];for(n in E){i=E[n];if(E.elements_list[n]){e.push(n)}}return e}();c=me.get_app_plugins_by_tags("element");for(a=0,u=c.length;a<u;a++){r=c[a];f=typeof(o=r.get_service()).get_elements_visual_edit==="function"?o.get_elements_visual_edit():void 0;for(s=0,l=f.length;s<l;s++){e=f[s];t.push(e.name())}}return t};E.get_element_object=function(e){var t,n,r,i;if(e==="CustomElement"){return}if(E[e]){return E[e]}else{r=je.get_service_and_type(e),n=r[0],t=r[1];return(i=je.get_service(n))!=null?i.get_element(e):void 0}};i=E.CLICKABLE_ELEMENT="clickable-element";E.delete_element_property=function(e){return{name:"delete_element",button_caption:"Delete",editor:"Button",optional:true,click_cb:function(){if(window.confirm("Delete element "+e.get_name()+"?")){e["delete"]();return e.commit()}},pretty:{section:"ElementMetaActions",no_caption:true}}};E.select_parent_property=function(e){return{name:"select_parent",caption:"Select parent",editor:"Dropdown",no_write_child:true,optional:true,set:s().sets.ParentElements(e),on_change:function(e){s().edit_canvas.select_one(e);return s().visual_edit.currently_editing(e)},pretty:{section:"ElementMetaActions"}}};E.reveal_in_tree_property=function(e){return{name:"reveal_in_tree",button_caption:"Reveal in the Elements tree",editor:"Button",optional:true,click_cb:function(){return s().visual_edit.reveal_in_element_tree(e)},pretty:{section:"ElementMetaActions",no_caption:true}}};E.lock_in_editor_property=function(e){var t;return{name:"lock_in_editor",caption:"Lock this element (not draggable in editor)",editor:"Checkbox",optional:true,"default":(t=s().edit_canvas)!=null?t.locked_elements[e.id()]:void 0,no_write_child:true,on_change:function(t){return s().edit_canvas.lock_element(e.id(),t)},pretty:{section:"ElementMetaActions"}}};E.add_fields=function(e,t){return t.fields=function(n,r){var i,o,a,u,l,c,f,d,_,p,h,g,m,v,y,b;c=[];d=n.get_style_id();p=!t.starts_hidden&&!t.always_visible;if(p){c.push(E.visibility_property)}u=n.get_property_applications();if(!r&&d){f=function(){var e,t,n;n=[];for(e=0,t=u.length;e<t;e++){i=u[e];if(i.not_in_style){n.push(i)}}return n}()}else if(typeof n.is_style==="function"?n.is_style():void 0){f=function(){var e,t,n;n=[];for(e=0,t=u.length;e<t;e++){i=u[e];if(!i.not_in_style){n.push(i)}}return n}()}else{f=u}for(h=0,g=f.length;h<g;h++){i=f[h];c.push.apply(c,i.get_properties())}if(!r&&d){a=function(){var r,i,o,a,s,u;a=(o=typeof e==="function"?e(n):void 0)!=null?o:[];u=[];for(r=0,i=a.length;r<i;r++){l=a[r];if(!((s=t.field_names[l.name])!=null?s.in_style:void 0)){u.push(l)}}return u}()}else if(typeof n.is_style==="function"?n.is_style():void 0){a=function(){var r,i,o,a,s,u;a=(o=typeof e==="function"?e(n):void 0)!=null?o:[];u=[];for(r=0,i=a.length;r<i;r++){l=a[r];if((s=t.field_names[l.name])!=null?s.in_style:void 0){u.push(l)}}return u}()}else{a=(m=typeof e==="function"?e(n):void 0)!=null?m:[]}c.push.apply(c,a);if(!(typeof n.is_style==="function"?n.is_style():void 0)){if((v=n.type())==="CustomDefinition"){_=n.get_static_property("element_type")}else{_=n.type()}c.push.apply(c,[{name:"element_style",caption:"Style",editor:"Dropdown",optional:true,no_write_child:true,prop_node:function(e){return e.get_style_node()},on_change:function(e){n.set_style(e);return n.commit()},set:s().sets.Styles(_,n.id()),pretty:{section:"ElementStyle",dropdown_width:"mid_extra_large"}},{name:"edit_style",button_caption:"Edit style",editor:"Button",optional:true,condition:function(e){return e.get_style_id()!=null},click_cb:function(){if(n.type()!==s().styles_canvas.element_type_node.get()){s().styles_canvas.element_type_node.set(null)}if(s().styles_canvas.search_box()){s().styles_canvas.search_box("")}s().styles_canvas.currently_displayed_style(n.get_style_id());return $(D.STYLES_TAB).click()},pretty:{section:"ElementStyle",no_caption:true,width:"tiny"}},{name:"delete_style",button_caption:"Remove style",editor:"Button",optional:true,condition:function(e){return e.get_style_id()!=null},click_cb:function(){n.set_style(null);return n.commit()},pretty:{section:"ElementStyle",no_caption:true,width:"tiny"}}])}if((y=n.type())!=="Page"&&y!=="CustomDefinition"&&y!=="CustomElement"&&!(typeof n.is_style==="function"?n.is_style():void 0)){c.push({name:"switch_element",button_caption:"Replace",editor:"Button",optional:true,click_cb:function(){return window.ReplaceElementPlanel(n)},pretty:{section:"ElementMetaActions",no_caption:true,width:"small"}});o=E.delete_element_property(n);o.pretty.width="small";c.push(o)}if((b=n.type())!=="Page"&&b!=="CustomDefinition"&&!(typeof n.is_style==="function"?n.is_style():void 0)){c.push(E.select_parent_property(n));c.push(E.reveal_in_tree_property(n));c.push(E.lock_in_editor_property(n))}return c}};E.do_add_an_invisible_div_on_the_top=function(e){var t;e.canvas.find(".invisible-draggable-div").remove();t=Ue.div("invisible-draggable-div");e.get_canvas().prepend(t);t.css({top:0,left:0});return e.state("invisible_div_drawn",true)};E.transform_element=function(e,t){var n,r,o,a,u,l,c,f,d,_,p,g,m,v,y,b,w,x,k,S,A,M,C,j,D,O,P,R,z,B;t.plugin_name=e;j=["is_input","is_container","change_cursor_style_if_clickable","initialize","add_an_invisible_div_on_the_top"];for(S=0,M=j.length;S<M;S++){d=j[S];if(t[d]==null){throw Ue.error("Error building "+e+": no value for "+d)}}w=!t.starts_hidden&&!t.always_visible;if(t.field_names==null){t.field_names={}}y=typeof t.property_applications==="function"?t.property_applications():t.property_applications;for(A=0,C=y.length;A<C;A++){n=y[A];O=(D=n.field_names)!=null?D:{};for(f in O){x=O[f];t.field_names[f]=Ue.json_deep_copy(x)}}if(e!=="Page"){t.field_names.delete_element={no_states:true,only_edit_mode:true}}if(e!=="CustomDefinition"&&e!=="CustomElement"&&e!=="Page"){t.field_names.switch_element={no_states:true,only_edit_mode:true}}if(e!=="CustomDefinition"&&e!=="Page"){t.field_names.select_parent={no_states:true,only_edit_mode:true};t.field_names.reveal_in_tree={no_states:true,only_edit_mode:true};t.field_names.lock_in_editor={no_states:true,only_edit_mode:true}}t.field_names.element_style={no_states:true};t.field_names.delete_style={no_states:true,only_edit_mode:true};t.field_names.edit_style={no_states:true,only_edit_mode:true};if(w){Ue.extend(t.field_names,E.visibility_field_names)}if(t._fields){E.add_fields(t._fields,t)}if(t.defaults){P=t.field_names;for(c in P){l=P[c];r=t.defaults[c];if(r!=null){l["default"]=r}}}if(t.starts_hidden){t.is_visible_on_page_load=function(e){return false}}else if(t.always_visible){t.is_visible_on_page_load=function(e){return true}}else if(w){t.is_visible_on_page_load=function(e){return e.get_static_property("is_visible",true)}}else{throw Ue.error("should not get here")}if(t.dont_add_hover_pressed){b=[]}else{b=["is_hovered","is_pressed","force_pressed"]}v=["invisible_div_drawn"];_=["add_tab_index"];m=[];p=t.add_specific_messages;if(t.is_container){b.push.apply(b,["group_data"]);t.add_specific_messages=function(e,t){var n;n=t.get_state_value("group_data");if(n&&n.id()!=="null"){Ue.extend(e,{get_group_data:{description:"'s "+n.display(),ret_value:n,fn:function(e,t){return e!=null?e.state("group_data"):void 0}}})}return typeof p==="function"?p(e,t):void 0};v.push.apply(v,["datasource_changed_by_workflow_action"]);_.push.apply(_,["set_group_data","reset_group"]);m.push.apply(m,[])}if(t.is_input){b.push("value");t.add_specific_messages=function(e,n){Ue.extend(e,{get_data:{description:t.is_checkbox?" is checked":"'s value",ret_value:n.get_state_value("value"),fn:function(e,t,n,r,i){if(e==null){return}if((i!=null?i.inputs_must_be_valid:void 0)&&e.is_visible()){return e.state("value_that_is_valid")}else{return e.state("value")}}}});if(t.is_checkbox){Ue.extend(e,{get_not_data:{description:" isn't checked",ret_value:n.get_state_value("value"),fn:function(e,t){return!(e!=null?e.state("value"):void 0)}}})}return typeof p==="function"?p(e,n):void 0};b.push("value_that_is_valid");b.push("currently_binding");if(!t.no_is_focused){b.push("is_focused")}v.push.apply(v,["has_been_changed","force_display_validity"]);_.push.apply(_,["reset_input","set_focus"]);if(t.content_validated){b.push.apply(b,["display_invalid","is_invalid"]);_.push("display_validity")}m.push.apply(m,["user_change","user_submit"]);if((k=T.event_element_mapping)["InputChanged"]==null){k["InputChanged"]=[]}if(vt.call(T.event_element_mapping["InputChanged"],e)<0){T.event_element_mapping["InputChanged"].push(e)}}g=t.initialize;t.initialize=function(e){var n,r,o,a,u,l,c,f,d,_=this;g.call(t,e);if(w&&(e.run_mode()||e.responsive_mode())){if(!e.get_static_property("is_visible",true)){e.do_hide()}e.on_property_change("is_visible",function(t){if(t){return e.do_show()}else{return e.do_hide()}})}n=function(){var n,r,i,o,a;o=e.element.get_property_applications();a=[];for(r=0,i=o.length;r<i;r++){n=o[r];a.push(function(n){var r,i;if(n.apply_once){return n.apply({},e.canvas)}else{if(t.additional_uses_properties){r=n.uses_properties.concat(t.additional_uses_properties)}else{r=n.uses_properties}i=true;return e.on_property_change(r,function(t){t._first_time=i;n.apply(t,e.canvas,e);return i=false})}}(n))}return a};e.wait_for_visible_lite(function(){return n()});if(e.run_mode()){e.wait_for_visible_lite(function(){var t,n,r,i,o,a,s,u,l,c;n={};u=e.element.get_property_applications();for(a=0,s=u.length;a<s;a++){r=u[a];r.get_transition_css(e.element,e.canvas,n)}e.get_transition_css(n);c=[];for(o in n){l=n[o],i=l.target,t=l.css_prop;if(!(t!==void 0&&t!=="")){continue}t=t.slice(0,t.length-2);c.push(h(i,{"-webkit-transition":t,"-moz-transition":t,"-o-transition":t,"-ms-transition":t,transition:t}))}return c})}if(t.change_cursor_style_if_clickable&&e.run_mode()){if(e.element.get_related_workflows("ButtonClicked").length){e.on_message("add_tab_index",function(t){return e.get_canvas().attr("tabindex",t)});e.get_canvas().addClass(i);e.on_property_change("button_disabled",function(t){if(t){return e.get_canvas()[0].style["cursor"]="default"}else{return e.get_canvas()[0].style["cursor"]="pointer"}})}}if(e.run_mode()&&e.element.get_related_workflows("ButtonClicked").length){e.get_canvas().focus(function(){e.get_canvas().addClass("show-outline")});e.get_canvas().blur(function(){e.get_canvas().removeClass("show-outline")});if(!t.specific_click_handler){e.get_canvas().click(function(t){var n,r;n=s().workflow["debugger"];if(n!=null){r=n.element_clicked(e,e.get_partial())}if(!r){return Ce(e,"ButtonClicked",t)}})}}if(t.add_an_invisible_div_on_the_top&&!e.run_mode()){E.do_add_an_invisible_div_on_the_top(e)}if(e.run_mode()&&!t.dont_add_hover_pressed){if(!Ue.is_on_mobile_or_tablet()){e.canvas.mouseenter(function(){e.state("is_hovered",true)});e.canvas.mouseleave(function(){e.state("is_hovered",false)});e.canvas.mousedown(function(){e.state("is_pressed",true);
$(document).one("mouseup",function(){e.state("is_pressed",false)})})}else{e.canvas.on("touchstart",function(){e.state("is_pressed",true);$(document).one("touchend",function(){var t;t=setTimeout(function(){return e.state("is_pressed",false)},100);$(document).one("scroll",function(){e.state("is_pressed",false);return clearTimeout(t)})})})}}if(t.is_container&&e.run_mode()){l=function(){var n;if(!e.state("datasource_changed_by_workflow_action")){if(t.default_group_data){n=t.default_group_data()}else{n=function(){var t;return(t=e.evaluate_property("data_source"))!=null?t:null}}return e.state("group_data",n)}};e.on_message("reset_group",function(){e.state("datasource_changed_by_workflow_action",false);l();return E.reset_inputs_and_groups(e)});e.on_message("set_group_data",function(t){if(t==null){t=null}e.state("datasource_changed_by_workflow_action",true);e.state("group_data",t);return r()});e.autorun(l);u=null;r=function(){var t;t=e.state("group_data");if(t&&(typeof t._id==="function"?t._id():void 0)!==u){u=typeof t._id==="function"?t._id():void 0;return E.reset_inputs_and_groups(e)}};e.autorun(r)}if(t.is_input){d=false;a=function(){if(d){s().show_error_to_user({instance:e,prop_name:"content",error:{message:"Circular reference evaluating the input's initial content"},type:"element"});return null}if(!t.get_starting_content){return null}try{d=true;return t.get_starting_content(e)}finally{d=false}};c=function(){if(!e.state("has_been_changed")){return e.state("value",a)}};e.autorun(c);if(e.run_mode()){if(vt.call(b,"is_invalid")>=0){e.state("is_invalid",function(){return!t.content_validated(e.state("value"),e)})}e.state("value_that_is_valid",function(){if(vt.call(b,"is_invalid")>=0&&e.state("is_invalid")){return I.NOT_VALID}else{return e.state("value")}});if(vt.call(b,"display_invalid")>=0){e.state("display_invalid",function(){return e.state("is_invalid")&&(e.state("has_been_changed")||e.state("force_display_validity"))})}e.on_message("display_validity",function(){return e.state("force_display_validity",true)});o=function(t){if(Ue.compare(t,e.state("value",void 0,true))){return false}if(t===void 0){t=null}e.state("value",t);e.state("has_been_changed",true);return true};f=false;e.on_message("user_change",function(e){if(!o(e)){return}return f=true});e.on_message("user_submit",function(t){if(!o(t)){if(!f){return}}f=false;Te(e,t);Ce(e,"InputChanged");return s().element.emit("user_changed_input",{instance:e,val:t})});return e.on_message("reset_input",function(){e.state("force_display_validity",false);if(e.state("has_been_changed")){e.state("has_been_changed",false);return c()}})}}};u=(R=t.get_states)!=null?R:function(){return[]};t.get_states=function(e){return b.concat(u(e))};o=(z=t.get_messages)!=null?z:function(){return[]};t.get_messages=function(e){return _.concat(o(e))};a=(B=t.get_private_messages)!=null?B:function(){return[]};t.get_private_messages=function(e){return m.concat(a(e))};return t};E.input_change_autorun=ae=function(e,t){return e.autorun(function(){if(!e.state("has_been_changed")){return t(e.state("value"))}})};E.register_focus=we=function(e,t){t.focus(function(){return e.state("is_focused",true)});return t.blur(function(){return e.state("is_focused",false)})};E.find_inputs_to_check=function(e,t,n,r){var i,o,a,u,l,c,f,d,_,p,h,g,m,y,b,w,x,k,S,A,E,M,T,C,j;p=[];c=[];for(h=0,b=t.length;h<b;h++){o=t[h];if(!r&&!s().workflow.should_workflow_run(n,o)){continue}p.push(o);d=function(e){var t;if(((t=e.next())!=null?typeof t.name==="function"?t.name():void 0:void 0)==="isnt_valid"){return true}else{return false}};_=[];E=o.find_expressions("GetElement");for(g=0,w=E.length;g<w;g++){a=E[g];if(!d(a)){_.push(a.element_id())}}M=o.find_expressions("ThisElement");for(m=0,x=M.length;m<x;m++){a=M[m];if(!d(a)){_.push(e.element_id())}}u=function(e,t){var n,r,i,o,s,l,c,f,p,h;n=v.event(e.get_static_property("custom_event"));if(t==null){t={}}if(t[n.id()]){return}t[n.id()]=true;if(!n){return}c=n.find_expressions("GetElement");for(i=0,o=c.length;i<o;i++){a=c[i];if(!d(a)){_.push(a.element_id())}}p=(f=n.actions("TriggerCustomEvent").concat(n.actions("TriggerCustomEventFromReusable")))!=null?f:[];h=[];for(l=0,s=p.length;l<s;l++){r=p[l];h.push(u(r,Ue.extend({},t)))}return h};C=(T=o.actions("TriggerCustomEvent").concat(o.actions("TriggerCustomEventFromReusable")))!=null?T:[];for(y=0,k=C.length;y<k;y++){i=C[y];u(i)}_=Ue.unique(_);j=_!=null?_:[];for(A=0,S=j.length;A<S;A++){f=j[A];l=e.find_instance_by_id(f);if(l&&l.is_visible()){c.push(l)}}}return{input_instances:c,to_run:p}};G=function(e,t,n){var r,i,o,a,s,u,l,c,f,d;o={top:0,left:0,instance:null};s=false;c=E.find_inputs_to_check(e,t,n),i=c.input_instances,a=c.to_run;for(u=0,l=i.length;u<l;u++){r=i[u];if(vt.call(r.get_messages(),"display_validity")>=0){r.message("display_validity");if(r.state("display_invalid")||((f=n.frozen_state.element_state[P.dehydrate_tree(r)])!=null?(d=f["value_that_is_valid"])!=null?d.not_valid:void 0:void 0)){s=true;if(o.top>r.element.get_top()||!o.instance){if(o.left>=r.element.get_left()||!o.instance){o.top=r.element.get_top();o.left=r.element.get_left();o.instance=r}}}}}return{validation_fail:s,min_top:o,to_run:a}};ee=function(e){var t,n,r,i,o,a;if(typeof e.parent==="function"?(i=e.parent())!=null?i.get_static_property("group_type"):void 0:void 0){n=e.parent().get_static_property("group_type");t=e.parent().state("group_data")}else if((typeof e.parent==="function"?(o=e.parent())!=null?o.element.type():void 0:void 0)==="GroupItem"){n=e.parent().parent().get_static_property("group_type");t=e.parent().state("group_data")}else if(typeof(r=e.element).root==="function"?(a=r.root())!=null?a.get_static_property("page_item_type"):void 0:void 0){n=e.element.root().get_static_property("page_item_type");t=s().pageparam.get()}return{type:n,thing:t}};te=E.get_input_parent_thing_field=function(e){var t,n,r,i;i=ee(e),r=i.type,n=i.thing;if(r==null||!(n!=null?typeof n.exists==="function"?n.exists():void 0:void 0)){return null}t=e.get_static_property("bind_field");if(!t){return null}return Ge.get(r).get_message(t).fn(n)};B=E.do_auto_binding=function(e,t,n,r,i,o){var a,u,l;if(o==null){o={0:{key:r,value:P.dehydrate_tree(i)}}}A.update_thing(t,o);a={appname:v.appname(),app_version:v.app_version(),temp_db:s().db_instance().cur_temp_db(),data:{type:n,items:[{id:t._id(),changes:o}]}};u=s().location.post("server://elasticsearch/modify",a);l=Be.show_progress_line(u);s().workflow.all_server_completed.add_promise(u);return u.callback(function(n,r){s().db_instance().ensure_object_updates(r);e.state("currently_binding",false);l();if(n){s().db_instance().flush(t._id());T.handle_uncaught_error(n,function(e){if(e){return window.alert(Ue.human_friendly(e))}})}if(e.supports_message("reset_input")){e.message("reset_input")}if(!n){if(e.get_static_property("show_alert_on_sucess")){return Ue.run_once(30,function(){var t,n,r;t=e.find_instance_by_id(e.get_static_property("alert_element"));r=e.evaluate_property("alert_message");n=t!=null?t.evaluate_property("text"):void 0;return{alert_element:t,element_text:r,alert_text:n}},function(e,t){var n,r,i,o;if(e){Ue.warn(e);return}n=t.alert_element,i=t.element_text,r=t.alert_text;if(n!=null){o={fade_in:500,hold:500,fade_out:500};if(i!==null&&i!==void 0&&i!==""){o.message=i}else{o.message=r}return n.message("show_alert",o)}})}}})};Te=E.run_auto_binding=function(e,t,n){var r;if(!e.get_static_property("auto_binding")){return}r=e.get_static_property("bind_field");return Ue.run_once(30,function(){var i,o,a,s;a=ee(e);s=a.type,o=a.thing;if(o!=null){i=o.child(r).get()}return{current_val:i,is_invalid:!n?e.state("is_invalid"):void 0,thing_type:a,val:typeof t==="function"?t():t}},function(t,i){var o,a,s,u,l,c,f,d;if(t){Ue.warn(t);return}if(!n){if(i.is_invalid){return}e.state("currently_binding",true)}f=i.thing_type,l=f.type,u=f.thing;if(u==null){return}c=i.val;a=Ge.get(l).custom_type();s=a.field(r).value();if(Ge.get(s).equals(i.current_val,c)){return}if(!l||u==null||!r){return}if(!n){if(e.element.E.field_names.content_format){o=e.get_static_property("content_format");if((d=E.type_content_format_mapping[s][0]!=="_all"&&vt.call(E.type_content_format_mapping[s],o)<0)!=null?d:[]){return}}}return B(e,u,l,r,c)})};Ce=E.run_element_workflow=function(e,t,n,r,o,a){var u,l,c,f;if(!a){if(n&&Ue.did_event_pass_through(n,"."+i)){return}if(e.state("force_pressed")){return}}l=r!=null?r:e.element.get_related_workflows(t);if(!(l!=null?l.length:void 0)){return}u=Ue.Promise(null,"button press evaluation");if(!a){e.state("force_pressed",true)}f=Be.show_progress_line(u);c=function(t){return function(n){var r,i,a,u,l=this;if(!n){t();return}i=e.element.get_related_workflows("OnError");if(i.length===0){t(n);return}a=T.build_wf_error_object(n);r={element:e,datasources:I.get_basic_datasources(e.element.root())};r.datasources.current_workflow_item_value=function(){return"sys.error"};r.datasources.current_workflow_item=function(){return new P.StaticObject(a)};if(o!=null){Ue.extend(r.datasources,o)}u=new I.FrozenState(r);return u.freeze_workflows(i,function(e){var o;if(e){t(e);return}o=s().workflow.run_workflows(r,i,true);return o.callback(function(e,r){if(e){t(e);return}if(r.length===0){t(n);return}return t()})})}};u.callback(c(function(t){return T.handle_uncaught_error(t,function(t){if(t){window.alert(Ue.human_friendly(t))}if(!a){e.state("force_pressed",false)}return f()})}));Ue.run_once(5,function(){if(a){return false}return e.evaluate_property("button_disabled")},function(t,n){var r,i,c=this;if(t){u.reject(t);return}if(n){u.resolve();return}if(!a){e.get_canvas().removeClass("show-outline")}r={element:e,inputs_must_be_valid:true,datasources:I.get_basic_datasources(e.element.root())};if(o!=null){Ue.extend(r.datasources,o)}i=new I.FrozenState(r);i.freeze_workflows(l,function(t){if(t){u.reject(t);return}return Ue.run_once(30,function(){return G(e,l,r)},function(e,t){var n,i,o,a,c;if(e){u.reject(e);return}o=t.validation_fail,n=t.min_top,i=t.to_run;if(!o){return u.resolve(s().workflow.run_workflows(r,l,true))}else{u.resolve(true);if(!Ue.isScrolledIntoView((a=n.instance)!=null?a.get_canvas():void 0).status){return Ue.velocity((c=n.instance)!=null?c.get_canvas():void 0,"scroll",{duration:200,offset:-100,complete_cb:function(){return n.instance.message("set_focus")}})}else{return n.instance.message("set_focus")}}})})});return u};g=function(e,t){var n;if(!e.thumbnail_mode()){n=e.get_canvas();setTimeout(function(){var r=this;return n.dotdotdot({wrap:t,callback:function(t,r){return Ue.run_once(30,function(){var t;return e.edit_mode()&&r.length!==0&&((t=e.canvas)!=null?typeof t.text==="function"?t.text():void 0:void 0)&&e.canvas.text().trim()===""&&e.evaluate_property("text")!==""},function(t,r){var i;if(t){Ue.warn(t);return}if(r){i=Ue.div("dots-placeholder",n);h(i,{"line-height":0,"font-size":"20px","text-align":e.get_static_property("font_alignment",true)});return i.text("............")}})}})},1);return e.autorun(function(){var t,r,i,o;o=["width","height","font_size","padding_vertical","line_height","word_spacing","letter_spacing"];for(r=0,i=o.length;r<i;r++){t=o[r];e.evaluate_property(t)}e.element.get_style_id();return typeof n.trigger==="function"?n.trigger("update.dot"):void 0})}};de("Text",{category:"visual elements",defaults:{width:200,height:45},field_names:Ue.extend({text:{"default":"...edit me..."},stretch_to_fit:{"default":false,no_states:true},cut_off_content:{no_states:true},shrink_if_less_high:{no_states:true},tag_type:{no_states:true,"default":"normal",in_style:true,if_no_style_use_element:true}},Re),property_applications:[new ve.Dimensions,new ve.Font,new ve.FontShadow,new ve.FontSpacing,new ve.PaddingText,new ve.Border,new ve.BoxShadow,new ve.Background,new ve.MinWidth,new ve.Rotation,new ve.ToolTip],change_cursor_style_if_clickable:true,get_html:function(e){var t;if(!e.run_mode()||e.get_static_property("tag_type")==="normal"||!v.get_public_setting("expose_text_tags")){return"<div></div>"}else{t=e.get_static_property("tag_type");return"<"+t+"></"+t+">"}},notify_width:function(e,t){return e.state("notify_width",t)},get_min_width:function(e){return 0},initialize:function(e){var t,n=this;t=e.get_canvas();return e.wait_for_visible_lite(function(){var n,r,i,o,a,s,u;if(e.edit_mode()||e.responsive_mode()){a="letter";if(e.responsive_mode()){t[0].style.overflow="hidden"}}else{a="words";t[0].style.overflow="visible"}o=e.get_static_property("stretch_to_fit");n=e.get_static_property("cut_off_content");i=e.get_static_property("shrink_if_less_high");r=null;e.autorun(function(){var a,s,u,l,c,f,d,_,p,h;u={};f=["text","font_size","padding_vertical","line_height","rotation_angle"];for(l=0,c=f.length;l<c;l++){s=f[l];u[s]=e.evaluate_property(s)}e.state("notify_width");if(e.run_mode()||e.responsive_mode()){if((d=e.element.root())!=null?d.use_responsive_algorithm():void 0){t[0].style["padding-bottom"]=((_=u.padding_vertical)!=null?_:0)+"px"}if(((p=e.element.root())!=null?p.use_responsive_algorithm():void 0)&&!n||!((h=e.element.root())!=null?h.use_responsive_algorithm():void 0)&&o){r=u.text;if(e.is_visible()){a=function(){var n,o,a,s,l;if(!e.is_visible(true)){return}o=t.find(".content");if(o.length===0){o=Ue.div("content",t)}if((r!=null?r.indexOf(" "):void 0)===-1){t[0].style["word-break"]="break-word"}o.html(Ue.bbcode_to_html(r));n=t.outerHeight()-t.height();if(u.rotation_angle!=null&&((l=u.rotation_angle)!==0&&l!==180)){return}a=parseInt(o.css("height").replace("px",""));s=e.element.get_height();if(i){return e.set_height(a+n)}else{return e.set_height(Math.max(s,a+n))}};setTimeout(a,1);return setTimeout(a,500)}}else{if(e.is_visible()){t.html(Ue.bbcode_to_html(u.text));return typeof t.trigger==="function"?t.trigger("update.dot"):void 0}}}else{t.html(Ue.bbcode_to_html(u.text));if(typeof t.trigger==="function"){t.trigger("update.dot")}return E.do_add_an_invisible_div_on_the_top(e)}});if(e.edit_mode()||((s=e.element.root())!=null?s.use_responsive_algorithm():void 0)&&n||!((u=e.element.root())!=null?u.use_responsive_algorithm():void 0)&&!o){return g(e,a)}})},is_input:false,is_container:false,add_an_invisible_div_on_the_top:false,events:["ButtonClicked"]});de("Button",{category:"visual elements",defaults:{font_alignment:"center",font_color:"#FFFFFF",background_style:"bgcolor",bgcolor:"#7F95EB",border_style:"none",border_roundness:3,border_width:1,border_color:"#7F95EB",boxshadow_style:"none",border_style_top:"none",border_roundness_top:3,border_width_top:1,border_color_top:"#7F95EB",border_style_left:"none",border_roundness_left:3,border_width_left:1,border_color_left:"#7F95EB",border_style_bottom:"none",border_roundness_bottom:3,border_width_bottom:1,border_color_bottom:"#7F95EB",border_style_right:"none",border_roundness_right:3,border_width_right:1,border_color_right:"#7F95EB",width:150,height:45,use_max_width:true,max_width:100,min_width:50},default_states:[{condition:{type:"ThisElement",next:{type:"Message",name:"is_hovered"}},properties:{bgcolor:"#9DA9E8",border_color:"#9DA9E8"}},{condition:{type:"ThisElement",next:{type:"Message",name:"is_pressed"}},properties:{bgcolor:"#6C7FEB",border_color:"#6C7FEB"}}],field_names:Ue.extend({text:{"default":"...edit me..."}},Re),property_applications:[new ve.Dimensions,new ve.Font,new ve.FontShadow,new ve.FontSpacing,new ve.Border,new ve.BoxShadow,new ve.Background,new ve.MinWidth,new ve.Rotation,new ve.ToolTip],get_html:function(e){return"<button></button>"},get_min_width:function(e){return 0},change_cursor_style_if_clickable:true,initialize:function(e){var t,n=this;t=e.get_canvas();h(t,{padding:"0px",cursor:"inherit",background:"none",border:"none","text-align":"left"});return e.wait_for_visible_lite(function(){return e.on_property_change(["text","background_style"],function(e){var n,r;r=e.text,n=e.background_style;t.text(r);if(n==="none"){return(new ve.NoSelect)._apply(true,t)}})})},is_input:false,is_container:false,add_an_invisible_div_on_the_top:false,events:["ButtonClicked"]});E.calculate_font_size_for_fontawesome=function(e){return e.autorun(function(){var t,n,r,i;n=e.evaluate_property("height");r=(i=e.state("notify_width"))!=null?i:e.evaluate_property("width");t=function(){var t,i;i=Math.min(n,r);t=Math.max(ve.calculate_border_height(e),ve.calculate_border_width(e));if(t!==0){i-=t+5}return i};return e.get_canvas()[0].style["font-size"]=t()+"px"})};de("Icon",{category:"visual elements",defaults:{font_alignment:"center",color:"#6676F2",background_style:"none",border_style:"none",border_roundness:4,border_width:2,border_color:"#6B6B6B",boxshadow_style:"none",width:80,height:80},default_states:[],field_names:Ue.extend({icon:{"default":"fa fa-flag-checkered"},icon_color:{"default":"#6676F2",in_style:true},spin_icon:{}},Re),property_applications:[new ve.Dimensions,new ve.FontShadow,new ve.Border,new ve.BoxShadow,new ve.Background,new ve.MinWidth,new ve.ToolTip],get_html:function(e){return"<button></button>"},notify_width:function(e,t){return e.state("notify_width",t)},get_min_width:function(e){return 0},change_cursor_style_if_clickable:true,initialize:function(e){var t,n=this;t=e.get_canvas();h(t,{padding:"0px","text-align":"center",cursor:"inherit",background:"none",border:"none"});return e.wait_for_visible_lite(function(){e.on_property_change("icon",function(e){var n;if(t.hasClass(i)){n=true}t.attr("class","");t.addClass(e+" inner-element bubble-element");if(n){return t.addClass(i)}});e.on_property_change("icon_color",function(e){return t[0].style["color"]=e});e.on_property_change("spin_icon",function(e){if(!e){e=false}return t.toggleClass("fa-spin",e)});return E.calculate_font_size_for_fontawesome(e)})},transition_properties:{icon_color:"color"},is_input:false,is_container:false,events:["ButtonClicked"],add_an_invisible_div_on_the_top:false,css_files:["css/optional/font-awesome.min.css"]});E.href_attributes=["mailto","tel","sms","skype"];E.forbidden_url_keys=["id","debug_mode","resume"];E.check_parameters=function(e,t){var n,r,i,o,a;if(e.get_static_property("add_parameters")){i=e.get_static_property("url_parameters");a=[];for(r in i){n=i[r];if(o=n[Ie.shrink("key")],vt.call(E.forbidden_url_keys,o)>=0){a.push(t(e.display()+": The parameter "+n[Ie.shrink("key")]+" cannot be used."))}else{a.push(void 0)}}return a}};de("Link",{category:"visual elements",defaults:{font_alignment:"left",font_color:"#4083a9",width:150,height:20,min_width:80,use_max_width:true,max_width:120},compute_initial_properties:function(e){return e.properties.no_html=true},default_states:[{condition:{type:"ThisElement",next:{type:"Message",name:"is_hovered"}},properties:{font_color:"#205f82"}},{condition:{type:"ThisElement",next:{type:"Message",name:"is_pressed"}},properties:{font_color:"#134B70"}}],field_names:{text:{"default":"...edit me..."},show_icon:{no_states:true,in_style:true},icon:{"default":"fa fa-facebook-official"},linktype:{"default":"pagelink",no_states:true},page:{"default":"index",no_states:true},data_to_send:{no_states:true},url:{},open_in_new_tab:{"default":false},add_parameters:{no_states:true},url_parameters:{optional:true,no_states:true},wrap_when_squizzed:{no_states:true,"default":true},no_html:{no_states:true}},property_applications:[new ve.Dimensions,new ve.Font,new ve.FontShadow,new ve.FontSpacing,new ve.PaddingText,new ve.Border,new ve.BoxShadow,new ve.Background,new ve.MinWidth,new ve.ToolTip],change_cursor_style_if_clickable:false,get_min_width:function(e){return 0},get_html:function(e){if(e.run_mode()){return"<a></a>"}else{return"<div></div>"}},initialize:function(e){var t,n=this;t=e.get_canvas();return e.wait_for_visible_lite(function(){var n;t.addClass(i);h(t,{"white-space":"pre-wrap","text-decoration":"none"});n=false;e.autorun(function(){var r,i,o,a,s,u,l,c,f,d,_,p,m;c={};m=["text","font_size","icon","show_icon","background_style","no_html"];for(_=0,p=m.length;_<p;_++){l=m[_];c[l]=e.evaluate_property(l)}d=c.text,i=c.font_size,o=c.icon,f=c.show_icon,r=c.background_style,u=c.no_html;e.state("notify_width");if(r==="image"){t.text("")}else{if(f){n=false;if(typeof t.trigger==="function"){t.trigger("destroy")}t.empty();a=Ue.div(o+" inner-element icon-in-link");h(a,{"font-family":"FontAwesome","padding-left":"3px"});t.append(a)}else{s=function(e){if(u){return e.html(Ue.bbcode_to_html(d).trim())}else{return e.html(d)}};if(e.get_static_property("wrap_when_squizzed")&&(e.run_mode()||e.responsive_mode())){e.wait_for_visible_lite(function(){return setTimeout(function(){var n,r,i,o;r=t.find(".content");if(r.length===0){r=Ue.div("content",t)}s(r);n=t.outerHeight()-t.height();i=parseInt(r.css("height").replace("px",""));o=e.element.get_height();return e.set_height(Math.max(o,i+n))},1)})}else{s(t);if(e.run_mode()&&!n){n=true;g(e,"letter")}}if(!e.run_mode()){E.do_add_an_invisible_div_on_the_top(e)}}}if(r==="none"){return(new ve.NoSelect)._apply(true,t)}});if(e.run_mode()){e.on_property_change("open_in_new_tab",function(e){if(e){return t[0].target="_blank"}else{return t[0].target="_self"}});return e.autorun(function(){var n,r,i,o,a,u,l,c,f,d,p;o=e.evaluate_property("linktype");r=function(e){var t,n;t=_.page_id_to_name(e);if(t==null){t=(n=v.get_page_by_name(e))!=null?n.name():void 0}return t};if(o==="pagelink"){a=e.evaluate_property("page");l=(d=r(a))!=null?d:"";n=e.evaluate_property("data_to_send");f={};if(n){u=v.get_page_by_name(l);if(u!=null){n=A.get_data_to_send(n,u.get_static_property("readable_field"));if(n){l+="/"+n}}}if(Ue.is_debug_mode()){f.debug_mode=true}if(e.evaluate_property("add_parameters")){c=e.element.property("url_parameters");le.with_eval_node(c,function(){var t,n,r,i,o,a;n=le.evaluate_properties(c.json._raw(),e.prop_eval_context(),le.DETECT_FIELD_NAMES,[],c.json._path());a=[];for(i in n){o=n[i],t=o.key,r=o.value;if(vt.call(E.forbidden_url_keys,t)<0){a.push(f[t]=r)}}return a})}if(l==="index"){l=""}i=s().location.get_server_base()+l;if(!Ue.is_empty(f)){i+="?"+ye.stringify(f)}}else{i=e.evaluate_property("url");if((i!=null?i.indexOf("//"):void 0)===-1&&(p=i.split(":")[0],vt.call(E.href_attributes,p)<0)&&i[0]!=="#"){i="//"+i}}t[0].href=i;if(Ue.on_phonegap()){t.on("touchend",function(){return window.open(i,"_blank","location=yes,enableViewportScale=yes")});return t.on("click",function(e){e.preventDefault();return false})}})}})},notify_width:function(e,t){return e.state("notify_width",t)},check_for_errors:function(e,t,n){var r;if(!n&&e.get_static_property("linktype")==="pagelink"){t(void 0,e,e.id());return true}if((r=e.root())!=null?r.get_static_property("native_app"):void 0){if(e.get_static_property("linktype")==="pagelink"){t(e.display()+": Links to another page should not be used in a native app page")}}return E.check_parameters(e,t)},is_input:false,is_container:false,add_an_invisible_div_on_the_top:false,css_files:["css/optional/font-awesome.min.css"]});qe="//"+k.cdn_host+"/static/img/transparent.png";ke=function(e){return h(e,{margin:"0px",width:"100%",height:"100%"})};E.rescale_image=function(e,t,n,r,i){var o=this;return Fe.get_image_real_dimensions(e,function(e){var o,a;ke(t);if(e.height/e.width>n/r){a=e.width/e.height*n;h(t,{"margin-left":(r-a)/2+"px",width:a+"px"})}else{o=e.height/e.width*r;h(t,{"margin-top":(n-o)/2+"px",height:o+"px"})}return typeof i==="function"?i(t):void 0})};se=function(e,t,n){var r;if(n||e.get_static_property("keep_proportion_resize")){r=t/e.element.get_width()*e.element.get_height();e.set_height(r)}else{r=e.element.get_height()}return r};(function(){var e,t;t=function(e){var t;t=e.property("src");if(!t.is_empty()&&t.is_static()&&e.get_static_property("src",true)!==""){return true}};e=function(e){var t;t=e.property("src");return t.is_empty()||t.is_static()&&(typeof t.get_static==="function"?t.get_static():void 0)===""};return de("Image",{category:"visual elements",defaults:{width:320,height:240},collapse_margin:500,keep_proportion_resize:true,field_names:Ue.extend({src:{},stretch_or_rescale:{"default":"rescale",no_states:true},crop_data:{no_states:true},keep_proportion_resize:{no_states:true},alt_tag:{}},Re),property_applications:[new ve.Dimensions,new ve.Border,new ve.BoxShadow,new ve.MinWidth,new ve.Rotation,new ve.ToolTip],get_html:function(){return"<div></div>"},initialize:function(e){var n,r=this;n=e.get_canvas();return e.wait_for_visible_lite(function(){var r,i,o,a,s;i=Ue.img(void 0,n);i[0].style.display="block";if(!e.run_mode()){r=Ue.div("display_text",n);i[0].style.float="left"}a=null;s=null;o=null;if(e.run_mode()){e.on_property_change("alt_tag",function(e){return i[0].alt=e!=null?e:""})}e.autorun(function(){var n,u,l,c,f,d,_,p,g,m,y=this;d={};g=["src","stretch_or_rescale","width","height","crop_data"];for(_=0,p=g.length;_<p;_++){f=g[_];d[f]=e.evaluate_property(f)}l=t(e.element);if(!e.run_mode()){if(!l){r.html((m=d.src)!=null?m:"");h(r,{display:"block",overflow:"hidden",width:"100%",color:"grey"});i[0].style.display="none";return}else{r[0].style.display="none";i[0].style.display="block"}}if(d.src&&!Ue.is_empty(d.src)){if(!i[0].src){i[0].src=qe;ke(i)}n=function(e,t,n,r){var u,l,c;l=function(){var a,s;s=o=ve.optimize_image(e,t,n,r);if(ve.downloaded_images[s]){return i[0].src=s}else{a=Ue.img(void 0,void 0,s);return a.on("load",function(){ve.downloaded_images[s]=true;if(s===o){return i[0].src=s}})}};s=ve.optimize_image(e,t,n,r);if(e===a&&!ve.downloaded_images[s]){u=(c=v.appname())==="test_app"?1:300;return setTimeout(function(){if(s===ve.optimize_image(e,t,n,r)){return l()}},u)}else{a=e;return l()}};if(!l&&d.stretch_or_rescale==="rescale"){E.rescale_image(d.src,i,d.height,d.width,function(){return n(d.src,d.width,d.height)})}else if(!l&&d.stretch_or_rescale==="adjust_height"){Fe.get_image_real_dimensions(d.src,function(t){var r;ke(i);r=t.height/t.width*d.width;n(d.src,d.width,r);return e.set_height(r)})}else{if(l&&e.element.root().use_responsive_algorithm()&&!e.get_static_property("keep_proportion_resize")){u={fit:"crop"}}ke(i);n(d.src,d.width,d.height,u)}c=function(e){return Math.floor(e*100)+"%"};if(l&&d.crop_data){return h(i,{width:c(d.crop_data.width_factor),height:c(d.crop_data.height_factor),"margin-left":c(d.crop_data.left_offset),"margin-top":d.crop_data.top_offset*d.height+"px"})}}else{i[0].src=qe;return ke(i)}});return e.autorun(function(){var t,n,r,o,a;if(e.evaluate_property("four_border_style")){o=["top","right","bottom","left"];a=[];for(n=0,r=o.length;n<r;n++){t=o[n];a.push(i[0].style["border-radius-"+t]=e.evaluate_property("border_roundness_"+t)+"px")}return a}else{return i[0].style["border-radius"]=e.evaluate_property("border_roundness")+"px"}})})},notify_width:function(e,t){return se(e,t)},get_min_width:function(e){return 0},change_cursor_style_if_clickable:true,add_an_invisible_div_on_the_top:false,is_input:false,is_container:false,events:["ButtonClicked"]})})();de("Shape",{category:"visual elements",defaults:{bgcolor:"#DEDEDE",background_style:"bgcolor",width:150,height:150},field_names:Ue.extend({keep_proportion_resize:{no_states:true}},Re),property_applications:[new ve.Dimensions,new ve.Background,new ve.Border,new ve.BoxShadow,new ve.Rotation,new ve.MinWidth],change_cursor_style_if_clickable:true,get_min_width:function(e){return 0},notify_width:function(e,t){return se(e,t)},get_html:function(e){return"<div></div>"},initialize:function(e){},is_input:false,is_container:false,add_an_invisible_div_on_the_top:false,events:["ButtonClicked"]});de("Alert",{category:"visual elements",defaults:{font_color:"#947739",background_style:"bgcolor",bgcolor:"#FFF6B2",border_style:"none",border_width:1,border_color:"#FFDFC2",boxshadow_style:"none",padding_vertical:10,padding_horizontal:0,font_alignment:"center",width:200,height:37},field_names:{text:{"default":"...edit me..."},at_to_top:{no_states:true,"default":false}},property_applications:[new ve.Dimensions,new ve.PaddingText,new ve.Border,new ve.BoxShadow,new ve.Font,new ve.FontShadow,new ve.FontSpacing,new ve.Background],get_html:function(e){return"<div></div>"},get_messages:function(e){return["show_alert"]},initialize:function(e){var t;t=e.get_canvas();if(e.edit_mode()){t.empty()}else if(e.run_mode()||e.responsive_mode()){t[0].style.display="none";if(e.responsive_mode()){e._has_been_hidden=true}}e.on_property_change("text",function(e){return t.html(Ue.bbcode_to_html(e))});if(!e.run_mode()){e.on_property_change("at_to_top",function(t){var n;if(t){n=e.element;n.set_property("width",n.root().get_width());n.set_property("top",0);return n.set_property("left",0)}})}if(e.edit_mode()){e.on_property_change(["top","left","width"],function(t){var n,r,i;r=t.top,n=t.left,i=t.width;if(r!==0||n!==0||i!==e.element.root().get_width()){return e.element.set_property("at_to_top",false)}})}return e.on_message("show_alert",function(n){var r=this;t.html(Ue.bbcode_to_html(n.message));h(t,{display:"block",opacity:0});e._is_visible_me=true;e._update_visible();return Ue.velocity(t,"fadeIn",{duration:n.fade_in,complete_cb:function(){return setTimeout(function(){return Ue.velocity(t,"fadeOut",{duration:n.fade_out,complete_cb:function(){t[0].style.display="none";e._is_visible_me=false;return e._update_visible()}})},n.hold)}})})},starts_hidden:true,change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:false,is_input:false,is_container:false,position_canvas:function(e,t){if(t.run_mode()&&t.get_static_property("at_to_top")){$("body").append(e);return h(e,{position:"fixed",top:"0px",left:"0px",width:"100%","min-height":t.element.get_height()+"px","z-index":"20000"})}else{return t.container.add(t)}},added_to_container:function(e){return!e.get_static_property("at_to_top")},update_show:function(e){}});A.AlertShowMessage={field_names:{element_id:{},fade_in:{"default":500},hold:{"default":2e3},fade_out:{"default":500},change_message:{},message:{}},run:function(e,t,n,r){return Ue.run_once(30,function(){var e,r;e=n.element.find_instance_by_id(t.element_id);if(!t.change_message||t.change_message===void 0){r=e!=null?e.evaluate_property("text"):void 0}else{r=void 0}return[r,e]},function(e,n){var i,o;o=n[0],i=n[1];if(e){return r(e)}else{if(o){t.message=o}if(i!=null){i.message("show_alert",t)}return r()}})},data_to_refresh:null};Ve=function(){var e;e=Ue.MakeKey(null,"always turned");e.turn();return function(t){var n;n=Ue.MakeKey(null,"next video");Ue.WaitFor(e,function(){return setTimeout(function(){t();return n.turn()},10)});return e=n}}();de("Video",{category:"visual elements",defaults:{width:320,height:240,collapse_margin:500,use_max_width:true,max_width:100},field_names:{video_source:{"default":"youtube",no_states:true},video_id:{},auth_token:{optional:true,no_states:true},autoplay:{"default":false,no_states:true},loop:{"default":false,no_states:true},control_color_vimeo:{"default":"#00adef",no_states:true,in_style:true}},property_applications:[new ve.Dimensions,new ve.Padding,new ve.Border,new ve.BoxShadow,new ve.MinWidth],get_html:function(e){return"<div></div>"},get_min_width:function(){return 0},notify_width:function(e,t){return se(e,t,true)},add_an_invisible_div_on_the_top:true,change_cursor_style_if_clickable:false,initialize:function(e){var t,n=this;t=e.get_canvas();return e.wait_for_visible_lite(function(){return setTimeout(function(){return e.autorun(function(){var n,r,i,o,a,s,u,l,c,f,d,_,p,h;i={};_=["video_source","video_id","autoplay","control_color_vimeo","width","height","padding_horizontal","padding_vertical","loop","auth_token"];for(f=0,d=_.length;f<d;f++){s=_[f];i[s]=e.evaluate_property(s)}r=i.width-2*i.padding_horizontal-ve.calculate_border_width(e);n=i.height-2*i.padding_vertical-ve.calculate_border_height(e);a='<iframe width="'+r+'" height="'+n+'"';if(i.video_source==="youtube"){if(((p=i.video_id)!=null?p.indexOf:void 0)!=null&&i.video_id.indexOf("watch?v=")!==-1){i.video_id=i.video_id.split("watch?v=")[1]}a+=' src="//www.youtube.com/embed/'+i.video_id+"?rel=0";if(i.autoplay&&e.run_mode()){a+="&autoplay=1"}if(i.loop&&e.run_mode()){a+="&loop=1&playlist="+i.video_id}a+='" frameborder="0" allowfullscreen modestbranding="1" autohide="1"'}if(i.video_source==="vimeo"){if(((h=i.video_id)!=null?h.indexOf:void 0)!=null&&i.video_id.indexOf("https://vimeo.com/")!==-1){i.video_id=i.video_id.split("https://vimeo.com/")[1];
}o=Ue.rgb_to_hex(i.control_color_vimeo).code.slice(1);a+=' src="//player.vimeo.com/video/'+i.video_id+"?title=0&amp;byline=0&amp;portrait=0&amp;color="+o+"&amp";if(i.autoplay&&e.run_mode()){a+=";autoplay=1"}if(i.loop&&e.run_mode()){a+="&loop=1"}a+='" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'}if(i.video_source==="ziggeo"){l=" src=//s3.amazonaws.com/appforest_uf/f1459806227195x906082602217793400/iframe.html";u=je.get_service("ziggeo");c=u!=null?u.get_key(u.key_for_html_header):void 0;a+=l+"?width="+i.width+"&height="+i.height+"&video_token="+i.video_id+"&ziggeo_token="+c+"&autoplay="+i.autoplay+"&auth_token="+i.auth_token;a+=' frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen'}a+="></iframe>";if(e.run_mode()){t.find("iframe").remove();if(i.video_id){return Ve(function(){return t.append(a)})}}else{t.empty();return t.append('<img style="width: '+r+"px; height: "+n+'px;" src="//s3.amazonaws.com/appforest_uf/f1457032051434x355180826736614100/Play_Smbol.png"></img>')}})},20)})},is_input:false,is_container:false});de("HTML",{category:"visual elements",defaults:{border_style:"none",border_color:"#6B6B6B",border_width:0,padding_vertical:2,padding_horizontal:2,width:200,height:100},field_names:{html:{"default":"<i>edit me...</i>"},useiframe:{"default":false},stretch_to_fit:{"default":false,no_states:true},keep_proportion_resize:{no_states:true}},property_applications:[new ve.Dimensions,new ve.Padding,new ve.Border,new ve.BoxShadow,new ve.MinWidth],get_html:function(){return"<div></div>"},get_min_width:function(){return 0},notify_width:function(e,t){return se(e,t)},add_an_invisible_div_on_the_top:true,change_cursor_style_if_clickable:false,initialize:function(e){var t,n,r,i;t=e.get_canvas();r=null;n=null;i=function(){var e;try{return n[0].contentWindow}catch(t){e=t;return false}};return e.autorun(function(){var o,a,u,l,c,f,d,_,p,h,g,m,v,y=this;d={};v=["html","useiframe","width","height"];for(g=0,m=v.length;g<m;g++){f=v[g];d[f]=e.evaluate_property(f)}c=d.html,p=d.useiframe,h=d.width,l=d.height;if(c==null){c=""}if(!e.run_mode()){c=c.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")}if(p){_=function(o){clearTimeout(r);if(!n){n=$('<iframe src="about:blank"></iframe>');t.append(n);if(!e.run_mode()){E.do_add_an_invisible_div_on_the_top(e)}}n[0].style.width=h+"px";n[0].style.height=l+"px";if(i()){n[0].contentWindow.contents=o;return n[0].src='javascript:window["contents"]'}else{return r=setTimeout(function(){return _(o)},100)}};return _(c)}else{try{if(e.run_mode()&&e.get_static_property("stretch_to_fit")){a=t.find(".content");if(a.length===0){a=Ue.div("content",t)}a.html(c);o=function(){var n,r,i;if(!e.is_visible(true)){return}n=t.outerHeight()-t.height();r=parseInt(a.css("height").replace("px",""));if(r===0&&a.find(" > *").length){r=parseInt(a.find(" > *").css("height").replace("px",""))}i=e.element.get_height();return e.set_height(Math.max(i,r+n))};if(e.is_visible()){o();setTimeout(o,10);setTimeout(o,600);return setTimeout(o,2e3)}}else{if(!e.run_mode()){c=c.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,"")}t.html(c);if(!e.run_mode()){return E.do_add_an_invisible_div_on_the_top(e)}}}catch(b){u=b;console.log("Bug in custom html:");console.log(c);console.log("Stacktrace:");console.log(u.stack);return s().show_error_to_user({instance:e,prop_name:"HTML",error:u,type:"element"})}}})},is_input:false,is_container:false});de("PoweredByBubble",{category:"visual elements",display:"Built on Bubble",defaults:{width:79,height:42},field_names:{element_type:{"default":"image_blue",no_states:true},add_border:{in_style:true,no_states:true},text_color:{"default":"#C9C9C9",in_style:true,no_states:true}},property_applications:[new ve.PositionOnly],get_html:function(e){if(e.run_mode()){return"<a></a>"}else{return"<div></div>"}},initialize:function(e){var t,n,r,i;n=e.element;t=e.get_canvas();i=Ue.div("powered-by-bubble",t);if(e.run_mode()){t[0].href="https://bubble.is?utm_source=user_icon";t[0].target="_blank"}r={image_blue:"//dd7tel2830j4w.cloudfront.net/f1443195883859x933629814535379500/Built_on_Bubble_blue.png",image_white:"//dd7tel2830j4w.cloudfront.net/f1443195889972x822161108255386400/Built_on_Bubble_white.png",image_grey:"//dd7tel2830j4w.cloudfront.net/f1443195469317x438595866318792100/Built_on_Bubble_grey.png"};return e.on_property_change(["element_type","add_border","text_color"],function(e){var t,o,a,s,u,l;s=e.element_type,t=e.add_border,l=e.text_color;i.empty();a={"border-radius":"3px",padding:"3px",height:"100%",width:"100%","text-align":"center"};switch(s){case"image_blue":case"image_white":case"image_grey":u=ve.optimize_image(r[s],71,33);i.append($('<img src="'+u+'" style="width: 100%;">'));break;case"text":i.text("Built without code on Bubble");a["font-family"]="Arial";a["font-size"]=10;a["color"]=l}if(t){switch(s){case"image_blue":o="#52ade0";break;case"image_white":o="white";break;case"image_grey":o="#C9C9C9";break;case"text":o=l}a["border"]="1px solid "+o}else{a["border"]="1px solid transparent"}if(s==="image_blue"||s==="image_white"||s==="image_grey"){n.set_property("width",79);n.set_property("height",42)}else{n.set_property("width",143);n.set_property("height",18)}return i.css(a)})},is_input:false,is_container:false,change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:false,not_resizable:function(){return true}});J=E.get_disabled_field_name={disabled:{"default":false}};K=E.get_auto_binding_field_names={auto_binding:{"default":false,no_states:true},information:{no_states:true},bind_field:{no_states:true},show_alert_on_sucess:{no_states:true},alert_element:{no_states:true,optional:true},alert_message:{no_states:true,optional:true}};d=Ue.extend({mandatory:{no_states:true},limit_number_of_characters:{no_states:true,"default":false},character_limit:{no_states:true}},J,K);E.type_content_format_mapping={text:["_all"],number:["int_number","float_number","currency"],geographic_address:["geographic_address"],date:["date","date_2"],file:["text"],image:["text"],number_range:[],dateinterval:[]};Ne=function(e){return e.on_property_change("disabled",function(t){return e.get_canvas()[0].disabled=t})};De=function(e){return e.on_property_change(["limit_number_of_characters","character_limit","content_format"],function(t){var n,r,i;i=t.limit_number_of_characters,n=t.character_limit,r=t.content_format;if(i&&n&&(r===null||r===void 0||r==="text"||r==="numerical_ref")){return e.get_canvas().attr("maxlength",n)}else{return e.get_canvas().attr("maxlength","")}})};y=function(e,t){var n,r,i=this;n=e.get_canvas();if(Ue.on_phonegap()){n.css("-webkit-user-select","text")}n.change(function(){e.message("user_submit",t());return true});we(e,e.canvas);r=null;return n.keyup(function(i){var o,a;if(r){clearTimeout(r)}if(e.get_static_property("content_format")==="geographic_address"){o=3e3}else{a=n.val();if(a===null||a===void 0||a===""||a.length===1){o=0}else{o=1500}}r=setTimeout(function(){return e.message("user_change",t())},o);return true})};V=function(e,t){var n,r,i;r=e.get_static_property("content_format");switch(r){case"int_number":i=parseInt(Ue.parseFloatRegional(t));break;case"float_number":case"percentage":case"currency":i=Ue.parseFloatRegional(t);break;case"geographic_address":i=function(){return Y.get_address_coordinates(t)};break;default:i=t;if(r===null||r===void 0||r==="text"||r==="numerical_ref"){if(e.get_static_property("limit_number_of_characters")){n=e.get_static_property("character_limit");if(n!=null&&i!=null&&i.length>n){i=i.slice(0,n)}}}}if(typeof i==="number"&&isNaN(i)){return null}else{return i}};R={font_size:14,font_color:"#3D3D3D",background_style:"bgcolor",border_style:"solid",border_width:1,border_color:"#BDBDBD",border_roundness:3,border_style_top:"solid",border_width_top:1,border_color_top:"#BDBDBD",border_roundness_top:3,border_style_left:"solid",border_width_left:1,border_color_left:"#BDBDBD",border_roundness_left:3,border_style_bottom:"solid",border_width_bottom:1,border_color_bottom:"#BDBDBD",border_roundness_bottom:3,border_style_right:"solid",border_width_right:1,border_color_right:"#BDBDBD",border_roundness_right:3,padding_horizontal:4,padding_vertical:0};z=E.default_states_for_inputs=[{condition:{type:"ThisElement",next:{type:"Message",name:"is_focused"}},properties:{border_color:"#52A8EC",boxshadow_color:"#52A8EC",boxshadow_style:"outset",boxshadow_horizontal:0,boxshadow_vertical:0,boxshadow_blur:6}},{condition:{type:"ThisElement",next:{type:"Message",name:"isnt_valid"}},properties:{border_color:"#FF0000",boxshadow_color:"#FF0000",boxshadow_style:"outset",boxshadow_horizontal:0,boxshadow_vertical:0,boxshadow_blur:6}}];E.input_masks={us_phone:{add_to_dropdown:true,caption:"US Phone",mask:"(999) 999-9999"},us_ssn:{add_to_dropdown:true,caption:"US SSN",mask:"999-99-9999",restricted:true},percentage:{add_to_dropdown:true,mask:"decimal",suffix:"%",placeholder:""},currency:{add_to_dropdown:true,mask:"currency",digits:2},date:{add_to_dropdown:true,mask:"mm/dd/yyyy",placeholder:"mm/dd/yyyy"},date_2:{add_to_dropdown:true,mask:"dd.mm.yyyy",placeholder:"dd.mm.yyyy"},numerical_ref:{add_to_dropdown:true,placeholder:"",caption:"Text (numbers only)",mask:"9{1,30}"},credit_card_number:{add_to_dropdown:true,restricted:true,placeholder:"",caption:"Credit card number",mask:"9999 9999 9999 [9][9][9][9]"},credit_card_cvc:{add_to_dropdown:true,restricted:true,placeholder:"",caption:"Credit card CVC",mask:"9{3,4}"},credit_card_exp_month:{add_to_dropdown:true,restricted:true,placeholder:"",caption:"Credit card exp month",mask:"9[9]"},credit_card_exp_year:{add_to_dropdown:true,restricted:true,placeholder:"",caption:"Credit card exp year",mask:"9999"},bank_routing_number:{add_to_dropdown:true,restricted:true,placeholder:"",caption:"Routing number",mask:"999999999"},int_number:{caption:"Integer",mask:"numeric",digits:0,radixPoint:"",placeholder:"",autoGroup:true},float_number:{caption:"Decimal",mask:"numeric",placeholder:"",autoGroup:true}};w=function(){var e,t;e=E.input_masks;t=[];for(ue in e){Ke=e[ue];t.push(ue)}return t}();E.input_content_options={text:"Text",email:"Email",password:"Password",int_number:"Integer",float_number:"Decimal",geographic_address:"Address"};_t=E.input_masks;for(ge in _t){_e=_t[ge];if(!_e.restricted){if(_e.add_to_dropdown){E.input_content_options[ge]=(pt=_e.caption)!=null?pt:Ue.toTitleCase(ge)}}}E.is_pw_valid=function(e){var t,n,r,i;if(typeof e!=="string"){return false}if(e.length===0||e.length>1e4){return false}if(!v.get_public_setting("have_pw_policy")){return true}t=v.get_public_setting("pw_length");if(!typeof t==="number"){t=null}n=v.get_public_setting("pw_require_capital_letter");r=v.get_public_setting("pw_require_number");i=v.get_public_setting("pw_require_special_char");if(t&&e.length<t){return false}if(n&&!e.match(/[A-Z]/)){return false}if(r&&!e.match(/\d/)){return false}if(i&&!e.match(/[^a-zA-Z\d\s:]/)){return false}return true};E.is_appname_valid=function(e){return!/[^a-z0-9-]/.test(e)};b=function(e){var t,n,r,i,o,a,s,u,l,c=this;n=e.get_canvas();i=null;l=(u=typeof(o=e.element).get_visible_workflows==="function"?o.get_visible_workflows():void 0)!=null?u:[];for(a=0,s=l.length;a<s;a++){r=l[a];if(r.find_expressions("GetElement.element_id="+e.element_id()).length){t=e.find_instance_by_id(typeof r.element_id==="function"?r.element_id():void 0);if(t!=null?t.is_visible():void 0){if(i==null){i=t}if(t!==i){i=null;break}}}}n.off("keydown.click_the_button");if(i){return n.on("keydown.click_the_button",function(e){var t;if(e.keyCode===13){t=i.get_canvas();if(t.is(":visible")){Ue.trigger_blur(n);return t.click()}}})}};Se=function(e){return h(e,{border:"none","background-color":"transparent"})};de("Input",{category:"input forms",defaults:Ue.extend({},R,{width:250,height:45,use_max_width:true,max_width:150}),default_states:z,field_names:Ue.extend({placeholder:{"default":"Type here..."},content:{},content_format:{"default":"text",no_states:true},currency_symbol:{"default":"$"},show_thousands:{no_states:true},always_show_decimals:{no_states:true},have_a_numerical_range:{no_states:true},min_range_value:{},max_range_value:{},check_password_policy:{no_states:true}},d),property_applications:[new ve.Dimensions,new ve.Background,new ve.Border,new ve.BoxShadow,new ve.Font,new ve.FontSpacing(null,["line_height"]),new ve.InputPadding,new ve.PlaceholderColor,new ve.MinWidth],get_html:function(e){var t;t=this._format_to_type(e.get_static_property("content_format"));return'<input type="'+t+'"></input>'},_format_to_type:function(e){if(Ue.is_on_mobile_or_tablet()){if(e==="int_number"||e==="us_phone"||e==="numerical_ref"){return"tel"}if(e==="float_number"){return"number"}}switch(e){case"password":return"password";case"email":return"email";default:return"input"}},get_min_width:function(e){return 0},initialize:function(e){var t,n=this;t=e.get_canvas();Se(t);e.on_message("add_tab_index",function(e){return t.attr("tabindex",e)});return e.wait_for_visible_lite(function(){var r,i,o,a;e.autorun(function(){return t.attr("placeholder",e.evaluate_property("placeholder"))});if(e.edit_mode()){e.on_property_change("content_format",function(e){return t.attr("type",n._format_to_type(e))})}De(e);if(!e.run_mode()){t.attr("readonly","true")}ae(e,function(t){var n,r;n=e.get_static_property("content_format");if(n==="geographic_address"){t=Ge.get("geographic_address").cast_to_string(t)}if(n==="date"||n==="date_2"){t=Ge.get("date").cast(t);if(n==="date"){t=Ue.format_date(t,"m/d/yyyy")}else{t=Ue.format_date(t,"dd.mm.yyyy")}}else if(n==="percentage"){r=Ue.parseFloatRegional(t);if(!isNaN(r)){t=t*100;t=parseFloat(t.toPrecision(12))}}else if(n==="currency"||n==="float_number"){if(!Ue.is_on_mobile_or_tablet()){if(t!=null){t=Ue.toLocaleStringRegional(t)}}}return e.get_canvas().val(t!=null?t:"")});if(e.run_mode()){e.on_message("set_focus",function(){return t.focus()});r=e.get_static_property("content_format");o=e.get_static_property("show_thousands");a=function(){if(vt.call(w,r)<0){return false}if(r==="float_number"||r==="int_number"){return o}};i=function(t){var n,i,o,a;if(vt.call(w,r)>=0){if(r==="percentage"){i=e.get_canvas().val();if(i!=null){n=Ue.parseFloatRegional(i.split("%")[0])/100}else{n=null}}else if(r==="date"||r==="date_2"){i=e.get_canvas().val();if(i!==""&&i!==void 0&&i!==null){if(r==="date"){o=i.split("/");n=new Date(o[2],o[0]-1,o[1])}else{o=i.split(".");n=new Date(o[2],o[1]-1,o[0])}}else{n=null}}else{n=t!=null?t:typeof(a=e.get_canvas()).inputmask==="function"?a.inputmask("unmaskedvalue"):void 0}}else{n=e.get_canvas().val()}return V(e,n)};if(!(Ue.is_android()&&a())){y(e,i)}Ne(e);e.autorun(function(){return b(e)});if(r==="int_number"&&!o){return Ue.make_numeric(t,true)}else if(r==="float_number"&&!o){return Ue.make_numeric(t)}else{if(vt.call(w,r)>=0){return Ue.autorun(function(){var n,o,a,s,u,l,c,f=this;u=Ue.detect_decimal_thousand_separators(),o=u.decimalSeparator,a=u.groupSeparator,n=u.decimalDigits;s={placeholder:(l=E.input_masks[r].placeholder)!=null?l:"_",clearMaskOnLostFocus:true,showMaskOnHover:false,radixPoint:(c=E.input_masks[r].radixPoint)!=null?c:o,groupSeparator:a,digits:E.input_masks[r].digits,greedy:false,digitsOptional:E.input_masks[r].digitsOptional,suffix:E.input_masks[r].suffix,autoGroup:E.input_masks[r].autoGroup};if(r==="currency"){s.prefix=e.evaluate_property("currency_symbol");if(e.get_static_property("always_show_decimals")){s.digitsOptional=false;s.placeholder="0"}else{s.digitsOptional=true;s.placeholder=""}}if(Ue.is_android()){return t.change(function(){var n,o,a;n=Ue.extend({alias:E.input_masks[r].mask},s);o=$.Inputmask.format(t.val(),n);t.val(o);a=$.Inputmask.unmask(o,n);return e.message("user_submit",i(a))})}else{t.inputmask(E.input_masks[r].mask,s);if(r==="currency"){return Ue.autorun(function(){return t[0].style["text-align"]=e.evaluate_property("font_alignment")})}}})}}}})},content_validated:function(e,t){var n,r,i,o,a,s;n=t.get_static_property("content_format");o=function(e){var n,r,i,o;if(!t.get_static_property("have_a_numerical_range")){return true}r=(i=t.evaluate_property("min_range_value"))!=null?i:-Infinity;n=(o=t.evaluate_property("max_range_value"))!=null?o:Infinity;if(n<r){return true}return r<=e&&e<=n};if(e===""||e===null||e===void 0||(e!=null?typeof e.trim==="function"?e.trim():void 0:void 0)===""){return!t.get_static_property("mandatory")}switch(n){case"float_number":a=Ue.parseFloatRegional(e);if(!isNaN(a)){return o(a)}else{return false}break;case"int_number":a=Ue.parseFloatRegional(e);a=parseInt(e);if(!isNaN(a)&&((s=String(a))===String(e)||s==="0")){return o(a)}else{return false}break;case"email":return Ue.is_email(e);case"geographic_address":return Y.get_address_coordinates(e)!=null;case"password":if(t.get_static_property("check_password_policy")){return E.is_pw_valid(e)}else{return true}break;case"appname_validate":return E.is_appname_valid(e!=null?e.toLowerCase():void 0);default:if(vt.call(w,n)>=0){if(n==="currency"||n==="percentage"){return o(e)}else if(n==="date"||n==="date_2"){r=Ge.get("date").cast(e);if(!r){return false}else{return true}}else{i=$.Inputmask.format(e,{mask:E.input_masks[n].mask,greedy:false});if(e===""){return!t.get_static_property("mandatory")}return $.Inputmask.isValid(i,{mask:E.input_masks[n].mask})}}else{return true}}},get_starting_content:function(e){var t,n,r,i,o,a,u,l,c,f,d,_,p,h,g,m,v,y;if(e.run_mode()&&e.get_static_property("auto_binding")){h=ee(e),u=h.type,a=h.thing;n=e.get_static_property("bind_field");l=V(e,Ge.get(u).get_message(n).fn(a));if(typeof l==="function"){return l()}else{return l}}else{l=V(e,e.evaluate_property("content"));if(typeof l==="function"){return l()}else{if(e.run_mode()&&!l&&e.get_static_property("content_format")==="email"){o=(g=Ue.local_storage_get(A.get_remember_email_key()))!=null?g.email:void 0;if(o&&!s().current_user().is_logged_in()){v=(m=typeof(c=e.element).get_visible_workflows==="function"?c.get_visible_workflows():void 0)!=null?m:[];for(f=0,_=v.length;f<_;f++){r=v[f];i=false;y=r.actions();for(d=0,p=y.length;d<p;d++){t=y[d];if(t.type()==="LogIn"){i=true;break}}if(i&&t.find_my_expressions("GetElement.element_id="+e.element_id()).length){return o}}}}return l}}},get_state_value:function(e,t){var n;if(t==="value"){n=e.get_static_property("content_format");if(n==="int_number"||n==="float_number"||n==="percentage"||n==="currency"){return"number"}else if(n==="geographic_address"){return"geographic_address"}else if(n==="date"||n==="date_2"){return"date"}else{return"text"}}},change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:false,is_input:true,is_container:false,jquery_plugins:function(){return["jquery_plugins/jquery.inputmask.bundle.min"]}});de("MultiLineInput",{display:"Multiline Input",category:"input forms",defaults:{font_size:14,font_color:"#3D3D3D",background_style:"bgcolor",border_style:"solid",border_width:1,border_color:"#BDBDBD",border_roundness:3,border_style_top:"solid",border_width_top:1,border_color_top:"#BDBDBD",border_roundness_top:3,border_style_left:"solid",border_width_left:1,border_color_left:"#BDBDBD",border_roundness_left:3,border_style_bottom:"solid",border_width_bottom:1,border_color_bottom:"#BDBDBD",border_roundness_bottom:3,border_style_right:"solid",border_width_right:1,border_color_right:"#BDBDBD",border_roundness_right:3,padding_horizontal:4,padding_vertical:4,width:300,height:100},default_states:z,field_names:Ue.extend({placeholder:{"default":"Type here..."},content:{},stretch_to_fit:{"default":false,no_states:true}},d),property_applications:[new ve.Dimensions,new ve.Background,new ve.Border,new ve.BoxShadow,new ve.Font,new ve.FontSpacing,new ve.Padding,new ve.PlaceholderColor,new ve.MinWidth],get_html:function(e){return"<textarea></textarea>"},get_min_width:function(e){return 0},initialize:function(e){var t,n=this;t=e.get_canvas();Se(t);e.on_message("add_tab_index",function(e){return t.attr("tabindex",e)});return e.wait_for_visible_lite(function(){var n;e.autorun(function(){return t.attr("placeholder",e.evaluate_property("placeholder"))});if(!e.run_mode()){t.attr("readonly","true");t[0].style.resize="none"}De(e);n=null;ae(e,function(r){t.val(r!=null?r:"");if(e.run_mode()&&e.get_static_property("stretch_to_fit")){n=t[0].disabled;t[0].disabled=false;return setTimeout(function(){window.optional_modules.autosize.update(t);return t[0].disabled=n},10)}});if(e.run_mode()){e.on_message("set_focus",function(){return t.focus()});y(e,function(){return e.get_canvas().val()});e.on_property_change("disabled",function(t){e.get_canvas()[0].disabled=t;return n=t});if(e.get_static_property("stretch_to_fit")){t[0].style["min-height"]=e.element.get_height()+"px";window.optional_modules.autosize(t);t.on("autosize:resized",function(){var n;n=parseInt(t.css("height").replace("px",""));return e.set_height(n)});return e.on_destroy(function(){return window.optional_modules.autosize.destroy(t)})}}})},content_validated:function(e,t){if(!e&&t.get_static_property("mandatory")){return false}else{return true}},get_starting_content:function(e){if(e.run_mode()&&e.get_static_property("auto_binding")){return te(e)}return e.evaluate_property("content")},get_state_value:function(e,t){if(t==="value"){return"text"}},change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:false,is_input:true,is_container:false,jquery_plugins:function(){return["jquery_plugins/autosize.min"]},only_send_to_client_in_runmode:true});de("Checkbox",{category:"input forms",defaults:{width:180,height:20},default_states:[{condition:{type:"ThisElement",next:{type:"Message",name:"isnt_valid"}},properties:{border_color:"#FF0000",boxshadow_color:"#FF0000",boxshadow_style:"outset",boxshadow_horizontal:0,boxshadow_vertical:0,boxshadow_blur:4}}],field_names:Ue.extend({label:{"default":"...edit me...",optional:true},contents:{"default":"unchecked"},dynamic:{no_states:true},mandatory:{no_states:true}},J,K),property_applications:[new ve.Dimensions,new ve.Font,new ve.FontShadow,new ve.FontSpacing,new ve.BoxShadow("input")],get_html:function(e){return"<div></div>"},initialize:function(e){var t,n,r,o=this;t=e.get_canvas();r=null;n=Ue.MakeKey(null,"checkbox_input_drawn");e.on_message("add_tab_index",function(e){return Ue.WaitFor(n,function(){return r.attr("tabindex",e)})});return e.wait_for_visible_lite(function(){var o,a;t[0].style.overflow="visible";o=Ue.LUID();r=$('<input type="checkbox" id="'+o+'" style="background-color: white;"></input>');a=$('<label for="'+o+'"></label>');t.append(r);t.append(a);n.turn();we(e,r);e.on_message("set_focus",function(){return r.focus()});if(e.run_mode()){t.addClass(i);r.change(function(){var t;e.message("user_submit",(t=r[0].checked)!=null?t:false);return true});e.on_property_change("disabled",function(e){return r[0].disabled=e})}e.on_property_change("label",function(e){return a.text(e)});return ae(e,function(e){var t;if(typeof e==="string"&&((t=e.toLowerCase())==="false"||t==="no"||t==="null"||t==="none"||t==="undefined")){e=false}if(e){return r[0].checked=true}else{return r[0].checked=false}})})},get_starting_content:function(e){var t;if(e.run_mode()&&e.get_static_property("auto_binding")){return te(e)}t=e.evaluate_property("contents");if(t==="checked"){return true}else if(t==="unchecked"){return false}else{return e.evaluate_property("dynamic")}},get_state_value:function(e,t){if(t==="value"){return"sys.bool"}},content_validated:function(e,t){if(!e&&t.get_static_property("mandatory")){return false}else{return true}},change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:true,is_input:true,is_checkbox:true,is_container:false});We=function(e){var t,n,r,i,o;if(typeof e!=="string"){e=""}i=function(){var n,r,i,o;i=e.split("\n");o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push(t.trim())}return o}();for(n=0,r=i.length;n<r;n++){t=i[n];if(t.length>0){if(t!=="0"&&t!=="00"&&t!=="000"&&t!=="0000"){t=t.replace(/^0+/g,"");t=t.replace(/(\.[0-9]*?)0+$/,"$1");t=t.replace(/\.$/,"")}if((o=String(Ue.parseFloatRegional(t)))!==t&&o!=="0"){return"text"}}}return"number"};t="BLANK_1427118194589";f="PLACEHOLDER_1427118222253";u=5e3;ut=function(e){var t,n;if(e.get_static_property("choices_style")==="static"){if(!s().is_edit_mode()){n=e.get_static_property("computed_value");if(n!=null){return n}}t=We(e.get_static_property("choices"));if(s().is_edit_mode()){e.set_property("computed_value",t)}return t}else if(e.get_static_property("dynamic_type")){return e.get_static_property("dynamic_type")}return"text"};E._get_raw_choice_list_dropdown=st=function(e,t){var n,r,i,o,a;a=t._get_raw_value(e.element);if(e.evaluate_property("choices_style")==="static"){r=e.evaluate_property("choices");if(typeof r!=="string"){i=[]}else{i=function(){var e,t,i,o;i=r.split("\n");o=[];for(e=0,t=i.length;e<t;e++){n=i[e];if(n.trim()){o.push(n.trim())}}return o}();if(a==="number"){i=function(){var e,t,r;r=[];for(e=0,t=i.length;e<t;e++){n=i[e];r.push(Ue.parseFloatRegional(n))}return r}()}}return s().db_instance().static_list(a,i)}else{o=e.evaluate_property("data_source");if(typeof(o!=null?o.get_children:void 0)==="function"){if(!o.contains){throw Ue.error("Get children but no contains: "+o.constructor.name+" "+o.constructor)}return o}else{return s().db_instance().static_list(a,[])}}};E._get_display_option=rt=function(e){var t=this;if(e.evaluate_property("choices_style")==="static"){return function(e){return e}}else{return function(n){var r;r={element:e,datasources:{injected_value:function(){return n},injected_value_value:function(){return t.get_injected_value(e.element)}}};return e.element.eval_property("option_display_expression",r)}}};de("Dropdown",{category:"input forms",defaults:{font_size:14,background_style:"bgcolor",bgcolor:"#E6E6E6",border_style:"solid",border_width:1,border_color:"#858585",border_roundness:3,border_style_top:"solid",border_width_top:1,border_color_top:"#858585",border_roundness_top:3,border_style_left:"solid",border_width_left:1,border_color_left:"#858585",border_roundness_left:3,border_style_bottom:"solid",border_width_bottom:1,border_color_bottom:"#858585",border_roundness_bottom:3,border_style_right:"solid",border_width_right:1,border_color_right:"#858585",border_roundness_right:3,width:250,height:45,placeholder:"Choose an option...",use_max_width:true,max_width:150,placeholder_color:"#9C9C9C"},default_states:z,field_names:Ue.extend({placeholder:{},choices_style:{"default":"static",no_states:true},choices:{no_states:true},dynamic_type:{no_states:true},data_source:{},option_display_expression:{no_states:true},"default":{},mandatory:{no_states:true},placeholder_color:{in_style:true},computed_value:{optional:true,no_states:true}},J,K),property_applications:[new ve.Dimensions,new ve.Font,new ve.Background,new ve.Border,new ve.BoxShadow,new ve.MinWidth,new ve.ToolTip],get_html:function(e){return"<select></select>"},get_min_width:function(e){return 0},_get_display_option:rt,initialize:function(e){var n,r,i,o,a,l,c,d,_,p,h,g,m,v,y,b,w=this;i=e.get_canvas();Se(i);o=[];g=null;h={};a=function(e){var t,n,r;t=$('<option class="dropdown-choice"></option>');t.text(e.display);r=e.value;n=P.dehydrate_tree(r);t.attr("value",JSON.stringify(n));h[n]={div:t,display:e.display};if(g!=null){t[0].style.color=g}return t};_=Ue.Box();e.wait_for_visible_lite(function(){return Ue.autorun(function(){g=e.evaluate_property("font_color");if(_()){i[0].style.color=e.evaluate_property("placeholder_color")}else{i[0].style.color=g}return i.find("option").css("color",g)})});if(e.run_mode()){Ne(e);c=function(){var n,r,i;r=w._get_raw_choice_list(e);n=w._get_display_option(e);o=function(){var e,t,o,a;o=r.get_children(0,u);a=[];for(e=0,t=o.length;e<t;e++){i=o[e];a.push({display:n(i),value:i})}return a}();if(!e.evaluate_property("mandatory")){o=[{display:"",value:t}].concat(o)}return o};b=function(n){if(n==null){if(e.get_static_property("mandatory")||!e.state("has_been_changed")){n=f}else{n=t}}return JSON.stringify(P.dehydrate_tree(n))};l=null;m=function(e){l=e;return y(e)};y=function(e){var t,n,r;t=b(e);if(t===JSON.stringify(f)){_(true);if((n=i.find(".dropdown-placeholder")[0])!=null){n.disabled=false}}else{_(false);if((r=i.find(".dropdown-placeholder")[0])!=null){r.disabled=true}}return i.val(t)};n=s().get_text("CORE","LOADING");d=function(){var e;e=i.find(".dropdown-placeholder");if(e.length===0){e=a({display:"",value:f});e.addClass("dropdown-placeholder");e[0].style.display="none";i.prepend(e)}return e};p=e.get_property_watcher("data_source");p.on_not_ready(function(){var e;e=d();e.text(n);return y(f)});v=function(){var t,n,r,i,s,u,_,p,g,v,y;s=d();o=c();u=e.evaluate_property("placeholder");s.text(u);_={};for(p=0,v=o.length;p<v;p++){t=o[p];_[P.dehydrate_tree(t.value)]=true}for(r in h){i=h[r].div;if(r!==f&&!_[r]){i.remove();delete h[r]}}for(g=0,y=o.length;g<y;g++){t=o[g];if(h[P.dehydrate_tree(t.value)]){if(h[P.dehydrate_tree(t.value)].display!==t.display){h[P.dehydrate_tree(t.value)].div.text(t.display);h[P.dehydrate_tree(t.value)].display=t.display}}else{i=a(t);n=o.indexOf(t);if(n>0){h[P.dehydrate_tree(o[n-1].value)].div.after(i)}else{s.after(i)}}}return m(l)};r=Ue.Watcher(function(){var t;if(!e.state("has_been_changed")){return false}t=e.state("value");if(t==null){return false}return!w._choice_list_contains(e,t)});e.on_destroy(function(){return r.destroy()});r.on_value(function(t){if(t){return e.message("reset_input")}});e.on_message("add_tab_index",function(e){return i.attr("tabindex",e)});e.wait_for_visible_lite(function(){var n,r;i.change(function(){var n;n=E.rehydrate_dropdown_value(JSON.parse(i.find("option:selected").attr("value")));if(n===f||n===t){n=null}e.message("user_submit",n);return m(n)});ae(e,function(e){return m(e)});n=Ue.Box(false);i.on("focus",function(){return n(true)});i.on("blur",function(){return n(false)});we(e,i);r=Ue.Box(false);return e.autorun(function(){if(e.is_visible()&&(!r()||!n())){v();return r(true)}})});return e.on_message("set_focus",function(){return i.focus()})}else{return e.wait_for_visible_lite(function(){return Ue.autorun(function(){var t,n,r;n=e.evaluate_property("default");if(e.evaluate_property("choices_style")==="static"&&!w._choice_list_contains(e,n)){n=null}if(n){_(false)}else{n=(r=e.evaluate_property("placeholder"))!=null?r:"Choose an option...";_(true)}i.empty();t=a({display:n});t.attr("value","default_edit_mode");i.append(t);return i.val("default_edit_mode")})})}},_get_raw_value:function(e){return ut(e)},_get_raw_choice_list:function(e){return st(e,this)},_choice_list_contains:function(e,t){var n;n=Ge.get(this._get_raw_value(e.element));return this._get_raw_choice_list(e).contains(t,n)},get_starting_content:function(e){var t;if(e.run_mode()&&e.get_static_property("auto_binding")){t=te(e)}else{t=e.evaluate_property("default")}if(typeof t==="string"&&this._get_raw_value(e.element)==="number"){t=Ue.parseFloatRegional(t)}if(t==null||!this._choice_list_contains(e,t)){return null}return t},get_state_value:function(e,t){if(t==="value"){return this._get_raw_value(e)}},get_injected_value:function(e){return e.get_static_property("dynamic_type")},get_injected_display:function(){return"Current option"},use_injected_datasource:function(e,t){return e.path().indexOf(t.property("option_display_expression").path())===0},content_validated:function(e,t){return e!=null||!t.get_static_property("mandatory")},change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:true,is_input:true,is_container:false});c=50;E.bootstrap_colors=["black","primary","danger","info","warning","success"];de("RadioButtons",{category:"input forms",display:"Radio Buttons",defaults:{width:200,height:75},field_names:Ue.extend({choices_style:{"default":"static",no_states:true},choices:{no_states:true,"default":"Choice 1"},dynamic_type:{no_states:true},data_source:{},option_display_expression:{no_states:true},"default":{},mandatory:{no_states:true},columns:{no_states:true,"default":1},color:{"default":"black",in_style:true},computed_value:{optional:true,no_states:true}},J,K),property_applications:[new ve.Dimensions,new ve.Font,new ve.Background,new ve.MinWidth],get_html:function(e){
return"<div></div>"},get_min_width:function(e){return 0},_get_display_option:rt,initialize:function(e){var t,n,r,o,a,s,u,l,f,d,_=this;s=Ue.LUID();n=e.get_canvas();d=Ue.div("radio",n);if(e.run_mode()){n.addClass(i)}t=Ue.Watcher(function(){var t;if(!e.state("has_been_changed")){return false}t=e.state("value");if(t==null){return false}return!_._choice_list_contains(e,t)});e.on_message("set_focus",function(){return n.find("input:first").focus()});e.on_message("add_tab_index",function(e){return n.find("input:first").attr("tabindex",e)});e.wait_for_visible_lite(function(){if(e.edit_mode()){d[0].style.height="100%"}return e.on_property_change("color",function(e){var t,n,r,i;i=E.bootstrap_colors;for(n=0,r=i.length;n<r;n++){t=i[n];d.removeClass("radio-"+t)}return d.addClass("radio-"+e)})});u={};r=function(e,t){var n,r;r=P.dehydrate_tree(e.value);n=$('<input type="radio" value="'+r+'" name="'+s+'" id="'+s+"_option_"+t+'"><label for="'+s+"_option_"+t+'">'+e.display+"</label>");u[r]=n;return n};a=function(){var t,n,r,i;if(e.edit_mode()&&e.evaluate_property("choices_style")==="dynamic"){r=["Dynamic choice 1","Dynamic choice 2","Dynamic choice 3","Dynamic choice 4"];e.get_canvas().data("Dynamic choice 1");return function(){var e,n,i;i=[];for(e=0,n=r.length;e<n;e++){t=r[e];i.push({display:t,value:t})}return i}()}r=_._get_raw_choice_list(e);n=_._get_display_option(e);return function(){var e,t,o,a;o=r.get_children(0,c);a=[];for(e=0,t=o.length;e<t;e++){i=o[e];a.push({display:n(i),value:i})}return a}()};o=null;l=function(t){var r,i;o=t;u=n.data("options_div_mapping");if(!t){if(e.edit_mode()){for(Ke in u){r=u[Ke];r[0].checked=true;return}}else{for(Ke in u){r=u[Ke];r[0].checked=false}}}return u!=null?(i=u[P.dehydrate_tree(t)])!=null?i[0].checked=true:void 0:void 0};f=function(){var t,i,s,c,f,_,p,h,g,m,v,y,b,w,x;d.empty();u={};m=e.get_static_property("columns");f=e.evaluate_property("width");t=Math.floor(m/e.element.get_width()*f);y=(f-ve.calculate_border_width(e))/t-10;x=a();for(_=b=0,w=x.length;b<w;_=++b){s=x[_];c=r(s,_);d.append(c);h=$(c[1]);h[0].style.width=y+"px";if(_<t){h[0].style["margin-top"]="3px"}else{h[0].style["margin-top"]="12px"}}n.data("options_div_mapping",u);d.find("input[type=radio]").on("change",function(){var t;t=E.rehydrate_dropdown_value($(this).attr("value"));e.message("user_submit",t);return l(t)});l(o);v=e.evaluate_property("disabled");for(Ke in u){c=u[Ke];c[0].disabled=v}if(!e.edit_mode()&&!e.thumbnail_mode()){i=n.outerHeight()-n.height();p=parseInt(d.css("height").replace("px",""));g=e.element.get_height();return e.set_height(Math.max(g,p+i))}};ae(e,function(e){return l(e)});e.wait_for_visible_lite(function(){return Ue.autorun(function(){var t,n,r;n=e.evaluate_property("disabled");r=[];for(Ke in u){t=u[Ke];r.push(t[0].disabled=n)}return r})});e.on_destroy(function(){return t.destroy()});t.on_value(function(t){if(t){return e.message("reset_input")}});return e.wait_for_visible_lite(function(){return e.autorun(function(){if(e.is_visible()){return f()}})})},_get_raw_value:function(e){return ut(e)},_get_raw_choice_list:function(e){return st(e,this)},_choice_list_contains:function(e,t){var n;n=Ge.get(this._get_raw_value(e.element));return this._get_raw_choice_list(e).contains(t,n)},get_starting_content:function(e){var t;if(e.run_mode()&&e.get_static_property("auto_binding")){t=te(e)}else{t=e.evaluate_property("default")}if(t==null||!this._choice_list_contains(e,t)){return null}return t},get_state_value:function(e,t){if(t==="value"){return this._get_raw_value(e)}},get_injected_value:function(e){return e.get_static_property("dynamic_type")},get_injected_display:function(){return"Current option"},use_injected_datasource:function(e,t){return e.path().indexOf(t.property("option_display_expression").path())===0},content_validated:function(e,t){return e!=null||!t.get_static_property("mandatory")},css_files:["css/optional/radio.css"],change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:true,is_input:true,is_container:false,no_is_focused:true});E.rehydrate_dropdown_value=function(e){var t;if(e===""){return null}else{return(t=P.rehydrate_tree(s().db_instance(),e))!=null?t:null}};de("AutocompleteDropdown",{category:"input forms",display:"Search Box",defaults:Ue.extend({},R,{width:400,height:45,use_max_width:true,max_width:150}),default_states:z,properties_for_new:{no_language:true},field_names:Ue.extend({placeholder:{"default":"Start typing..."},choices_style:{"default":"dynamic",no_states:true},choices:{no_states:true},data_source:{no_states:true},field_to_search:{no_states:true},no_language:{no_states:true},"default":{optional:true},allow_not_in_list:{no_states:true},mandatory:{no_states:true},ac_list_max:{"default":10}},J,K),property_applications:[new ve.Dimensions,new ve.Background(function(e){return e.find("input").not(".tt-input")}),new ve.Border("input"),new ve.BoxShadow("input"),new ve.Font("input"),new ve.FontSpacing(null,["line_height"]),new ve.InputPadding("input"),new ve.PlaceholderColor("input"),new ve.MinWidth],get_html:function(e){return"<div></div>"},get_min_width:function(e){return 0},initialize:function(e){var t,n,r,i=this;t=e.get_canvas();n=null;r=Ue.MakeKey(null,"autocomplete_input_drawn");e.on_message("add_tab_index",function(e){return Ue.WaitFor(r,function(){return n.attr("tabindex",e)})});return e.wait_for_visible_lite(function(){var o,a,s,u,l,c,f,d,_,p,g,m,v,y,w,x;n=$('<input type="text"></input>');Se(n);n[0].style["box-sizing"]="border-box";t.append(n);t[0].style.overflow="visible";r.turn();e.autorun(function(){var n,r,i,o,a;n={};a=["height","width"];for(i=0,o=a.length;i<o;i++){r=a[i];n[r]=e.evaluate_property(r)}return t.find("input").css({height:n.height,width:n.width})});_={};x=function(t){var n,r,i,o,a,s,u;if(t==null){return""}n=e.get_static_property("choices_style");if(n==="geographic_places"){if(e.edit_mode()&&!e.element.property("default").is_static()){return e.element.property("default").get_tree_display()}else{return Ge.get("geographic_address").cast_to_string(t)}}else if(n==="dynamic"){r=e.get_static_property("field_to_search");s=t.child(r).get();if(_[s]!=null&&_[s]!==t){i=false;o=0;for(a in _){u=_[a];if(!(a===s||a.indexOf(s+" (")===0)){continue}o++;if(P.dehydrate_tree(t)===P.dehydrate_tree(u)){s=a;i=true;break}}if(!i){s=s+" ("+o+")"}}_[s]=t;return s}else{return t}};y=function(t){var n,r;n=e.get_static_property("choices_style");if(n==="geographic_places"){r=function(){return Y.get_address_coordinates(t)};r.toUniqueString=function(){return t};return r}else if(n==="dynamic"){return _[t]}else{if(vt.call(i._get_static_choices(e),t)>=0){return t}else{return null}}};e.autorun(function(){return n.attr("placeholder",e.evaluate_property("placeholder"))});e.autorun(function(){if(ce.is_rtl(ce.app_language())){return t.find("input").attr("dir","rtl")}else{return t.find("input").attr("dir","auto")}});if(e.run_mode()){s=e.get_static_property("choices_style");if(s==="static"){d=function(){var t,n,r,i;r=this._get_static_choices(e);i=[];for(t=0,n=r.length;t<n;t++){a=r[t];i.push({value:a})}return i}.call(i);p=function(e,t){var n,r;r=function(){var t,r,i;i=[];for(t=0,r=d.length;t<r;t++){n=d[t];if(n.value.toLowerCase().indexOf(e.trim().toLowerCase())!==-1){i.push(n)}}return i}();return t(r)}}else if(s==="dynamic"){c=e.get_static_property("field_to_search");p=function(t,n){if(!c){n([]);return}return Ue.run_once(30,function(){var n,r,i,o,a;n=e.evaluate_property("data_source");if(!n){return[]}o={constraint_type:/[^a-zA-Z0-9]/.exec(t)!=null?"match_phrase_prefix":"prefix_search",key:c,value:t.trim().toLowerCase(),opts:{no_language:e.get_static_property("no_language")}};a=n.filter([o]);r=a.get_children(0,e.evaluate_property("ac_list_max"));return function(){var e,t,n;n=[];for(e=0,t=r.length;e<t;e++){i=r[e];n.push({value:x(i)})}return n}()},function(e,t){if(e){Ue.warn(e);return}return n(t)})}}else if(s==="geographic_places"){Y.load_google_map_api();w=["geocode"];p=function(e,t){return Y.get_address_place_autocomplete(e,w,function(e){var n;return t(function(){var t,r,i;i=[];for(t=0,r=e.length;t<r;t++){n=e[t];i.push({value:n.description})}return i}())})}}n.typeahead({minLength:2,highlight:true},{source:p});we(e,n);e.on_message("set_focus",function(){return n.focus()});l=null;g=function(){return Ue.run_once(30,function(){return{font_color:e.evaluate_property("font_color"),font_face:e.evaluate_property("font_face"),font_size:e.evaluate_property("font_size"),width:e.evaluate_property("width"),border_radius:e.evaluate_property("border_roundness"),is_rtl:ce.is_rtl(ce.app_language())}},function(r,i){var o,a,s,c,f;if(r){Ue.warn(r);return}a=Ue.lighten_color(Ue.rgb_to_hex(i.font_color).code,.5);t.find(".tt-hint").css("color",a);f=t.offset(),o=f.left,c=f.top;if(Ue.is_fixed(n)){c=c+t.height()-1-$(window).scrollTop()}else{c=c+t.height()-1}s={"font-family":Ye.get_face_and_variant(i.font_face).font_family,"font-size":i.font_size+"px","min-width":i.width+"px","border-radius":i.border_radius+"px",top:c+"px",left:o+"px",right:"initial","z-index":1e4,position:Ue.is_fixed(t)?"fixed":"absolute","text-align":i.is_rtl?"right":"left"};h(l,s);if(Ue.is_on_mobile_or_tablet()){l.off("touchend");return l.on("touchend",function(t){var r;r=y($(t.target).text());if(r){m(r);Ue.run_once(30,function(){if(e.get_static_property("choices_style")==="geographic_places"){return $(t.target).text()}else{return x(r)}},function(e,t){if(e){Ue.warn(e);return}return typeof n.typeahead==="function"?n.typeahead("val",t):void 0})}else{u();m(null)}return typeof n.typeahead==="function"?n.typeahead("close"):void 0})}})};e.wait_for_visible(function(){l=t.find(".tt-dropdown-menu");l.detach();$("body").append(l);return g()});n.on("typeahead:opened touchstart",function(){return g()});u=function(){if(!e.get_static_property("allow_not_in_list")){return n.typeahead("val","")}};v=function(){var t,r;t=n.typeahead("val");if(!t){Ue.run_once(10,function(){return{existing_val:e.state("value"),typed_content:e.state("typed_content")}},function(e,t){var n,r;if(e){Ue.warn(e);return}n=t.existing_val,r=t.typed_content;if(n||r){m(null)}else{}});return}r=y(t);if(r==null){u();return m(null)}else{return m(r)}};m=function(t){if((s==="dynamic"||s==="static")&&!t&&e.get_static_property("allow_not_in_list")){if(e.state("typed_content")!==n.typeahead("val")){e.state("typed_content",n.typeahead("val"));e.state("has_been_changed",true);e.state("value",null);return Ce(e,"InputChanged")}}else{e.state("typed_content",null);return e.message("user_submit",t)}};if(!Ue.is_on_mobile_or_tablet()){f=Date.now();n.on("typeahead:closed",function(){if(Date.now()-f>200||Ue.running_test()){f=Date.now();return v()}});n.on("blur.autocomplete",function(){if(Date.now()-f>200||Ue.running_test()){f=Date.now();return v()}})}else{n.on("blur",function(){return v()})}n.on("keypress",function(t){if(t.which===13){n.blur();return b(e)}});if(s==="dynamic"){o=Ue.Watcher(function(){var t,n,r;if(!e.state("has_been_changed")){return false}r=e.state("value");if(r==null){return false}n=e.evaluate_property("data_source");if(!n){return true}t=Ge.get(e.element.property("data_source").property("type_to_find").json.get());return!n.contains(r,t)});e.on_destroy(function(){return o.destroy()});o.on_value(function(t){if(t){return e.message("reset_input")}})}e.on_destroy(function(){return typeof n.typeahead==="function"?n.typeahead("destroy"):void 0});e.on_property_change("disabled",function(e){return n[0].disabled=e})}return ae(e,function(t){var r;r=x(t);if(e.run_mode()){return typeof n.typeahead==="function"?n.typeahead("val",r):void 0}else{return n.val(r)}})})},_get_static_choices:function(e){var t,n;n=e.get_static_property("choices");if(typeof n!=="string"){n=""}return function(){var e,r,i,o;i=n.split("\n");o=[];for(e=0,r=i.length;e<r;e++){t=i[e];o.push(t.trim())}return o}()},get_starting_content:function(e){var t,n,r,i;if(e.run_mode()&&e.get_static_property("auto_binding")){i=te(e)}else{i=e.evaluate_property("default")}if(i==null){return null}r=e.get_static_property("choices_style");if(r==="geographic_places"){if(!Ge.get("geographic_address").cast_to_string(i)){i=Y.get_address_coordinates(i);if(!Ge.get("geographic_address").cast_to_string(i)){return null}}}else if(r==="static"){if(this._get_static_choices(e).indexOf(i)===-1){return null}}else{n=e.evaluate_property("data_source");t=Ge.get(e.element.property("data_source").property("type_to_find").get_static());if(!n||!n.contains(i,t)){return null}}return i},content_validated:function(e,t){if(!t.get_static_property("mandatory")){return true}if(e!=null){return true}if(t.get_static_property("allow_not_in_list")){return t.state("typed_content")!=null}},get_state_value:function(e,t){var n,r;if(t==="value"){n=e.get_static_property("choices_style");if(n==="static"){return"text"}else if(n==="geographic_places"){return"geographic_address"}else{r=e.property("data_source").property("type_to_find").json.get();if(r){return r}return"text"}}else if(t==="typed_content"){return"text"}},get_states:function(e){return["typed_content"]},add_specific_messages:function(e,t){if(t.get_static_property("choices_style")!=="geographic_places"){return Ue.extend(e,{get_typed_content:{description:"'s typed text",ret_value:"text",fn:function(e,t,n,r,i){if(e==null){return}return e.state("typed_content")}}})}},change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:true,is_input:true,is_container:false,only_send_to_client_in_runmode:true,jquery_plugins:function(){return["jquery_plugins/typeahead.jquery.min"]},css_files:["css/optional/typeahead.css"]});de("SliderInput",{display:"Slider Input",category:"input forms",defaults:{width:200,height:45},field_names:Ue.extend({min_value:{"default":0},max_value:{"default":10},step:{"default":1},range_type:{"default":"simple",no_states:true},content:{},orientation:{no_states:true,"default":"horizontal"},border_color:{"default":"#aaa",in_style:true},background_color:{"default":"#fff",in_style:true},handle_color:{"default":"#e6e6e6",in_style:true},range_area_color:{"default":"#cccccc",in_style:true}},J,K),property_applications:[new ve.Dimensions,new ve.MinWidth],get_html:function(e){return"<div></div>"},get_min_width:function(e){return 0},initialize:function(e){var t,n,r=this;t=e.get_canvas();n=Ue.MakeKey(null,"slider_init");e.on_message("add_tab_index",function(e){return Ue.WaitFor(n,function(){return t.find(".ui-slider-handle").attr("tabindex",e)})});return e.wait_for_visible_lite(function(){var r,o;r=Ue.div("jquery-slider",t);r.slider();t.css("padding",8);e.on_destroy(function(){if(r.slider("instance")){return r.slider("destroy")}});if(!e.run_mode()){r.off()}if(e.get_static_property("range_type")==="range"){o="values"}else{o="value"}if(e.run_mode()){t.addClass(i);e.wait_for_visible(function(){var i=this;return Ue.WaitFor(n,function(){e.on_property_change("disabled",function(e){return r.slider("option","disabled",e)});return e.on_message("set_focus",function(){return t.find(".ui-slider-handle").focus()})})})}return e.autorun(function(){var t,i,a,s,u,l,c,f,d,_,p,h,g,m=this;l={};p=["min_value","max_value","step","range_type","orientation","height","width","handle_color","range_area_color","border_color","background_color"];for(d=0,_=p.length;d<_;d++){u=p[d];l[u]=e.evaluate_property(u)}s={min:(h=l.min_value)!=null?h:0,max:(g=l.max_value)!=null?g:9,step:l.step,range:l.range_type==="range",orientation:l.orientation,slide:function(t,n){setImmediate(function(){return e.message("user_change",r.slider(o))});return true},stop:function(t,n){setImmediate(function(){return e.message("user_submit",r.slider(o))});return true}};for(i in s){f=s[i];r.slider("option",i,f)}c={"margin-left":3,"margin-right":3,cursor:"pointer",background:l.background_color,"border-color":l.border_color};t={cursor:"pointer",outline:"none","border-color":l.border_color};if(l.orientation==="horizontal"){c.height=l.height-16;c.width=l.width-23;t.top=-8;t.height=l.height-1;t.width=19;r.find(".ui-slider-range").css({height:"100%"})}else{c.width=l.width-22;c.height=l.height-20;t.width=l.width-11;t.height=19;r.find(".ui-slider-range").css({width:"100%"})}t.background=l.handle_color;if(l.range_type==="range"){r.find(".ui-slider-range").css({background:l.range_area_color})}r.css(c);r.find(".ui-slider-handle").css(t);n.turn();a=null;return ae(e,function(e){if(o==="values"&&e==null){e=[]}a=e;return r.slider(o,a)})})})},get_starting_content:function(e){var t,n,r,i,o,a,s;if(e.run_mode()&&e.get_static_property("auto_binding")){r=te(e)}else{r=e.evaluate_property("content")}if(e.get_static_property("range_type")==="range"){r=(i=r!=null?typeof r.all==="function"?r.all():void 0:void 0)!=null?i:r;if(r!=null?r.length:void 0){return r}n=(o=e.evaluate_property("min_value"))!=null?o:0;t=(a=e.evaluate_property("max_value"))!=null?a:9;return[n,t]}else{return(s=r!=null?r:e.evaluate_property("min_value"))!=null?s:0}},get_state_value:function(e,t){if(t==="value"){if(e.get_static_property("range_type")==="range"){return"number_range"}else{return"number"}}},change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:true,is_input:true,is_container:false,jquery_plugins:function(){return["jquery_plugins/jquery-ui-slider-draggable.min","jquery_plugins/jquery.ui.touch-punch.min.js"]},css_files:["css/optional/jquery-ui.slider.css"]});pe=false;Oe=E.show_message_for_ios_8_upload_bug=function(){if(!pe&&Ue.safe_contains(typeof navigator!=="undefined"&&navigator!==null?navigator.userAgent:void 0,"12A365")){pe=true;return alert("The iOS version you're using prevents you from uploading files, please upgrade your system and try again.")}};de("PictureInput",{display:"Picture Uploader",category:"input forms",defaults:{font_size:14,bold:true,background_style:"bgcolor",border_style:"solid",border_width:1,border_roundness:0,border_color:"#A6A6A6",border_style_top:"solid",border_width_top:1,border_roundness_top:0,border_color_top:"#A6A6A6",border_style_left:"solid",border_width_left:1,border_roundness_left:0,border_color_left:"#A6A6A6",border_style_bottom:"solid",border_width_bottom:1,border_roundness_bottom:0,border_color_bottom:"#A6A6A6",border_style_right:"solid",border_width_right:1,border_roundness_right:0,border_color_right:"#A6A6A6",padding_horizontal:0,padding_vertical:0,bgcolor:"#EBEBEB",font_alignment:"center",width:130,height:140},default_states:z,field_names:Ue.extend({src:{},placeholder:{no_states:true,"default":"Click to upload an image"},mandatory:{no_states:true},"private":{no_states:true},attach_to:{},service:{no_states:true},destination:{},keep_proportion_resize:{no_states:true},limit_image_width:{no_states:true}},J,K),property_applications:[new ve.Font(".button_for_file_uploader"),new ve.Dimensions,new ve.Border,new ve.Background(".button_for_file_uploader"),new ve.BoxShadow,new ve.MinWidth],get_html:function(e){return"<div></div>"},get_min_width:function(){return 0},notify_width:function(e,t){return se(e,t)},initialize:function(e){var t=this;return e.wait_for_visible_lite(function(){var t,n,r,o,a,s,u,l,c,f;Oe();t=5;n=e.get_canvas();a=Ue.img(void 0,n);l={width:"100%",height:"100%","z-index":t,position:"absolute"};h(a,l);n.append(a);c=$('<button class="button_for_file_uploader"></button>');Se(c);l={"z-index":t-1,position:"absolute",left:"0px",top:"0px",cursor:"pointer",width:"100%",height:"100%"};h(c,l);n.append(c);f=function(t){if(!t){return null}return ve.optimize_image(t,e.get_static_property("width"),e.get_static_property("height"))};r=function(t){if(!t){a[0].src=qe;c.css("opacity",1);return a.css("opacity",0)}else{e.autorun(function(){return E.rescale_image(t,a,e.evaluate_property("height"),e.evaluate_property("width"),function(){return a[0].src=t})});c.css("opacity",0);return a.css("opacity",1)}};ae(e,function(t){if(!e.run_mode()&&!e.element.property("src").is_static()){t=""}else{t=f(t)}return r(t)});s=null;u=Ue.MakeKey(null,"picinput_drawn");e.on_message("add_tab_index",function(e){return Ue.WaitFor(u,function(){return s.attr("tabindex",e)})});if(e.run_mode()){n.addClass(i);o=function(t){var n=this;return Ue.run_once(30,function(){return E.process_upload_security(e)},function(e,n){if(e){return t(e)}else{return t(null,n)}})};s=$('<input type="file" accept="image/*"></input>');s=$('<input type="file"></input>');if(!s[0].files){s=$('<input type="button"></input>')}n.append(s);h(s,{opacity:0,position:"absolute","z-index":1+a.css("z-index"),cursor:"pointer",left:"0px",width:"100%",height:"100%"});He.MakeImageUploader(s,void 0,o,function(t){e.state("loading",false);r(f(t));e.message("user_submit",t);return s[0].value=null},function(){return e.state("loading",true)},function(t){return T.handle_uncaught_error(t,function(t){if(t){window.alert(Ue.human_friendly(t))}return e.state("loading",false)})},e.get_static_property("limit_image_width"));u.turn();e.on_property_change("disabled",function(e){return s[0].disabled=e});we(e,s);e.on_message("set_focus",function(){return s.focus()})}return e.on_property_change("placeholder",function(e){return c.text(e)})})},get_starting_content:function(e){if(e.run_mode()&&e.get_static_property("auto_binding")){return te(e)}return e.evaluate_property("src")},get_state_value:function(e,t){if(t==="value"){return"image"}},get_states:function(e){return["loading"]},add_specific_messages:function(e,t){return Ue.extend(e,{get_loading_status:{description:" is loading",ret_value:"boolean",fn:function(e,t){return e!=null?e.state("loading"):void 0}}})},need_to_wait_before_checking_validity:true,content_validated:function(e,t){return e||!t.get_static_property("mandatory")},change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:false,is_input:true,is_container:false});E.process_upload_security=function(e){var t,n;t={};if(e.get_static_property("private")){t.attach_to=(n=e.evaluate_property("attach_to"))!=null?typeof n._id==="function"?n._id():void 0:void 0}else{t["public"]=true}E.add_storage_plugin_data(e,t);return t};E.add_storage_plugin_data=function(e,t){var n,r,i,o,a,s,u;r=(a=e.get_static_property("service"))!=null?a:"bubble";t.service=r;if(r!=="bubble"&&je.is_installed(r)){r=je.get_service(r);s=r.file_upload.fields;u=[];for(i=0,o=s.length;i<o;i++){n=s[i];u.push(t[n.name]=e.evaluate_property(n.name))}return u}};de("FileInput",{display:"File Uploader",category:"input forms",defaults:{font_size:14,font_color:"#3D3D3D",background_style:"bgcolor",border_style:"solid",border_color:"#BDBDBD",border_roundness:3,border_style_top:"solid",border_width_top:1,border_color_top:"#BDBDBD",border_roundness_top:3,border_style_left:"solid",border_width_left:1,border_color_left:"#BDBDBD",border_roundness_left:3,border_style_bottom:"solid",border_width_bottom:1,border_color_bottom:"#BDBDBD",border_roundness_bottom:3,border_style_right:"solid",border_width_right:1,border_color_right:"#BDBDBD",border_roundness_right:3,border_width:1,font_alignment:"center",padding_horizontal:0,padding_vertical:15,width:200,height:45,use_max_width:true,max_width:150},default_states:z,field_names:Ue.extend({src:{},placeholder:{"default":"Click to upload a file"},mandatory:{no_states:true},"private":{no_states:true},attach_to:{},service:{no_states:true},destination:{}},J,K),property_applications:[new ve.Dimensions,new ve.Background,new ve.Border,new ve.BoxShadow,new ve.Font(".file-input-text"),new ve.FontSpacing(".file-input-text"),new ve.PaddingText(".file-input-text"),new ve.MinWidth],get_html:function(e){return"<div></div>"},get_min_width:function(){return 0},initialize:function(e){var t=this;return e.wait_for_visible_lite(function(){var t,n,r,o,a,s,u;Oe();t=e.get_canvas();u=$('<div class="file-input-text"></div>');h(u,{"-moz-box-sizing":"border-box",position:"absolute",top:"0px",cursor:"pointer",overflow:"hidden",width:"100%",height:"100%"});t.append(u);s=Ue.Box();n=function(e){var t,n;if(!e){s(true);return}s(false);n=e.split("/");t=n[-1+n.length];return u.text(t)};Ue.autorun(function(){if(s()){return u.text(e.evaluate_property("placeholder"))}});ae(e,function(e){return n(e)});o=null;a=Ue.MakeKey(null,"fileinput_drawn");e.on_message("add_tab_index",function(e){return Ue.WaitFor(a,function(){return o.attr("tabindex",e)})});if(e.run_mode()){o=$('<input type="file"></input>');t.addClass(i);if(!o[0].files){o=$('<input type="button"></input>')}r=function(t){var n=this;return Ue.run_once(30,function(){return E.process_upload_security(e)},function(e,n){if(e){return t(e)}else if(!n["public"]&&!n.attach_to){return t(Ue.error({statusCode:400,reason:"PRIVATE_FILE"}))}else{return t(null,n)}})};t.append(o);h(o,{opacity:0,position:"absolute","z-index":1+u.css("z-index"),cursor:"pointer",top:"0px",width:"100%",height:"100%"});He.MakeImageUploader(o,void 0,r,function(t){e.state("loading",false);n(t);e.message("user_submit",t);return o[0].value=null},function(){return e.state("loading",true)},function(t){return T.handle_uncaught_error(t,function(t){if(t){window.alert(Ue.human_friendly(t))}return e.state("loading",false)})});a.turn();e.on_property_change("disabled",function(e){return o[0].disabled=e});we(e,o);e.on_message("set_focus",function(){return o.focus()})}return e.on_property_change("placeholder",function(e){return u.text(e)})})},get_starting_content:function(e){if(e.run_mode()&&e.get_static_property("auto_binding")){return te(e)}return e.evaluate_property("src")},get_state_value:function(e,t){if(t==="value"){return"file"}},get_states:function(e){return["loading"]},add_specific_messages:function(e,t){return Ue.extend(e,{get_loading_status:{description:" is loading",ret_value:"boolean",fn:function(e,t){return e!=null?e.state("loading"):void 0}}})},need_to_wait_before_checking_validity:true,content_validated:function(e,t){return e||!t.get_static_property("mandatory")},change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:false,is_input:true,is_container:false});Qe=function(e){var t;if(!e){return}t=Ge.get("date").cast(e);if(!t){return}return[t.getFullYear(),t.getMonth(),t.getDate()]};de("DateInput",{display:"Date/Time Picker",category:"input forms",defaults:{font_size:14,font_color:"#3D3D3D",background_style:"bgcolor",border_style:"solid",border_color:"#BDBDBD",border_roundness:3,border_width:1,border_roundness_top:3,border_style_left:"solid",border_width_left:1,border_color_left:"#BDBDBD",border_roundness_left:3,border_style_bottom:"solid",border_width_bottom:1,border_color_bottom:"#BDBDBD",border_roundness_bottom:3,border_style_right:"solid",border_width_right:1,border_color_right:"#BDBDBD",border_roundness_right:3,padding_horizontal:4,padding_vertical:0,width:250,height:45,use_max_width:true,max_width:150},default_states:z,field_names:Ue.extend({input_type:{"default":"date",no_states:true},content:{},overwrite_placeholder:{no_states:true},placeholder:{optional:true,no_states:true},date_format:{"default":"number2",no_states:true,in_style:true},start_monday:{no_states:true},time_interval:{"default":30,no_states:true},time_format:{"default":"full",no_states:true,in_style:true},min_date:{},max_date:{},min_hour:{},max_hour:{},show_month_year_picker:{no_states:true},mandatory:{no_states:true}},J,K),property_applications:[new ve.Dimensions,new ve.Background("input"),new ve.Border("input"),new ve.BoxShadow("input"),new ve.Font("input"),new ve.FontSpacing(null,["line_height"]),new ve.InputPadding("input"),new ve.PlaceholderColor("input"),new ve.MinWidth],additional_uses_properties:["input_type"],get_html:function(e){return"<div></div>"},get_min_width:function(){return 0},initialize:function(e){var t,n,r,o,a,u,l=this;t=e.get_canvas();n=a=r=u=null;o=Ue.MakeKey(null,"dateinput_drawn");e.on_message("add_tab_index",function(e){return Ue.WaitFor(o,function(){return n.attr("tabindex",e)})});return e.wait_for_visible_lite(function(){var l,c,f,d,_,p,g;t.addClass("date_picker_element");t[0].style.overflow="visible";e.on_property_change("input_type",function(e){t.empty();n=$('<input type="text" class="date_div"></input>');Se(n);t.append(n);o.turn();if(e==="date_time"){a=$('<input type="text" class="time_div"></input>');Se(a);return t.append(a)}});c=function(e){switch(e){case"number1":return"d/mm/yyyy";case"number2":return"m/dd/yyyy";case"alpha":return"d mmmm, yyyy";case"alphalong":return"dddd, d mmmm, yyyy";case"alphashort":return"d-mmm-yyyy"}};e.autorun(function(){var t,r,i,o,u,l,f,d,_,p;i={};p=["input_type","width","height","padding_horizontal","date_format","time_format","placeholder","overwrite_placeholder"];for(d=0,_=p.length;d<_;d++){l=p[d];i[l]=e.evaluate_property(l)}t=i.height-ve.calculate_border_height(e);h(n,{height:t+"px",cursor:"pointer","box-sizing":"content-box"});if(i.input_type==="date_time"){r=i.width-4*i.padding_horizontal-2*ve.calculate_border_width(e);h(n,{width:Math.floor(r-70-10)+"px","float":"left"});h(a,{width:"70px","float":"right",height:t+"px",cursor:"pointer","box-sizing":"content-box"})}else{r=i.width-2*i.padding_horizontal-ve.calculate_border_width(e);n[0].style.width=r+"px"}if(i.input_type==="date"&&i.overwrite_placeholder){o=i.placeholder}else{if(v.app().id()==="test_app"){u=new Date("1/15/2013")}else{u=new Date}o=Ue.format_date(u,c(i.date_format),s().get_text("BUILT_IN","DATE_FORMAT"))}n.attr("placeholder",o);switch(i.time_format){case"full":f="12:00";break;case"ampm":f="12:00 AM"}return a!=null?a.attr("placeholder",f):void 0});if(e.run_mode()){t.addClass(i);l={container:"html",selectYears:false,selectMonths:false,firstDay:e.get_static_property("start_monday"),selectMonths:e.get_static_property("show_month_year_picker"),selectYears:e.get_static_property("show_month_year_picker")};l.format=c(e.get_static_property("date_format"));f=function(){var t,n,i,o,a,s;e.state("is_focused",false);if(r!=null?r.get():void 0){t=r.get("select");n={year:t.year,month:t.month,day:t.date};if(e.get_static_property("input_type")==="date_time"){i=u.get("select");if(!i){o=null;return}else{n.hour=(a=i!=null?i.hour:void 0)!=null?a:"";n.minute=(s=i!=null?i.mins:void 0)!=null?s:"";o=new Date(n.year,n.month,n.day,n.hour,n.minute)}}else{o=new Date(n.year,n.month,n.day)}}else{o=null}e.message("user_submit",o);return true};d=function(){var t;t=e.get_canvas();return Ue.run_once(30,function(){var n;if(e.element.parents("Popup").length){n=$(document).scrollTop()}else{n=0}return{top:t.offset().top-n,left:t.offset().left,width:t.width(),"font-family":Ye.get_face_and_variant(e.evaluate_property("font_face")).font_family}},function(e,t){if(e){Ue.warn(e);return}r.$root.css(t);return u!=null?u.$root.css(t):void 0})};l.onOpen=d;l.onClose=f;n.pickadate(l);r=n.pickadate("picker");if(e.element.parents("Popup").length){_="fixed";g=100}else{_="absolute";g=0}e.wait_for_visible(function(){d();return setTimeout(d,100)});Ue.autorun(function(){return r.$root.css({"margin-top":e.evaluate_property("height"),position:_,"max-width":e.evaluate_property("width")})});e.on_property_change(["min_date","max_date"],function(e){var t,n,i,o;n=e.min_date,t=e.max_date;return r.set({min:(i=Qe(n))!=null?i:-Infinity,max:(o=Qe(t))!=null?o:Infinity})});if(e.get_static_property("input_type")==="date_time"){p={container:"html"};p.interval=e.get_static_property("time_interval");switch(e.get_static_property("time_format")){case"full":p.format="H:i";break;case"ampm":p.format="h:i A"}p.onClose=f;p.onOpen=d;a.pickatime(p);u=a.pickatime("picker");Ue.autorun(function(){return u.$root.css({"margin-top":e.evaluate_property("height"),position:_,"max-width":e.evaluate_property("width")})});e.on_property_change(["min_hour","max_hour"],function(e){var t,n,r;n=e.min_hour,t=e.max_hour;r=function(e){if(!e){return false}return[e,0]};return u.set({min:r(n),max:r(t)})})}e.on_property_change("disabled",function(e){n[0].disabled=e;return a!=null?a[0].disabled=e:void 0});ae(e,function(t){var n;if(t){r.set("select",Qe(t));if(e.get_static_property("input_type")==="date_time"){n=Ge.get("date").cast(t);return u.set("select",[n.getHours(),n.getMinutes()])}}else{r.clear();if(e.get_static_property("input_type")==="date_time"){return u.clear()}}})}we(e,t.find("input"));e.on_message("set_focus",function(){return r.open()});if(!e.run_mode()){n.attr("readonly","true");return a!=null?a.attr("readonly","true"):void 0;
}})},get_starting_content:function(e){if(e.run_mode()&&e.get_static_property("auto_binding")){return te(e)}return e.evaluate_property("content")},content_validated:function(e,t){return e||!t.get_static_property("mandatory")},change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:false,is_input:true,is_container:false,get_state_value:function(e,t){if(t==="value"){return"date"}},jquery_plugins:function(e,t,n){var r,i;r=["jquery_plugins/datepicker/picker","jquery_plugins/datepicker/picker.date","jquery_plugins/datepicker/picker.time"];if(typeof s().appname==="function"){i=ce.get_iso_code(n);if(i==="en_US"||i==="en_GB"||i==="en_AU"||i==="en_ZA"){i=void 0}else if(i==="ar_AR"){i="ar"}if(i){r.push("jquery_plugins/datepicker/"+i)}}return r},css_files:["css/optional/datepicker.css"]});Ae=function(e,t){var n,r;n=function(){var n;if(e.element.root().use_responsive_algorithm()){return(n=Ue.real_inner_width(e.get_canvas()))!=null?n:t}else{return e.element.get_width()}};r=n();if(r){e.child_container.resize_width(r)}return setImmediate(function(){return Ue.wait_for_updates(function(){r=n();if(r){return e.child_container.resize_width(r)}})})};E.container_field_names=S={group_type:{no_states:true},data_source:{}};ze=function(e,t){if(t==="group_data"){return e.get_static_property("group_type")}};E.state_value_helper_for_group=ze;re=E.group_element_definition={category:"containers",defaults:{bgcolor:"#FFFFFF",background_style:"bgcolor",width:400,height:250},field_names:Ue.extend({collapse_when_hidden:{no_states:true,"default":false},collapse_animation:{no_states:true,"default":false},animation_type:{no_states:true,"default":"slide"}},Re,S),property_applications:[new ve.Dimensions,new ve.Background,new ve.Border,new ve.BoxShadow,new ve.MinWidth],get_html:function(e){return"<div></div>"},change_cursor_style_if_clickable:true,container_names:function(){return["elements"]},get_container_canvas:function(e,t){return e.get_canvas()},is_input:false,is_container:true,add_an_invisible_div_on_the_top:false,get_state_value:function(e,t){return ze(e,t)},notify_width:function(e,t){return Ue.WaitFor(e.get_children_drawn_key(),function(){return Ae(e,t)})},get_min_width:function(e){return 0},events:["ButtonClicked"]};o=15;oe=function(e){e.on_message("child_movement",function(t){var n;n=e.element.get_height()+t;if(e.is_visible()||!e._has_been_hidden){e.set_height(n)}return e.state("actual_height",n)});if(e.run_mode()){if(e.get_static_property("collapse_animation")){return e.canvas[0].style.overflow="hidden"}}};ne={do_show:function(e){var t,n,r,i,a;if(!e._has_been_hidden){return}e._has_been_hidden=false;t=e.get_canvas();t[0].style.display="block";if(!e.run_mode()){return}r=function(){var t;t=e.state("actual_height");if(!t){t=e.element.get_height()}return t};if(e.get_static_property("collapse_when_hidden")){if(e.get_static_property("collapse_animation")&&Ue.page_loaded_key.is_turned()){switch(e.get_static_property("animation_type")){case"slide":n=0;e.set_height(n);i=r()/o;a=function(){if(n>=r()){e.set_height(r());return}n+=i;e.set_height(n);return setTimeout(function(){return a()},1)};return a();case"fade":t[0].style.opacity=0;t.velocity("stop");e.set_height(r());return Ue.velocity(t,"fadeIn",{duration:400})}}else{return e.set_height(r())}}else{return e.set_height(r())}},do_hide:function(e){var t,n,r,i,a,s;if(e._has_been_hidden){return}e._has_been_hidden=true;t=e.get_canvas();n=e.get_static_property("collapse_when_hidden");if(!e.run_mode()||!n){t[0].style.display="none";return}i=parseInt(t.css("height").replace("px",""));if(n){if(e.get_static_property("collapse_animation")&&Ue.page_loaded_key.is_turned()){switch(e.get_static_property("animation_type")){case"slide":a=i/o;r=i;s=function(){if(r<=0){e.set_height(0);t[0].style.display="none";return}r-=a;e.set_height(r);return setTimeout(function(){return s()},1)};return s();case"fade":t.velocity("stop");return Ue.velocity(t,"fadeOut",{duration:400,complete_cb:function(){t[0].style.display="none";return e.set_height(0)}})}}else{e.set_height(0);return t[0].style.display="none"}}}};E._check_for_errors_datasource_set_to_self=Je=function(e,t,n){var r,i,o,a,s,u;r=function(i,o,a){var s,u,l,c,f,d,_,p,h;if(o==null){o=0}s=function(){if(a){return" (in conditions)"}else{return""}};u=i.property("data_source");c=u.find_expressions("GetElement.element_id="+e.id()).concat(u.find_expressions("ThisElement"));for(f=0,d=c.length;f<d;f++){l=c[f];if(((_=l.raw().next)!=null?_.name:void 0)===t){n(e.display()+": Data source cannot refer to the same element"+s());return}}l=u.raw();if((l!=null?l.type:void 0)==="GetElement"){if(((p=l.next)!=null?p.name:void 0)===t){if(l.properties.element_id===e.id()){if(o===0){return n(e.display()+": Data source cannot refer to the same element"+s())}else{return n(e.display()+": Data source cannot use an element that refers to the current element"+s())}}else if(l.properties.element_id){return r(v.element(l.properties.element_id),o+1,a)}}}else if((l!=null?l.type:void 0)==="ThisElement"&&((h=l.next)!=null?h.name:void 0)===t){return n(e.display()+": Data source cannot refer to the same element"+s())}else if((l!=null?l.type:void 0)==="ElementParent"){if(a&&i.context_element().parent().id()===e.id()||!a&&i.parent().id()===e.id()){return n(e.display()+": Data source cannot use an element that refers the the current element"+s())}}};r(e);s=e.states();u=[];for(o=0,a=s.length;o<a;o++){i=s[o];u.push(r(i,0,true))}return u};de("Group",Ue.extend({},re,ne,{get_private_messages:function(e){return["child_movement"]},initialize:function(e){return oe(e)},check_for_errors:function(e,t){return Je(e,"get_group_data",t)}}));tt=function(e,t,n,r){var i,o,a,s,u;if(!((s=v.element(t.element_id))!=null?s.exists():void 0)){return{}}i=n.find_instance_by_id(t.element_id);o=P.dehydrate_tree(i);a={};a[I.STATES.Message(i,null,"get_group_data")]=r;a[I.ESTATE_PREFIX+o]={group_data:r};if((i!=null?i.element.id():void 0)===((u=C.get_element_parent(e))!=null?u.id():void 0)){a[I.STATES.ElementParent()]=r}return a};A.DisplayGroupData={field_names:{element_id:{},data_source:{}},run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,n){if(e){return r(e)}else{if(n!=null){n.message("set_group_data",t.data_source)}return r()}})},data_to_refresh:function(e,t,n){return tt(e,t,n,t.data_source)}};A.ResetGroup={field_names:{element_id:{}},run:function(e,t,n,r){return Ue.run_once(30,function(){var e;return e=n.element.find_instance_by_id(t.element_id)},function(e,t){if(e){return r(e)}else{if(t!=null){t.message("reset_group")}return r()}})},data_to_refresh:function(e,t,n){return tt(e,t,n,null)}};dt=function(e){var t,n=this;t=e.get_canvas();e.autorun(function(){var t;t=e.state("group_with_focus_workflow_shown")||e.evaluate_property("is_visible");if(t){return e.do_show()}else{return e.do_hide()}});if(e.run_mode()){$("body").click(function(n){if(e.is_visible()&&!$.contains(t[0],n.target)&&t[0]!==n.target&&!e.get_canvas().data("GroupWithFocus_loading")){return e.state("group_with_focus_workflow_shown",false)}});return e.on_message("child_movement",function(t){var n;n=e.element.get_height()+t;return e.get_canvas()[0].style.height=n+"px"})}};Ze=Ue.extend({},re,ne,{display:"Group Focus (old)",workflow_show:function(e){e.state("group_with_focus_workflow_shown",true);e.get_canvas().data("GroupWithFocus_loading",true);return setTimeout(function(){return e.get_canvas().data("GroupWithFocus_loading",false)},1)},workflow_hide:function(e){return e.state("group_with_focus_workflow_shown",false)},initialize:function(e){return dt(e)},check_for_errors:function(e,t){return Je(e,"get_group_data",t)},get_private_messages:function(e){return["child_movement"]},starts_hidden:true});ft=Ue.extend({},Ze);ft.field_names=Ue.extend(ft.field_names,{information:{no_states:true}});de("GroupWithFocus",Ue.extend({},ft));ct=Ue.extend({},Ze);ct.field_names=Ue.extend({},S,{reference:{no_states:true},offset_left:{no_states:true,"default":0},offset_top:{no_states:true,"default":0},fixed_width:{no_states:true,"default":true}});de("GroupFocus",Ue.extend(ct,{display:"Group Focus",defaults:{bgcolor:"#E8E8E8",background_style:"bgcolor",width:250,height:100},initialize:function(e){dt(e);e.on_message("child_movement",function(t){var n;n=e.element.get_height()+t;if(e.is_visible()||!e._has_been_hidden){return e.canvas[0].style.height=n+"px"}});if(e.edit_mode()){return e.wait_for_visible_lite(function(){return e.autorun(function(){var t,n,r,i,o,a,u,l,c,f;i={};c=["reference","offset_left","offset_top"];for(u=0,l=c.length;u<l;u++){r=c[u];i[r]=e.get_static_property(r)}if(!i.reference||!s().visual_edit.edit_canvas.elements[i.reference]||!s().visual_edit.edit_canvas.elements[i.reference].is(":visible")){e.get_canvas().parent(".element").css({top:0,left:0});return}f=s().visual_edit.edit_canvas.elements[i.reference].offset(),a=f.top,t=f.left;n=$(".container.page-element").parent(".non-draggable").offset();o=v.element(i.reference);return e.get_canvas().parent(".element").css({top:a+o.get_height()+i.offset_top-n.top,left:t+i.offset_left-n.left})})})}},property_applications:[new ve.ShortDimensions,new ve.Background,new ve.Border,new ve.BoxShadow,new ve.MinWidth],not_draggable:function(){return true},goes_on_document:function(){return true},starts_hidden:true,not_max_adjustable:true,position_canvas:function(e,t){var n,r,i;if(t.responsive_mode()){r={position:"absolute"};n=Ue.div("r-wrapper groupfocus");n.append(e);s().visual_edit.responsive_canvas.get_current_preview_canvas().find("> .r-wrapper").append(n);t.container.add_to_instances(t);s().visual_edit.responsive_canvas.register_wrapper(t.element_id(),n,true);e.hide()}else if(t.edit_mode()){$(".container.page-element").parent(".non-draggable").append(e);r={position:"absolute"}}else{$(window.document.body).append(e);r={position:"fixed"}}Ue.extend(r,{width:t.element.get_width()+"px",height:t.element.get_height()+"px","z-index":2003+t.element.get_zindex()});h(e,r);if(t.run_mode()||t.responsive_mode()){i=function(e){return Ue.WaitFor(t.get_children_drawn_key(),function(){return t.wait_for_visible_lite(function(){t.get_canvas().css({width:e});return Ae(t,e)})})};i(Ue.real_inner_width(t.get_canvas()));return t.on_resize(function(e){return Ue.run_once(30,function(){return t.find_instance_by_id(t.get_static_property("reference"))},function(n,r){var o,a;if(n){Ue.warn(n);return}if(!r){return}o=r.get_canvas().offset().left+t.get_static_property("offset_left");a=Math.max(t.element.get_min_width(),Math.min(t.element.get_width(),e-20-o));return i(a)})})}},do_show:function(e){var t,n;if(!e._has_been_hidden){return}e._has_been_hidden=false;t=e.get_canvas();if(!e.run_mode()){t[0].style.display="block";if(e.responsive_mode()){n=Ue.div("groupfocus-greyout",s().visual_edit.responsive_canvas.get_current_preview_canvas().find("> .r-wrapper"));h(n,{"background-color":"rgba(0, 0, 0, 0.701961)",top:"0px",left:"0px",position:"absolute",width:"100%",height:n.parents(".res-preview").find(".main-page").height()+"px","z-index":2001+e.element.get_zindex()})}return}return Ue.run_once(30,function(){return e.find_instance_by_id(e.get_static_property("reference"))},function(n,r){var i,o,a;if(n){Ue.warn(n);return}if(!r){return}o=function(){var n,i;n=r.get_canvas().offset().left+e.get_static_property("offset_left");i=r.get_canvas().offset().top+r.get_canvas().height()+e.get_static_property("offset_top")-$(window).scrollTop();return t.css({top:i,left:n})};o();t[0].style.display="block";e._is_visible_me=true;e._update_visible();if(!Ue.is_on_mobile_or_tablet()){a=null;$(window).off("resize.groupfocus"+e.toUniqueString());$(window).on("resize.groupfocus"+e.toUniqueString(),function(){var t;t=$(window).width();if(a!==t){a=t;if(e.is_visible()&&!e.get_canvas().data("GroupWithFocus_loading")){return e.state("group_with_focus_workflow_shown",false)}}})}if(Ue.is_on_mobile_or_tablet()){i="touchmove.groupfocus"+e.toUniqueString()+" touchend.groupfocus"+e.toUniqueString()}else{i="scroll.groupfocus"+e.toUniqueString()}$(window).off(i);return $(window).on(i,o)})},do_hide:function(e){var t;if(e._has_been_hidden){return}e._has_been_hidden=true;t=e.get_canvas();t[0].style.display="none";e._is_visible_me=false;e._update_visible();$(window).off("resize.groupfocus"+e.toUniqueString());$(window).off("scroll.groupfocus"+e.toUniqueString());if(e.responsive_mode()){return s().visual_edit.responsive_canvas.get_current_preview_canvas().find("> .r-wrapper").find(".groupfocus-greyout").remove()}}}));Q=function(e){var t,n,r;if(!e.state("greyout")){if(e.edit_mode()){n=$(".canvas");r="absolute"}else if(e.responsive_mode()){n=s().visual_edit.responsive_canvas.get_current_preview_canvas().find("> .r-wrapper");r="absolute"}else{n=$(document.body);r="fixed"}t=Ue.div("greyout",n);t[0].style.display="none";e.state("greyout",t);e.on_destroy(function(){return t.remove()});h(t,{top:"0px",left:"0px",position:r,width:"100%",height:"100%","z-index":2001,"background-color":"rgba(0,0,0,0.7)"})}return e.state("greyout")};H=function(e){var t,n;t=e.get_canvas();if(e.edit_mode()){n=$(".element",$(D.VISUAL_CANVAS)).not($(".element.Popup,.element.CustomElement.non-draggable",$(D.VISUAL_CANVAS))).not($("*",$(".element.Popup,.element.CustomElement.non-draggable")))}if(e.run_mode()){n=$(".bubble-element",$(".main-page,.floating-group")).not($(".element.Popup,.element.CustomElement.non-draggable",$(".main-page"))).not($("*",$(".element.Popup,.element.CustomElement.non-draggable")))}return n!=null?n.add(".stripe-container"):void 0};p=function(e,t){var n,r;if(Ue.is_on_mobile_or_tablet()){return}n=H(e);r="blur("+t+"px)";return n!=null?n.css({"-webkit-filter":r,filter:r}):void 0};xe=function(e){var t;if(Ue.is_on_mobile_or_tablet()){return}t=H(e);return t!=null?t.css({"-webkit-filter":"none",filter:"none"}):void 0};m=function(e,t){var n;n=Q(e);return n[0].style["background-color"]=t};E.greyout_field_names={prevent_user_from_closing_through_esc:{no_states:true},greyout_color:{"default":"rgba(0,0,0,0.7)",no_states:true,in_style:true},greyout_blur:{"default":0,no_states:true,in_style:true}};E.get_greyout_properties=function(){return[{name:"prevent_user_from_closing_through_esc",caption:"This popup can't be closed by pressing 'Esc'",editor:"Checkbox",pretty:{short_caption:false,section:"Background"}},{name:"greyout_color",caption:"Grayout color",editor:"Color",add_opacity:true,pretty:{short_caption:false,section:"Background"}},{name:"greyout_blur",caption:"Grayout blur",editor:"Dropdown",numerical_step:.1,set:s().sets.Numeric([0,.5,1,1.5,2,2.5,3,4,5,6,7,8,9,10]),pretty:{short_caption:false,section:"Background"}}]};at=function(){if(Ue.is_on_mobile_or_tablet()){return"50px"}else{return"100px"}};ot=function(e,t){var n,r;if(e._has_been_hidden){return}n=e.get_canvas();if(t==null){t=n.height()}if(t>$(window).height()-100){r="absolute";$("body")[0].style.overflow="visible";if(Ue.on_phonegap()){$(window).off("touchmove.popup_opened")}}else if(!e.responsive_mode()){r="fixed";$("body")[0].style.overflow="hidden";if(Ue.on_phonegap()){if(!e.element.find_elements_custom("RepeatingGroup").length){$(window).on("touchmove.popup_opened",function(e){return e.preventDefault()})}}}n[0].style.position=r;if(r==="absolute"){if(!e.state("has_been_absolutely_positionned")){e.state("has_been_absolutely_positionned",true);return n[0].style.top=$(window).scrollTop()+50+"px"}}else{return n[0].style.top=at()}};Ee=function(e,t){e.get_canvas()[0].style["margin-left"]="-"+t/2+"px";e.get_canvas()[0].style.width=t+"px";return Ue.WaitFor(e.get_children_drawn_key(),function(){return Ue.run_once(30,function(){return ve.calculate_border_width(e)},function(n,r){e.child_container.resize_width(t-r);return e.wait_for_visible(function(){return setImmediate(function(){var n;e.child_container.resize_width((n=Ue.real_inner_width(e.get_canvas()))!=null?n:t-r);return ot(e)})})})})};de("Popup",{category:"containers",defaults:{bgcolor:"#FFFFFF",background_style:"bgcolor",border_style:"none",border_roundness:3,boxshadow_style:"outset",boxshadow_horizontal:2,boxshadow_vertical:2,boxshadow_blur:4,boxshadow_color:"#000000",width:500,height:350},field_names:Ue.extend({},Re,E.greyout_field_names,S),not_draggable:function(){return true},property_applications:[new ve.ShortDimensions,new ve.Border,new ve.BoxShadow,new ve.Background,new ve.MinWidth],get_min_width:function(){return 0},not_max_adjustable:true,get_html:function(e){return"<div></div>"},change_cursor_style_if_clickable:true,container_names:function(){return["elements"]},get_container_canvas:function(e,t){return e.get_canvas()},goes_on_document:function(){return true},initialize:function(e){var t,n;if(e.run_mode()){e.get_canvas()[0].style.display="none"}e.on_property_change("greyout_color",function(t){return m(e,t)});e.on_property_change("greyout_blur",function(t){var n=this;if(t!==null&&t!==void 0&&t!==0){return e.wait_for_visible(function(){return p(e,t)})}});n=0;e.on_message("child_movement",function(t){n=t;return e.wait_for_visible(function(){var t;t=e.element.get_height()+n;ot(e,t);return e.get_canvas()[0].style.height=t+"px"})});t=function(t){var n,r,i,o;o=e.element.get_related_workflows(t);n={element:e};r=s().workflow.run_workflows(n,o,true);i=Be.show_progress_line(r);return r.then(i,function(e){i();return T.handle_uncaught_error(e,function(e){if(e){return window.alert(Ue.human_friendly(e))}})})};e.on_message("popup_closed",function(){return t("PopupClosed")});e.on_message("popup_opened",function(){return t("PopupOpened")});return e.on_destroy(function(){var t;if((t=e.get_static_property("greyout_blur"))!==null&&t!==void 0&&t!==0||e.edit_mode()){return xe(e)}})},check_for_errors:function(e,t){return Je(e,"get_group_data",t)},is_input:false,is_container:true,add_an_invisible_div_on_the_top:false,events:["ButtonClicked","PopupClosed","PopupOpened"],get_state_value:function(e,t){return ze(e,t)},position_canvas:function(e,t){var n,r,i,o;if(t.responsive_mode()){i="absolute";n=Ue.div("r-wrapper popup");n.append(e);s().visual_edit.responsive_canvas.get_current_preview_canvas().find("> .r-wrapper").append(n);t.container.add_to_instances(t);s().visual_edit.responsive_canvas.register_wrapper(t.element_id(),n,true);e.hide()}else if(t.edit_mode()){$(".canvas").append(e);i="absolute"}else{$(window.document.body).append(e);i="fixed"}o=t.element.get_width();h(e,{height:t.element.get_height()+"px",top:at(),position:i,left:"50%","z-index":2002});e.data("overwrite-left","50%");if(t.run_mode()||t.responsive_mode()){r=function(e){if(t.run_mode()){if(e==null){e=$(window).width()}}else if(t.responsive_mode()){if(e==null){e=s().visual_edit.responsive_canvas.current_width_without_dependency}}return Math.max(t.element.get_min_width(),Math.min(t.element.get_width(),e-20))};Ee(t,r());return t.on_resize(function(e){return Ee(t,r(e))})}else{return h(e,{width:o+"px","margin-left":"-"+o/2+"px"})}},do_show:function(e){var t,n,r,i,o=this;e._has_been_hidden=false;e.state("has_been_absolutely_positionned",false);t=e.get_canvas();r=e.element.id();n=Q(e);m(e,e.get_static_property("greyout_color"));if((i=e.get_static_property("greyout_blur"))!==null&&i!==void 0&&i!==0||e.edit_mode()){p(e,e.get_static_property("greyout_blur"))}if(e.run_mode()){ot(e);return Ue.run_once(30,function(){return{height:e.evaluate_property("height"),width:e.evaluate_property("width")}},function(r,i){var o,a,s,u=this;o=i.height,s=i.width;ot(e,o);h(t,{opacity:0,"margin-left":"-"+s/2+"px",width:s+"px"});a=Math.max(e.element.get_min_width(),Math.min(s,$(window).width()-20));Ee(e,a);t[0].style.display="block";Ue.velocity(t,"fadeIn",{duration:300});h(n,{opacity:0,display:"block"});Ue.velocity(n,"fadeIn",{duration:300,complete_cb:function(){n[0].style.top="-1px";return setTimeout(function(){return n[0].style.top="0px"},151)}});setTimeout(function(){var t,n,r,i,o,a,s;i=[];n=false;r=function(e){var t,o,a,s,u;u=(s=e.children)!=null?s:[];for(o=0,a=u.length;o<a;o++){t=u[o];if(vt.call(t.element.get_messages(),"set_focus")>=0){if(t.get_canvas().is(":focus")){n=true;return}i.push(t)}r(t)}};r(e);if(n){return}i=function(){var e,n,r;r=[];for(e=0,n=i.length;e<n;e++){t=i[e];if(t.get_canvas().attr("tabindex")&&t.is_visible()){r.push(t)}}return r}();i.sort(function(e,t){if(e.get_canvas().attr("tabindex")<=t.get_canvas().attr("tabindex")){return-1}else{return 1}});s=[];for(o=0,a=i.length;o<a;o++){t=i[o];if(t.is_visible()){t.message("set_focus");break}else{s.push(void 0)}}return s},400);if(!e.get_static_property("prevent_user_from_closing_through_esc")){$(document).off("keydown.escape");$(document).on("keydown.escape",function(t){if(t.keyCode===27){e.do_hide();$(document).off("keydown.escape")}});n.off("click");n.on("click",function(){return e.do_hide()})}return e.message("popup_opened")})}else{t[0].style.display="block";if(!e.thumbnail_mode()){n[0].style.display="block"}if(e.responsive_mode()){n[0].style.height=n.parents(".res-preview").find(".main-page").height()+"px";Ue.run_once(30,function(){return e.evaluate_property("width")},function(t,n){var r;r=s().visual_edit.responsive_canvas.current_width_without_dependency;n=Math.max(e.element.get_min_width(),Math.min(n,r-20));return Ee(e,n)})}if(e.edit_mode()){return n.click(function(){return s().visual_edit.turn_element_on(e.element_id(),false)})}}},do_hide:function(e){var t,n,r,i=this;e._has_been_hidden=true;if(Ue.on_phonegap()){$(window).off("touchmove.popup_opened")}t=e.get_canvas();n=Q(e);if((r=e.get_static_property("greyout_blur"))!==null&&r!==void 0&&r!==0||e.edit_mode()){xe(e)}if(!e.edit_mode()&&t.is(":visible")){Ue.velocity(t,"fadeOut",{duration:300,complete_cb:function(){return t[0].style.display="none"}});Ue.velocity(n,"fadeOut",{duration:300,complete_cb:function(){return n[0].style.display="none"}});e.message("popup_closed")}else{t[0].style.display="none";n[0].style.display="none"}return $("body")[0].style.overflow="visible"},get_private_messages:function(e){return["popup_opened","popup_closed","child_movement"]},starts_hidden:true,modal:function(){return true}});F={element_id:{}};A.ShowElement={field_names:Ue.extend({},F),run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,t){if(e){Ue.warn(e)}if(t!=null){t.workflow_show()}return r()})},data_to_refresh:null};A.HideElement={field_names:Ue.extend({animation:{no_states:true,"default":"none"},direction:{no_states:true,"default":"left"}},F),run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,t){if(e){Ue.warn(e)}if(t!=null){t.workflow_hide()}return r()})},data_to_refresh:null};A.ToggleElement={field_names:Ue.extend({},F),run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,t){if(t){if(t.is_visible()){t.workflow_hide()}else{t.workflow_show()}}return r()})},data_to_refresh:null};A.SetCustomState={field_names:Ue.extend({value:{optional:true},custom_state:{}},F),run:function(e,t,n,r){return Ue.run_once(30,function(){var e,r,i;e=n.element.find_instance_by_id(t.element_id);r={element:e,make_static:e!=null?e.element.element_custom_state(t.custom_state).make_static():void 0};if(r.make_static){r.all=(i=t.value)!=null?typeof i.make_static==="function"?i.make_static():void 0:void 0}return r},function(e,n){var i,o,a,s;o=n.element,a=n.make_static,i=n.all;if(a&&i){s=i}else{s=t.value}if(o!=null){o.state(t.custom_state,s!=null?s:null)}return r()})},data_to_refresh:function(e,t,n){var r,i,o,a,s,u,l;if(!((u=v.element(t.element_id))!=null?u.exists():void 0)){return{}}a={};i=n.find_instance_by_id(t.element_id);if(i&&t.custom_state){o=P.dehydrate_tree(i);r=i.element.element_custom_state(t.custom_state);if(r.make_static()&&((l=t.value)!=null?l.all:void 0)!=null){s=t.value.make_static()}else{s=t.value}a[I.STATES.Message(i,null,r.name())]=s!=null?s:null}return a}};E.floating_field_names={floating_reference:{"default":"top",no_states:true},floating_reference_horizontal:{"default":"none",no_states:true}};E.floating_group_fields=function(){return[]};de("FloatingGroup",{display:"Floating Group",category:"containers",defaults:{floating_reference:"top",width:400,height:250},field_names:Ue.extend({},E.floating_field_names,Re,S),property_applications:[new ve.Dimensions,new ve.Background,new ve.Border,new ve.BoxShadow,new ve.MinWidth],added_to_container:function(e){return e.parent().type()!=="Page"},get_min_width:function(){return 0},goes_on_document_for_drawing:function(){return true},position_canvas:function(e,t){var n,r,i=this;n=t.element;r=t.element.parent();if(!(t.run_mode()||t.responsive_mode())||r.type()!=="Page"){t.container.add(t,true);t.container.container_canvas.append(t.get_canvas());t.wait_for_visible_lite(function(){h(t.get_canvas(),{position:"absolute",width:t.element.get_width()+"px",top:t.element.get_top()+"px",left:t.element.get_left()+"px",height:t.element.get_height()+"px"});return Ue.WaitFor(t.get_children_drawn_key(),function(){return Ae(t)})});return}if(t.responsive_mode()){t.container.wrap(t);t.container.add_to_instances(t);e=t.container.to_canvas(t)}return t.wait_for_visible_lite(function(){var i,o,a,s,u,l,c,f,d,_,p,h,g;if(n.root().use_responsive_algorithm()&&!n.root().get_static_property("fixed_width")){i=function(){var i,o,a,s,u,l,c,f,d,_,p,h,g;u=n.get_width();d=n.get_min_width();f=n.get_max_width();l=n.get_left();i=t.container.container_width;s=r.get_container_width();p=s-(l+u);g=l+p;o=u-d;h=s-i;if(o===0){a=1}else if(o>=h){a=(o-h)/o;h=0}else{a=0;h-=o}if(g===0||h===0){c=1}else if(g>=h){c=(g-h)/g}else{c=0}e.css("left",l*c);_=d+o*a;if(f){_=Math.min(_,f)}e.css("width",_);return Ue.WaitFor(t.get_children_drawn_key(),function(){return Ae(t,_)})};t.container.on("resize_width",i);return Ue.WaitFor(t.container.flow_created,function(){var o,a,s,u,l,c,f;s=n.get_height();a=n.get_static_property("floating_reference");u=void 0;if(a==="bottom"||a==="top"||a==="both"){l=t.responsive_mode()?"absolute":"fixed";if(a==="top"){c=n.get_top();o=void 0}else if(a==="bottom"){c=void 0;o=r.get_height()-n.get_top()-n.get_height();if(Ue.is_debug_mode()){o+=50}}else if(a==="both"){c=n.get_top();o=r.get_height()-n.get_top()-n.get_height();if(Ue.is_debug_mode()){o+=50}s=void 0;u="auto"}}else{l="absolute";c=n.get_top();o=void 0}f=$(".greyout").css("z-index")-500;if(!f||f<=0){f=2}if(t.responsive_mode()){t.container.container_canvas.append(e)}else{$("body").append(e)}e.addClass("floating-group");e.css({position:l,"z-index":f+t.element.get_zindex(),height:s,top:c,bottom:o,"overflow-y":u});return i()})}else{_=l=n.get_top();f=a=n.get_left();c=n.get_height();p=n.get_width();switch(n.get_static_property("floating_reference_horizontal")){case"left":a=f;u=void 0;break;case"right":u=r.get_width()-f-p;a=void 0;break;default:a="50%";s=-r.get_width()/2+f}if((g=n.get_static_property("floating_reference"))==="bottom"||g==="top"){d="fixed";switch(n.get_static_property("floating_reference")){case"top":l=n.get_top();o=void 0;break;case"bottom":o=r.get_height()-_-c;l=void 0}}else{d="absolute"}h=$(".greyout").css("z-index")-500;if(!h||h<=0){h=2}$("body").append(e);e.addClass("floating-group");e.css({position:d,"z-index":h+t.element.get_zindex(),width:p,height:c,top:l,bottom:o,left:a,right:u,"margin-left":s});if(n.root().use_responsive_algorithm()){return Ue.WaitFor(t.get_children_drawn_key(),function(){return Ae(t,p)})}}})},initialize:function(e){if(e.get_static_property("floating_reference")!=="both"){return e.on_message("child_movement",function(t){var n;n=e.element.get_height()+t;return e.get_canvas().height(n)})}},check_for_errors:function(e,t){return Je(e,"get_group_data",t)},is_input:false,is_container:true,add_an_invisible_div_on_the_top:false,get_html:function(e){return"<div></div>"},change_cursor_style_if_clickable:true,container_names:function(){return["elements"]},get_container_canvas:function(e,t){return e.get_canvas()},get_state_value:function(e,t){return ze(e,t)},get_private_messages:function(){return["child_movement"]},events:["ButtonClicked"]});it=function(e){return function(t){var n,r,i,o,a;if(t.get_static_property("four_border_style",true)){i=0;for(o=0,a=e.length;o<a;o++){n=e[o];r=t.get_static_property("border_style"+n,true);if(r&&r!=="none"){i+=t.get_static_property("border_width"+n,true)}}return i}else{r=t.get_static_property("border_style",true);if(r&&r!=="none"){return 2*t.get_static_property("border_width",true)}else{return 0}}}};Z=it(["_left","_right"]);X=it(["_top","_bottom"]);lt=function(e){var t;return e.get_static_property("seperator_width",true)*((t=e.get_static_property("seperator_style",true))===void 0||t===null||t==="none"?0:1)};E._get_cell_width=et=function(e){var t,n;n=lt(e);t=e.get_static_property("columns");return(e.get_width()-n*(t-1)-Z(e))/t};E._get_cell_height=function(e){var t,n;n=lt(e);t=e.get_static_property("rows");return(e.get_height()-n*(t-1)-X(e))/t};r="#CCCCCC";l=500;de("RepeatingGroup",{display:"Repeating Group",category:"containers",defaults:{width:300,height:350},field_names:{group_type:{no_states:true},data_source:{},rows:{"default":4,no_states:true},columns:{"default":1,no_states:true},seperator_style:{"default":"dashed",no_states:true,in_style:true},seperator_width:{"default":1,no_states:true,in_style:true},seperator_color:{"default":"#969696",no_states:true,in_style:true},layout_style:{"default":"infinite_scroll",no_states:true},cell_min_width:{no_states:true,"default":100},fixed_width:{no_states:true},use_max_width:{no_states:true,"default":false},max_width:{"default":100,optional:true,no_states:true},allow_more_than_one_colum:{"default":false,no_states:true},responsive_alignment:{"default":"center",no_states:true}},property_applications:[new ve.Dimensions,new ve.Border,new ve.BoxShadow,new ve.Background],get_html:function(e){return"<div></div>"},get_container_width:function(e){var t,n,r;t=e.get_static_property("columns");n=e.get_static_property("seperator_width",true)*((r=e.get_static_property("seperator_style",true))===void 0||r===null||r==="none"?0:1);return(e.get_width()-n*(t-1)-Z(e))/t},get_min_width:function(e){var t,n,r;if(e.get_static_property("fixed_width")){return e.get_width()}else{n=e.get_static_property((r="cell_min_width")!=null?r:0);t=et(e);if(n>t){return t}else{return n}}},notify_width:function(e,t){var n,r,i,o,a,s,u,l,c,f,d,_,p,h,g;if(!e.get_static_property("fixed_width")){f=lt(e.element);u=e.get_static_property("columns");o=et(e.element);if(e.get_static_property("layout_style")!=="horizontal_scroll"){if(t){if(u===1&&!e.get_static_property("allow_more_than_one_colum")){r=1;n=t-Z(e)}else{a=e.element.get_min_width();d=(t-f*(u-1)-Z(e))/u;if(d<a){n=a;r=Math.floor(t/n)}else{if(t>e.element.get_width()){n=o}else{n=d}}r=Math.max(Math.floor(t/n),1);n=(t-f*(r-1)-Z(e))/r;c=t-Z(e)-r*n-f*(r-1);n=n+c/r}e.columns=r;e.cell_width=n;g=(h=e.children)!=null?h:[];for(s=_=0,p=g.length;_<p;s=++_){i=g[s];e.message("resize_cell",s+1,i,n)}if(i!=null){i.message("child_shown")}if(e.responsive_mode()){return e.message("resize_dummies",n)}}}else{l=e.get_canvas().scrollLeft();e.get_canvas().find("> .rows").css("width",e.last_cell*o+(e.last_cell-1)*f+10);e.get_canvas().scrollLeft(l);if(e.responsive_mode()){return e.message("resize_dummies",n)}}}},change_cursor_style_if_clickable:true,container_names:function(){return["elements"]},get_container_canvas:function(e,t){return $("> .list-item",e.get_canvas())},is_input:false,is_container:false,add_an_invisible_div_on_the_top:false,get_states:function(e){return["list_data","show_range","loading"]},add_specific_messages:function(e,t){var n;n=t.get_state_value("list_data");if(n){return Ue.extend(e,{get_list_data:{description:"'s "+n.display(),ret_value:n,fn:function(e,t){return e!=null?e.state("list_data"!=null?"list_data":new P.StaticList([])):void 0}},get_loading_status:{description:" is loading",ret_value:"boolean",fn:function(e,t){return e!=null?e.state("loading"):void 0}}})}},get_messages:function(e){return["set_list_data","clear_list","show_previous","show_next","draw_till","scroll_to","go_to_page","resize_cell","resize_dummies"];
},draw_children:function(e){},initialize:function(e){var t,n,i,o,u,c,f,d,_,p,g,m,v,y,b,w,x,k,S,A,M,T,C,j,D,O,I,R=this;i=e.get_canvas();o=function(){var t;return(t=e.columns)!=null?t:e.get_static_property("columns")};C=function(){if(e.get_static_property("layout_style")==="horizontal_scroll"){return 1}else{return e.get_static_property("rows")}};A=function(e){return Math.floor((e-1)/o())+1};S=function(e){return(e-1)%o()+1};v=function(t){if(e.get_static_property("layout_style")==="horizontal_scroll"){return false}else{return A(t)>1}};m=function(t){if(e.get_static_property("layout_style")==="horizontal_scroll"){return t>1}else{return S(t)>1}};y=false;D=1;O=function(){return e.edit_mode()&&e.state("show_borders")&&(e.get_static_property("seperator_width")===0||e.get_static_property("seperator_style")==="none")};_=function(){if(O()){return D}else{return lt(e.element)}};d=function(){return(e.element.get_width()-_()*(o()-1)-Z(e))/(o()+0)};f=function(){return(e.element.get_height()-_()*(C()-1)-Z(e))/(C()+0)};g=function(){return e.element.get_zindex()};n=function(t,n){if(v(t)){h(n,{"border-top-width":_()+"px","border-top-color":O()?r:e.get_static_property("seperator_color"),"border-top-style":O()?"solid":e.get_static_property("seperator_style")})}else{n[0].style["border-top-style"]="none"}if(m(t)){return h(n,{"border-left-width":_()+"px","border-left-color":O()?r:e.get_static_property("seperator_color"),"border-left-style":O()?"solid":e.get_static_property("seperator_style")})}else{return n[0].style["border-left-style"]="none"}};I=void 0;p=function(){var t,n;if(I==null){if((n=e.get_static_property("layout_style"))==="show_all"||n==="vertical_extendable"||n==="limit_items"){I=0}else{t=Ue.div("div-for-scrollbar",$("body"));t.css("overflow-y","scroll");I=Math.max(t[0].offsetWidth-t[0].clientWidth,0);t.remove()}}return I};w=function(e,t){h(t.canvas,{"float":"left",position:"relative","box-sizing":"border-box","-moz-box-sizing":"border-box","z-index":g(),height:f()+(v(e)?_():0)+"px"});return T(e,t)};T=function(t,r,i){var a,s,u;a=(s=i!=null?i:e.cell_width)!=null?s:d();if(e.get_static_property("layout_style")!=="horizontal_scroll"){if(S(t)===o()){if(o()>1){a-=p()+1}}}h(r.canvas,{width:a+(m(t)?_():0)+"px"});n(t,r.canvas);if(r!=null){if((u=r.child_container)!=null){u.resize_width(a)}}return setImmediate(function(){var e;return r!=null?(e=r.child_container)!=null?e.resize_width(a):void 0:void 0})};c=function(){var t;if(e.edit_mode()||e.thumbnail_mode()){t=$("> .list-dummy",i)}else{if($("> .rows",i).length){t=$("> .rows > .list-dummy",i)}else{t=$("> .list-dummy",i)}}return t};e.on_message("resize_cell",function(e,t,n){return T(e,t,n)});e.on_message("resize_dummies",function(e){var t,n,r,i,o,a;o=c();a=[];for(n=r=0,i=o.length;r<i;n=++r){t=o[n];a.push(T(n+1,{canvas:$(t)},e))}return a});b=function(){var e;return(typeof window!=="undefined"&&window!==null?(e=window.BrowserDetect)!=null?e.OS:void 0:void 0)==="Windows"};if(!(e.run_mode()||e.responsive_mode())){x=Ue.div("list-item",e.canvas)}u=function(){return Ue.wait_for_updates(function(){return setTimeout(function(){var t,n;t=c();if(e.edit_mode()||e.thumbnail_mode()){t.html(x.html())}else if(e.responsive_mode()){t.html((n=e.children)!=null?n[0].canvas.html():void 0)}t.find(".resize-handle").remove();t.find(".element").css({"-webkit-box-shadow":"none","box-shadow":"none","-moz-box-shadow":"none"});t.find(".element").removeClass("element");return t.find(".container").removeClass("container")},100)})};k=t=null;e.wait_for_visible_lite(function(){var r,c,g,m,v,S,A,E,M,T,j,D,O,I,P,R,z,B;if(e.run_mode()||e.responsive_mode()){T=e.get_static_property("layout_style");e.children=[];A=[];v=function(t,r){var i,o,s;if(!(e.responsive_mode()&&t>1)){s=new a(e,f(),t);i=L.ElementInstance(s,m,e.mode);i.state("group_data",L.STATE_NOT_READY);i.drawn_key=Ue.MakeKey(null,"cell_drawn");s.instance=i;e.children.push(i);i.state("cell_index",t);i.draw();w(t,i);n(t,i.canvas);i.do_hide();i.drawn_key.turn()}if(T!=="show_all"){o=Ue.div("list-dummy",r);w(t,{canvas:o});n(t,o);return A.push(o)}};S=function(t,n){var r,i=this;r=null;return e.autorun(function(){var i,a,s,u,l,c,f,p,h,g,m,v,b,w,x,k,S,E,M,j,D,O,P;if(!e.is_visible()){if(typeof r==="function"){r()}return}e.state("loading",true);if(!r){r=Be.spinner(e)}c=e.state("list_data");g=t();u=n();l=(S=c!=null?typeof c.get_children==="function"?c.get_children(g,u):void 0:void 0)!=null?S:[];l=function(){var e,t,n;n=[];for(e=0,t=l.length;e<t;e++){s=l[e];if(s!=null){n.push(s)}}return n}();if(typeof r==="function"){r()}r=null;e.state("loading",false);for(p=v=0,k=l.length;v<k;p=++v){s=l[p];if(e.children[p]!=null){(function(t,n){var r,i;r=e.children[n];Ue.WaitFor(Ue.page_loaded_key,function(){return r.can_register_workflows().turn()});r.message("set_group_data",t);r.do_show();if(T==="show_all"||T==="vertical_extendable"){r.message("child_shown")}return(i=A[n])!=null?i[0].style.display="none":void 0})(s,p)}}e.last_cell=p;i=e.children[p-1];if(i&&(T==="show_all"||T==="vertical_extendable")){i.message("child_shown")}a=p;if(T!=="show_all"&&T!=="vertical_extendable"){m=C()*o();for(h=b=a,E=A.length;a<=E?b<E:b>E;h=a<=E?++b:--b){if(h<m){if((M=A[h])!=null){M[0].style.display="block"}}if((j=e.children[h])!=null){j.do_hide()}}if((T==="infinite_scroll"||T==="horizontal_scroll")&&a<A.length){for(h=w=a,D=A.length;a<=D?w<D:w>D;h=a<=D?++w:--w){A[h][0].style.display="none"}}}else{for(f=x=a,O=e.children.length;a<=O?x<O:x>O;f=a<=O?++x:--x){e.children[f].do_hide();if(T==="vertical_extendable"){if((P=A[f])!=null){P[0].style.display="none"}}}if(a<e.children.length){e.children[e.children.length-1].message("child_shown")}}if(T==="horizontal_scroll"){I[0].style.width=p*d()+(p-1)*_()+10+"px"}if(c!=null&&T==="limit_items"&&o()===1&&C()===1){if(e.state("show_range")===(c!=null?c.length():void 0)&&c.length()>1){e.state("show_range",c.length()-1)}}if(y){return Ue.wait_for_updates(function(){return e.get_children_drawn_key().turn()})}})};if(T==="infinite_scroll"||T==="horizontal_scroll"||T==="show_all"||T==="vertical_extendable"){D=0;I=Ue.div("rows",i);if(T==="infinite_scroll"){I[0].style["min-height"]=e.element.get_height()+1+"px"}t=function(t){var n,r,i;if(t>D){for(n=r=i=D+1;i<=t?r<=t:r>=t;n=i<=t?++r:--r){v(n,I)}D=t;e.last_cell=D}if(T==="horizontal_scroll"){return I[0].style.width=t*d()+(t-1)*_()+10+"px"}};m=e.container.create_child(e,I);if(T==="infinite_scroll"||T==="horizontal_scroll"||T==="vertical_extendable"){E=e.element.get_height()-Z(e);g=f()+_();c=i.height();O={"overflow-scrolling":"touch","-webkit-overflow-scrolling":"touch"};if(!e.responsive_mode()){if(T==="infinite_scroll"){if(b()){O["overflow-y"]="scroll"}else{O["overflow-y"]="auto"}}else if(T==="vertical_extendable"){O["overflow-y"]="hidden"}else if(T==="horizontal_scroll"){if(b()){O["overflow-x"]="scroll"}else{O["overflow-x"]="auto"}if(ce.is_rtl(ce.app_language())){O["direction"]="ltr"}}}else{O["overflow-y"]="hidden"}h(i,O);I[0].style.float="left";if(T==="vertical_extendable"){M=function(){var e;e=Math.ceil(($(window).scrollTop()+$(window).height()-i.offset().top)/f());return o()*Math.max(C(),e)-1};k=Ue.Box(M());setTimeout(function(){var e;e=M()-k();if(e>0){return r(e)}},100)}else{k=Ue.Box(C()*o())}R=false;P=Ue.is_on_mobile_or_tablet()||p()>0?"scroll":"DOMMouseScroll mousewheel";r=function(n,r){if(n==null){n=1}R=true;return Ue.run_once(30,function(){var t,r;return(t=(r=e.state("list_data"))!=null?r.get_children(k(),n):void 0)!=null?t:[]},function(e,i){var a,s;if(e){Ue.warn(e);R=false;return}if(i.length){s=Math.min(i.length,n);if(T==="infinite_scroll"){a=o()}else{a=0}t(k()+s+a);k(k()+s+a-1);return Ue.wait_for_updates(function(){return R=false})}else{R=false;return typeof r==="function"?r():void 0}})};if(T==="infinite_scroll"||T==="horizontal_scroll"){i.on(P,function(e){var t,n,a,s;n=$(window).height();if(T==="infinite_scroll"){if(!(Ue.is_on_mobile_or_tablet()||((a=window.BrowserDetect)!=null?a.OS:void 0)==="Windows")){t=i.offset().top+c;if(R&&t<$(window).scrollTop()+n){e.preventDefault();return}else if(((s=e.originalEvent)!=null?s.wheelDelta:void 0)<0&&t>$(window).scrollTop()+n){i[0].style["overflow-y"]="hidden";return}else{i[0].style["overflow-y"]="auto"}}if(i.scrollTop()+E>parseInt(I.css("height").replace("px",""))-50){return r(2*o())}}else if(T==="horizontal_scroll"){if(R){e.preventDefault();return}if(i.scrollLeft()+i.width()>parseInt(I.css("width").replace("px",""))-d()){return r(2,function(){return I.css("width",(k()+1)*d()+k()*_())})}}})}else if(T==="vertical_extendable"){$(window).on("DOMMouseScroll mousewheel scroll",function(e){var t;t=i.offset().top+i.height();if(R){return}setTimeout(function(){var e;if(t<$(window).scrollTop()+$(window).height()+100){e=Math.floor(($(window).scrollTop()+$(window).height()-t)/f()+2);return r(Math.max(e,2)*o())}},50)})}t(k()+1);return S(function(){return 0},function(){return k()+1})}else{I[0].style.overflow="hidden";k=Ue.Box(null,true);S(function(){return 0},function(){return k()});return e.autorun(function(){var n,r,i;n=Math.min((r=(i=e.state("list_data"))!=null?i.length():void 0)!=null?r:0,l);t(n);k(n);if(n===0){return e.set_height(0)}})}}else{m=e.container.create_child(e,e.canvas);for(j=z=1,B=C()*o();1<=B?z<=B:z>=B;j=1<=B?++z:--z){v(j,e.canvas)}return S(function(){return e.state("show_range")},function(){return C()*o()})}}else{if(e.thumbnail_mode()){e.draw_children()}e.autorun(function(){var t,r,a,s;w(1,{canvas:x});n(1,x);i.find(".list-dummy").remove();for(r=a=2,s=o()*C();2<=s?a<=s:a>=s;r=2<=s?++a:--a){if(!(o()*C()>=2)){continue}t=Ue.div("list-dummy",i);w(r,{canvas:t});n(r,t)}if(e.edit_mode()){return u()}});return e.autorun(function(){var t,n,r,i;i=e.element.elements();for(n=0,r=i.length;n<r;n++){t=i[n];t.json.register_dependency();s().visual_edit.turned_on(t.id())}return u()})}});M=null;j=function(t){var n;if(t!==void 0){y=true}if(t&&t.dehydrate){n=t.dehydrate()}else{n="no data";t=null}if(n!==M){M=n;e.state("list_data",t);return e.state("show_range",0)}};if(e.responsive_mode()){return setImmediate(function(){var t;return j(new P.StaticList([new P.SampleObject((t=e.get_static_property("group_type"))!=null?t:"user")]))})}else if(e.run_mode()){e.autorun(function(){var t;if(!e.state("datasource_changed_by_workflow_action")){t=e.evaluate_property("data_source");return j(t)}});e.on_message("set_list_data",function(t){e.state("datasource_changed_by_workflow_action",true);return j(t)});e.on_message("clear_list",function(){var t,n,r,i,o,a,s;e.state("datasource_changed_by_workflow_action",false);n=e.get_static_property("layout_style");if(n==="limit_items"){e.state("show_range",0)}else if(n==="infinite_scroll"){e.get_canvas().scrollTop(0)}else if(n==="horizontal_scroll"){e.get_canvas().scrollLeft(0)}a=(o=e.children)!=null?o:[];s=[];for(r=0,i=a.length;r<i;r++){t=a[r];s.push(E.reset_inputs_and_groups(t))}return s});e.on_message("show_next",function(t){var n=this;if(t==null){t=false}return Ue.run_once(30,function(){var t;return(t=e.state("list_data"))!=null?t.length():void 0},function(n,r){var i,a;if(n){Ue.warn(n);return}a=C()*o();i=e.state("show_range");i+=a;if(i===r&&t){i=0}else if(i+a>r){i=r-a;if(i<0){i=0}}return e.state("show_range",i)})});e.on_message("show_previous",function(t){var n=this;if(t==null){t=false}return Ue.run_once(30,function(){var t;return(t=e.state("list_data"))!=null?t.length():void 0},function(n,r){var i,a;if(n){Ue.warn(n);return}a=C()*o();i=e.state("show_range");if(i===0&&t){i=Math.max(r-a,0)}else{i-=a;if(i<0){i=0}}return e.state("show_range",i)})});e.on_message("go_to_page",function(t){var n=this;return Ue.run_once(30,function(){var t;return(t=e.state("list_data"))!=null?t.length():void 0},function(n,r){var i,a;if(n){Ue.warn(n);return}a=C()*o();i=(t-1)*a;if(i+a>r){i=r-a;if(i<0){i=0}}return e.state("show_range",i)})});e.on_message("draw_till",function(n){var r;r=e.get_static_property("layout_style");if(r!=="infinite_scroll"&&r!=="horizontal_scroll"&&r!=="vertical_extendable"||!k){return}if(k()>n){return}t(n+1);return k(n)});return e.on_message("scroll_to",function(t){var n;if(e.get_static_property("layout_style")==="limit_items"){return}n=e.state("list_data");return Ue.run_once(20,function(){if(n==null&&!e.state("loading")){return-1}return n!=null?n.position(t.entry,Ge.get(e.get_static_property("group_type"))):void 0},function(n,r){var i,o,a;if(n){Ue.warn(n);return}if(r===-1){return}i=function(){var n,i,o,a,s;n=e.children[r];o=e.get_static_property("layout_style");if(o==="infinite_scroll"){s=n.get_canvas().position().top+e.get_canvas().scrollTop();if(t.animate){return e.get_canvas().animate({scrollTop:s},300)}else{return e.get_canvas().scrollTop(s)}}else if(o==="horizontal_scroll"){s=n.get_canvas().position().left+e.get_canvas().scrollLeft();if(t.animate){return e.get_canvas().animate({scrollLeft:s},300)}else{return e.get_canvas().scrollLeft(s)}}else{if(t.animate){return Ue.velocity(n.get_canvas(),"scroll",{duration:300})}else{a=n.get_canvas();while(a.length&&!a.hasClass("main-page")&&!i){if(a.css("position")==="fixed"){i=a}a=a.parent()}if(!a.length||a.hasClass("main-page")){i=$(window)}return i.scrollTop(n.get_canvas().offset().top)}}};if(!((o=e.children)!=null?(a=o[r])!=null?a.is_visible():void 0:void 0)){return Ue.wait_for_updates(function(){var t;e.message("draw_till",r);t=function(){return setTimeout(function(){var n,o,a;if(((n=e.children)!=null?(o=n[r])!=null?o.is_visible():void 0:void 0)&&((a=e.children)!=null?a[r].canvas.is(":visible"):void 0)){return i()}else{return t()}},50)};return t()})}else{return i()}})})}},get_state_value:function(e,t){var n;if(t==="list_data"){n=e.get_static_property("group_type");if(!n){return"null"}else{return"list."+n}}},check_for_errors:function(e,t){return Je(e,"get_list_data",t)},new_namespace:true,use_element_search_data:function(){},show_borders:function(e){return e.state("show_borders",true)},hide_borders:function(e){return e.state("show_borders",false)},is_list:true});x={};Me={};ie=E.transform_element("GroupItem",{get_html:function(){return"<div></div>"},default_group_data:function(){return L.STATE_NOT_READY},can_register_workflows:function(e){if(e._can_register_workflow_key==null){e._can_register_workflow_key=Ue.MakeKey(null,"_can_register_workflow_key")}return e._can_register_workflow_key},initialize:function(e){var t,n,r,i,o,a,s,u,l,c;e.split_namespace();e.canvas.addClass("group-item entry-"+e.element.num+" ");s=null;u=e.element.rg_instance;i=u.get_static_property("layout_style");a=function(){var e;return(e=u.columns)!=null?e:u.get_static_property("columns")};l=function(e){var t;if(e>1){return u.get_static_property("seperator_width",true)*((t=u.get_static_property("seperator_style",true))===void 0||t===null||t==="none"?0:1)}else{return 0}};o=e.element.num;t=function(){if(i==="horizontal_scroll"){return 1}else{return Math.floor((o-1)/a())+1}};r=function(){if(i==="limit_items"){return u.get_static_property("rows")}else if(i==="show_all"||i==="vertical_extendable"){return Math.ceil(u.last_cell/a())}else if(i==="horizontal_scroll"){return 1}};e.autorun(function(){var n,r;s=u.toUniqueString();if(Me[s]==null){Me[s]={}}n=t();if(e.is_visible()&&!Me[s][n]){return Me[s][n]=Math.max((r=Me[s][n])!=null?r:0,e.get_canvas().height())}});e.autorun(function(){var t;t=e.element_id();e.parent().add_to_namespace(e);if(t){return e.canvas[0].key=t}});n=function(){var t,n,i,o,a;t=r();if(!t){return 0}i=0;for(n=o=1;1<=t?o<=t:o>=t;n=1<=t?++o:--o){if((a=Me[s])!=null?a[n]:void 0){i+=Me[s][n]+l(n)}else{i+=e.element.get_height()+l(n)}}return i+ve.calculate_border_height(u)};c=null;e.on_message("child_movement",function(r){c=r;return Ue.WaitFor(e.drawn_key,function(){return e.wait_for_visible(function(){var r,o,f,d,_,p,h,g,m,v,y,b,w;f=e.element_id();if(x[s]==null){x[s]={}}if(c==null){m=x[s][f]}else{m=e.element.get_height()+c;e.get_canvas().height(m);x[s][f]=m}e.get_canvas()[0].key=f;d=(t()-1)*a()+1;h=i==="horizontal_scroll"?u.last_cell:d+a()-1;r=[];g=m-l(t());for(p=v=d;d<=h?v<=h:v>=h;p=d<=h?++v:--v){o=(w=u.children[p-1])!=null?w.canvas:void 0;if(o){r.push(o);_=x[s][o[0].key];if(_>g){g=_}}}for(y=0,b=r.length;y<b;y++){o=r[y];o.height(g)}if(i!=="infinite_scroll"){Me[s][t()]=g;return u.set_height(n())}})})});return e.on_message("child_shown",function(){if(i!=="infinite_scroll"){return u.set_height(n())}})},position_canvas:function(e,t){return t.container.get_canvas().append(e)},is_container:true,container_names:function(){return["elements"]},get_container_canvas:function(e,t){return e.get_canvas()},get_private_messages:function(){return["child_movement","child_shown"]},is_input:false,change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:false,property_applications:[]});E.GroupItem=a=function(e){wt(t,e);function t(e,t,n){this.rg_instance=e;this.height=t;this.num=n;this._type="GroupItem";this.E=ie;this.json=new le.RuntimeJSON(null)}t.prototype.exists=function(){return true};t.prototype.id=function(){var e,t,n,r=this;if(this.id_watcher==null){this.id_watcher=Ue.Watcher(function(){var e;return r.rg_instance.element.id()+"_group_item_"+((e=r.instance.state("group_data"))!=null?typeof e._id==="function"?e._id():void 0:void 0)+"_"+r.num})}n=this.id_watcher.get_current(),e=n[0],t=n[1];if(e){return t}else{return this.rg_instance.element.id()+"_group_item_null"}};t.prototype.parent=function(){return this.rg_instance.element};t.prototype.get_container_elements=function(e){return this.rg_instance.element.get_container_elements(e)};t.prototype.get_height=function(){return this.height};t.prototype.get_responsive_data=function(){return this.rg_instance.element.get_responsive_data()};return t}(le.Element);nt=function(e,t,n,r){var i,o,a;o=n.find_instance_by_id(t.element_id);a=P.dehydrate_tree(o);i={};i[I.STATES.Message(o,null,"get_list_data")]=r;i[I.ESTATE_PREFIX+a]={list_data:r};return i};A.DisplayListData={field_names:{element_id:{},data_source:{}},run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,n){if(e){return r(e)}else{if(n!=null){n.message("set_list_data",t.data_source)}return r(null,null)}})},data_to_refresh:function(e,t,n){return nt(e,t,n,t.data_source)}};A.ListClear={field_names:{element_id:{}},run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,t){if(e){return r(e)}else{if(t!=null){t.message("clear_list")}return r()}})},data_to_refresh:function(e,t,n){return nt(e,t,n)}};W={element_id:{},wrap_around:{"default":false}};Xe=function(e,t,n){var r;r=v.element(e!=null?e.element_id():void 0);if(r&&(r!=null?r.get_static_property("layout_style"):void 0)!=="limit_items"){return t(n(e)+": "+r.get_name()+" is scrollable, you cannot go to a different page")}};A.ListShowNext={field_names:Ue.extend({},W),run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,n){if(e){return r(e)}else{if(n!=null){n.message("show_next",t.wrap_around)}return r()}})},data_to_refresh:null,check_for_errors:function(e,t){return Xe(e,t,this.display)}};A.ListShowPrevious={field_names:Ue.extend({},W),run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,n){if(e){return r(e)}else{if(n!=null){n.message("show_previous",t.wrap_around)}return r()}})},data_to_refresh:null,check_for_errors:function(e,t){return Xe(e,t,this.display)}};A.ListGoToPage={field_names:{element_id:{},page:{}},run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,n){if(e){return r(e)}else{if(n!=null){n.message("go_to_page",t.page)}return r()}})},data_to_refresh:null,check_for_errors:function(e,t){return Xe(e,t,this.display)}};A.ScrollToListEntry={field_names:{element_id:{},entry:{},animate:{}},run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,n){if(e){return r(e)}else{if(n&&t.entry!=null){setTimeout(function(){return n.message("scroll_to",t)},100)}return r()}})},data_to_refresh:null,check_for_errors:function(e,t){var n;n=v.element(e!=null?e.element_id():void 0);if(n&&(n!=null?n.get_static_property("layout_style"):void 0)==="limit_items"){return t(this.display(e)+": "+n.get_name()+" has a 'Fixed number of cells' layout and can't be scrolled to.")}}};de("GoogleMap",{display:"Map",category:"visual elements",defaults:{width:450,height:350,collapse_margin:500},field_names:{marker_type:{"default":"single",no_states:true},marker_data_type:{no_states:true},data_source:{no_states:true},location_field:{no_states:true},show_info_window:{"default":"no",no_states:true},marker_caption_expression:{no_states:true},map_type:{"default":"ROADMAP",no_states:true,in_style:true},map_style:{"default":"normal",in_style:true},custom_style:{in_style:true},allow_zoom_drag:{"default":true},disable_zoom_scroll:{"default":false,no_states:true},manual_setting:{"default":false,no_states:true},center:{no_states:true},initial_zoom:{"default":10,no_states:true},use_customized_marker_icon:{"default":false,no_states:true},use_customized_marker_icon_for_list:{"default":"no",no_states:true},custom_marker_icon:{no_states:true},custom_marker_field:{no_states:true},keep_proportion_resize:{no_states:true}},property_applications:[new ve.Dimensions,new ve.Border,new ve.BoxShadow,new ve.Padding,new ve.MinWidth],get_html:function(e){return"<div></div>"},get_min_width:function(){return 0},notify_width:function(e,t){return se(e,t)},initialize:function(e){var t,n,r,i,o,a,s,u,l,c,f=this;n=Ue.MakeKey(null,"map built");l=null;u=Y.load_google_map_api();c=function(e){if(e){return l!=null?l.panTo(e):void 0}};r=e.get_canvas();o=function(t){return e.state("marker_data",t)};a=false;t=Y.SAMPLE_VALUE;i={};s=function(e){var t,n,r;if(!e){return}t=Y.get_coordinates(e);if(t!=null){n=t.latitude,r=t.longitude;return new window.google.maps.LatLng(n,r)}};if(e.run_mode()){e.on_message("set_marker_data",function(t){e.state("datasource_changed_by_workflow_action",true);a=false;return o(t)});e.on_message("clear_marker_data",function(){e.state("datasource_changed_by_workflow_action",false);return a=false});e.on_message("map_adjust_zoom",function(e){var t=this;return Ue.WaitFor(n,function(){var t,n;if(!e.manual_setting){t=new window.google.maps.LatLngBounds;for(Ke in i){n=i[Ke];t.extend(n.marker.position)}return l.fitBounds(t)}else{l.setZoom(e.initial_zoom);return c(s(e.center))}})})}return e.wait_for_visible_lite(function(){var d,_,p;p=e.element_id()+"_"+Ue.LUID()+"_map_wrapper_"+e.responsive_mode();d=Ue.div("map-wrapper",r);h(d,{height:"100%",width:"100%"});d[0].id=p;_=d[0];return Ue.WaitFor(u,function(){var r;r=function(){var r,u,d,p;l=new window.google.maps.Map(_,{streetViewControl:false});if(e.run_mode()){window.google.maps.event.addListener(l,"click",function(){return e.state("currently_selected_marker",null)});window.google.maps.event.addListener(l,"idle",function(){var t;t=l.getCenter();return e.state("map_center_address",function(){return Y.get_address_from_location({latitude:t.lat(),longitude:t.lng()})})});window.google.maps.event.addListener(l,"center_changed",function(){var t;t=l.getCenter();return e.state("map_center_address",function(){return Y.get_address_from_location({latitude:t.lat(),longitude:t.lng()})})})}e.autorun(function(){var t,n,r,i,o,a,s,u;s=["height","width","four_border_style","border_width","border_style","padding_vertical","padding_horizontal"];for(r=0,o=s.length;r<o;r++){n=s[r];e.evaluate_property(n)}u=["_top","_right","_bottom","_left"];for(i=0,a=u.length;i<a;i++){t=u[i];e.evaluate_property("border_style"+t);e.evaluate_property("border_width"+t)}return window.google.maps.event.trigger(l,"resize")});e.on_property_change(["allow_zoom_drag","map_style","custom_style","disable_zoom_scroll"],function(e){var t,n,r,i,o;t=e.allow_zoom_drag,r=e.disable_zoom_scroll,o=e.map_style,n=e.custom_style;i={};if(o&&(o!=="normal"&&o!=="_custom")){i.styles=E.google_map_styles[o].data}else if(o==="_custom"){try{i.styles=Ue.json_parse(n)}catch(a){i.styles=null}}else{i.styles=null}i.disableDefaultUI=!t;i.scrollwheel=t&&!r;i.draggable=t;i.disableDoubleClickZoom=!t;return l.setOptions(i)});e.on_property_change("map_type",function(e){return l.setMapTypeId(window.google.maps.MapTypeId[e])});e.on_property_change(["initial_zoom","marker_type"],function(e){var t,n;t=e.initial_zoom,n=e.marker_type;if(n==="none"||n==="single"){return l.setZoom(t)}});u=function(){var e,n;if(v.app().id()==="test_app"){n=s(t);c(n);return n}try{e=Y.get_current_geographic_position()}catch(r){e=Y.SAMPLE_VALUE}if(e){n=s(e)}else{n=s(t)}c(n);return n};d=function(e,t){return e.toString()+(t!=null?t:"")};r=function(e,t,n,r){var o,a;a={position:e,map:l};if(!n&&v.app().id()!=="test_app"){a.animation=window.google.maps.Animation.DROP}if(t){a.icon=t}o=new window.google.maps.Marker(a);i[d(o.getPosition(),r)]={marker:o};return o};p=function(e){var t,n,r;r=[];for(n in e){t=e[n];t.marker.setMap(null);if(t.event_listener){window.google.maps.event.removeListener(t.event_listener)}r.push(delete i[n])}return r};e.autorun(function(){var n,o,_,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y;j=e.evaluate_property("marker_type");if(j==="none"){p(i);S=s(e.state("marker_data"));if(S){c(S)}else{u()}}if(j==="single"){p(i);C=s(e.state("marker_data"));if(e.get_static_property("use_customized_marker_icon")){v=e.get_static_property("custom_marker_icon")}l.setZoom(e.get_static_property("initial_zoom"));if(C){M=r(C,v,true);if(e.edit_mode()||e.run_mode()&&!((F=l.getBounds())!=null?F.contains(M.getPosition()):void 0)){c(C)}}else{if(e.edit_mode()){b=u();M=r(b,v)}else{c(s(t))}}}if(j==="list"){if(e.evaluate_property("use_customized_marker_icon_for_list")==="upload"){m=e.evaluate_property("custom_marker_icon")}if(e.run_mode()){T=e.evaluate_property("marker_data_type");if(T==="geographic_address"){w=function(e){return e}}else{y=Ge.get(T);A=e.evaluate_property("location_field");if(A){E=y.get_message(A);w=E!=null?E.fn:void 0}k=y.get_message(e.evaluate_property("custom_marker_field"))}D=e.state("marker_data");P={};if(w!=null){G=(W=D!=null?typeof D.all==="function"?D.all():void 0:void 0)!=null?W:[];for(N=0,q=G.length;N<q;N++){_=G[N];g=w(_);if(g){I={position:s(g),bubble_object:_};if(T!=="geographic_address"){if((V=e.get_static_property("show_info_window"))==="on_click"||V==="always"){h={element:e,datasources:{injected_value:function(){return _},injected_value_value:function(){return f.get_injected_value(e.element)}}};I.title=e.element.eval_property("marker_caption_expression",h)}}if(e.get_static_property("use_customized_marker_icon_for_list")==="upload"){I.icon=m}else if(e.get_static_property("use_customized_marker_icon_for_list")==="field"&&T!=="geographic_address"){I.icon=ve.optimize_image(k.fn(_),30,30,{},false,true)}P[d(I.position,typeof _._id==="function"?_._id():void 0)]=I}}}if(Ue.is_empty(P)&&!a){p(i);c(s(t));return l.setZoom(10)}else{O={};for(x in i){M=i[x];if(!P[x]){O[x]=M}}p(O);o=new window.google.maps.LatLngBounds;B=function(t,n){var r,a,s,u=this;o.extend(n.position);if(t.title){if(!i[x].infowindow){r=new window.google.maps.InfoWindow;i[x].infowindow=r}else{r=i[x].infowindow}a=Ue.div("infowindow-content");a.text(t.title);a[0].style.padding="3px";a[0].style["font-family"]="Lato";a[0].style.color="rgb(39, 39, 39)";r.setContent(a[0]);if(e.get_static_property("show_info_window")==="always"){r.open(l,n)}}return(s=i[x]).event_listener!=null?(s=i[x]).event_listener:s.event_listener=window.google.maps.event.addListener(n,"click",function(){e.state("currently_selected_marker",t.bubble_object);if(r){r.open(l,n)}return Ce(e,"MapMarkerClicked")})};for(x in P){I=P[x];if(!i[x]){M=r(I.position,I.icon,true,typeof(z=I.bubble_object)._id==="function"?z._id():void 0)}else{M=i[x].marker}B(I,M)}R={};Y=["manual_setting","center","initial_zoom"];for(L=0,U=Y.length;L<U;L++){n=Y[L];R[n]=e.evaluate_property(n)}if(R.manual_setting&&R.center!=null){if(R.initial_zoom==null){R.initial_zoom=16}return e.message("map_adjust_zoom",R)}else if(!a){a=true;l.fitBounds(o);if(l.getZoom()>18){return l.setZoom(16)}}}}else{p(i);b=u();r(b,m);return l.setZoom(10)}}});e.autorun(function(){var t,n,r;if(!e.state("datasource_changed_by_workflow_action")){if(e.run_mode()){t=(n=e.evaluate_property("data_source"))!=null?n:null}else if(e.element.property("data_source").is_static()){t=(r=e.evaluate_property("data_source"))!=null?r:null}return o(t)}});return n.turn()};return e.wait_for_visible(function(){return setTimeout(r,1)})})})},change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:true,is_input:false,is_container:false,events:["MapMarkerClicked"],get_states:function(e){return["currently_selected_marker","map_center_address"]},add_specific_messages:function(e,t){var n;n=t.get_state_value("currently_selected_marker");if(n){Ue.extend(e,{get_currently_selected_marker:{description:"'s current marker",ret_value:n,fn:function(e,t){return e!=null?e.state("currently_selected_marker"):void 0}}})}return Ue.extend(e,{get_map_center_address:{description:"'s center address",ret_value:"geographic_address",fn:function(e,t){return e!=null?e.state("map_center_address"):void 0}}})},get_messages:function(e){return["set_marker_data","clear_marker_data","map_adjust_zoom"]},get_state_value:function(e,t){switch(t){case"currently_selected_marker":return e.get_static_property("marker_data_type");case"map_center_address":return"geographic_address"}},get_injected_value:function(e){return e.get_static_property("marker_data_type")},get_injected_display:function(){return"Current marker"},use_injected_datasource:function(e,t){return e.path().indexOf(t.property("marker_caption_expression").path())===0},check_for_errors:function(e,t){var n;if(e.get_static_property("map_style",true)==="_custom"&&e.get_static_property("custom_style",true)!=null){try{return Ue.json_parse(e.get_static_property("custom_style",true))}catch(r){n=r;return t(e.display()+": the custom style cannot be parsed as a JSON object")}}},jquery_plugins:function(){return["google_map_styles.js"]}});A.DisplayMapMarkerData={field_names:{element_id:{},data_source:{}},run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,n){if(e){return r(e)}else{if(n!=null){n.message("set_marker_data",t.data_source)}return r()}})},data_to_refresh:null};A.ClearMapMarkers={field_names:{element_id:{}},run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,t){if(e){return r(e)}else{if(t!=null){t.message("clear_marker_data")}return r()}})},data_to_refresh:null};A.MapAdjustZoom={field_names:{element_id:{},manual_setting:{},center:{},initial_zoom:{"default":10}},run:function(e,t,n,r){return Ue.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(e,n){if(e){Ue.warn(e)}if(n!=null){n.message("map_adjust_zoom",t)}return r()})},data_to_refresh:null};E.preset_page_widths={custom:{},full_width:{width:1200,caption:"Full width"},centered:{width:980},mobile:{width:380}};E.preset_page_width_list={};ht=E.preset_page_widths;for(ge in ht){O=ht[ge];E.preset_page_width_list[ge]=(gt=O.caption)!=null?gt:Ue.toTitleCase(ge)}de("Page",{container_names:function(){return["elements"]},get_container_canvas:function(e,t){if(t==="elements"){return e.get_canvas()}},get_container_elements:function(e,t){if(t==="elements"){return e._get_container_elements(t)}},field_names:{page_item_type:{no_states:true},readable_field:{no_states:true},title:{"default":"My Page"},native_app:{no_states:true},native_app_name:{no_states:true,"default":"App"},mobile_page:{no_states:true},delete_page:{no_states:true},meta_title:{server_side_eval:true,no_states:true},meta_description:{server_side_eval:true,no_states:true},meta_image:{server_side_eval:true,no_states:true},backdrop_background_style:{"default":"bgcolor",no_states:true,in_style:true},backdrop_bgcolor:{"default":"#FFFFFF",in_style:true},backdrop_background_gradient_direction:{"default":"top",in_style:true},
backdrop_background_gradient_from:{"default":"#FFFFFF",in_style:true},backdrop_background_gradient_to:{"default":"#AAAAAA",in_style:true},backdrop_background_gradient_mid:{in_style:true,optional:true},backdrop_background_gradient_style:{in_style:true,"default":"linear"},backdrop_background_radial_gradient_shape:{in_style:true,"default":"ellipse"},backdrop_background_radial_gradient_size:{in_style:true,"default":"farthest-corner"},backdrop_background_radial_gradient_xpos:{in_style:true,"default":10},backdrop_background_radial_gradient_ypos:{in_style:true,"default":10},backdrop_background_image:{in_style:true},backdrop_center_background:{in_style:true},backdrop_background_size_cover:{in_style:true},backdrop_repeat_background_vertical:{in_style:true},backdrop_repeat_background_horizontal:{in_style:true},backdrop_image_paralax:{no_states:true,"default":false,in_style:true},backdrop_paralax_speed:{no_states:true,"default":.2,in_style:true},backdrop_background_color_if_empty_image:{"default":"rgba(255, 255, 255, 0.0)",no_states:true,in_style:true},backdrop_video_source:{"default":"http://vjs.zencdn.net/v/oceans.mp4",in_style:true},backdrop_video_image_fallback:{in_style:true},backdrop_video_silence:{"default":true,in_style:true},stripes:{no_states:true,in_style:true},preset_width:{no_states:true,"default":"custom",in_style:false},html_header:{no_states:true,server_side_eval:true},new_responsive:{no_states:true},fixed_width:{no_states:true,"default":false},min_width:{"default":0,no_states:true},backdrop_crop_responsive:{no_states:true}},always_visible:true,property_applications:function(e){if(!e||!(e!=null?e.use_responsive_algorithm():void 0)){return[new ve.Background,new ve.ShortDimensions]}else{return[new ve.ShortDimensions]}},get_html:function(e){return'<div class="main-page"></div>'},is_responsive_mode:function(e){return e.run_mode()&&e.element.use_responsive_algorithm()},calculate_run_mode_width:function(e){var t;if(this.is_responsive_mode(e)&&!e.get_static_property("fixed_width")){t=$(window).width();return Math.max(e.element.get_min_width(),t)}else{return e.element.get_width()}},initialize_container_width:function(e,t){var n,r=this;if(!this.is_responsive_mode(e)){return}t.resize_width(this.calculate_run_mode_width(e));setImmediate(function(){return t.resize_width(r.calculate_run_mode_width(e))});n=null;return $(window).resize(function(){var i,o,a,s,u;o=r.calculate_run_mode_width(e);if(o!==n){u=$("iframe");for(a=0,s=u.length;a<s;a++){i=u[a];if($(i).is(":visible")){if($(i).width()===screen.width){return}}}n=o;t.resize_width(o);return e.get_canvas()[0].style.width=o+"px"}})},position_canvas:function(e,t){var n;if(t.responsive_mode()){t.container.add(t);return}n=this.calculate_run_mode_width(t);h(e,{width:n+"px",height:t.element.get_height()+"px"});if(t.edit_mode()){$(".canvas").append(e)}else{$("html, body").css("height","100%");$(window.document.body).append(e);e[0].style["min-height"]="100%"}return h(e,{"margin-right":"auto","margin-left":"auto",position:"relative","z-index":2})},get_min_width:function(){return 0},not_max_adjustable:true,can_register_workflows:function(){return Ue.FakeKey()},initialize:function(e){var t;if(e.run_mode()){e.register_workflows(e.element.events())}e.on_property_change("title",function(t){if(e.edit_mode()){return $(".edit-date").text(t)}else if(e.run_mode()){return window.document.title=t}});if(e.edit_mode()){e.on_property_change("preset_width",function(t){if(E.preset_page_widths[t].width!=null){return e.element.set_property("width",E.preset_page_widths[t].width)}});e.on_property_change("width",function(t){var n,r;r=E.preset_page_widths;for(n in r){O=r[n];if(!(t===O.width)){continue}e.element.set_property("preset_width",n);return}return e.element.set_property("preset_width","custom")})}if(e.run_mode()){I.page_width($(window).width());$(window).on("resize",function(){return I.page_width($(window).width())});I.page_current_scroll_position($(window).scrollTop());$(window).on("scroll",function(){return I.page_current_scroll_position($(window).scrollTop())})}t=function(){var t,n,r,i,o,a,s,u,l,c=this;if(e.element.use_responsive_algorithm()){r=e.get_canvas()}else{r=Ue.div("stripe-container Backdrop",e.container.get_canvas());if(e.run_mode()){$(window).off("resize.backdrop-non-responsive");$(window).on("resize.backdrop-non-responsive",function(){return r[0].style.width=Math.max($(".main-page").width(),$(window).width())+"px"})}}if(e.thumbnail_mode()){r.css({"z-index":1,position:"absolute",top:0,width:e.element.get_width(),height:e.element.get_height(),overflow:"hidden"})}else{h(r,{"z-index":1,position:e.get_static_property("fixed_width")?"relative":"absolute",top:"0px",width:e.get_static_property("fixed_width")?e.element.get_width():"100%",overflow:"hidden"})}if(Ue.is_debug_mode()){n=300;$(".main-page").css("height",$(".main-page").height()+n)}else{n=0}s=function(){var t;if(e.thumbnail_mode()){t=e.element.get_height()}else{t=Math.max(r.parent().height(),$(".main-page").height());if(t===0){t=e.element.get_height()}}return r[0].style.height=t+"px"};s();window.fix_backdrop_height=s;if(e.edit_mode()){e.autorun(function(){return r.css("height",e.evaluate_property("height")+20)})}t=null;e.autorun(function(){var n,i,o,a,s,u,l,c,f,d;n={is_backdrop:true};f=["background_style","bgcolor","background_gradient_direction","background_gradient_from","background_gradient_mid","background_gradient_to","background_image","center_background","background_size_cover","repeat_background_vertical","repeat_background_horizontal","background_color_if_empty_image","background_gradient_style","background_radial_gradient_shape","background_radial_gradient_size","background_radial_gradient_xpos","background_radial_gradient_ypos"];for(s=0,l=f.length;s<l;s++){o=f[s];n[o]=e.evaluate_property("backdrop_"+o)}if(e.run_mode()){d=["backdrop_paralax_speed","backdrop_image_paralax"];for(u=0,c=d.length;u<c;u++){o=d[u];n[o]=e.evaluate_property(o)}}if(n.background_style==="video"){if(e.run_mode()&&!Ue.is_on_mobile_or_tablet()){if(!t){t=new $.BigVideo;t.init()}$("#big-video-wrap").css("background","black");a=ve.optimize_image(e.evaluate_property("backdrop_video_source"),void 0,void 0,void 0,true);t.show(a,{forceAutoplay:true,doLoop:true});return e.autorun(function(){if(e.evaluate_property("backdrop_video_silence")){return t.getPlayer().volume(0)}else{return t.getPlayer().volume(.8)}})}else{r.css("background","black");i=e.evaluate_property("backdrop_video_image_fallback");if(i){return r.css({"background-image":"url("+ve.optimize_image(i,r.width())+")","background-position":"center top"})}}}else{return(new ve.Background)._apply(n,r)}});if(!e.element.use_responsive_algorithm()){l=Ue.MakeKey(null,"stripe_drawn");u=[];$(window).off("resize.withstripe",s);$(window).on("resize.withstripe",s);e.on_destroy(function(){return $(window).off("resize.withstripe",s)});e.autorun(function(){var t,n,i,o,a,s,c,f,d,_,p=this;s=0;o=0;t=function(e){var t,n;t={};n=Ue.div("backdrop-stripe",r);if(e.floating){t["z-index"]=5e3}else{t["z-index"]=f}f-=1;t["width"]="100%";t["box-sizing"]="border-box";t["-moz-box-sizing"]="border-box";t["height"]=e.stripe_height+"px";if(e.border_width>0){t["border-bottom"]=""+e.border_width+"px "+e.border_style+" "+e.border_color;t["border-radius"]=e.border_roundness+"px"}h(n,t);(new ve.Background)._apply(e,n);(new ve.BoxShadow)._apply(e,n);return n};n=function(t,n){var r;if(n.floating&&!e.edit_mode()){r="fixed";t.addClass("floating")}else{r="absolute"}return t.css("position",r)};f=5e3;r.find(".backdrop-stripe").remove();c=q(e);if(c.length===0){return}for(d=0,_=c.length;d<_;d++){i=c[d];a=t(i);n(a,i);if(i.floating!==true||i.floating&&i.floating_reference==="top"){a.css("top",s+"px");u.push({div:a,top:s,height:parseFloat(i.stripe_height)});s+=parseFloat(i.stripe_height)}else{a.css("bottom",o+"px");u.push({});o+=parseFloat(i.stripe_height)}}return l.turn()});a=e.element.get_responsive_data();o=0;i=$(".main-page");e.on_message("movement_in_stripe",function(t,o){return Ue.WaitFor(l,function(){var a,s,l,c,f,d,_,p;l=0;for(c=d=0,_=u.length;d<_;c=++d){f=u[c];if(f.top===void 0){continue}if(c>=t){if(c===t){s=o-l}else{s=f.height_change}f.div.height(f.height+s);f.div.css("top",f.top+l+"px");f.height_change=s}l+=(p=f.height_change)!=null?p:0}a=e.element.get_height()+l+n;r.css("height",a);return i.css("height",a)})})}return e.on_message("child_movement",function(t){var o;o=e.element.get_height()+t+n;r.css("height",o);return i!=null?i.css("height",o):void 0})};if(e.edit_mode()){return e.autorun(function(){e.container.get_canvas().find(".stripe-container.Backdrop").remove();e.autorun(function(){var t,n,r,i,o;if(!e.is_destroyed()){n={};o=["background_style","bgcolor","background_gradient_direction","background_gradient_from","background_gradient_to","background_gradient_mid","background_image","repeat_background_vertical","center_background","repeat_background_horizontal","background_size_cover","background_color_if_empty_image","background_gradient_style","background_radial_gradient_shape","background_radial_gradient_size","background_radial_gradient_xpos","background_radial_gradient_ypos"];for(r=0,i=o.length;r<i;r++){t=o[r];n[t]=e.evaluate_property(t)}return(new ve.Background)._apply(n,e.get_canvas())}});return t()})}else{return t()}},is_input:false,is_container:false,change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:false,get_private_messages:function(){return["movement_in_stripe","child_movement"]},not_draggable:function(){return true},required_js_files:function(e){if(e.get_static_property("backdrop_background_style")==="video"||e.get_style().get_static_property("backdrop_background_style")==="video"){return["jquery_plugins/jquery-ui-slider-draggable.min","jquery_plugins/video.js","jquery_plugins/bigvideo.js"]}else if(e.get_static_property("backdrop_background_style")==="image"&&e.get_static_property("backdrop_image_paralax")||e.get_style().get_static_property("backdrop_background_style")==="image"&&e.get_style().get_static_property("backdrop_image_paralax")){return["jquery_plugins/parallax.min"]}else{return[]}},required_css_files:function(e){if(e.get_static_property("backdrop_background_style")==="video"||e.get_style().get_static_property("backdrop_background_style")==="video"){return["css/optional/bigvideo.css"]}else{return[]}}});E.get_stripes=function(e){var t;if(typeof e.get_style==="function"?e.get_style().exists():void 0){t=e.get_style().property("stripes")}else{t=e.property("stripes")}if(t.is_empty()){return[]}return t.entries()};q=function(e){var t,n,r,i,o;r=E.get_stripes(e.element);if(!r.length){return[]}n=[];for(i=0,o=r.length;i<o;i++){t=r[i];le.with_eval_node(t,function(){return n.push(le.evaluate_properties(t.json._raw(),e.prop_eval_context(),le.DETECT_FIELD_NAMES,[],t.json._path()))})}return n};E.stripe_defaults={bgcolor:"#AAAAAA",background_style:"bgcolor",boxshadow_horizontal:0,border_style:"none",border_roundness:0,border_width:1,border_color:"#6B6B6B"};E.all_loaded=true;E.load_all_page_images=function(e){};n.load_all_page_images=function(e){var t,n,r,i,o;i=v.get_page_by_name(e).get_images_for_preload();o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push($("body").append(j(t)))}return o};j=function(e){var t;t=Ue.img("hidden-image-for-caching",void 0,ve.optimize_image(e.src,e.width,e.height));t.on("load",function(){return ve.downloaded_images[e]=true});return t};for(Ke in E){N=E[Ke];if(N.field_names){mt=N.field_names;for(ge in mt){O=mt[ge];if(O.in_style){L.style_properties[ge]=true}}}}E.get_element_display=function(e){var t,n;t=E.get_element_object(e);if(!t){return"Mising type: "+e}else{return(n=t.display)!=null?n:t.plugin_name}};be=e;if(Ue.on_server()){Pe=be("./../optional/meta/special_meta");M=be("./../core/core_elements_fields");M.add_fields_to_elements()}s=e("./../lib");He=e("./widgets");C=e("./../core/core_expressions");P=e("./../db/db");I=e("./../lang/dataops");Ge=e("./../lang/values");Be=e("./status_bar");Y=e("./../geolocation");Fe=e("./../util");Ye=e("./../webfonts");me=e("./../lang/plugins");Ie=e("./../lang/shrink");E.loaded.turn()}).call(this)},{"./../client_config":16,"./../core/core_expressions":21,"./../db/db":28,"./../editor/css":36,"./../geolocation":41,"./../lang/application":50,"./../lang/appquery":51,"./../lang/dataops":54,"./../lang/elements":55,"./../lang/lang":57,"./../lang/plugins":60,"./../lang/shrink":61,"./../lang/values":62,"./../languages":64,"./../lib":65,"./../locations":66,"./../services":70,"./../tests/testing":71,"./../u":72,"./../util":74,"./../webfonts":76,"./core_actions":18,"./core_events":20,"./property_applications":24,"./status_bar":25,"./widgets":26,querystring:285}],20:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};o=n;y=e("./../u");y.safe_register("./core/core_events",o);m=e("./../services");if(o.event_element_mapping==null){o.event_element_mapping={}}u=function(){var e,t,r;t=function(){var t,i;t=n.event_element_mapping;i=[];for(e in t){r=t[e];if(e!=="OnError"){i.push(e)}}return i}();t.push("OnError");return t};o.get_events_for_an_element=function(e){var t,r,i,o;r=[];o=n.event_element_mapping;for(t in o){i=o[t];if(k.call(i,e)>=0){r.push(t)}}return y.sort_array(r,u())};f=function(){return{General:[{type:"LoggedIn"},{type:"LoggedOut"},{type:"PageLoaded"},{type:"DoInterval"},{type:"ConditionTrue"},{type:"OnPageError"}]}};l=function(){return{Custom:[{type:"CustomEvent"}]}};o.get_root_events=f;h=function(e,n){o[e]=n;return n.register=function(n,r,i){var o,a,s=this;a=function(){var e,i;e={element:r};i=t().workflow.run_workflows(e,[n]);return i.callback(function(e){if(e){return console.log("Workflow failed: "+y.human_friendly(e))}})};t().workflow.on_event(e,a);o=function(){return t().workflow.off_event(e,a)};return o}};p=o.make_element_event=function(e,i,a){var s,u,l;if(!a){o[e]=i}if(i.field_names==null){i.field_names={element_id:{}}}u=i._fields;i.fields=function(e){var r,i,o,a,s,l,c;if((s=e.owner())!=null?typeof s.is_custom_definition==="function"?s.is_custom_definition():void 0:void 0){o="CustomDefinition";if((l=e.type())==="PopupClosed"||l==="PopupOpened"){if(e.owner().get_static_property("element_type")==="Popup"){i=true}else{i=false}}else{i=true}}else{o="Page";i=false}a=(c=t().sets)!=null?c.PageElementsByType(e,n.event_element_mapping[e.type()],o,i,n.event_element_mapping[e.type()]):void 0;r=[{name:"element_id",caption:"Element",editor:"Dropdown",set:a}];if(u!=null){r.push.apply(r,u(e))}return r};s=(l=i._display)!=null?l:i.display;i.display=function(e){var t,n,o,a;t=(n=(o=(a=r.element(e!=null?e.element_id():void 0))!=null?a.get_name():void 0)!=null?o:i.element_name)!=null?n:"An element ";return t+s(e)};return i.register=function(){}};h("LoggedIn",{display:function(){return"User is logged in"},can_redirect:true,server_side_redirect:function(){return t().current_user().is_logged_in()}});h("LoggedOut",{display:function(){return"User is logged out"},can_redirect:true,server_side_redirect:function(){return!t().current_user().is_logged_in()}});h("PageLoaded",{display:function(){return"Page is loaded"},can_redirect:true,server_side_redirect:function(){return true}});d=y.MakeSwitch(null,"conditiontrue is running");d.turn_on();o["ConditionTrue"]={display:function(e){var t;t=e!=null?e.property("condition").get_tree_display():void 0;return"Do when "+(t?t:"condition is true")},can_redirect:false,never_show_condition:true,field_names:{run_when:{"default":"just_once"}},fields:function(){return[{name:"run_when",caption:"Run this ",editor:"Dropdown",set:t().sets.Object({just_once:"Just once",every_time:"Every time"})}]},condition_not_optional:true,register:function(e,n,r){var i,o,s=this;o=null;y.WaitFor(n.get_children_drawn_key(),function(){var i;o=y.Watcher(function(){var t;y.ensure_ready(d);t={element:n,datasources:a.get_basic_datasources(n.element.root())};new a.FrozenState(t);return[e.check_condition(t),t]});i=true;return o.on_value(function(n){var a,s;s=n[0],a=n[1];if(s){if(i){d.turn_off();t().workflow.run_workflows(a,[e]).callback(function(e){if(e){y.warn(e)}return d.turn_on()});i=false;if(r.run_when!=="every_time"){return o.destroy()}}}else{return i=true}})});i=function(){return o!=null?o.destroy():void 0};return i}};w=[];x=0;o["OnPageError"]={display:function(e){return"An unhandled error occurs"},fields:function(){return[]},field_names:{},register:function(e,t,n){var r,i,o=this;i=x;x++;w.push({id:i,workflow:e,element_instance:t,properties:n});r=function(){var e;return w=function(){var t,n,r;r=[];for(t=0,n=w.length;t<n;t++){e=w[t];if(e.id!==i){r.push(e)}}return r}()};return r}};o.build_wf_error_object=function(e){var t,n,r;t=e.reason;if(!t){if(400<=(r=e.statusCode)&&r<=499){t="MISCELLANEOUS"}else{t="TEMPORARY_BUG"}}n=y.human_friendly(e);return{code:t,message:n}};o.handle_uncaught_error=function(e,n){var r,i,u,l,c,f,d,_,p,h=this;if(e==null){n(null);return}if(w.length===0){n(e);return}u=o.build_wf_error_object(e);l=[];for(d=0,_=w.length;d<_;d++){p=w[d],f=p.workflow,r=p.element_instance,c=p.properties;i={element:r,datasources:a.get_basic_datasources(r.element.root())};i.datasources.current_workflow_item_value=function(){return"sys.error"};i.datasources.current_workflow_item=function(){return new s.StaticObject(u)};l.push(t().workflow.run_workflows(i,[f],true))}return y.promise_array(l).callback(function(t,r){var i,o,a;if(t){n(t);return}for(o=0,a=r.length;o<a;o++){i=r[o];if(i.length!==0){n(null);return}}return n(e)})};o["DoInterval"]={display:function(e){var t;return"Do every "+((t=e!=null?e.get_static_property("interval"):void 0)!=null?t:"X")+" seconds"},field_names:{interval:{"default":5}},fields:function(){return[{name:"interval",caption:"Interval (seconds)",editor:"StaticNumber",optional:false}]},register:function(e,n,r){var i,o,a,s=this;a=true;o=function(){if(a){return setTimeout(function(){var r;r={element:n};t().workflow.run_workflows(r,[e]);return y.WaitFor(t().workflow.everything_done_key(),o)},r.interval*1e3)}};o();i=function(){return a=false};return i}};p("ButtonClicked",{display:function(){return" is clicked"}});p("InputChanged",{display:function(){return"'s value is changed"},element_name:"An input "});p("PopupClosed",{display:function(){return" is closed"},element_name:"A popup "});p("PopupOpened",{display:function(){return" is opened"},element_name:"A popup "});p("MapMarkerClicked",{display:function(){return"'s marker is clicked"},element_name:"A map"});p("OnError",{display:function(){return" has an error running a workflow"}});o["CustomEvent"]={display:function(e){var t;t=e!=null?e.get_static_property("event_name"):void 0;if(t){return t}else{return"Create a custom event..."}},field_names:{event_name:{},custom_event_data_type:{}},fields:function(){return[{name:"event_name",caption:"Event name",editor:"StaticText"},{name:"custom_event_data_type",caption:"Type of thing",editor:"Dropdown",set:t().sets.DisplayableInListValues(true),optional:true}]},register:function(){}};b=function(e){var n;n=e.get_static_property("raw_data");e.set_property("waiting_for_data",true);return _.wait_for_stable(function(){var i,o,a,s,u;e.set_property("raw_data",null);u=y.Watcher(function(){return e.get_static_property("raw_data")});o=t().location.format_pieces({appname:r.appname(),app_version:r.app_version(),version_explicit:"default"},{protocol:"https:"});o+="/api/1.1/wf/"+e.wf_name()+"/initialize";a=function(){e.set_property("waiting_for_data",false);return u.destroy()};s=new window.ConfirmPanel({title:"Detecting Request Data",build:function(e){var t,n;t=y.div("instruction",e);n=y.div();n.html('Trigger a request to (click to copy) \n <code class="enpoint-to-initiliaze code-explanation">'+o+"</code>");t.append(n);y.copy_on_click(n,void 0,true);return v.show_loading_animation(e)},additional_class:"waiting-post-wf-data",button_caption:"CANCEL",no_cancel:true,cb_yes:function(){a();return e.set_property("raw_data",n)}});i=function(){g(e);a();return s.popup.hide()};return u.on_value(function(t){if(t){g(e);a();return s.popup.hide()}})})};g=function(e){var t,n,r,i,o,a;t=y.safe_require("./editor_plugin/apiconnector_editor");n=y.json_parse((o=e.get_static_property("raw_data"))!=null?o:"{}");i=y.json_parse((a=e.get_static_property("data_type"))!=null?a:"{}").types;r=t.get_response_schema_value({response:n,api_id:e.id(),call_name:"Request Data",is_wf_data:true,API_CONNECTOR_BASE:"api_wf_data"});return new t.EditDataTypesPopup({api_call:{types:i},raw_response:n,schema:r,API_CONNECTOR_BASE:"api_wf_data",API_CONNECTOR_FIELD_PREFIX:"_wf_",IGNORE_FIELD:"_ignore",is_wf_data:true,cb:function(t,n){e.set_property("data_type",y.json_stringify({types:t,is_list:n.is_list}));return e.commit()}})};o["APIEvent"]={display:function(e,t){var n;n=e!=null?e.wf_name():void 0;if(n){return n}else if(t){return"API Endpoint"}else{return"New API endpoint..."}},field_names:{wf_name:{},expose:{"default":true},auth_unecessary:{"default":false},ignore_privacy_rules:{"default":false},return_200_if_not_run:{"default":false},from_salesforce:{"default":false},parameters:{},detect_request:{},include_headers:{},parameter_def:{"default":"manual"},modify_types:{}},fields:function(e){return[{name:"wf_name",caption:"Endpoint name",editor:"StaticText",validation_fn:function(e){return!y.firebase_illegal(e)}},{name:"expose",caption:"Expose as a public endpoint",editor:"Checkbox"},{name:"auth_unecessary",caption:"This endpoint can be run without authentication",editor:"Checkbox"},{name:"ignore_privacy_rules",caption:"Ignore privacy rules when running the workflow",editor:"Checkbox"},{name:"from_salesforce",caption:"This endpoint can be run as a Saleforce outbound message",editor:"Checkbox",condition:function(){return k.call(r.list_plugins(),"salesforce")>=0}},{name:"parameter_def",caption:"Parameter definition",set:t().sets.Object({manual:"Manual definition",auto:"Detect request data"}),editor:"Dropdown"},{name:"parameters",condition:function(e){return e.get_static_property("parameter_def")!=="auto"},editor:"ObjectList",button_caption:"Add a new parameter",sub_properties:function(e){var n,r;r=t().sets.Filtered(t().sets.AllowableValues(false,true),function(e){var t;return(t=e.value)!=="dateinterval"&&t!=="number_range"});n=[{name:"key",caption:"Key",editor:"StaticText",validation_fn:function(e){return!y.firebase_illegal(e)}},{name:"value",caption:"Type",editor:"Dropdown",set:r,condition:"key","default":"text",pretty:{dropdown_width:"medium-large"}},{name:"is_list",caption:"Is a list/array",editor:"Checkbox",condition:"key"},{name:"optional",caption:"Optional",editor:"Checkbox",condition:"key"}];return n}},{name:"include_headers",caption:"Include headers in the detected data",editor:"Checkbox",condition:function(e){return e.get_static_property("parameter_def")==="auto"}},{name:"detect_request",button_caption:"Detect data",editor:"Button",optional:true,condition:function(e){return e.get_static_property("parameter_def")==="auto"},click_cb:function(){return b(e)},pretty:{width:"small"}},{name:"modify_types",button_caption:"Modify types",editor:"Button",optional:true,condition:function(e){return e.get_static_property("parameter_def")==="auto"},disabled:function(e){return e.get_static_property("data_type")==null},click_cb:function(){return g(e)},pretty:{width:"small"}},{name:"return_200_if_not_run",caption:"Return a 200 if condition is not met",editor:"Checkbox"}]},register:function(){},check_for_errors:function(e,t){var n,r,i,o,a,s,u,l,c;if(e.wf_name()){if(e.wf_name().indexOf(" ")!==-1){t(this.display(e)+" - the endpoint name should not have any space")}if(y.firebase_illegal(e.wf_name())){t(this.display(e)+" - the endpoint name contains illegal characters")}}u=e.get_parameters();c=[];for(a=0,s=u.length;a<s;a++){l=u[a],r=l.key,o=l.value,i=l.optional,n=l.is_list;if(r){if(r.trim()!==r){c.push(t(this.display(e)+" - the parameter "+r.trim()+" has some spaces around it"))}else{c.push(void 0)}}}return c}};o["RecurringEvent"]={display:function(e,t){var n;n=e!=null?e.get_static_property("event_name"):void 0;if(n){return n}else if(t){return"Recurring event"}else{return"New recurring event..."}},field_names:{event_name:{},custom_event_data_type:{},ignore_privacy_rules:{"default":false}},fields:function(){return[{name:"event_name",caption:"Event name",editor:"StaticText"},{name:"custom_event_data_type",caption:"Type of thing",editor:"Dropdown",set:t().sets.DisplayableInListValues(false,true)},{name:"ignore_privacy_rules",caption:"Ignore privacy rules when running the workflow",editor:"Checkbox"}]},register:function(){}};t=e("./../lib");i=e("./../client_config");r=e("./../lang/appquery");o.get_all_events=function(e){var t,n;if(e.is_api()){t={General:[{type:"APIEvent"},{type:"RecurringEvent"}]}}else{t=f();t["Elements"]=function(){var t,r,i,o;i=c(e);o=[];for(t=0,r=i.length;t<r;t++){n=i[t];o.push({type:n})}return o}()}y.extend(t,l());return t};o.get_full_list_events=function(){var e,t,n;e=f();(n=e["General"]).push.apply(n,[{type:"APIEvent"},{type:"RecurringEvent"}]);e["Elements"]=function(){var e,n,r,i;r=u();i=[];for(e=0,n=r.length;e<n;e++){t=r[e];i.push({type:t})}return i}();y.extend(e,l());return e};c=function(e){var t,r,i,o,a,s,l,c,f,d,_;i=[];if(e.is_custom_definition()){i.push.apply(i,n.get_events_for_an_element(e.element_type()))}f=e.find_elements();for(a=0,l=f.length;a<l;a++){t=f[a];d=u();for(s=0,c=d.length;s<c;s++){r=d[s];if(t.type()==="CustomElement"&&(typeof(o=t.E).is_popup==="function"?o.is_popup():void 0)&&k.call(n.event_element_mapping[r],"Popup")>=0){i.push(r)}if(_=t.type(),k.call(n.event_element_mapping[r],_)>=0){i.push(r)}}}i=y.unique(i);return y.sort_array(i,u())};o.get_event_object=function(e){var t,n,r,i;if(o[e]){return o[e]}else{r=m.get_service_and_type(e),n=r[0],t=r[1];return(i=m.get_service(n))!=null?i.get_event(e):void 0}};a=e("./../lang/dataops");s=e("./../db/db");v=e("./status_bar");_=e("./../lang/lang")}).call(this)},{"./../client_config":16,"./../db/db":28,"./../lang/appquery":51,"./../lang/dataops":54,"./../lang/lang":57,"./../lib":65,"./../services":70,"./../u":72,"./status_bar":25}],21:[function(e,t,n){(function(t){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,K,J,X,Z,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,fe,de,_e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};re=e("./../u");U=e("./../lang/lang");_=n;re.safe_register("./core/core_expressions",_);o={};i=function(e,t){_[e]=t;return o[e]=t};C=function(e,t){var n,r;return typeof(n=t.datasources)[r=this.context_key]==="function"?n[r](e,t):void 0};ie=function(e,t,n){var r,i,o;return(o=typeof(r=t.datasources)[i=this.context_key+"_value"]==="function"?r[i](n,t):void 0)!=null?o:"null"};i("CurrentUser",{field_names:{},fields:function(e){return[]},get_value:function(e){return"user"},get_unique_string:function(e,t){return m.STATES.CurrentUser()},display:function(){return"Current User"},context_key:"current_user",evaluate:C,get_runmode_value:function(){return"user"}});V={"Current Position":"Current geographic position","Website Home":"Website home URL",CurrentLanguage:"Current language",AppIsTest:"Is Development version"};i("PageData",{field_names:{name:{}},fields:function(e){return[{name:"name"}]},get_value:function(e){var t;return(t=m.get_page_data_type(e("name")))!=null?t:"null"},display:function(e){var t,n;t=e("name");return(n=V[t])!=null?n:re.FirstLetterCapitalize(t.toLowerCase())},context_key:"page_data",evaluate:C,get_runmode_value:ie,get_unique_string:function(e,t){return m.STATES.PageData(e.name)},check_for_errors:function(e){if(m.get_page_data_type(e("name"))==="null"){return"Missing data... please double-check"}}});i("ThisElement",{field_names:{},fields:function(e,t){return[]},get_value:function(e,t){return oe.get(t.context_element().get_value_id())},get_unique_string:function(e,t){return m.STATES.ThisElement()},display:function(e,t){return"This "+S.get_short_display(t.context_element().type())},evaluate:function(e,t){return t.element},get_runmode_value:function(e,t){return t.element.element.get_value_id()}});R=function(e){var t,n,r;return oe.get((n=typeof(t=e.owner).root==="function"?(r=t.root())!=null?r.get_static_property("page_item_type"):void 0:void 0)!=null?n:"null")};i("CurrentPageItem",{field_names:{},fields:function(e,t){return[]},get_value:function(e,t){return R(t)},get_unique_string:function(e,t){return m.STATES.CurrentPageItem()},context_key:"current_page_item",evaluate:C,get_runmode_value:ie,display:function(e,t){var n,r;r=R(t);if(r.id()==="null"){n="Thing"}else{n=r.display()}return"Current Page "+n},check_for_errors:function(e,t){var n;if(R(t).id()==="null"){n=typeof t.root==="function"?t.root():void 0;return"Trying to get the current thing for "+(n!=null?n.name():void 0)+" but this page does not accept data..."}}});_.get_workflow_item_context=function(e,t,n){var r;r=re.extend({},e);r.datasources=re.extend({},e.datasources);r.datasources.current_workflow_item=function(){return t};r.datasources.current_workflow_item_value=function(){return n};return r};i("CurrentWorkflowItem",{field_names:{},fields:function(e,t){return[]},get_value:function(e,t){var n,r,i,o;n=typeof(i=t.owner).event==="function"?i.event():void 0;r=n?(o=n.type())==="OnError"||o==="OnPageError"?"sys.error":n.get_static_property("custom_event_data_type"):void 0;if(r==null){r="null"}return oe.get(r)},context_key:"current_workflow_item",evaluate:C,get_runmode_value:ie,get_unique_string:function(e,t){},display:function(e,t){var n,r,i,o;r=this.get_value(e,t);if((o=typeof(i=t.owner).event==="function"?i.event().get_static_property("custom_event_data_type"):void 0)!=null){o}else{"null"}if(r.id()==="null"){n="Thing"}else{n=r.display()}return"Current Workflow "+n}});i("GetParamFromUrl",{field_names:{parameter_name:{},type:{"default":"parameter"},value:{"default":"text"}},fields:function(e,n){return[{name:"type",caption:"Type",editor:"Dropdown",set:t().sets.List(["parameter","path"])},{name:"parameter_name",caption:"Parameter name",editor:"ShortText",condition:"type is parameter"},{name:"value",caption:"Type",editor:"Dropdown",set:t().sets.DisplayableInListValues(true,true,false,true)}]},get_value:function(e){return e("value")},get_runmode_value:function(e){var t,n;return(t=(n=e["%p"])!=null?n["%v"]:void 0)!=null?t:"text"},evaluate:function(e,n,r){var i,o;t().pageparam._dependency.register();if(e.type==="path"){i=t().location.get_pieces().path[1]}else{i=t().location.get_query()[e.parameter_name]}if(i==null){return i}o=e.value;if(!o){return i}if(o.indexOf("custom.")===0||o==="user"){if(typeof i!=="string"||i.trim()===""){return null}return t().db_instance().get(i)}else{return oe.get(o).cast(i)}},get_unique_string:function(e,t){},display:function(e,t){var n,r;n=e("parameter_name");r=e("type");if(r==="path"){return"Get path from page URL"}else{if(n){return"Get "+n+" from page URL"}}return"Get data from page URL"},get_spot:function(){return"SlidableSpot"}});i("APIEventParameter",{field_names:{key:{}},fields:function(e){return[{key:"key"}]},get_value:function(e,t){var n,r,i,o,a,s,u,l,c,f;n=e("key");r=typeof(s=t.owner).event==="function"?s.event():void 0;if(r==null||!r.get_parameters){return"null"}c=r.get_parameters();for(u=0,l=c.length;u<l;u++){f=c[u],o=f.key,a=f.value,i=f.is_list;if(o===n){if(i){return"list."+a}else{return a}}}},display:function(e){var t;t=e("key");if(t==="_wf_request_data"){return"Request Data"}else{return t}},evaluate:function(e,t){return t.call_parameters[e.key]},get_runmode_value:function(e,t,n){var r,i,o,a,u,l,c,f;if(!t.event_id){return"null"}r=s.workflow_item(t.event_id);c=r.get_parameters();for(u=0,l=c.length;u<l;u++){f=c[u],o=f.key,a=f.value,i=f.is_list;if(o===n.key){if(i){return"list."+a}else{return a}}}return"null"},get_unique_string:function(e,t){return m.STATES.APIEventParameter(e.key)}});_.NO_DB_CONSTRAINTS=["list.date_range","list.number_range","list.geographic_address"];le=function(e){var t;t=["boolean","text","number","date","dateinterval","file","image"];
if(e){t.push("geographic_address")}return t};_.get_fields_set=N=function(e){var n,r,i,o,a,s,u,l,c;u=e.to_find_name,n=e.db_fields_only,s=e.sortable_fields_only,a=e.show_dynamic_sort_option,i=e.hide_unique_id,r=e.exclude_fields;if(r==null){r=[]}if(s){c=le(n)}else{c=null}if(n){l=_.NO_DB_CONSTRAINTS}else{l=null}if(n){o=t().sets.CustomFields({white_list_values:c,values_to_filter_out:l,value_name:u,include_all_fields:!s,add_email_field_for_user_type:u==="user",add_unique_id:!s&&!i,show_dynamic_sort_option:a,show_random_sort_option:s,add_stripe_customer_id:u==="user"&&X.is_installed("stripe")})}else{o=t().sets.MessagesWithoutArguments({white_list_values:c,values_to_filter_out:l,value_name:u,add_advanced:!s?true:false,show_dynamic_sort_option:a,show_random_sort_option:s})}if(r.length>0){return t().sets.Filtered(o,function(e){var t;return t=e.value,_e.call(r,t)<0})}else{return o}};_.constraints_field_names={constraints:{}};_.get_key_value=function(e,t){var n,r,i;if(t){i=oe.get(t)}if(e==="email"&&t==="user"){n="email"}else if(e!==_.ALL_DB_FIELDS&&e!==_.ADVANCED_SEARCH_CONSTRAINT&&e!==_.UNIQUE_ID&&e!=="StripeCustomerID"){n=d.sub_node_key_to_value(i,e);r=(n!=null?n.matches("list*"):void 0)?n.inner():n}else{n=e}return{key_value_delisted:r,key_value:n}};_.constraints_without_values=["empty","not empty","is_empty","is_not_empty"];_.get_constraints_fields=function(e,n,r){var i=this;return[{name:"constraints",editor:"ObjectList",button_caption:"Add a new constraint",optional:true,sub_properties:function(i){var o,a,s,u,l,c,f,d,p;u=i!=null?typeof i.entry==="function"?i.entry("key").get_static():void 0:void 0;p=_.get_key_value(u,e),c=p.key_value_delisted,l=p.key_value;if(l===_.ADVANCED_SEARCH_CONSTRAINT){a="advanced_search_constraint"}else if(l){a=i!=null?i.entry("constraint_type").get_static():void 0;if(a){if(_e.call(t().sets.SearchOperators(l,n).get_options_raw(),a)<0){a=null}}}s=a==="in"||a==="not in"?l===_.UNIQUE_ID?oe.get("list.text"):oe.get("list."+l.id()):a==="contains_all_fields"||(l===_.UNIQUE_ID||l==="StripeCustomerID")?oe.get("text"):a==="advanced_search_constraint"?oe.get("sys.bool"):a==="range_contains_point"||a==="range_greater_than_point"||a==="range_less_than_point"?l.id().split("_range")[0]:c!=null?c:oe.get("null");if(r){f={};f[_.ADVANCED_SEARCH_CONSTRAINT]="Constraint: ";d=t().sets.Object(f)}else{d=N({to_find_name:e,db_fields_only:n})}o=[{name:"key",editor:u!=null?"Label":"Dropdown",label_text:function(){return d.get_display(u)},check_for_error:function(e,t,n,r){var i;if(!e.label_text()){i=""+n+": the constraint field is empty";return r(i,t)}},set:d,pretty:{arrowless:true}},{name:"constraint_type",editor:l===_.ADVANCED_SEARCH_CONSTRAINT||l===_.UNIQUE_ID&&n?"Label":"Dropdown",set:l?t().sets.SearchOperators(l,n):t().sets.NullSet(),label_text:function(){if(l===_.ADVANCED_SEARCH_CONSTRAINT){return""}if(l===_.UNIQUE_ID){return"="}},condition:function(){return l!=null},pretty:{arrowless:true}}];if(_e.call(_.constraints_without_values,a)<0){o.push({name:"value",editor:a==="geographic_search"?"GeographicSearch":a==="in"||a==="not in"?"Basic":l===_.UNIQUE_ID||(c!=null?c.matches("text"):void 0)||(a==="contains_all_fields"||a==="email_equals")?"ShortText":"Basic",value:s,condition:function(){return a!=null||(c!=null?c._id:void 0)==="geographic_address"||l===_.UNIQUE_ID},pretty:{arrowless:true}})}return o}}]};_.sorting_field_names={sort_field:{},dynamic_sort_field:{},geo_reference:{},descending:{optional:true},additional_sort_fields:{optional:true}};de=function(e,t,n,r,i){if(r==null){r=[]}return[{name:"sort_field",caption:"Sort by",editor:"Dropdown",set:N({to_find_name:e,db_fields_only:t,sortable_fields_only:true,show_dynamic_sort_option:true,exclude_fields:r}),optional:!i},{name:"dynamic_sort_field",caption:"Dynamic field name",editor:"ShortText",value:"text",condition:"sort_field is "+_.DYNAMIC_SORTING_FIELD,optional:true},{name:"geo_reference",caption:"Distance from",editor:"Basic",value:"geographic_address",condition:function(){var t;return((t=oe.get(e).get_message(n))!=null?t.ret_value().id():void 0)==="geographic_address"}},{name:"descending",caption:"Descending",editor:"Basic",value:"boolean",condition:function(){return n!=null&&n!==_.RANDOM_SORTING},optional:true}]};_.get_sorting_fields=function(e,t,n){var r,i=this;return(r=de(e,t,n)).concat.apply(r,[{name:"additional_sort_fields",editor:"ObjectList",button_caption:"Add another sort field",sub_properties:function(n,r){var i,o,a,s,u,l,c,f,d;a=[_.RANDOM_SORTING];i=function(e){if(e&&e!==_.DYNAMIC_SORTING_FIELD){return a.push(e)}};i((l=r.property("sort_field"))!=null?l.raw():void 0);o=n!=null?(c=n.raw())!=null?c.sort_field:void 0:void 0;d=(f=r.property("additional_sort_fields"))!=null?f.raw():void 0;for(u in d){s=d[u];if(s.sort_field!==o){i(s.sort_field)}}return de(e,t,o,a,true)},condition:function(){return n!=null&&n!==_.RANDOM_SORTING},optional:true}])};q=function(e,t){var n,r,i,o;if(e===_.ALL_DB_FIELDS||e===_.RANDOM_SORTING||e===_.UNIQUE_ID){return true}if(e==="email"&&t.id()==="user"){return true}if(t.field(e).exists()){return true}o=a.get_special_fields(t);for(r=0,i=o.length;r<i;r++){n=o[r];if(n.name()===e){return true}}console.log("WARNING: bad field name in search: "+e);return false};_.get_sorts_list=function(e,t){var n,r,i,o,a,s;i=[];n=oe.get(e.type_to_find).custom_type();if(!(n!=null?n.exists():void 0)){return[{sort_field:e.sort_field,descending:e.descending}]}o=function(r){var i,o;o=O(r,e.type_to_find,t);i=r.descending;if(n.field(o).value()==="geographic_address"){if(j.get_coordinates(r.geo_reference)!=null){o={location_field:o,geo_reference:r.geo_reference}}else{o=null}}else if(o&&!q(o,n)){o=null;i=null}else if(o===_.RANDOM_SORTING){i=null}else if(o===null||o===void 0){i=null}return{sort_field:o,descending:i}};i.push(o(e));if(e.sort_field===_.RANDOM_SORTING){return i}s=e.additional_sort_fields;for(a in s){r=s[a];i.push(o(r))}return i};O=function(e,t,n){var r,i,o,a,s,u,l,c,f,d,p,h,g,m,v,y;if(e.sort_field!==_.DYNAMIC_SORTING_FIELD){return e.sort_field}if(!e.dynamic_sort_field){return null}r=oe.get(t).custom_type();if(!(r!=null?r.exists():void 0)){return null}o=[];if(n){v=(m=r.fields())!=null?m:[];for(c=0,p=v.length;c<p;c++){i=v[c];o.push({display:i.display(),name:i.name(),value:i.value()})}o.push({display:"Created Date",name:"Created Date",value:"date"});o.push({display:"Modified Date",name:"Modified Date",value:"date"})}else{s=oe.get(t).get_messages();for(f=0,h=s.length;f<h;f++){a=s[f];if((a!=null?a.arg_value():void 0)==null){o.push({display:a.description(void 0,true),name:a.name(),value:a.ret_value_id()})}}}l=e.dynamic_sort_field.toLowerCase();u=le(n);for(d=0,g=o.length;d<g;d++){i=o[d];if(i.display.toLowerCase()===l){if(y=i.value,_e.call(u,y)<0){throw re.error({statusCode:400,message:"The dynamic sort field "+e.dynamic_sort_field+" on the type "+r.display()+" cannot be used for sorting"})}return i.name}}throw re.error({statusCode:400,message:"The dynamic sort field "+e.dynamic_sort_field+" is not recognized as a field on the type "+r.display()});return null};_.resolve_sorts=function(e,t){var n,r,i,o,a;r=[];a=e!=null?e:[];for(i=0,o=a.length;i<o;i++){n=a[i];if(n){if(n.self||n.sort_on_id){r.push(n)}else if(n.sort_field){if(t||typeof n.sort_field!=="object"){r.push(n)}}}}return r};_.resolve_constraints=_.process_constraints=Y=function(e){var t,n,r,i,o,a,s,u,l,c,f,d;r=[];o=e!=null?e:[];for(n in o){t=o[n];if(!(t!=null)){continue}if(t.constraint_type||t.key===_.UNIQUE_ID){if((a=t.constraint_type)==="in"||a==="not in"){i=Array.isArray(t.value)?t.value:(s=(u=t.value)!=null?typeof u.all==="function"?u.all():void 0:void 0)!=null?s:[];r.push({key:t.key,constraint_type:t.constraint_type,value:i})}else if((l=t.constraint_type)==="range_contains"||l==="range_contained_by"||l==="range_overlaps"||l==="range_greater_than"||l==="range_less_than"){i=Array.isArray(t.value)?t.value:(c=(f=t.value)!=null?typeof f.all==="function"?f.all():void 0:void 0)!=null?c:[];if(i.length){r.push({key:t.key,constraint_type:t.constraint_type,value:i})}}else if(d=t.constraint_type,_e.call(_.constraints_without_values,d)>=0){r.push(t)}else if(t.constraint_type!=="geographic_search"&&(t.value!=null&&t.value!=="")){r.push(t)}else if(t.constraint_type==="geographic_search"&&t.value.origin_address!=null&&t.value.origin_address!==""){t.value.origin_address=j.get_address_coordinates(t.value.origin_address);r.push(t)}}if(t.key===_.ADVANCED_SEARCH_CONSTRAINT){r.push(t)}}return r};_.ALL_DB_FIELDS="_all";_.ADVANCED_SEARCH_CONSTRAINT="_advanced_search_constraint";_.UNIQUE_ID="_id";_.DYNAMIC_SORTING_FIELD="_dynamic_sort_field";_.RANDOM_SORTING="_random_sorting";K=function(e){if(!e){return"null"}return"list."+e};i("Search",{get_spot:function(){return"SlidableSpot"},field_names:re.extend({type_to_find:{}},_.constraints_field_names,_.sorting_field_names),fields:function(e,n){var r,i,o,a,s;o=[{name:"type_to_find",caption:"Type",editor:"Dropdown",set:t().sets.CustomTypes(true,false)}];i=_.get_constraints_fields(e("type_to_find"),true);i.push.apply(i,_.get_sorting_fields(e("type_to_find"),true,e("sort_field")));for(a=0,s=i.length;a<s;a++){r=i[a];if(r.condition==null){r.condition="type_to_find"}}o.push.apply(o,i);return o},get_value:function(e){return K(e("type_to_find"))},get_runmode_value:function(e,t,n){return K(n.type_to_find)},get_unique_string:function(e,t){var n,r;r=e.type_to_find,n=e.constraints;return m.STATES.Search(r,n,_.get_sorts_list(e,true))},evaluate:function(e,n){var r,i,o,a,s,u,l,c,f,d,p,h;c=e.type_to_find,i=e.constraints;a=Y(i);o=oe.get(c).custom_type();if(!(o!=null?o.exists():void 0)){c=null}else{a=function(){var e,t,n;n=[];for(e=0,t=a.length;e<t;e++){r=a[e];if(q(r.key,o)){n.push(r)}}return n}();u=_.get_sorts_list(e,true)}if(!c){return new v.StaticList([])}else{s=null;for(f=0,p=a.length;f<p;f++){r=a[f];if(r.key===_.UNIQUE_ID){s=r.value}}if(typeof s!=="string"||s===""){return t().db_instance().find(c,a,u)}else{l=t().db_instance().get(s);if(!l.exists()){return new v.StaticList([])}if(l._type()!==c){return new v.StaticList([])}for(d=0,h=a.length;d<h;d++){r=a[d];if(r.key!==_.UNIQUE_ID){if(!v.local_constrain(l,r)){return new v.StaticList([])}}}return new v.StaticList([l])}}},display:function(e,t){var n,r;r=e("type_to_find");if(r){r=oe.get(r)}n=r!=null?r.display():void 0;if(n){n=" "+n+"s";return"Search for"+n}else{return"Do a search for"}}});_.convert_api_call_to_db_object=function(e,t){var n,r,i;r=oe.get(t.value_id);if(!((i=r.V)!=null?i.convert_to_bubble_instance:void 0)){throw re.error("value "+r.id()+" missing convert_to_bubble_instance",{value_id:r.id(),appname:s.appname(),result:e})}if((r!=null?r.V.is_simple:void 0)&&t.is_list){return function(){var t,i,o,a;o=e!=null?e:[];a=[];for(t=0,i=o.length;t<i;t++){n=o[t];a.push(r.V.convert_to_bubble_instance(n))}return a}()}return r.V.convert_to_bubble_instance(e)};P=function(e){var t,n,r;if(!e){return}n=e.split(".")[0];t=e.split(".").slice(1).join(".");return(r=X.get_service(n))!=null?r.get_call(t):void 0};I=function(e){var t;t=P(e);if(!t){return"null"}return t.get_value_id()};i("GetDataFromAPI",{get_spot:function(){return"SlidableSpot"},display:function(e,t){var n,r;return(n=(r=P(e("provider")))!=null?r.display():void 0)!=null?n:"Get data from an external API"},field_names:U.DETECT_FIELD_NAMES,fields:function(e,n){var r,i,o;i=[{name:"provider",caption:"API provider",editor:"Dropdown",set:t().sets.APIList()}];o=e("provider");r=P(o);if(!r){return i}if(r.fields){i=i.concat(r.fields(e,n))}else{X.add_fields_from_parameters(r.parameters,i)}X.add_key_button(r.service_name,i);return i},evaluate:function(e,t){var n,r;n=P(e.provider);if(!n||t.responsive_mode){return null}if(n.is_authenticated()){r=n.execute(null,e);return _.convert_api_call_to_db_object(r,n)}},get_value:function(e){return I(e("provider"))},get_runmode_value:function(e,t,n){return I(n.provider)},get_unique_string:function(e,t){return m.STATES.GetDataFromAPI(e)}});_.get_element_parent=B=function(e){var t;return(t=e.context_element())!=null?t.parent():void 0};_.get_runtime_parent=function(e){var t;t=e.element.parent();while(t&&t.element.type()!=="RepeatingGroup"&&_e.call(t.element.get_states(),"group_data")<0){t=t.parent()}return t};f=function(e){var t,n;return(t=e!=null?(n=e.parent())!=null?n.get_static_property("group_type"):void 0:void 0)!=null?t:null};w=function(e,t){return oe.get(f(t.context_element()))};i("ElementParent",{field_names:{},fields:function(e,t){return[]},get_value:function(e,t){return w(e,t)},get_runmode_value:function(e,t){return f(t.element.element)},evaluate:function(e,t){var n,r;r=_.get_runtime_parent(t);if(!r){return void 0}else{n=r.state("group_data");return n}},get_unique_string:function(e,t){return m.STATES.ElementParent()},display:function(e,t){var n,r,i,o;o=this.get_value(e,t);if(o.id()==="null"){i="Thing"}else{i=o.display()}r=t.context_element().parent();while(r&&r.type()!=="RepeatingGroup"&&_e.call(r.get_states(),"group_data")<0){r=r.parent()}if((r!=null?r.type():void 0)==="RepeatingGroup"){n="Current cell's "}else{n="Parent group's "}return n+i},check_for_errors:function(e,t){var n,r;if(w(e,t).id()==="null"){n=t.context_element();if(n){r=typeof n.parent==="function"?n.parent():void 0;if(!r){return"You are trying to get the data for the parent of "+n.get_name()+", but this is the top-most element!"}return"You are trying to get the data for the parent of "+n.get_name()+".  However, the parent is "+r.get_name()+", which does not have a type of data set on it."}}}});i("CurrentCellsIndex",{field_names:{},fields:function(){return[]},get_value:function(){return"number"},get_runmode_value:function(){return"number"},evaluate:function(e,t){var n;n=_.get_runtime_parent(t);if(!n){return void 0}else{while((n!=null?n.element.type():void 0)!=="GroupItem"){n=typeof n.parent==="function"?n.parent():void 0}if(n){return n.state("cell_index")}}},get_unique_string:function(){return m.STATES.CurrentCellsIndex()},display:function(){return"Current cell's index"}});g=function(e,t){if(t.length<=e){return t}else{return t.slice(0,e-3)+"..."}};D=function(e,t){var n,r;n=s.action(e("action_id"));if(!n||!n.exists()){return null}r=n.next();while(r){if(t.owner.id()===r.id()){return n}else{r=r.next()}}return null};i("PreviousStep",{field_names:{action_id:{}},fields:function(e,t){return[{name:"action_id"}]},get_value:function(e,t){var n,r;return(n=(r=D(e,t))!=null?r.return_value():void 0)!=null?n:"null"},get_runmode_value:function(e,t,n){var r;r=n.action_id;return t.frozen_state.get(this.get_unique_string({action_id:r})+"_value")},evaluate:function(e,t){return t.frozen_state.get(this.get_unique_string(e))},get_unique_string:function(e){return m.STATES.PreviousStep(e.action_id)},display:function(e,t){var n,r,i;n=D(e,t);if(!n){return"Result of missing step"}r=0;i=s.action(e("action_id"));while(i.is_action()){i=i.previous();r+=1}return"Result of step "+r+" ("+g(20,n.display())+")"},check_for_errors:function(e,t){if(!D(e,t)){return"It looks like the action this used to refer to was deleted or moved"}}});z=function(e,t){var n,r,i,o;n=s.element(e("element_id"));if(((r=t.context_element())!=null?typeof r.root==="function"?(i=r.root())!=null?i.id():void 0:void 0:void 0)&&(n!=null?(o=n.root())!=null?o.id():void 0:void 0)!==t.context_element().root().id()){return null}return n};i("GetElement",{field_names:{element_id:{}},fields:function(e,t){return[{name:"element_id"}]},get_value:function(e,t){var n,r;n=(r=z(e,t))!=null?r.id():void 0;if(n){return"element."+n}else{return"null"}},get_runmode_value:function(e,t,n){var r;r=n.element_id;if(r){return"element."+r}else{return"null"}},evaluate:function(e,t){return t.element.find_instance_by_id(e.element_id)},get_unique_string:function(e,t){return null},display:function(e,t){var n,r;n=z(e,t);return(r=n!=null?n.get_name():void 0)!=null?r:"[missing element]"},check_for_errors:function(e,t){if(!z(e,t)){return"It looks the element this used to refer to was deleted or is on a different page... please double-check!"}}});ue=function(e){var t,n;t=e;while((t!=null?t.exists():void 0)&&t.path().indexOf(".")!==-1){if((typeof t.name==="function"?t.name():void 0)==="filtered"){n=t.get_value().inner();return n}t=t.parent_expression()}};i("Dehydrated",{field_names:{val:{},value_id:{}},fields:function(e,t){return[{name:"val"},{name:"value_id"}]},get_value:function(e,t){return e("value_id")},get_runmode_value:function(e,t,n){var r;r=n.value_id;return r},evaluate:function(e,n){return v.rehydrate_tree(t().db_instance(),e.val)},get_unique_string:function(e,t){return null},display:function(e,t){return"Dehydrated"},check_for_errors:function(e,t){}});i("InjectedValue",{field_names:{},fields:function(e,t){return[]},get_value:function(e,t){var n,r,i,o,a,s;n=(r=ue(t))!=null?r.id():void 0;if(n){return n}if(typeof(t!=null?(i=t.owner)!=null?i.get_injected_value:void 0:void 0)==="function"){n=t.owner.get_injected_value(t);if(n){return n}}return(o=t!=null?(a=t.owner)!=null?(s=a.E)!=null?typeof s.get_injected_value==="function"?s.get_injected_value(t.owner):void 0:void 0:void 0:void 0)!=null?o:"null"},context_key:"injected_value",evaluate:C,get_runmode_value:ie,get_unique_string:function(e,t){return null},display:function(e,t){var n,r,i;r=ue(t);if(r){return"This "+r.display()}if(typeof t.owner.get_injected_display==="function"){n=t.owner.get_injected_display(t);if(n){return n}}if(((i=t.owner.E)!=null?i.get_injected_display:void 0)!=null){return t.owner.E.get_injected_display(t)}}});Z=function(e,t,n){var i,o;o=e(t);if(o[r.type]==="GetElement"){i=o[r.properties][r.element_id];if(i){return d._apply_content_format_to_input(i,n)}}};i("Formulas",{get_spot:function(){return"SlidableSpot"},display:function(e,t){var n;n=e("formula_type");if(n){return"Calculate "+n}else{return"Calculate formula"}},field_names:U.DETECT_FIELD_NAMES,fields:function(e,n){var r,i,o,a,s,u,l;r=[{name:"formula_type",caption:"Type",editor:"Dropdown",set:t().sets.Object(p.list_of_formulas)}];a=e("formula_type");if(!a){return r}s=p[a];l=s.fields;u=function(t,n){var i,o,a;return r.push({name:t,caption:(i=n.caption)!=null?i:t,editor:(o=n.editor)!=null?o:"Basic",value:(a=n.value)!=null?a:"number",value_setter:{property_modifier:function(){var r;return Z(e,t,(r=n.content_format)!=null?r:"float_number")},no_need_to_show_message:function(){return true}}})};for(o in l){i=l[o];u(o,i)}return r},get_value:function(e){var t,n,r;t=e("formula_type");return(n=(r=p[t])!=null?r.ret_value:void 0)!=null?n:"number"},get_runmode_value:function(e,t,n){var r,i,o;r=n.formula_type;return(i=(o=p[r])!=null?o.ret_value:void 0)!=null?i:"number"},get_unique_string:function(e,t){},evaluate:function(e,t){var n,r;n=p[e.formula_type];return(r=n!=null?n.evaluate(e,t):void 0)!=null?r:null}});i("AppSetting",{get_spot:function(){return"SlidableSpot"},field_names:re.extend({setting_name:{},"private":{}}),fields:function(e,t){var n;n=[{name:"setting_name",caption:"Setting name",editor:"StaticText"},{name:"private",caption:"Private",editor:"Checkbox"}];return n},get_value:function(e){return"text"},get_runmode_value:function(e,t,n){return"text"},get_unique_string:function(e,t){},evaluate:function(e,t){if(!e.setting_name){return null}if(e["private"]){return s.get_private_setting(e.setting_name)}else{return s.get_public_setting(e.setting_name)}},display:function(e,t){var n,r;r=e("setting_name");n=e("private");if(!r){return"Setting: [TBD]"}else if(n){return"Private Setting: "+r}else{return"Public Setting: "+r}}});i("AppText",{get_spot:function(){return"SlidableSpot"},field_names:{text_id:{},information:{}},fields:function(e,n){var r,i,o;r=[{name:"text_id",caption:"Text ID",editor:"Dropdown",set:t().sets.AppTexts()}];o=e("text_id");if(o){i=F.app_language();if(i&&s.get_public_setting("text."+i+".USER_TEXTS."+o)){r.push({name:"information",label_text:"Content in "+i+": "+s.get_public_setting("text."+i+".USER_TEXTS."+o),editor:"Label"})}r.push({name:"information",label_text:"Define the value of the text in a different language in the Settings Tab.",click_cb:function(){$(".tab.tabs-6").click();t().settings_editor.settings_canvas.open_tab("Language");return window.HideSlidable()},editor:"Label"})}return r},get_value:function(e){return"text"},get_runmode_value:function(e,t,n){return"text"},get_unique_string:function(e,t){},evaluate:function(e,n){if(!e.text_id){return""}return t().get_text("USER_TEXTS",e.text_id)},display:function(e,t){var n,r,i,o;i=e("text_id");o=s.get_public_setting("user_text_ids."+i);if(o===true){r=i}else{r=o}n=r!=null?r:"?";return"App Text ("+n+")"}});_.get_composer_context=function(e){var t,n,r,i,o,a,s,u,l,c,f,d,p,h,g,m,v,y;if(e.owner.get_composer_context){return e.owner.get_composer_context()}n=e.context_element();if(e.owner instanceof U.GenericEvent){a=false;s=e;while(s!=null){if(s.node_name()==="condition"){a=true;break}s=s.parent_expression()}}if(e.owner instanceof U.GenericElement){r=e.owner.E.field_names;s=e;while(s!=null){if(r[s.node_name()]!=null){if(r[s.node_name()].server_side_eval){u=true;break}}s=s.parent_expression()}}s=e;while(s!=null){if((typeof s.name==="function"?s.name():void 0)==="filtered"){g=(p=(h=s.property("constraints"))!=null?typeof h.entries==="function"?h.entries():void 0:void 0)!=null?p:[];for(f=0,d=g.length;f<d;f++){t=g[f];if(t.get_static_property("key")===_.ADVANCED_SEARCH_CONSTRAINT&&e.path().indexOf(t.path())===0){o=true;i=true;break}}}if(o){break}s=s.parent_expression()}if(!o){if((n!=null?(m=n.E)!=null?m.use_injected_datasource:void 0:void 0)!=null){o=typeof(l=n.E).use_injected_datasource==="function"?l.use_injected_datasource(e,n):void 0}else{if(typeof e.owner.use_injected_datasource==="function"){v=e.owner.use_injected_datasource(e),o=v[0],i=v[1]}}}return{node:e,is_state:e.owner instanceof U.State,is_event_condition:a,is_workflow:e.owner instanceof U.WorkflowObject,is_api:typeof(c=e.owner).root==="function"?(y=c.root())!=null?y.is_api():void 0:void 0,element_node:n,injected_value:o,full_list_of_datasources:i,is_style:n!=null?typeof n.is_style==="function"?n.is_style():void 0:void 0,server_side_eval:u}};_.get_visible_elements=function(e){var t,n,r,i;if(!e){return[]}r=e.root();if(!r){return[]}t=(i=[r]).concat.apply(i,r.find_elements());return function(){var r,i,o;o=[];for(r=0,i=t.length;r<i;r++){n=t[r];if(_.is_element_visible(n,e)){o.push(n)}}return o}()};_.is_element_visible=function(e,t){var n,r,i,o,a;if(((o=e.root())!=null?o.id():void 0)!==((a=t.root())!=null?a.id():void 0)){return false}r=function(){var e,n,r,o;r=t.parents("RepeatingGroup");o=[];for(e=0,n=r.length;e<n;e++){i=r[e];o.push(i.id())}return o}();n=function(e){var t,n,o,a;o=e.parents("RepeatingGroup");for(t=0,n=o.length;t<n;t++){i=o[t];if(a=i.id(),_e.call(r,a)<0){return false}}return true};return n(e)};x=["Input","MultiLineInput","RichTextInput","Dropdown","SliderInput","DateInput","PictureInput","FileInput","Checkbox","Group","Popup","RepeatingGroup","FloatingGroup","CustomElement","Image","Button","Icon","Text","Link"];k={};for(L=ce=0,fe=x.length;ce<fe;L=++ce){b=x[L];k[b]=L}_.sort_elements_by_type=function(e){var t,n,i,o,a,s,u;a={};i={};for(s=0,u=e.length;s<u;s++){t=e[s];n=t.id();a[n]=t.json._child(r.type).get();i[n]=t.get_name()}o=function(e,t){var n,r,o,s,u,l;n=e.id();s=t.id();o=a[n];l=a[s];if(e.incompatible_type&&!t.incompatible_type){return 1}else if(!e.incompatible_type&&t.incompatible_type){return-1}if(o===l){if(i[n]<i[s]){return-1}else{return 1}}else{r=k[o];u=k[l];if(r!=null&&u==null){return-1}else if(r==null&&u!=null){return 1}if(r!=null){if(u!=null){if(r<u){return-1}else{return 1}}else{return-1}}else if(o<l){return-1}else{return 1}}};return e.sort(o)};te=function(e,t){var n,r,i,o,a,s,u,l;a=t!=null?t.parent():void 0;if(!a||a instanceof U.Root){return e}n=[];o=[];i=a.json._path();for(s=0,u=e.length;s<u;s++){r=e[s];l=r.json._path();if(l.indexOf(i)!==-1){n.push(r)}else{o.push(r)}}return n.concat(o)};_.get_datasources_for_context=function(e,t){var n,r,i,o,a,l,f,d,p,h,g,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,z,B,N,L,q,F,W,G,V,Y,H,$,K=this;g=[];if(t.privacy_condition){g.push(U.RAW.DataSource("CurrentUser"));g.push(U.RAW.DataSource("InjectedValue"));return g}if(t.is_style){g.push(U.RAW.DataSource("ThisElement"));P=["Current Page Width","Current Page Scrolling Position"];for(x=0,A=P.length;x<A;x++){a=P[x];g.push(U.RAW.DataSource("PageData",{name:a}))}return g}if(t.is_api){i=t.node.owner.event();z=i.get_parameters();for(k=0,E=z.length;k<E;k++){o=z[k].key;g.push(U.RAW.DataSource("APIEventParameter",{key:o}))}}if(t.injected_value){g.push(U.RAW.DataSource("InjectedValue"));if(!t.full_list_of_datasources){return g}}if(t.element_node&&!(t.is_api||t.server_side_eval)&&(t.is_state||t.is_workflow)){d=U.RAW.DataSource("ThisElement",{element_id:t.element_node.id()});v=ee(d,t).get_value();if((q=_.get_messages_for_context(v,t))!=null?q.length:void 0){g.push(d)}}if(((F=typeof(y=t.node.owner).event==="function"?(W=y.event())!=null?W.get_static_property("custom_event_data_type"):void 0:void 0)!=null?F:"null")!=="null"||((G=typeof(b=t.node.owner).event==="function"?(V=b.event())!=null?V.type():void 0:void 0)==="OnError"||G==="OnPageError")){g.push(U.RAW.DataSource("CurrentWorkflowItem"))}if(!t.is_api&&!t.server_side_eval){l=(Y=(H=t.element_node)!=null?($=H.parent())!=null?$.get_states():void 0:void 0)!=null?Y:[];if(_e.call(l,"group_data")>=0||_e.call(l,"list_data")>=0||_e.call(l,"currently_selected_event")>=0||_e.call(l,"currently_selected_marker")>=0){g.push(U.RAW.DataSource("ElementParent"))}if(_e.call(l,"list_data")>=0){g.push(U.RAW.DataSource("CurrentCellsIndex"))}}f=typeof(w=t.node.owner).previous==="function"?w.previous():void 0;while(f instanceof U.Action){if(f.return_value().id()!=="null"){g.push(U.RAW.DataSource("PreviousStep",{action_id:f.id()}))}f=f.previous()}g.push(U.RAW.DataSource("CurrentUser"));if(!t.is_api&&R(t.node).id()!=="null"){g.push(U.RAW.DataSource("CurrentPageItem"))}if(!t.server_side_eval){g.push({type:"Search",cb_fn:function(e){return e({node:t.node,stay_on_this_node:true,val:U.RAW.DataSource("Search")})}});g.push({type:"GetDataFromAPI",cb_fn:function(e){return e({node:t.node,stay_on_this_node:true,val:U.RAW.DataSource("GetDataFromAPI")})}});g.push({type:"Formulas",cb_fn:function(e){return e({node:t.node,stay_on_this_node:true,val:U.RAW.DataSource("Formulas")})}})}if(!t.is_api&&!t.server_side_eval){r=[];B=_.get_visible_elements(t.element_node);for(S=0,M=B.length;S<M;S++){n=B[S];d=U.RAW.DataSource("GetElement",{element_id:n.id()});if(n.is_input()){if(n.type()==="Input"||u(d,e,t)){delete n.incompatible_type}else{n.incompatible_type=true}r.push(n)}else if(u(d,e,t)){r.push(n)}}_.sort_elements_by_type(r);r=te(r,t.element_node);for(D=0,T=r.length;D<T;D++){n=r[D];g.push(U.RAW.DataSource("GetElement",{element_id:n.id(),incompatible_type:n.incompatible_type}))}}g.push(U.RAW.DataSource("AppText",{}));if(!t.server_side_eval){N=m.get_page_data_names(t);for(O=0,C=N.length;O<C;O++){a=N[O];g.push(U.RAW.DataSource("PageData",{name:a}))}}if(!t.is_api&&!t.server_side_eval){g.push(U.RAW.DataSource("GetParamFromUrl",{}))}if(L=s.appname(),_e.call(c.hard_code,L)>=0){g.push(U.RAW.DataSource("AppSetting",{}))}if((typeof e.get_name==="function"?e.get_name():void 0)==="saveable"){p=[];for(I=0,j=g.length;I<j;I++){h=g[I];if(u(h,e,t)){p.push(h)}}return p}return g};_.get_messages_for_context=function(e,t){var n;return function(){var r,i,o,a;o=e.get_messages();a=[];for(r=0,i=o.length;r<i;r++){n=o[r];if(n.filter_context(t)){a.push(n)}}return a}()};ee=function(e,t){return U.new_expression(U.VirtualJSON(t.node.json,e),t.node.owner)};u=function(e,t,n){var r;if(e.type==="Search"){return true}r=ee(e,n).get_value();return l(r,t,n,{})};_.can_message_get_to=function(e,t,n){var r;r=e.ret_value();return l(r,t,n,{})};se={};G=function(e){var t,n,r;if(e&&typeof e==="object"){if(e.toUniqueString){return e.toUniqueString()}else{n={};for(t in e){r=e[t];n[t]=G(r)}return n}}else{return e}};l=function(e,t,n){var r,i,o;if(n){r=JSON.stringify(G(n))}else{r=""}if(typeof t.display==="function"){i=t.display()}else{i=t}o=(e!=null?e.id():void 0)+"_"+i+" "+r;if(se[o]==null){se[o]=re.Watcher(function(){if(!(e!=null?e.id():void 0)){return}return ae(oe.get(e.id()),t,n)})}return se[o].get()};ae=function(e,t,n,r){var i,o,a,s,u,l;if(r==null){r={}}if(r[e.id()]){return false}r[e.id()]=true;if(e.matches(t)){return true}o=_.get_messages_for_context(e,n);a=function(){var e,t,n;n=[];for(e=0,t=o.length;e<t;e++){i=o[e];n.push(i.ret_value())}return n}();for(u=0,l=a.length;u<l;u++){s=a[u];if(ae(s,t,n,r)){return true}}return false};H=function(e,t){var n;if(e.type()==="ThisElement"){return 60}if(e.type()==="PreviousStep"){return 80}if(e.type()==="CurrentUser"){return 40}if((n=e.type())==="ElementParent"||n==="CurrentCellsIndex"){return 70}return 30};_.datasource_to_option=function(e,n){var r,i,o,a;r=ee(e,n);if((a=e.properties)!=null?a.element_id:void 0){if(e.properties.incompatible_type){o="Documentation.Data.DataSources.IncompatibleType";i="Incompatible type"}else{o=e.properties.element_id}}else{if(_[e.type]!=null){o=y.for_datasource(e)}}return new(t().sets.Option)(r.display(),e,o,H(r,n),i)};_.message_to_option=function(e,n){var r,i,o=this;i=U.RAW.Message(e.name());if(e.spot_data()==="SlidableSpot"){r={};r.cb_fn=function(e){return e({stay_on_this_node:true,node:n.node.next(),val:i})}}return new(t().sets.Option)(e.description(),r!=null?r:i,e.M.documentation_id,void 0,void 0,e.M.delete_cb)};_.assign_to_sections=function(e,t){var n,r,i,o,a,s,u,l,c;s=t.is_workflow?"This Workflow":"This Element";r={APIEventParameter:s,ThisElement:s,InjectedValue:s,CurrentUser:"DB Data",CurrentPageItem:"DB Data",CurrentWorkflowItem:"DB Data",Search:"DB Data",GetDataFromAPI:"DB Data",Formulas:"DB Data",ElementParent:s,CurrentCellsIndex:s,PreviousStep:s,PageData:"General Info",GetElement:"Page Elements","boolean":"Literals",GetParamFromUrl:"General Info",AppText:"General Info",AppSetting:"General Info"};o={};for(u=0,l=e.length;u<l;u++){i=e[u];if(typeof i.value==="object"){n=i.value.type}else{n=typeof i.value}a=function(){if((c=r[n])!=null){return c}else{throw re.error("missing section for datasource "+n)}}();if(o[a]==null){o[a]=[]}o[a].push(i)}return o};s=e("./../lang/appquery");t=e("./../lib");m=e("./../lang/dataops");U=e("./../lang/lang");X=e("./../services");h=e("./../editor/css");y=e("./../documentation_id_getter");oe=e("./../lang/values");j=e("./../geolocation");v=e("./../db/db");d=e("./core_actions");p=e("./core_formulas");a=e("./../lang/application");r=e("./../lang/shrink").S;S=e("./../lang/elements");c=e("./../client_config");F=e("./../languages")}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./../client_config":16,"./../db/db":28,"./../documentation_id_getter":34,"./../editor/css":36,"./../geolocation":41,"./../lang/application":50,"./../lang/appquery":51,"./../lang/dataops":54,"./../lang/elements":55,"./../lang/lang":57,"./../lang/shrink":61,"./../lang/values":62,"./../languages":64,"./../lib":65,"./../locations":66,"./../services":70,"./../tests/testing":71,"./../u":72,"./core_actions":18,"./core_formulas":22}],22:[function(e,t,n){(function(){var t,r,i,o,a;a=e("./../u");o=e("./../lang/lang");i=e("./../geolocation");r=n;r.list_of_formulas={};r.all={};t=function(e,t){r[e]=t;r.list_of_formulas[e]=t.display;return r.all[e]=t};t("PMT",{display:"Loan Payment",fields:{rate:{content_format:"percentage"},nper:{},pv:{}},evaluate:function(e){var t,n,r,i,o,a,s;a=e.rate,n=e.nper,i=e.pv;t=0;s=0;if(a===0){return-(i+t)/n}o=Math.pow(1+a,n);r=a/(o-1)*-(i*o+t);if(s===1){r/=1+a}return r},testing:{properties:{rate:.1,nper:10,pv:1e3},result:-162.74539488251153}});t("CoordToAddress",{display:"Coordinates to Address",fields:{latitude:{},longitude:{}},ret_value:"geographic_address",evaluate:function(e){return i.get_address_from_location(e)},testing:{ignore:true}});t("RandomString",{display:"Generate random string",fields:{length:{"default":6,caption:"Length of characters"},letters:{"default":true,editor:"Checkbox",caption:"Use letters"},non_cap:{"default":true,editor:"Checkbox",
caption:"Use non capitalized letters"},numbers:{"default":false,editor:"Checkbox",caption:"Use numbers"},special_chars:{"default":false,editor:"Checkbox",caption:"Use special characters"}},ret_value:"text",evaluate:function(e,t){var n,r,i,o,a,s,u,l,c,f;if(!e){return""}if(t.is_in_partial){return"not available in debugger"}i=e.length,o=e.letters,a=e.non_cap,s=e.numbers,c=e.special_chars;u="";if(o){u+="ASDFGHJKLZXCVBNMQWERTYUIOP"}if(a){u+="qwertyuiopasdfghjklzxcvbnm"}if(s){u+="1234567890"}if(c){u+="{}[];:/<>?_+~!@#"}if(t!=null?t.random_generator:void 0){n=function(e){return t.random_generator.random(0,e)}}else{n=function(e){return Math.random()*e}}l="";for(r=f=0;0<=i?f<i:f>i;r=0<=i?++f:--f){l+=u.charAt(Math.floor(n(u.length)))}return l},testing:{ignore:true}});t("SumProduct",{display:"Calculate sumproduct",fields:{list_1:{value:"list.number",caption:"List 1"},list_2:{value:"list.number",caption:"List 2"}},evaluate:function(e,t){var n,r,i,o,a,s,u;if(!e){return 0}r=e.list_1,i=e.list_2;s=function(e){var t;return(t=e!=null?typeof e.all==="function"?e.all():void 0:void 0)!=null?t:e};r=s(r);i=s(i);if(!(r!=null?r.length:void 0)||!(i!=null?i.length:void 0)){return 0}o=Math.min(r.length,i.length);a=0;for(n=u=0;0<=o?u<o:u>o;n=0<=o?++u:--u){a+=r[n]*i[n]}return a},testing:{ignore:true}})}).call(this)},{"./../geolocation":41,"./../lang/lang":57,"./../u":72}],23:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,$,K,J,X,Z,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,fe,de,_e,pe,he,ge,me,ve,ye,be,we,xe,ke,Se,Ae,Ee,Me,Te,Ce,je,De,Oe,Ie,Pe=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1},Re=this;g=n;ue=e("./../u");s=e("./../lang/appquery");A=e("./../documentation_id_getter");f=e("./../client_config");W=e("./../db/postgres_constraints");ue.safe_register("./core/core_values",g);H=e;if(ue.on_server()){U=H("moment-timezone")}else{U=e("./../jquery_plugins/moment.timezone.min.js")}o=function(e,t){return g[e]=t};u=function(e,t){var n,r,i;i=t.messages;for(r in i){n=i[r];n.documentation_id=A.for_value_messages(e,r)}delete t.messages;t.get_message_names=function(){var e,t,n;n=[];for(e in i){t=i[e];n.push(e)}return n};t.get_message=function(e){return i[e]};t.is_simple=true;return t};l=function(e){if(e==null){return""}else{return String(e)}};D=function(e,t){throw ue.error("Expected a "+e+", but got a "+typeof t+" (original data: "+ue.json_stringify(t,true)+")")};o("text",u("text",{messages:{equals:{description:" is ",ret_value:"sys.bool",arg_value:"text",fn:function(e,t){return e===t},build_pg_constraint:W.equals,build_pg_r_constraint:W.equals,build_pg_relationship:W.equals_both},not_equals:{description:" is not ",ret_value:"sys.bool",arg_value:"text",fn:function(e,t){return e!==t},build_pg_constraint:W.not_equals,build_pg_r_constraint:W.not_equals,build_pg_relationship:W.not_equals_both},contains:{description:" contains ",ret_value:"sys.bool",arg_value:"text",fn:function(e,t){if(!(e!=null?e.indexOf:void 0)){return false}return e.indexOf(t)!==-1}},not_contains:{description:" doesn't contain ",ret_value:"sys.bool",arg_value:"text",fn:function(e,t){if(!(e!=null?e.indexOf:void 0)){return true}return e.indexOf(t)===-1}},is_empty:{description:" is empty",ret_value:"sys.bool",build_pg_constraint:W.is_empty,fn:function(e,t){return e===void 0||e===null||e===""}},is_not_empty:{description:" is not empty",ret_value:"sys.bool",build_pg_constraint:W.is_not_empty,fn:function(e,t){return e!==void 0&&e!==null&&e!==""}},to_capitalized_words:{description:":capitalized words",ret_value:"text",arg_value:null,fn:function(e,t){return ue.toTitleCase(e)}},to_uppercase:{description:":uppercase",ret_value:"text",arg_value:null,fn:function(e,t){return e!=null?typeof e.toUpperCase==="function"?e.toUpperCase():void 0:void 0}},to_lowercase:{description:":lowercase",ret_value:"text",arg_value:null,fn:function(e,t){return e!=null?typeof e.toLowerCase==="function"?e.toLowerCase():void 0:void 0}},format_text:{description:function(e){var t,n;t=e!=null?e.get_static_property("formatting_type"):void 0;if(t!=null){switch(t){case"url_encode":n=" URL";break;case"md5_hash":n=" MD5 hash";break;case"hmac":n=" HMAC digest";break;default:n=" "+_.input_masks[t].caption}}else{n="..."}return":formatted as"+n},description_for_sliding_palette:"Text Formatting",ret_value:"text",arg_value:null,spot_data:"SlidableSpot",field_names:{formatting_type:{},replace_space:{"default":true},hmac_key:{},encode_b64:{}},fields:function(){var e;e={us_phone:_.input_masks["us_phone"].caption,url_encode:"URL Encoded",md5_hash:"MD5 Hash",hmac:"HMAC SHA256 Digest"};if(Pe.call(s.list_plugins(),"salesforce")>=0){ue.extend(e,{us_ssn:_.input_masks["us_ssn"].caption})}return[{name:"formatting_type",caption:"Format type",editor:"Dropdown",set:r().sets.Object(e)},{name:"replace_space",caption:"Replace spaces by +",editor:"Checkbox",condition:"formatting_type is url_encode"},{name:"hmac_key",caption:"HMAC Secret",editor:"ShortText",condition:"formatting_type is hmac"},{name:"encode_b64",caption:"Base64-encode the result",editor:"Checkbox",condition:"formatting_type is hmac"},{name:"information",label_text:"Note that this conversion will only happen server-side. The key will be kept secret if used in an API workflow, it is not safe if used in a regular workflow in a page.",editor:"Label",condition:"formatting_type is hmac"}]},fn:function(e,t,n){var r,i,o,a;i=n.formatting_type;if(e==null){return""}if(i==="us_phone"){if(e.length===11){r=e[0];e=e.slice(1)}else{r=null}if(e.length===10){a="("+e.slice(0,3)+") "+e.slice(3,6)+"-"+e.slice(6);if(r){a=r+" "+a}return a}else{return e}}else if(i==="us_ssn"){if(e.length===9){return e.slice(0,3)+"-"+e.slice(3,5)+"-"+e.slice(5)}else{return e}}else if(i==="url_encode"){if(n.replace_space){return encodeURIComponent(e.replace(/\s/g,"+"))}else{return encodeURIComponent(e)}}else if(i==="md5_hash"){return ue.digest(e)}else if(i==="hmac"){if(!ue.on_server()){return"HMAC Digest computation on the client"}if(!n.hmac_key){return"HMAC Secret missing"}o=v.createHmac("SHA256",n.hmac_key).update(e);if(n.encode_b64){return o.digest("base64")}else{return o.digest("hex")}}else{return"unrecognized format type: "+i}}},trimmed:{description:":trimmed",ret_value:"text",arg_value:null,fn:function(e,t){return e!=null?typeof e.trim==="function"?e.trim():void 0:void 0}},length:{description:":number of characters",ret_value:"number",arg_value:null,fn:function(e,t){if(!e){return 0}return e.length}},truncated:{description:":truncated to ",ret_value:"text",arg_value:"number",fn:function(e,t){if(typeof e!=="string"){return null}if(!t){return e}else{return e.slice(0,se(t))}}},truncated_right:{description:":truncated from end to ",ret_value:"text",arg_value:"number",fn:function(e,t){if(typeof e!=="string"){return null}if(!t){return e}else{return e.slice(e.length-se(t))}}},extract_from_text:{description:function(e){var t,n;t=e!=null?e.property("component_to_extract"):void 0;if(t&&!t.is_empty()){n=" "+t.get_static()}else{n="..."}return":extract"+n},description_for_sliding_palette:"Extract from text",ret_value:"text",spot_data:"SlidableSpot",field_names:{text_type:{},component_to_extract:{}},fields:function(e){var t,n,i;i=e("text_type");t={email:["domain","top domain","alias"]};if(i){n=t[i]}else{n=[]}return[{name:"text_type",caption:"Text type",editor:"Dropdown",set:r().sets.List(["email"])},{name:"component_to_extract",caption:"Component",editor:"Dropdown",set:r().sets.List(n),condition:function(){return i}}]},fn:function(e,t,n){var r,i,o;if(!e){return""}switch(n.text_type){case"email":if(!ue.is_email(e)){return""}else{switch(n.component_to_extract){case"domain":return e.split("@")[1];case"alias":return e.split("@")[0];case"top domain":r=e.split("@")[1];o=r.split(".");i=o.length;return o[i-2]+"."+o[i-1]}}}}},find_replace:{description:":find & replace",description_for_sliding_palette:"Find and Replace",ret_value:"text",spot_data:"SlidableSpot",field_names:{find:{},use_regex:{"default":false},replace:{optional:true}},fields:function(e){return[{name:"use_regex",caption:"Use a regex pattern",editor:"Checkbox"},{name:"find",caption:e("use_regex")?"Regex pattern":"Text to find",editor:"LongText"},{name:"replace",caption:"Replace by",editor:"LongText"}]},fn:function(e,t,n){var r,i,o,a,s;if(!e||e.split==null){return""}i=n.find;if(i===void 0||i===null||i===""){return e}a=(s=n.replace)!=null?s:"";if(!n.use_regex){return e.split(i).join(a)}else{try{o=new RegExp(i,"g")}catch(u){r=u;throw ue.error({statusCode:400,message:"Bad Regex format: "+r.message})}return e.replace(o,a)}}},extract_regex:{description:":extract with Regex",description_for_sliding_palette:"Extract with Regex",ret_value:"list.text",spot_data:"SlidableSpot",field_names:{regex:{}},fields:function(e){return[{name:"regex",caption:"Regex pattern",editor:"ShortText"}]},fn:function(e,t,n){var r,i,o;if(!e||e.split==null||((o=n.regex)===void 0||o===null||o==="")){return null}try{i=new RegExp(n.regex,"g")}catch(a){r=a;throw ue.error({statusCode:400,message:"Bad Regex format: "+r.message})}return e.match(i)}}},display:function(){return"text"},equals:function(e,t){return e===t},get_sample:function(){return"Lorem ipsum..."},cast:l,cast_to_string:l,get_JS_object:function(e){if(!e){return null}return l(e)},JS_to_bubble:function(e){if(e==null){return null}if(typeof e!=="string"){D("string",e)}return e},can_sort:true,editor_name:"text",convert_to_bubble_instance:function(e){return e},storable:true,bindable:false}));$=function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)};se=function(e){var t;t=parseFloat(e);if(!isFinite(t)){return null}else{return t}};F=function(e,t){var n,r,i,o,a,s;a=se(e);s=se(t);n=Math.abs(a);r=Math.abs(s);if(a===s){return true}i=Math.abs(a-s);o=1e-15;if(a===0||s===0||i<Number.MIN_VALUE){return i<o*Number.MIN_VALUE}return i/Math.min(n+r,Number.MAX_VALUE)<o};y={dollar:"$",euro:"€",pound:"£",yen:"¥",rand:"R",naira:"₦",won:"₩",peso:"₱"};ae={comma:",",space:"Space",dot:"."};S={point:".",comma:","};g.format_number_names={formatting_type:{"default":"number",no_states:true},decimal_place:{},decimal_separator:{"default":"point"},thousand_separator:{},currency_symbol:{},negative_parenthese:{}};g.format_number_fields=function(){return[{name:"formatting_type",caption:"Number type",editor:"Dropdown",set:r().sets.Object({number:"Number",currency:"Currency",percentage:"Percentage"})},{name:"decimal_place",caption:"Decimal place",editor:"Dropdown",set:r().sets.Integer([0,1,2,3,4]),numerical_step:1,optional:true,pretty:{dropdown_width:"short"}},{name:"decimal_separator",caption:"Decimal separator",editor:"Dropdown",set:r().sets.Object(S),pretty:{dropdown_width:"short"}},{name:"thousand_separator",caption:"Thousand separator",editor:"Dropdown",set:r().sets.Object(ae),optional:true,pretty:{dropdown_width:"short"}},{name:"currency_symbol",caption:"Currency",editor:"Dropdown",set:r().sets.Object(y),optional:true,condition:"formatting_type is currency",pretty:{dropdown_width:"short"}},{name:"negative_parenthese",caption:"Use parentheses for negative numbers",editor:"Checkbox"}]};o("number",u("number",{messages:{format_number:{description:function(e){var t,n;t=e!=null?e.evaluate_properties():void 0;if(t){n=" "+this.fn("1028.58",void 0,t)}else{n="..."}return":formatted as"+n},description_for_sliding_palette:"Number Formatting",ret_value:"text",fn:function(e,t,n){var r,i,o,a,s,u;e=se(e);if(e==null){return}o=function(e){return n[e]};if(o("formatting_type")==="percentage"){e=e*100}e=parseFloat(e.toPrecision(12));if(o("decimal_place")!==void 0){i=e.toFixed(o("decimal_place"))}else{i=e.toString()}r=S[o("decimal_separator")];i=i.replace(".",r);if(o("thousand_separator")){a=ae[o("thousand_separator")];if(a==="Space"){a=" "}s=i.split(r);s[0]=ue.add_thousand_sep(s[0],a);i=s.join(r)}if(o("formatting_type")==="currency"&&o("currency_symbol")){u=y[o("currency_symbol")];i=u+i}if(o("formatting_type")==="percentage"){i=i+"%"}if(o("negative_parenthese")&&e<0){i="("+i.slice(1)+")"}return i},spot_data:"SlidableSpot",field_names:g.format_number_names,fields:function(){return g.format_number_fields()}},equals:{description:" is ",ret_value:"sys.bool",arg_value:"number",fn:function(e,t){return F(e,t)},build_pg_constraint:W.equals,build_pg_r_constraint:W.equals,build_pg_relationship:W.equals_both},not_equals:{description:" is not ",ret_value:"sys.bool",arg_value:"number",fn:function(e,t){return!F(e,t)},build_pg_constraint:W.not_equals,build_pg_r_constraint:W.not_equals,build_pg_relationship:W.not_equals_both},greater_than:{description:" > ",ret_value:"sys.bool",arg_value:"number",fn:function(e,t){return se(e)>se(t)}},greater_or_equal_than:{description:" ≥ ",ret_value:"sys.bool",arg_value:"number",fn:function(e,t){return se(e)>=se(t)}},less_than:{description:" < ",ret_value:"sys.bool",arg_value:"number",fn:function(e,t){return se(e)<se(t)}},less_or_equal_than:{description:" ≤ ",ret_value:"sys.bool",arg_value:"number",fn:function(e,t){return se(e)<=se(t)}},plus:{description:" + ",ret_value:"number",arg_value:"number",fn:function(e,t){return se(e)+se(t)}},minus:{description:" - ",ret_value:"number",arg_value:"number",fn:function(e,t){return se(e)-se(t)}},times:{description:" * ",ret_value:"number",arg_value:"number",fn:function(e,t){return se(e)*se(t)}},divide:{description:" / ",ret_value:"number",arg_value:"number",fn:function(e,t){return se(se(e)/se(t))}},round:{description:":rounded to ",ret_value:"number",arg_value:"number",fn:function(e,t){return $(se(e),se(t))},editor:{"static":true,"default":1}},floor:{description:":floor ",ret_value:"number",fn:function(e,t){return Math.floor(se(e))}},ceil:{description:":ceiling ",ret_value:"number",fn:function(e,t){return Math.ceil(se(e))}},power:{description:" ^ ",ret_value:"number",arg_value:"number",fn:function(e,t){return Math.pow(se(e),se(t))}},to_range:{description:"<- range ->",arg_value:"number",ret_value:"number_range",fn:function(e,t){e=se(e);t=se(t);if(e==null||t==null){return null}return[Math.min(e,t),Math.max(e,t)]}},max:{description:" <- max -> ",ret_value:"number",arg_value:"number",fn:function(e,t){return Math.max(se(e),se(t))}},min:{description:" <- min -> ",ret_value:"number",arg_value:"number",fn:function(e,t){return Math.min(se(e),se(t))}},modulo:{description:" <- modulo -> ",ret_value:"number",arg_value:"number",fn:function(e,t){return se(e)%se(t)}},is_empty:{description:" is empty",ret_value:"sys.bool",build_pg_constraint:W.is_empty,fn:function(e,t){return e===void 0||e===null||e===""}},is_not_empty:{description:" is not empty",ret_value:"sys.bool",build_pg_constraint:W.is_not_empty,fn:function(e,t){return e!==void 0&&e!==null&&e!==""}}},editor_name:"number",display:function(){return"number"},cast_to_string:function(e){var t;e=se(e);if(e===null){return""}else{e=parseFloat(e.toPrecision(12));t=ue.detect_decimal_thousand_separators().decimalSeparator;e=String(e);if(t!=="."){e=e.replace(".",t)}return e}},equals:F,get_sample:function(){return 42},cast:function(e){return se(e)},get_JS_object:function(e){return se(e)},JS_to_bubble:function(e){var t;if(e==null){return null}t=se(e);if(typeof t!=="number"){D("number",e)}return t},convert_to_bubble_instance:function(e){return se(e)},can_sort:true,storable:true,bindable:false}));we=function(e){if(e!=null?e.all:void 0){return e.all()}else{return e}};me=function(e,t,n){var r,i,o,a,s,u,l,c=this;a={min:{description:e==="date"?":start":":min",ret_value:e,fn:function(e,r){if(!e){return}e=we(e);return n(Math.min(t(e[0]),t(e[1])))}},max:{description:e==="date"?":end":":max",ret_value:e,fn:function(e,r){if(!e){return}e=we(e);return n(Math.max(t(e[0]),t(e[1])))}},average:{description:e==="date"?":center":":average",ret_value:e,fn:function(e,r){if(!e){return}e=we(e);return n((t(e[0])+t(e[1]))/2)}},is_empty:{description:" is empty",ret_value:"sys.bool",fn:function(e,t){e=we(e);return e===void 0||e===null||e.length===0}},is_not_empty:{description:" is not empty",ret_value:"sys.bool",fn:function(e,t){e=we(e);return e!==void 0&&e!==null&&e.length!==0}}};if(e==="date"){u="before";o="after"}else{u="smaller";o="greater"}s={range_contains:{description:" contains "},range_contains_point:{description:" contains point "},range_contained_by:{description:" is contained by "},range_overlaps:{description:" overlaps with "},range_greater_than:{description:" is "+o},range_greater_than_point:{description:" is "+o+" (point) "},range_less_than:{description:" is "+u},range_less_than_point:{description:" is "+u+" (point) "}};l=function(n,r){var i,o=this;i=n.indexOf("_point")!==-1;return a[n]={description:r.description,ret_value:"sys.bool",arg_value:i?e:e+"_range",fn:function(e,r){var o,a,s;if(!e){return false}e=we(e);s=function(e){var n,r;n=t(e!=null?e[0]:void 0);r=t(e!=null?e[1]:void 0);return[Math.min(n,r),Math.max(n,r)]};a=s(e);if(i){o=t(r)}else{r=we(r);o=s(r)}return k.all_search_constraints[n](o,a)}}};for(i in s){r=s[i];l(i,r)}return a};o("number_range",u("number_range",{messages:me("number",se,function(e){return e}),display:function(){return"numeric range"},cast_to_string:function(e){return JSON.stringify(this.cast(e))},can_cast_to_string:function(){return false},equals:function(e,t){var n,r;e=we(e);t=we(t);n=e!=null?e.sort():void 0;r=t!=null?t.sort():void 0;return(n!=null?n[0]:void 0)===(r!=null?r[0]:void 0)&&(n!=null?n[1]:void 0)===(r!=null?r[1]:void 0)},get_sample:function(){return[1,30]},cast:function(e){var t,n;if(!e){return[]}e=we(e);t=se(e[0]);n=se(e[1]);return[Math.min(t,n),Math.max(t,n)]},get_JS_object:function(e){if(!e){return null}return this.cast(e)},JS_to_bubble:function(e){if(e==null){return null}if(!Array.isArray(e)||typeof e[0]!=="number"||typeof e[1]!=="number"){D("number range",e)}return this.cast(e)},storable:true,bindable:false}));q=function(e){var t;if(e instanceof Date){t=e}else if(typeof e==="number"){t=new Date(e)}else if(typeof e==="string"){if(String(parseFloat(e))===e){t=new Date(parseFloat(e))}else{t=new Date(Date.parse(e))}}else{t=new Date(NaN)}if(isNaN(t.valueOf())){return null}else{return t}};o("null",u("null",{messages:{},can_cast_to_string:function(){return false},cast_to_string:function(e){return""},get_sample:function(){return null},equals:function(e,t){return e!=null===(t!=null)},cast:function(e){return e},display:function(){return""},get_JS_object:function(e){return null},JS_to_bubble:function(e){return null},storable:false,bindable:false,convert_to_bubble_instance:function(){return null}}));ve=function(e,t){var n;return e.setHours(e.getHours()-((n=t!=null?t.timezone_offset:void 0)!=null?n:0)/60)};o("date",u("date",{messages:{format_date:{description:function(e){var t,n,r;t={formatting_type:(r=e!=null?e.property("formatting_type").raw():void 0)!=null?r:"m/dd/yy",custom_format:e!=null?e.property("custom_format").raw():void 0};if(t){n=" "+this.fn(new Date,void 0,t)}else{n="..."}return":formatted as"+n},description_for_sliding_palette:"Date Formatting",ret_value:"text",arg_value:null,spot_data:"SlidableSpot",field_names:{formatting_type:{"default":"m/dd/yy"},custom_format:{"default":"ddd, m/dd/yy, mmmm (mmm) dS, yyyy, h:MM tt, HH:MM:ss.L"},tz_type:{"default":"browser"},tz_static:{},tz_dynamic:{}},fields:function(){var e,t,n,i,o,a;e=new Date;n={};a=["m/dd/yy","m/dd/yyyy","mmm d, yyyy","mmmm d, yyyy","ddd, mmm d, yyyy","ddd d mmmm, yyyy","dddd, mmmm d, yyyy","h:MM tt","HH:MM","HH:MM:ss"];for(i=0,o=a.length;i<o;i++){t=a[i];n[t]=ue.format_date(e,t,r().get_text("BUILT_IN","DATE_FORMAT"))}n.iso_date="Simplified extended ISO";n.custom="Custom";return[{name:"formatting_type",caption:"Format type",editor:"Dropdown",set:r().sets.Object(n)},{name:"custom_format",caption:"Custom format",editor:"StaticText",condition:"formatting_type is custom"},{name:"tz_type",caption:"Time zone selection",editor:"Dropdown",set:r().sets.Object({browser:"User's current time zone","static":"Static choice",dynamic:"Dynamic choice"})},{name:"tz_static",caption:"Time zone ID",editor:"Dropdown",set:r().sets.List(U.tz.names(),"real_time_search"),condition:"tz_type is static"},{name:"tz_dynamic",caption:"Dynamic time zone",editor:"Basic",value:"text",condition:"tz_type is dynamic"}]},fn:function(e,t,n,i,o){var a,s,u;a=n!=null?n.formatting_type:void 0;if(a==="custom"){a=n.custom_format}e=q(e);if(e===null){return""}else{switch(n.tz_type){case"browser":u=o!=null?o.timezone_string:void 0;break;case"static":u=n.tz_static;break;case"dynamic":u=n.tz_dynamic}if(u&&U.tz.zone(u)!=null){s=U.tz.zone(u).offset(e.getTime())-e.getTimezoneOffset()}if(a==="iso_date"){return e.toISOString()}return ue.format_date(e,a,r().get_text("BUILT_IN","DATE_FORMAT"),s)}}},to_range:{description:"<- range ->",arg_value:"date",ret_value:"date_range",fn:function(e,t){e=q(e);t=q(t);if(e==null||t==null){return null}return[q(Math.min(e,t)),q(Math.max(e,t))]}},plus_seconds:{description:" +(seconds): ",ret_value:"date",arg_value:"number",fn:function(e,t){var n;n=new Date(q(e));if(e===null){return null}else{n.setSeconds(n.getSeconds()+t);return n}}},plus_hours:{description:" +(hours): ",ret_value:"date",arg_value:"number",fn:function(e,t){var n,r;r=new Date(q(e));if(e===null){return null}else{n=1e3*60*60*t;r.setTime(r.getTime()+n);return r}}},plus_days:{description:" +(days): ",ret_value:"date",arg_value:"number",fn:function(e,t){var n;n=new Date(q(e));if(e===null){return null}else{n.setDate(n.getDate()+t);return n}}},plus_months:{description:" +(months): ",ret_value:"date",arg_value:"number",fn:function(e,t){var n;n=new Date(q(e));if(e===null){return null}else{n.setMonth(n.getMonth()+t);return n}}},plus_years:{description:" +(years): ",ret_value:"date",arg_value:"number",fn:function(e,t){var n;n=new Date(q(e));if(e===null){return null}else{n.setFullYear(n.getFullYear()+t);return n}}},change_seconds:{description:" change seconds to ",ret_value:"date",arg_value:"number",fn:function(e,t){var n;n=new Date(q(e));if(e===null){return null}else{n.setSeconds(se(t));n.setMilliseconds(0);return n}}},change_minutes:{description:" change minutes to ",ret_value:"date",arg_value:"number",fn:function(e,t){var n;n=new Date(q(e));if(e===null){return null}else{n.setMinutes(se(t));return n}}},change_hours:{description:" change hours to ",ret_value:"date",arg_value:"number",fn:function(e,t,n,r,i){var o,a;o=new Date(q(e));ve(o,i);if(e===null){return null}else{o.setHours(se(t)+((a=i!=null?i.timezone_offset:void 0)!=null?a:0)/60);return o}}},change_date:{description:" change date to ",ret_value:"date",arg_value:"number",fn:function(e,t){var n;n=new Date(q(e));if(e===null){return null}else{n.setDate(se(t));return n}}},change_month:{description:" change month to ",ret_value:"date",arg_value:"number",fn:function(e,t){var n;n=new Date(q(e));if(e===null){return null}else{n.setMonth(se(t)-1);return n}}},change_years:{description:" change years to ",ret_value:"date",arg_value:"number",fn:function(e,t){var n;n=new Date(q(e));if(e===null){return null}else{n.setFullYear(se(t));return n}}},greater_than:{description:" > ",ret_value:"sys.bool",arg_value:"date",fn:function(e,t){return q(e)>q(t)}},less_than:{description:" < ",ret_value:"sys.bool",arg_value:"date",fn:function(e,t){return q(e)<q(t)}},minus:{description:" - ",ret_value:"dateinterval",arg_value:"date",fn:function(e,t){return q(e)-q(t)}},extract_from_date:{description:function(e){var t,n;t=e!=null?e.property("component_to_extract"):void 0;if(t&&!t.is_empty()){n=" "+t.get_static()}else{n="..."}return":extract"+n},description_for_sliding_palette:"Extract from date",ret_value:"number",spot_data:"SlidableSpot",field_names:{component_to_extract:{}},fields:function(e){var t,n,i,o,a;n={};a=["minute","hour","day","date","week","month","year"];for(i=0,o=a.length;i<o;i++){t=a[i];n[t]=t}n.UNIX="UNIX timestamp (ms)";return[{name:"component_to_extract",caption:"Component",editor:"Dropdown",set:r().sets.Object(n)}]},fn:function(e,t,n,r,i){var o;e=q(e);if(!e){return""}if(n.component_to_extract!=="UNIX"){ve(e,i)}o=function(e){var t,n;t=new Date(e.getTime());t.setHours(0,0,0,0);t.setDate(t.getDate()+3-(t.getDay()+6)%7);n=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)};switch(n.component_to_extract){case"minute":return e.getMinutes();case"hour":return e.getHours();case"day":return e.getDay();case"date":return e.getDate();case"week":return o(e);case"month":return e.getMonth()+1;case"year":return e.getYear()+1900;case"UNIX":return e.getTime()}}},max:{description:" <- max -> ",ret_value:"date",arg_value:"date",fn:function(e,t){var n,r;if(((n=q(e))!=null?typeof n.getTime==="function"?n.getTime():void 0:void 0)>=((r=q(t))!=null?typeof r.getTime==="function"?r.getTime():void 0:void 0)||t==null){return e}else{return t}}},min:{description:" <- min -> ",ret_value:"date",arg_value:"date",fn:function(e,t){var n,r;if(((n=q(e))!=null?typeof n.getTime==="function"?n.getTime():void 0:void 0)<=((r=q(t))!=null?typeof r.getTime==="function"?r.getTime():void 0:void 0)||t==null){return e}else{return t}}},is_empty:{description:" is empty",ret_value:"sys.bool",build_pg_constraint:W.is_empty,fn:function(e,t){return e===void 0||e===null||e===""}},is_not_empty:{description:" is not empty",ret_value:"sys.bool",build_pg_constraint:W.is_not_empty,fn:function(e,t){return e!==void 0&&e!==null&&e!==""}}},display:function(){return"date"},cast_to_string:function(e){return ue.format_date(q(e),"mmm d, yyyy h:MM tt")},equals:function(e,t){var n,r;return((n=q(e))!=null?n.valueOf():void 0)===((r=q(t))!=null?r.valueOf():void 0)},get_sample:function(){return new Date},cast:function(e){return q(e)},get_JS_object:function(e){return q(e)},JS_to_bubble:function(e){var t;t=this.cast(e);if(t==null){D("date",e)}return t},convert_to_bubble_instance:function(e){return q(e)},can_sort:true,storable:true,bindable:false}));x=function(e){var t;return(t=q(e))!=null?t.getTime():void 0};o("date_range",u("date_range",{messages:me("date",x,q),display:function(){return"date range"},cast_to_string:function(e){var t,n,r;r=this.cast(e),n=r[0],t=r[1];return JSON.stringify([ue.format_date(n,"mmm d, yyyy h:MM tt"),ue.format_date(t,"mmm d, yyyy h:MM tt")])},can_cast_to_string:function(){return false},equals:function(e,t){var n,r,i,o,a,s;e=we(e);t=we(t);o=x(q(e!=null?e[0]:void 0));a=x(q(e!=null?e[1]:void 0));s=x(q(t[0]));i=x(q(t[1]));n=[o,a].sort();r=[s,i].sort();return(n!=null?n[0]:void 0)===(r!=null?r[0]:void 0)&&(n!=null?n[1]:void 0)===(r!=null?r[1]:void 0)},get_sample:function(){var e,t;e=new Date;t=t.setDate(e.getDate()-2);return[e,t]},cast:function(e){var t,n;if(!e){return[]}e=we(e);t=x(q(e[0]));n=x(q(e[1]));return[q(Math.min(t,n)),q(Math.max(t,n))]},get_JS_object:function(e){if(!e){return null}return this.cast(e)},JS_to_bubble:function(e){if(e==null){return null}if(!Array.isArray(e)||q(e[0])==null||q(e[1])==null){D("date range",e)}return this.cast(e)},storable:true,bindable:false}));o("dateinterval",u("dateinterval",{messages:{to_days:{description:":format as days",ret_value:"number",arg_value:null,fn:function(e,t){return ue.format_date_interval(e,"days")}},to_hours:{description:":format as hours",ret_value:"number",arg_value:null,fn:function(e,t){return ue.format_date_interval(e,"hours")}},to_minutes:{description:":format as minutes",ret_value:"number",arg_value:null,fn:function(e,t){return ue.format_date_interval(e,"minutes")}},to_seconds:{description:":format as seconds",ret_value:"number",arg_value:null,fn:function(e,t){return ue.format_date_interval(e,"seconds")}}},display:function(){return"date interval"},cast_to_string:function(e){return ue.print_date_interval(e)},can_cast_to_string:function(){return false},equals:F,get_sample:function(){return 252e8},cast:function(e){return se(e)},get_JS_object:function(e){return this.cast(e)},JS_to_bubble:function(e){if(e==null){return null}if(typeof e!=="number"){D("date interval",e)}return e},storable:true,bindable:false}));C={description:function(e){return":formatted as text"},description_for_sliding_palette:"Boolean Formatting",ret_value:"text",arg_value:null,fn:function(e,t,n){var r,i;if(e){return(r=n.formatting_for_true)!=null?r:""}else{return(i=n.formatting_for_false)!=null?i:""}},spot_data:"SlidableSpot",field_names:{formatting_for_true:{"default":"yes"},formatting_for_false:{"default":"no"}},fields:function(){return[{name:"formatting_for_true",caption:"Formatting for yes",editor:"LongText",optional:true},{name:"formatting_for_false",caption:"Formatting for no",editor:"LongText",optional:true}]}};j={description:function(e){return":formatted as number"},description_for_sliding_palette:"Boolean Formatting",ret_value:"number",arg_value:null,fn:function(e,t,n){var r,i;if(e){return(r=n.formatting_for_true)!=null?r:0}else{return(i=n.formatting_for_false)!=null?i:0}},spot_data:"SlidableSpot",field_names:{formatting_for_true:{"default":1},formatting_for_false:{"default":0}},fields:function(){return[{name:"formatting_for_true",caption:"Formatting for yes",editor:"StaticNumber"},{name:"formatting_for_false",caption:"Formatting for no",editor:"StaticNumber"}]}};(function(){var e,t,n;n=function(e){if(typeof e==="boolean"){return e}else if(typeof e==="string"){e=e.toLowerCase();switch(e){case"yes":case"true":return true;case"no":case"false":return false;default:return null}}else{return null}};e=function(e){e=n(e);if(e==null){return""}else{if(e){return r().get_text("BUILT_IN","YES")}else{return r().get_text("BUILT_IN","NO")}}};t=function(e,t){return n(e)===n(t)};o("sys",{get:function(r){if(r==="error"){return u(r,{messages:{code:{description:"'s code",ret_value:"text",fn:function(e,t){return e!=null?e.child("code").get():void 0}},message:{description:"'s message",ret_value:"text",fn:function(e,t){return e!=null?e.child("message").get():void 0}}},display:function(){return"Error"},cast_to_string:function(e){return e!=null?e.child("message").get():void 0},equals:function(){return false},storable:false,bindable:false,get_sample:function(){return new k.StaticObject({code:"SAMPLE",message:"THIS IS A SAMPLE"})},convert_to_bubble_instance:function(e){return e},cast:function(e){return e}})}else if(r==="bool"){return u(r,{messages:{and_:{description:" and ",ret_value:"sys.bool",arg_value:"sys.bool",fn:function(e,t){return n(e)&&n(t)}},or_:{description:" or ",ret_value:"sys.bool",arg_value:"sys.bool",fn:function(e,t){return n(e)||n(t)}},format_boolean:C,format_boolean_number:j},display:function(){return"yes / no"},editor_name:"boolean",cast_to_string:e,equals:t,storable:false,bindable:false,synonyms:["boolean"],get_sample:function(){return true},convert_to_bubble_instance:function(e){return n(e)},cast:function(e){return n(e)},get_JS_object:function(e){var t;t=this.cast(e);if(t==null){t=false}return t}})}else if(r==="uid"){return u(r,{display:function(){return"unique identifier"},editor_name:"text",cast_to_string:function(e){return e},equals:function(e,t){return e===t},storable:false,bindable:false,synonyms:["text"],get_sample:function(){return"asdf234sdz"},cast:l,cast_to_string:l,messages:{equals:{description:" is ",ret_value:"sys.bool",arg_value:"text",fn:function(e,t){return e===t},build_pg_constraint:W.equals,build_pg_r_constraint:W.equals,build_pg_relationship:W.equals_both},not_equals:{description:" is not ",ret_value:"sys.bool",arg_value:"text",fn:function(e,t){return e!==t},build_pg_constraint:W.not_equals,build_pg_r_constraint:W.not_equals,build_pg_relationship:W.not_equals_both},is_empty:{description:" is empty",ret_value:"sys.bool",build_pg_constraint:W.is_empty,fn:function(e,t){return e===void 0||e===null||e===""}},is_not_empty:{description:" is not empty",ret_value:"sys.bool",build_pg_constraint:W.is_not_empty,fn:function(e,t){return e!==void 0&&e!==null&&e!==""}},trimmed:{description:":trimmed",ret_value:"text",arg_value:null,fn:function(e,t){return e!=null?typeof e.trim==="function"?e.trim():void 0:void 0}},length:{description:":number of characters",ret_value:"number",arg_value:null,fn:function(e,t){if(!e){return 0}return e.length}},truncated:{description:":truncated to ",ret_value:"text",
arg_value:"number",fn:function(e,t){if(typeof e!=="string"){return null}if(!t){return e}else{return e.slice(0,se(t))}}},truncated_right:{description:":truncated from end to ",ret_value:"text",arg_value:"number",fn:function(e,t){if(typeof e!=="string"){return null}if(!t){return e}else{return e.slice(e.length-se(t))}}}}})}},list:function(){return[]},display:function(){return"sys"}});return o("boolean",u("boolean",{messages:{is_true:{description:' is "yes"',ret_value:"sys.bool",build_pg_constraint:W.is_true,fn:function(e,t){return n(e)}},is_false:{description:' is "no"',ret_value:"sys.bool",build_pg_constraint:W.is_false,fn:function(e,t){return!n(e)}},format_boolean:C,format_boolean_number:j},display:function(){return"yes / no"},editor_name:"boolean",cast_to_string:e,equals:t,get_sample:function(){return true},cast:function(e){return n(e)},get_JS_object:function(e){var t;t=this.cast(e);if(t==null){t=false}return t},JS_to_bubble:function(e){e=this.cast(e);if(e===void 0){D("boolean",e)}return e},convert_to_bubble_instance:function(e){return n(e)},storable:true,bindable:false}))})();T=function(e){return{is_empty:{description:" is empty",ret_value:"sys.bool",build_pg_constraint:W.is_empty,fn:function(e,t){return e===void 0||e===null||e===""}},is_not_empty:{description:" is not empty",ret_value:"sys.bool",build_pg_constraint:W.is_not_empty,fn:function(e,t){return e!==void 0&&e!==null&&e!==""}},file_name:{description:"'s file name",ret_value:"text",arg_value:null,fn:function(e,t){var n;if(!(e!=null?e.split:void 0)){return null}n=e.split("/");return decodeURIComponent(n[n.length-1])}},url:{description:"'s URL",ret_value:"text",arg_value:null,fn:function(e,t){return e}},saved_s3:{description:":saved to S3",ret_value:e,arg_value:null,filter_context:function(e){return e.is_workflow},fn:function(e,n){var i,o,a,s,u;if(e==null||!e.split){return null}if(!ue.is_url(e)){return null}if(e.indexOf("blob:")===0){return null}if(!ue.on_server()||ue.running_test()){return e}if(e.indexOf(f.user_file_url)!==-1){return e}s=r().KeyValueDB().get("small",e);if(s!=null){return s}e=e.replace("/../","/");u=e.split("/");o=u[u.length-1];i={file_url:e,filename:o,appname:r().appname(),app_version:r().app_version()};a=(new t).upload_by_url(i);r().KeyValueDB().put("small",e,a,5*60);return a}},to_base64:{description:":encoded in base64",ret_value:"text",arg_value:null,filter_context:function(e){return e.is_workflow},fn:function(e,t){var n;if(e==null||!e.split){return null}if(!ue.on_server()){return""}if(e.slice(0,2)==="//"){e="http:"+e}if(e.indexOf("http")!==0){return null}n=r().http_request({url:e,encoding:null}).block().body;return ue.base64(n)}}}};o("file",u("file",{messages:T("file"),display:function(){return"file"},equals:function(e,t){return e===t},get_sample:function(){return"file_name.png"},cast:l,cast_to_string:l,get_JS_object:function(e){if(!e){return null}return l(e)},JS_to_bubble:function(e){if(e==null){return null}if(typeof e!=="string"){D("file url as a string",e)}return e},convert_to_bubble_instance:function(e){return e},editor_name:"text",synonyms:["text"],storable:true,bindable:false,can_sort:true}));o("image",u("image",{messages:ue.extend({},T("image"),{imgix_treatment:{description:function(e){return":processed with Imgix"},description_for_sliding_palette:"Imgix processing",ret_value:"image",arg_value:null,fn:function(e,t,n){if(!e){return null}return P.add_processing_options(e,n)},spot_data:"SlidableSpot",field_names:{auto_enhance:{},q:{"default":75,optional:true},fm:{optional:true},extract_face:{"default":false},crop_to_fit:{"default":false},red_eye:{"default":false},blur:{"default":false},blur_level:{"default":100},mask:{"default":false},pixel:{"default":false},pixel_level:{"default":10},sepia:{"default":false},sepia_level:{"default":50},mono:{"default":false},mono_level:{"default":"#3498db"}},fields:function(){return[{name:"auto_enhance",caption:"Auto enhance the image",editor:"Checkbox"},{name:"q",caption:"Quality (0 - 100)",editor:"Dropdown",numerical_step:25,set:r().sets.Numeric([0,25,50,75,100])},{name:"fm",caption:"File format",editor:"Dropdown",set:r().sets.List(["png","png8","png32","jpg","pjpg"])},{name:"extract_face",caption:"Auto crop around the face",editor:"Checkbox"},{name:"crop_to_fit",caption:"Resize to fit the dimensions by cropping",editor:"Checkbox",condition:"extract_face is false"},{name:"mask",caption:"Apply a circle/ellipse mask",editor:"Checkbox"},{name:"red_eye",caption:"Remove red eyes",editor:"Checkbox"},{name:"blur",caption:"Apply some blur",editor:"Checkbox"},{name:"blur_level",caption:"Blur level",condition:"blur",editor:"Dropdown",numerical_step:100,set:r().sets.Numeric([0,100,500,1e3,1500,2e3])},{name:"pixel",caption:"Apply some pixellation",editor:"Checkbox"},{name:"pixel_level",caption:"Pixellation level",condition:"pixel",editor:"Dropdown",numerical_step:10,set:r().sets.Numeric([0,20,40,60,80,100])},{name:"sepia",caption:"Apply some sepia effect",editor:"Checkbox"},{name:"sepia_level",caption:"Sepia level",condition:"sepia",editor:"Dropdown",numerical_step:10,set:r().sets.Numeric([0,20,40,60,80,100])},{name:"mono",caption:"Applies an overall monochromatic hue change",editor:"Checkbox"},{name:"mono_level",caption:"Monochromatic color",condition:"mono",editor:"Color"}]}}}),display:function(){return"image"},equals:function(e,t){return e===t},get_sample:function(){return"image_name.png"},cast:l,cast_to_string:l,get_JS_object:function(e){if(!e){return null}return l(e)},JS_to_bubble:function(e){if(e==null){return null}if(typeof e!=="string"){D("image url as a string",e)}return e},convert_to_bubble_instance:function(e){return e},editor_name:"text",synonyms:["text"],storable:true,bindable:false}));o("geographic_address",u("geographic_address",{display:function(){return"geographic address"},equals:function(e,t){return e===t},messages:{formatted_address:{description:"'s formatted address",ret_value:"text",fn:function(e,t){if(!e){return""}return O.get_address(e)}},google_map_link:{description:"'s link to Google Maps",ret_value:"text",fn:function(e,t){var n,r,i,o;if(typeof e!=="string"){return""}r=O.get_coordinates(e);if(!r){return""}i=r.latitude,o=r.longitude;n=O.get_address(e).split(" ").join("+").replace(",","");return"https://www.google.com/maps/place/"+n+"/@"+i+","+o+",15z"}},distance_from:{description:function(e){var t,n;t=e!=null?e.property("origin_address"):void 0;if(t&&!t.is_empty()){n=" "+t.get_tree_display()}else{n="..."}return" distance from"+n},description_for_sliding_palette:"Distance to an address",ret_value:"number",arg_value:null,spot_data:"SlidableSpot",field_names:{origin_address:{},unit:{"default":"miles"}},fields:function(){return[{name:"origin_address",caption:"Origin address",editor:"Basic",value:"geographic_address"},{name:"unit",caption:"Unit",editor:"Dropdown",set:r().sets.Object({kms:"kms",miles:"miles"})}]},fn:function(e,t,n){var r,i;if(typeof e!=="string"){return null}if(typeof n.origin_address!=="string"){return null}i=O.get_coordinates(n.origin_address);r=O.get_coordinates(e);if(!r||!i){return null}return O.geographic_distance(r,i,n.unit)}},is_empty:{description:" is empty",ret_value:"sys.bool",fn:function(e,t){return e===void 0||e===null||e===""}},is_not_empty:{description:" is not empty",ret_value:"sys.bool",fn:function(e,t){return e!==void 0&&e!==null&&e!==""}},extract_from_address:{description:function(e){var t,n;t=e!=null?e.property("component_to_extract"):void 0;if(t&&!t.is_empty()){n=" "+t.get_static()}else{n="..."}return":extract"+n},description_for_sliding_palette:"Extract from address",ret_value:"text",arg_value:null,spot_data:"SlidableSpot",field_names:{component_to_extract:{}},fields:function(){var e,t;return[{name:"component_to_extract",caption:"Component",editor:"Dropdown",set:r().sets.List(function(){var n,r;n=O.types_to_save;r=[];for(e in n){t=n[e];r.push(e)}return r}())}]},fn:function(e,t,n){var r,i;if(!e){return""}r=O.get_address_components(e);return(i=r[n.component_to_extract])!=null?i:""}},equals:{description:" is ",ret_value:"sys.bool",arg_value:"text",fn:function(e,t){return e===O.get_address_coordinates(t)}},latitude:{description:"'s latitude",ret_value:"number",fn:function(e,t){var n;return(n=O.get_coordinates(e))!=null?n.latitude:void 0}},longitude:{description:"'s longitude",ret_value:"number",fn:function(e,t){var n;return(n=O.get_coordinates(e))!=null?n.longitude:void 0}},timezone:{description:"'s time zone ID",ret_value:"text",fn:function(e,t){var n;if(!e){return""}return(n=O.get_timezone(e))!=null?n.timeZoneId:void 0}},timezone_name:{description:"'s time zone name",ret_value:"text",fn:function(e,t){var n;if(!e){return""}return(n=O.get_timezone(e))!=null?n.timeZoneName:void 0}},daysaving_offset:{description:"'s daylight saving time offset",ret_value:"number",fn:function(e,t){var n;if(!e){return""}return(n=O.get_timezone(e))!=null?n.dstOffset:void 0}}},cast:function(e){return O.get_address_coordinates(e)},cast_to_string:function(e){if(!e){return""}else{return O.get_address(e)}},get_JS_object:function(e){if(!e){return null}return{address:this.get_message("formatted_address").fn(e),lat:this.get_message("latitude").fn(e),lng:this.get_message("longitude").fn(e)}},JS_to_bubble:function(e){if(e==null){return null}if(typeof e==="string"){return function(){return O.get_address_coordinates(e)}}else if(typeof e==="object"){if(typeof e.address==="string"){return function(){return O.get_address_coordinates(e.address)}}else if(typeof e.lat==="number"&&typeof e.lng==="number"){return function(){return O.get_address_from_location({latitude:e.lat,longitude:e.lng})}}}return D("geographic address as either a string or an object with lat and lng",e)},get_sample:function(){return O.SAMPLE_VALUE},synonyms:["text"],editor_name:"geographic_address",can_sort:false,storable:true,bindable:false}));he={};ke={};pe=function(e,t,n){var r;if(n){r=function(e){if(!he[e.element_id()]){he[e.element_id()]=e.element.get_related_workflows("ButtonClicked")}return he[e.element_id()]};ue.extend(t,{isnt_clickable:{description:" isn't clickable",ret_value:"boolean",fn:function(e,t){var n,i,o;if(!e){return null}if(ue.on_server()){return e.state("client_eval_isnt_clickable")}i=function(){var t,n,i,o,a,s,u,l;if(e.evaluate_property("button_disabled")){return true}else{a=e.toUniqueString();if(ke[a]){delete ke[a];i=true}ke[a]=true;t={element:e,datasources:w.get_basic_datasources(e.element.root())};n=r(e);l=_.find_inputs_to_check(e,n,t,i).input_instances;for(s=0,u=l.length;s<u;s++){o=l[s];if(Pe.call(o.element.get_states(),"is_invalid")>=0&&o.state("is_invalid")){return true}}return false}};n=i();if(!e.is_fake_instance){if((o=w.dehydrate_context)!=null){if(typeof o.save_to_state==="function"){o.save_to_state(e,"client_eval_isnt_clickable",n)}}}return n},filter_context:function(e){return e.is_state||e.is_event_condition}}})}if(Pe.call(e,"display_invalid")>=0){ue.extend(t,{is_valid:{description:" is valid",ret_value:"sys.bool",fn:function(e,t){return!(e!=null?e.state("display_invalid"):void 0)}},isnt_valid:{description:" isn't valid",ret_value:"sys.bool",fn:function(e,t){return e!=null?e.state("display_invalid"):void 0}}})}if(Pe.call(e,"is_hovered")>=0){ue.extend(t,{is_hovered:{description:" is hovered",ret_value:"sys.bool",fn:function(e,t){return e!=null?e.state("is_hovered"):void 0},filter_context:function(e){return e.is_state}},isnt_hovered:{description:" isn't hovered",ret_value:"sys.bool",fn:function(e,t){return!(e!=null?e.state("is_hovered"):void 0)},filter_context:function(e){return e.is_state}},is_pressed:{description:" is pressed",ret_value:"sys.bool",fn:function(e,t){return e!=null?e.state("is_pressed"):void 0},filter_context:function(e){return e.is_state}},isnt_pressed:{description:" isn't pressed",ret_value:"sys.bool",fn:function(e,t){return e!=null?e.state("is_pressed"):void 0},filter_context:function(e){return e.is_state}}})}if(Pe.call(e,"is_focused")>=0){return ue.extend(t,{is_focused:{description:" is focused",ret_value:"sys.bool",fn:function(e,t){return e!=null?e.state("is_focused"):void 0},filter_context:function(e){return e.is_state}},isnt_focused:{description:" isn't focused",ret_value:"sys.bool",fn:function(e,t){return!(e!=null?e.state("is_focused"):void 0)},filter_context:function(e){return e.is_state}}})}};o("element",{get:function(e){var t,n,r,i,o,a,u,l,c,f,d;n=s.element(e);o={};if(n!=null?n.exists():void 0){a=n.get_states();n.add_specific_messages(o);pe(a,o,(f=n.type(),Pe.call(p.event_element_mapping["ButtonClicked"],f)>=0));ue.extend(o,{is_visible:{description:" is visible",ret_value:"sys.bool",fn:function(e,t){return e!=null?e.is_visible():void 0},filter_context:function(e){return e.is_state||e.is_event_condition}},isnt_visible:{description:" isn't visible",ret_value:"sys.bool",fn:function(e,t){return!(e!=null?e.is_visible():void 0)},filter_context:function(e){return e.is_state||e.is_event_condition}}});d=n.element_custom_states();u=function(e){return o[e.name()]={description:"'s "+e.display(),ret_value:e.value(),fn:function(t,n){return t!=null?t.state(e.name()):void 0},delete_cb:function(){if(window.confirm("Delete custom state "+e.display()+"?")){return e["delete"]()}}}};for(l=0,c=d.length;l<c;l++){t=d[l];u(t)}}for(i in o){r=o[i];if(i.indexOf("custom.")===0){r.documentation_id="Documentation.Elements.GeneralConcepts.States.CustomStates"}else{r.documentation_id="Documentation.Elements.GeneralConcepts.States."+i}}return{display:function(){return"element"},get_message_names:function(){var e,t,n;n=[];for(e in o){t=o[e];n.push(e)}return n},get_message:function(e){return o[e]},cast:function(e){return e},storable:false,bindable:false}},list:function(){return[]},display:function(){return"element"}});o("style",{get:function(e){var t,n,r;r={};pe(_.get_element_object(e).get_states(),r,Pe.call(p.event_element_mapping["ButtonClicked"],e)>=0);for(n in r){t=r[n];t.documentation_id="Documentation.Elements.GeneralConcepts.States."+n}return{display:function(){return"style"},get_message_names:function(){var e,t,n;n=[];for(e in r){t=r[e];n.push(e)}return n},get_message:function(e){return r[e]},cast:function(e){return e},storable:false,bindable:false}},list:function(){return[]},display:function(){return"style"}});o("list",{list:function(){},display:function(){return"list"},get:function(e){var t,n,o,a,s,u,l,c,f,d=this;a=de.get(e);l=function(e,t){var n,r,i,o,s,u;n=[];u=(s=e!=null?typeof e.all==="function"?e.all():void 0:void 0)!=null?s:[];for(i=0,o=u.length;i<o;i++){r=u[i];n.push(a.cast_to_string(r))}if(t==="line_break"){t="\n"}return n.join(t)};t={count:{description:":count",ret_value:"number",fn:function(e,t,n,r){var i,o,a,s,u,l;if(typeof(e!=null?e.length:void 0)!=="function"){return 0}i=r!=null?(s=r["%n"])!=null?s["%nm"]:void 0:void 0;if(i==="greater_or_equal_than"||i==="greater_than"||i==="less_or_equal_than"||i==="less_than"){a=(u=r["%n"])!=null?u["%a"]:void 0;if(typeof a==="number"){o=e!=null?e["length_"+i](a):void 0;if(i.indexOf("greater")===0){if(o){return a+1}else{return a-1}}else{if(o){return a-1}else{return a+1}}}}return(l=e.length())!=null?l:0}},contains:{description:" contains ",ret_value:"sys.bool",arg_value:e,build_pg_constraint:W.contains,build_pg_r_constraint:W["in"],build_pg_relationship:W.contains_both,fn:function(e,t){if(!e){return false}return typeof e.contains==="function"?e.contains(t,a):void 0}},not_contains:{description:" doesn't contain ",ret_value:"sys.bool",arg_value:e,build_pg_constraint:W.not_contains,build_pg_r_constraint:W.not_in,build_pg_relationship:W.not_contains_both,fn:function(e,t){if(!e){return true}return!(typeof e.contains==="function"?e.contains(t,a):void 0)}},first_element:{description:":first item",ret_value:e,fn:function(e,t){return e!=null?typeof e.get_children==="function"?e.get_children(0,1)[0]:void 0:void 0}},last_element:{description:":last item",ret_value:e,fn:function(e,t){var n;if(!(e!=null?e.get_children:void 0)){return null}n=e.length();if(n){return e.get_children(n-1,1)[0]}}},random_element:{description:":random item",ret_value:e,fn:function(e,t,n,r,i){var o,a,s;if(!(e!=null?e.get_children:void 0)){return null}a=e.length();if(a){if(i!=null?i.random_generator:void 0){o=function(e){return i.random_generator.random(0,a)}}else{o=function(e){return Math.random()*a}}s=Math.floor(o());return e.get_children(s,1)[0]}}},specific_item:{description:":item #",ret_value:e,arg_value:"number",fn:function(e,t){if(!(e!=null?e.get_children:void 0)){return null}if(t==null){return null}if(t<1){return null}return e.get_children(t-1,1)[0]}},limit_to:{description:":items until #",ret_value:"list."+e,arg_value:"number",fn:function(e,t){if(!(e!=null?e.get_children:void 0)||t==null){return new k.StaticList([])}return e.capped(t)}},list_from:{description:":items from #",ret_value:"list."+e,arg_value:"number",fn:function(e,t){if(!(e!=null?e.get_children:void 0)||t==null){return new k.StaticList([])}return e.offset(t-1)}},contains_list:{description:" contains list ",ret_value:"sys.bool",arg_value:"list."+e,fn:function(e,t){var n,r,i,o,s;if(!e){return false}s=(o=t!=null?typeof t.all==="function"?t.all():void 0:void 0)!=null?o:[];for(r=0,i=s.length;r<i;r++){n=s[r];if(!(typeof e.contains==="function"?e.contains(n,a):void 0)){return false}}return true}}};if(a.can_cast_to_string()){t["join"]={description:" join with ",ret_value:"text",arg_value:"text",fn:function(e,t){if(!k.is_list(e)){e=new k.StaticList([])}return l(e,t)},editor:{"static":true,"default":", "}}}if(a.matches("number")){ue.extend(t,{sum:{description:":sum",ret_value:"number",fn:function(e,t){if(!k.is_list(e)){e=new k.StaticList([])}return e.sum()}},product:{description:":product",ret_value:"number",fn:function(e,t){if(!k.is_list(e)){e=new k.StaticList([])}return e.product()}},average:{description:":average",ret_value:"number",fn:function(e,t){if(!k.is_list(e)||e.length()===0){e=new k.StaticList([0])}return e.average()}},median:{description:":median",ret_value:"number",fn:function(e,t){if(!k.is_list(e)||e.length()===0){e=new k.StaticList([0])}return e.median()}},min:{description:":min",ret_value:"number",fn:function(e,t){if(!k.is_list(e)||e.length()===0){e=new k.StaticList([0])}return e.min()}},max:{description:":max",ret_value:"number",fn:function(e,t){if(!k.is_list(e)||e.length()===0){e=new k.StaticList([0])}return e.max()}}})}f=a.get_messages();s=function(n){var r,i;if(!n.M.arg_value){if(((i=n.M.ret_value)!=null?i.indexOf("list"):void 0)===0){r=n.M.ret_value}else{r="list."+n.M.ret_value}return t[n.name()]={description:function(e){return n.description(e)},ret_value:r,spot_data:n.M.spot_data,description_for_sliding_palette:n.M.description_for_sliding_palette,field_names:n.M.field_names,fields:n.M.fields,compound_message:true,fn:function(t,r,i){var o,a,s,u,l,c,f;if(!k.is_list(t)){t=new k.StaticList([])}s=new k.TransformList(t,{value_id:e,message:n.name(),properties:i});if(((c=n.M.ret_value)!=null?c.indexOf("list"):void 0)===0){a=[];f=s.all();for(u=0,l=f.length;u<l;u++){o=f[u];if(o!==null&&o!==void 0){a.push(o)}}s=new k.ConcatList(new k.StaticList(a))}return s}}}};for(u=0,c=f.length;u<c;u++){n=f[u];s(n)}t["filtered"]={description:":filtered",description_for_sliding_palette:"List filter",spot_data:"SlidableSpot",ret_value:"list."+e,field_names:ue.extend({},h.constraints_field_names,h.sorting_field_names),fields:function(t){var n;if(a.matches(de.compound)){n=h.get_constraints_fields(e);n.push.apply(n,h.get_sorting_fields(e,false,t("sort_field")))}else{n=h.get_constraints_fields(e,void 0,true)}return n},fn:function(t,n,r,o,s){var u,l,c,f,d;if(!k.is_list(t)){t=new k.StaticList([])}r.type_to_find=e;d=(f=r.constraints)!=null?f:{};for(c in d){u=d[c];if(u.key===h.ADVANCED_SEARCH_CONSTRAINT){u.value=R.reduce(o[i.properties][i.constraints][c][i.value],s);if(!a.matches(de.compound)){u.self=e}}}l=function(){var e,t,n;t=(e=r.constraints)!=null?e:{};n=[];for(c in t){u=t[c];n.push(u)}return n}();return t.filter(l).sort(h.get_sorts_list(r))}};if(a.matches(de.compound)){t["sorted"]={description:function(t){var n,r,i,o;r=t!=null?t.property("sort_field").raw():void 0;if(r===h.DYNAMIC_SORTING_FIELD){n=" by dynamic field"}else if(r===h.RANDOM_SORTING){n=" randomly"}else if(r){n=" by "+((i=(o=de.get(e).custom_type())!=null?o.field(r).display():void 0)!=null?i:r)}return":sorted"+(n!=null?n:"")},description_for_sliding_palette:"List sorting order",spot_data:"SlidableSpot",ret_value:"list."+e,field_names:ue.extend({},h.sorting_field_names),fields:function(t){var n;n=h.get_sorting_fields(e,false,t("sort_field"));n[0].optional=false;return n},fn:function(t,n,r){var i;if(Array.isArray(t)){t=new k.StaticList(t)}else if(!t||!t.all){return new k.StaticList([])}r.type_to_find=e;i=h.get_sorts_list(r);return new k.SortedList(t,{sorts_list:i})}};t.ranked_by={description:function(e){var t,r;r=e!=null?e.property("target_item"):void 0;t=e!=null?e.get_static_property("method"):void 0;if(!t){n=":ranked by..."}else{n=":ranked by "+{similar:"similarity to ",different:"difference from "}[t];if(!(r!=null?r.exists():void 0)){n+="..."}else{n+=r.get_tree_display()}}return n},description_for_sliding_palette:"Ranking",spot_data:"SlidableSpot",ret_value:"list."+e,field_names:{target_item:{},method:{}},fields:function(){return[{name:"method",caption:"Rank by",editor:"Dropdown",set:r().sets.Object({similar:"similarity to...",different:"difference from..."})},{name:"target_item",caption:"Target",editor:"Basic",value:e}]},fn:function(t,r,i){var o,a,s,u,l,c,f,d,_,p;u=(_=t!=null?typeof t.all==="function"?t.all():void 0:void 0)!=null?_:[];if((p=i.target_item)!=null?p.child:void 0){o=function(){var t,r,i,o;i=de.get(e).get_messages();o=[];for(t=0,r=i.length;t<r;t++){n=i[t];if(n.ret_value().matches("number")){o.push(n)}}return o}();c={};for(f=0,d=o.length;f<d;f++){n=o[f];s=n.name();c[s]=i.target_item.child(s).get()}l=function(e){var t,r,i;if(!(e!=null?e.child:void 0)){return Infinity}t=0;for(r=0,i=o.length;r<i;r++){n=o[r];s=n.name();t+=Math.pow(c[s]-e.child(s).get(),2)}return t};a=i.method==="different"?-1:1;u.sort(function(e,t){return(l(e)-l(t))*a})}return u}}}else if(a.can_sort()){t["sorted"]={description:function(e){return":sorted"},description_for_sliding_palette:"List sorting order",spot_data:"SlidableSpot",ret_value:"list."+e,field_names:{random:{},descending:{optional:true}},fields:function(e){var t;t=e("random");return[{name:"random",caption:"Randomized list",editor:"Checkbox"},{name:"descending",caption:"Descending",editor:"Basic",value:"boolean",condition:function(){return!t}}]},fn:function(e,t,n){if(Array.isArray(e)){e=new k.StaticList(e)}else if(!e||!e.all){return new k.StaticList([])}if(n==null){n={}}n.sorts_list=[{sort_field:n.random?h.RANDOM_SORTING:void 0,descending:n.descending,self:true}];return new k.SortedList(e,n)}}}t["merged_with"]={description:" merged with ",ret_value:"list."+e,arg_value:"list."+e,fn:function(e,t){if(!k.is_list(e)){e=new k.StaticList([])}if(!k.is_list(t)){t=new k.StaticList([])}return new k.UniqueList(new k.ConcatList(new k.StaticList([e,t])))}};t["intersect_with"]={description:" intersect with ",ret_value:"list."+e,arg_value:"list."+e,fn:function(e,t){if(!k.is_list(e)){e=new k.StaticList([])}if(!k.is_list(t)){t=new k.StaticList([])}return new k.IntersectList(new k.StaticList([e,t]))}};t["unique"]={description:":unique elements",ret_value:"list."+e,fn:function(e,t){if(!k.is_list(e)){e=new k.StaticList([])}return new k.UniqueList(e)}};t["plus_element"]={description:":plus item ",ret_value:"list."+e,arg_value:e,fn:function(e,t){if(!k.is_list(e)){e=new k.StaticList([])}if(!k.guess_value_id(t)){t=new k.StaticList([])}t=new k.StaticList([t]);return new k.UniqueList(new k.ConcatList(new k.StaticList([e,t])))}};t["make_static"]={description:":make static ",ret_value:"list."+e,fn:function(e,t){if(!k.is_list(e)){e=new k.StaticList([])}return new k.StaticList(e.all())}};for(o in t){n=t[o];if(!n.compound_message){n.documentation_id="Documentation.Data.Messages.list."+o}}return{get_message_names:function(){var e,n,r;r=[];for(e in t){n=t[e];r.push(e)}return r},get_message:function(e){return t[e]},display:function(){return"List of "+a.display()+"s"},inner:function(){return a},equals:function(e,t){return false},get_sample:function(){return new K.SampleList(e)},cast:function(t){if(typeof(t!=null?t.get_children:void 0)==="function"){return t}else if(Array.isArray(t)){return r().db_instance().static_list(e,t)}else{return null}},storable:false,bindable:false,can_cast_to_string:function(){return a.can_cast_to_string()},cast_to_string:function(e){if(e==null){return null}if(!a.can_cast_to_string){ue.warn("cannot cast to string");return""}return l(e,", ")}}}});m=function(e,t,n){return function(r){var i,o;i=n+(r?"."+r:"");if(n==="user"){r="user"}if(!r){throw ue.error("custom value created without id.  Namespace: "+n)}o=s.custom_type(r);return ge(i,o,e,t)}};ge=function(e,t,n,i,o){var u,l,c,f,_,p,h,g;_={};if(n){ue.extend(_,n())}if(!o){ue.extend(_,{"Created By":{description:"'s Creator",ret_value:"user",fn:z("Created By"),is_lookup:true},equals:{description:" is ",ret_value:"sys.bool",arg_value:e,fn:function(e,t){return b(e,t)},build_pg_constraint:W.equals,build_pg_r_constraint:W.equals,build_pg_relationship:W.equals_both},not_equals:{description:" is not ",ret_value:"sys.bool",arg_value:e,fn:function(e,t){return!b(e,t)},build_pg_constraint:W.not_equals,build_pg_r_constraint:W.not_equals,build_pg_relationship:W.not_equals_both},is_empty:{description:" is empty",ret_value:"sys.bool",fn:function(e,t){return!(e!=null?typeof e.exists==="function"?e.exists():void 0:void 0)},build_pg_constraint:W.is_empty},is_not_empty:{description:" is not empty",ret_value:"sys.bool",fn:function(e,t){return e!=null?typeof e.exists==="function"?e.exists():void 0:void 0},build_pg_constraint:W.is_not_empty},"Created Date":{description:"'s Creation Date",ret_value:"date",fn:z("Created Date"),is_lookup:true,privacy_condition_okay:false},"Modified Date":{description:"'s Modified Date",ret_value:"date",fn:z("Modified Date"),is_lookup:true,privacy_condition_okay:false},_id:{description:"'s unique id",ret_value:"text",fn:function(e,t){if(e!=null?typeof e.exists==="function"?e.exists():void 0:void 0){return e!=null?typeof e._id==="function"?e._id():void 0:void 0}else{return null}}},id_link:{description:"'s link",ret_value:"text",spot_data:"SlidableSpot",description_for_sliding_palette:"Link Destination",field_names:{element_id:{}},fields:function(){return[{name:"element_id",caption:"Page to send this to",editor:"Dropdown",set:r().sets.Filtered(r().sets.Pages(),function(t){var n;if(a.get_sorted_list_of_pages().length>120){return true}n=s.element(t.value);return(n!=null?n.get_static_property("page_item_type"):void 0)===e})}]},fn:function(e,t,n){var i,o,a;o=e!=null?typeof e._id==="function"?e._id():void 0:void 0;if(o){a=s.element(n.element_id);if(a){i=d.get_data_to_send(e,a.get_static_property("readable_field"));return r().location.get_page_url(a.name()+"/"+i)}}}},convert_to_list:{not_public_plugin:true,description:":converted to list",ret_value:"list."+e,fn:function(e,t,n){if(!e||!k.guess_value_id(e)){return new k.StaticList([])}else{return new k.StaticList([e])}}}})}if(i){g=i();for(p=0,h=g.length;p<h;p++){c=g[p];delete _[c]}}if(e==="user"){f="user"}else{f="custom"}for(l in _){u=_[l];u.documentation_id=A.for_value_messages_custom_types(f,l)}return{get_message_names:function(){var e,n,r,i;r=function(){var n,r,i,o;i=t.fields();o=[];for(n=0,r=i.length;n<r;n++){e=i[n];if(!e.deleted()){o.push(e.name())}}return o}();if(t.no_special_messages){return r}return r.concat(function(){var e;e=[];for(n in _){i=_[n];if(!i.hidden){e.push(n)}}return e}())},get_message:function(e){var n,r,i,o,a;i=_[e];if(i){return i}n=t.field(e);if(!n){return{description:"[missing: "+e+"]",ret_value:"null",fn:function(){}}}r=e;return{description:(o="'s "+n.display())!=null?o:e,ret_value:(a=n.value())!=null?a:"null",fn:z(r),is_lookup:true,delete_cb:function(){if(window.confirm("Delete field "+n.display()+"?")){return n.set_deleted(true)}}}},display:function(){return t.display()},custom_type:function(){return t},equals:b,get_sample:function(){return new K.SampleObject(e)},storable:true,bindable:true,cast:function(e){if(typeof(e!=null?e.child:void 0)==="function"){return e}else{return null}}}};o("custom",{get:m(void 0,void 0,"custom"),list:function(){var e,t,n,r,i;r=s.custom_types();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];if(e.id()!=="user"&&!e.deleted()){i.push(e.id())}}return i},display:function(){return"custom type"}});o("custom-action",{get:function(e){return d.get_custom_action_value(e)},list:function(){var e,t,n,r,i;r=(n=f.custom_action_definitions)!=null?n:{};i=[];for(e in r){t=r[e];i.push(e)}return i},display:function(){return"custom action"}});ce=function(){return["Created By"]};le=function(){var e,t,n,r,i,o=this;t={email:{description:"'s email",ret_value:"text",fn:function(e,t){var n;if(!e){return null}else{return(n=typeof e.get_email==="function"?e.get_email():void 0)!=null?n:null}}},logged_in:{description:" is logged in",ret_value:"sys.bool",fn:function(e,t){if(!e){return null}else{return typeof e.is_logged_in==="function"?e.is_logged_in():void 0}},is_lookup:"user_signed_up"},not_logged_in:{description:" isn't logged in",ret_value:"sys.bool",fn:function(e,t){if(!e){return null}else{return!(typeof e.is_logged_in==="function"?e.is_logged_in():void 0)}}},email_confirmed:{description:"'s email confirmed",ret_value:"boolean",fn:function(e,t){if(!e){return null}else{return typeof e.child==="function"?e.child("authentication").child("email").child("email_confirmed").get():void 0}}}};e=function(e,n,r){var i,o,a;i=(o=n.fields)!=null?o:te.add_fields_from_parameters(n.parameters,[]);return t[e]={description:(a="'s "+n.display())!=null?a:ue.toTitleCase(e),ret_value:n.get_value_id(),hidden:r,fn:E.make_call_fn(n),spot_data:i.length?"SlidableSpot":void 0,description_for_sliding_palette:"Call parameters",field_names:ue.extend({},n.parameters,{element_id:{}}),fields:function(){return i}}};ue.optional_pause();i=te.get_user_calls();for(r in i){n=i[r];e(r,n);ue.optional_pause("add_oauth_message "+r)}return t};o("user",m(le,ce,"user"));o("api",{get:function(e){var t,n,r;t=e.split(".")[0];n=e.split(".").slice(1).join(".");return(r=te.get_service(t))!=null?r.get_values()[n]:void 0},list:function(){var e,t,n,r,i;r=te.get_value_ids();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e.replace("api.",""))}return i},display:function(){return"external data"}});o("api_wf_data",{get:function(e){var t,n;t=e.split(".")[0];return(n=s.workflow_item(t))!=null?n.get_value()[e]:void 0},list:function(){return[]},display:function(){return"API Event data"}});M=function(e){var t;if(typeof(e!=null?e._id:void 0)==="function"){return e._id()}else if(typeof(e!=null?e.get:void 0)==="function"){t=e.get();if(typeof(t!=null?t.replace:void 0)==="function"){return t.replace(w.HYDRATE_STRING,"")}}else{return void 0}};b=function(e,t){return M(e)===M(t)};h=e("./core_expressions");_=e("./core_elements");p=e("./core_events");k=e("./../db/db");c=e("./../db/client_db");de=e("./../lang/values");z=de.lookup_fn;r=e("./../lib");K=e("./../db/sample");O=e("./../geolocation");te=e("./../services");E=e("./../external");d=e("./../core/core_actions");P=e("./../imgix");w=e("./../lang/dataops");ne=e("./../lang/shrink");R=e("./../lang/lang");i=ne.S;H=e;if(ue.on_server()){t=H("./../fileupload");v=H("crypto")}a=e("./../lang/application");Ce=a.SPECIAL_TYPES;ye=function(e){var t;t=e.name();return o(t,function(n){var r;r=ge(t,e,void 0,void 0,true);r.dont_list=true;return r})};for(xe=0,Ee=Ce.length;xe<Ee;xe++){re=Ce[xe];ye(re)}}).call(this)},{"./../client_config":16,"./../core/core_actions":18,"./../db/client_db":27,"./../db/db":28,"./../db/postgres_constraints":29,"./../db/sample":30,"./../documentation_id_getter":34,"./../external":40,"./../geolocation":41,"./../imgix":42,"./../jquery_plugins/moment.timezone.min.js":47,"./../lang/application":50,"./../lang/appquery":51,"./../lang/dataops":54,"./../lang/lang":57,"./../lang/shrink":61,"./../lang/values":62,"./../lib":65,
"./../services":70,"./../tests/testing":71,"./../u":72,"./core_elements":19,"./core_events":20,"./core_expressions":21,querystring:285,util:302}],24:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,K,J,X,Z,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,fe,de,_e,pe,he,ge,me,ve=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1},ye={}.hasOwnProperty,be=function(e,t){for(var n in t){if(ye.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};L=e("./../u");L.safe_register("./core/property_applications",n);n.apply_css_style=k=function(e,t){var n,r,i,o,a,s,u;s=e!=null?e:[];u=[];for(o=0,a=s.length;o<a;o++){n=s[o];u.push(function(){var e;e=[];for(r in t){i=t[r];e.push(n.style[r]=i)}return e}())}return u};W=function(e,t){var n,r,i,o,a,s,u=this;i=function(t){var n,r,i,o;n=(r=(i=e.element)!=null?typeof i.get_style_if_exists==="function"?i.get_style_if_exists():void 0:void 0)!=null?r:typeof e.get_style_if_exists==="function"?e.get_style_if_exists():void 0;if(n){return n.get_static_property(t)}return(o=typeof e.evaluate_property==="function"?e.evaluate_property(t):void 0)!=null?o:typeof e.get_static_property==="function"?e.get_static_property(t,true):void 0};if(e.get_static_property("four_border_style")){o=0;for(a=0,s=t.length;a<s;a++){n=t[a];r=i("border_style"+n);if(r!==void 0&&r!=="none"){o+=i("border_width"+n)}}return o}else{r=i("border_style");if(r!==void 0&&r!=="none"){return 2*i("border_width")}else{return 0}}};n.calculate_border_height=function(e){return W(e,["_top","_bottom"])};n.calculate_border_width=function(e){return W(e,["_left","_right"])};n.PropertyApplication=m=function(){function e(e,t){var n;this.sel_fn=e;this.to_remove=t!=null?t:[];this.uses_properties=function(){var e,t,r,i,o;i=(r=this._uses_properties)!=null?r:[];o=[];for(e=0,t=i.length;e<t;e++){n=i[e];if(ve.call(this.to_remove,n)<0){o.push(n)}}return o}.call(this)}e.prototype.get_target=function(e){if(this.sel_fn){if(typeof this.sel_fn==="string"){e=e.find(this.sel_fn)}else{e=this.sel_fn(e)}}return e};e.prototype.apply=function(e,t,n){var r,i,o,a,s,u,l,c,f;l=this.to_remove;for(o=0,s=l.length;o<s;o++){r=l[o];delete e[r]}c=this.get_target(t);f=[];for(a=0,u=c.length;a<u;a++){i=c[a];f.push(this._apply(e,$(i),n))}return f};e.prototype.get_transition_css=function(e,t,n){var r,i,o,a,s,u,l,c,f,d,_,p;r="";d=this.uses_properties;for(c=0,f=d.length;c<f;c++){o=d[c];if(!((_=this.transition_properties)!=null?_[o]:void 0)){continue}s=e.transition(o);if(s!=null?s.exists():void 0){i=this.transition_properties[s.prop_name()];r+=i+" "+s.duration()+"ms "+s.fn()+", "}}if(r){a=this.get_target(t);if(typeof this.sel_fn==="string"){u=this.sel_fn}else{u=a.prop("outerHTML")}if(n[u]==null){n[u]={}}if((l=n[u]).target==null){l.target=a}return n[u].css_prop=((p=n[u].css_prop)!=null?p:"")+r}};e.prototype.get_properties=function(e){var t,n,r,i,o,a,s,u;r=function(){var e,t,r,i,o;r=this._get_properties();o=[];for(e=0,t=r.length;e<t;e++){n=r[e];if(i=n.name,ve.call(this.to_remove,i)<0){o.push(n)}}return o}.call(this);if(e){for(i=0,a=r.length;i<a;i++){n=r[i];t=(u=this.field_names[n.name])!=null?u["default"]:void 0;if(t){n["default"]=t}}for(o=0,s=r.length;o<s;o++){n=r[o];if(e[n.name]!=null){n["default"]=e[n.name]}}}return r};return e}();n.NoSelect=d=function(e){be(t,e);function t(){J=t.__super__.constructor.apply(this,arguments);return J}t.prototype._apply=function(e,t){if(e){return k(t,{"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","user-select":"none"})}};t.prototype.apply_once=true;return t}(m);n.Dimensions=o=function(e){be(t,e);function t(){X=t.__super__.constructor.apply(this,arguments);return X}t.prototype._apply=function(e,t){};t.prototype.field_names={width:{"default":100,no_states:true},height:{"default":100,no_states:true},left:{no_states:true},top:{no_states:true}};t.prototype.not_in_style=true;t.prototype.apply_once=true;t.prototype.class_name="Dimensions";return t}(m);n.MinWidth=f=function(e){be(t,e);function t(){ue=t.__super__.constructor.apply(this,arguments);return ue}t.prototype._apply=function(){};t.prototype.field_names={min_width:{"default":20,no_states:true},fixed_width:{no_states:true,"default":false},use_max_width:{no_states:true,"default":false},max_width:{"default":100,optional:true,no_states:true},collapse_margin:{"default":0,optional:true,no_states:true},responsive_alignment:{"default":"center",no_states:true}};t.prototype.not_in_style=true;t.prototype.apply_once=true;t.prototype.class_name="MinWidth";return t}(m);n.ShortDimensions=y=function(e){be(t,e);function t(){fe=t.__super__.constructor.apply(this,arguments);return fe}t.prototype._apply=function(){};t.prototype.field_names={width:{"default":960,no_states:true},height:{"default":600,no_states:true}};t.prototype.not_in_style=true;t.prototype.apply_once=true;t.prototype.class_name="ShortDimensions";return t}(m);n.PositionOnly=g=function(e){be(t,e);function t(){de=t.__super__.constructor.apply(this,arguments);return de}t.prototype._apply=function(){};t.prototype.field_names={left:{no_states:true},top:{no_states:true}};t.prototype.not_in_style=true;t.prototype.apply_once=true;t.prototype.class_name="PositionOnly";return t}(m);n.Rotation=v=function(e){be(t,e);function t(){_e=t.__super__.constructor.apply(this,arguments);return _e}t.prototype._apply=function(e,t){var n,r,i;n=(i=e.rotation_angle)!=null?i:0;if(n===0&&e._first_time){return}r="rotate("+n+"deg)";return k(t,{"-ms-transform":r,"-webkit-transform":r,transform:r})};t.prototype.not_in_style=true;t.prototype.field_names={rotation_angle:{"default":0}};t.prototype._uses_properties=["rotation_angle"];t.prototype.class_name="Rotation";return t}(m);n.BoxShadow=i=function(e){be(t,e);function t(){pe=t.__super__.constructor.apply(this,arguments);return pe}t.prototype._apply=function(e,t){var n,r,i,o,a,s,u,l,c,f,d,_;if(e&&e.boxshadow_style!=="none"){e=L.extend({},e);e.blur=(f=(d=e.boxshadow_blur)!=null?d:e.blur)!=null?f:0;e.horizontal=(_=(r=e.boxshadow_horizontal)!=null?r:e.horizontal)!=null?_:0;e.vertical=(i=(o=e.boxshadow_vertical)!=null?o:e.vertical)!=null?i:0;e.spread=(a=(s=e.boxshadow_spread)!=null?s:e.spread)!=null?a:0;e.color=(u=(l=e.boxshadow_color)!=null?l:e.color)!=null?u:0;n=e.boxshadow_style==="inset"?"inset":"";e.inset=e.boxshadow_style!==void 0?n:(c=e.inset)!=null?c:"";return R.add_outline(t,"default",5,e)}else if(e.boxshadow_style==="none"&&!e._first_time){return R.remove_outline(t,"default")}};t.prototype.transition_properties={boxshadow_style:"box-shadow"};t.prototype._uses_properties=["boxshadow_style","boxshadow_horizontal","boxshadow_vertical","boxshadow_blur","boxshadow_color"];t.prototype.field_names={boxshadow_style:{"default":"none"},boxshadow_horizontal:{"default":2},boxshadow_vertical:{"default":2},boxshadow_blur:{"default":4},boxshadow_color:{"default":"#AAAAAA"}};t.prototype.class_name="BoxShadow";return t}(m);n.Font=a=function(e){be(t,e);function t(){he=t.__super__.constructor.apply(this,arguments);return he}t.prototype._apply=function(e,t){var n,r,i,o;if(e){if(c().is_edit_mode()){q.load_font(e.font_face)}n=q.get_face_and_variant(e.font_face);k(t,{"font-family":n.font_family,"font-size":e.font_size+"px"});if(e.bold){o="bold"}else if(n.variant&&n.variant!=="regular"){o=n.variant}else if(!((!n.variant||n.variant==="regular")&&e._first_time)){o="normal"}if(o){t[0].style["font-weight"]=o}if(e.underline){i="underline"}else if(!e.underline&&!e._first_time){i="none"}if(i){t[0].style["text-decoration"]=i}if(e.italic){r="italic"}else if(!e.italic&&!e._first_time){r="normal"}if(r){t[0].style["font-style"]=r}t[0].style["color"]=e.font_color;if(!(e.font_alignment==="left"&&e._first_time)){return t[0].style["text-align"]=e.font_alignment}}};t.prototype._uses_properties=["font_face","font_size","bold","underline","italic","font_color","font_alignment"];t.prototype.transition_properties={font_size:"font-size",font_color:"color"};t.prototype.field_names={font_face:{"default":"Lato"},font_size:{"default":14},bold:{},italic:{},underline:{},font_alignment:{"default":"left"},font_color:{"default":"#252525"}};t.prototype.class_name="Font";return t}(m);n.FontShadow=s=function(e){be(t,e);function t(){ge=t.__super__.constructor.apply(this,arguments);return ge}t.prototype._apply=function(e,t){var n;if(e){if(e.textshadow){n=e.textshadow_horizontal+"px "+e.textshadow_vertical+"px "+e.textshadow_blur+"px "+e.textshadow_color;t[0].style.textShadow=n}if(!e.textshadow&&!e._first_time){return t[0].style.textShadow="none"}}};t.prototype._uses_properties=["textshadow","textshadow_horizontal","textshadow_vertical","textshadow_blur","textshadow_color"];t.prototype.transition_properties={textshadow:"text-shadow"};t.prototype.field_names={textshadow:{},textshadow_horizontal:{"default":1},textshadow_vertical:{"default":1},textshadow_blur:{"default":0},textshadow_color:{"default":"#Ffffff"}};t.prototype.class_name="FontShadow";return t}(m);n.FontSpacing=u=function(e){be(t,e);function t(){me=t.__super__.constructor.apply(this,arguments);return me}t.prototype._apply=function(e,t){if(e){if(!(e.letter_spacing===0&&e._first_time)){t[0].style["letter-spacing"]=e.letter_spacing+"px"}if(!(e.word_spacing===0&&e._first_time)){t[0].style["word-spacing"]=e.word_spacing+"px"}return t[0].style["line-height"]=e.line_height}};t.prototype._uses_properties=["letter_spacing","word_spacing","line_height"];t.prototype.transition_properties={letter_spacing:"letter-spacing",word_spacing:"word-spacing",line_height:"line-height"};t.prototype.field_names={word_spacing:{"default":0},line_height:{"default":1},letter_spacing:{"default":0}};t.prototype.class_name="FontSpacing";return t}(m);E={four_border_style:{"default":false,no_states:true}};Z=["","_top","_right","_bottom","_left"];for(G=0,Y=Z.length;G<Y;G++){A=Z[G];E["border_style"+A]={"default":"none"};E["border_roundness"+A]={"default":0};E["border_width"+A]={"default":1};E["border_color"+A]={"default":"#6B6B6B"}}O=function(e){if(e==="top"){return"top-left"}else if(e==="right"){return"top-right"}else if(e==="bottom"){return"bottom-right"}else if(e==="left"){return"bottom-left"}};M={};Q=["","top","right","bottom","left"];for(V=0,H=Q.length;V<H;V++){A=Q[V];if(A===""){M["border_roundness"]="border-radius";M["border_width"]="border-width";M["border_color"]="border-color"}else{K="_"+A;M["border_roundness"+K]="border-"+A+"-radius";M["border_width"+K]="border-"+A+"-width";M["border_color"+K]="border-"+A+"-color"}}n.Border=r=function(e){var t,n;be(r,e);function r(e,t,n){this.sel_fn=e;this.to_remove=t!=null?t:[];this.data=n;r.__super__.constructor.call(this,this.sel_fn,this.to_remove)}r.prototype._apply=function(e,t){var n,r,i,o,a;if(e){if(e.four_border_style){o=["top","right","bottom","left"];a=[];for(r=0,i=o.length;r<i;r++){A=o[r];a.push(function(n){var r,i;i={};if(!(e["border_style_"+n]==="none"&&e._first_time)){i["border-"+n+"-style"]=e["border_style_"+n];i["border-"+n+"-width"]=e["border_width_"+n]+"px";i["border-"+n+"-color"]=L.RGBA_to_RGB(e["border_color_"+n]);i["border-"+n+"-color"]=e["border_color_"+n]}r=O(n);i["border-"+r+"-radius"]=e["border_roundness_"+n]+"px";return k(t,i)}(A))}return a}else{n={};if(!(e.border_style==="none"&&e._first_time)){n["border-style"]=e.border_style;n["border-width"]=e.border_width+"px";n["border-color"]=L.RGBA_to_RGB(e.border_color);n["border-color"]=e.border_color}n["border-radius"]=e.border_roundness+"px";n["-moz-border-radius"]=e.border_roundness+"px";return k(t,n)}}};r.prototype._uses_properties=function(){var e;e=[];for(t in E){n=E[t];e.push(t)}return e}();r.prototype.transition_properties=M;r.prototype.field_names=E;r.prototype.class_name="Border";return r}(m);n.PaddingText=p=function(e){be(t,e);function t(){ee=t.__super__.constructor.apply(this,arguments);return ee}t.prototype._apply=function(e,t){var n;if(e){if(e.vertical_centering){n=(e.height-e.font_size)/2-2}else{n=e.padding_vertical}if(n==null){n=0}if(e.padding_horizontal==null){e.padding_horizontal=0}if(!(n===0&&e._first_time)){t[0].style["padding-top"]=n+"px ";if(e.stretch_to_fit){t[0].style["padding-bottom"]=n+"px "}}if(!(e.padding_horizontal===0&&e._first_time)){t[0].style["padding-left"]=e.padding_horizontal+"px ";return t[0].style["padding-right"]=e.padding_horizontal+"px "}}};t.prototype._uses_properties=["vertical_centering","padding_vertical","padding_horizontal","font_size","height","stretch_to_fit"];t.prototype.transition_properties={padding_vertical:"padding-top",padding_horizontal:"padding-left"};t.prototype.field_names={padding_vertical:{"default":0},padding_horizontal:{"default":0},vertical_centering:{"default":false}};t.prototype.class_name="PaddingText";return t}(m);n.Padding=_=function(e){be(t,e);function t(){te=t.__super__.constructor.apply(this,arguments);return te}t.prototype._apply=function(e,t){if(e){if(e.padding_vertical==null){e.padding_vertical=0}if(e.padding_horizontal==null){e.padding_horizontal=0}if(!(e.padding_vertical===0&&e.padding_horizontal===0&&e._first_time)){return t[0].style["padding"]=e.padding_vertical+"px "+e.padding_horizontal+"px"}}};t.prototype._uses_properties=["padding_vertical","padding_horizontal"];t.prototype.transition_properties={padding_vertical:"padding-top",padding_horizontal:"padding-left"};t.prototype.field_names={padding_vertical:{"default":0},padding_horizontal:{"default":0}};t.prototype.class_name="Padding";return t}(m);n.InputPadding=l=function(e){be(t,e);function t(){ne=t.__super__.constructor.apply(this,arguments);return ne}t.prototype._apply=function(e,t){if(e){if(e.padding_horizontal==null){e.padding_horizontal=0}if(!(e.padding_horizontal===0&&e._first_time)){return t[0].style["padding"]="0px "+e.padding_horizontal+"px"}}};t.prototype._uses_properties=["padding_horizontal"];t.prototype.transition_properties={placeholder_color:"placeholder_color"};t.prototype.field_names={padding_horizontal:{"default":4}};t.prototype.class_name="InputPadding";return t}(m);n.PlaceholderColor=h=function(e){be(t,e);function t(){re=t.__super__.constructor.apply(this,arguments);return re}t.prototype._apply=function(e,t){if(e){t.removeClass(["grey","black","white","blue","green","red"].join(" "));if(e.placeholder_color!=="grey"){return t.addClass(e.placeholder_color)}}};t.prototype._uses_properties=["placeholder_color"];t.prototype.transition_properties={};t.prototype.field_names={placeholder_color:{"default":"grey"}};t.prototype.class_name="PlaceholderColor";return t}(m);n.ToolTip=w=function(e){be(t,e);function t(){ie=t.__super__.constructor.apply(this,arguments);return ie}t.prototype._apply=function(e,t,n){if(e&&n.run_mode()){return t.attr("title",e.title_attribute)}};t.prototype._uses_properties=["title_attribute"];t.prototype.transition_properties={};t.prototype.not_in_style=true;t.prototype.field_names={title_attribute:{optional:true}};t.prototype.class_name="ToolTip";return t}(m);n.UniqueID=x=function(e){be(t,e);function t(){oe=t.__super__.constructor.apply(this,arguments);return oe}t.prototype._apply=function(e,t,n){var r;if(e&&n.run_mode()){if(S.get_public_setting("expose_id_option")){if(e.unique_id!=null||(r=t[0].id)!==""&&r!==null&&r!==void 0){if(e.unique_id==null){if(!T.run_mode_ids){return t.removeAttr("id")}}else{return t[0].id=e.unique_id}}}}};t.prototype._uses_properties=["unique_id"];t.prototype.transition_properties={};t.prototype.not_in_style=true;t.prototype.field_names={title_attribute:{optional:true,no_states:true}};t.prototype.class_name="UniqueID";return t}(m);n.optimize_image=function(e,t,n,r,i,o){var a,s,u,l;if(typeof e!=="string"){return}if(t===0){t=void 0}if(n===0){n=void 0}l=e.indexOf("https://")===0;e=e.replace("http://","").replace("https://","");if(e.indexOf("//")===0){e=e.replace("//","")}s=function(e){var t,n,r,a;if(o){return false}if(!T.image_optimization_service||e.indexOf("ignore_imgix")!==-1||i||e.indexOf(".svg")!==-1){return true}t=typeof c==="function"?(n=c())!=null?(r=n.location)!=null?typeof r.get_pieces==="function"?(a=r.get_pieces())!=null?a.domain:void 0:void 0:void 0:void 0:void 0;if(e.indexOf(T.user_file_url)===-1&&e.indexOf(T.user_file_cdn)===-1&&!T.always_proxy_user_files){return true}return false};if(T.image_optimization_service&&e.indexOf(T.image_optimization_service)!==-1||e.indexOf("/user/iop/")!==-1){e=e}else if(!(r!=null?r.force:void 0)&&s(e)){if(T.user_file_cdn){e=e.replace(T.user_file_url,T.user_file_cdn)}}else{if(!c().is_edit_mode()){a=S.get_public_setting("image_dpr");if(.75<=a&&a<=8){if(r==null){r={}}r.dpr=a}}e=I.get_reduced_file_url(e,t,n,r)}if(l){u="https:"}else{u=c().location.parsed_url().protocol}e=u+"//"+e;return e};n.downloaded_images={};F=function(e,t){var r;if(n.downloaded_images[t]){return e[0].style["background-image"]="url("+t+")"}else{r=L.img(void 0,void 0,t);e.data("_last_downloaded_image",t);return r.on("load",function(){n.downloaded_images[t];if(t===e.data("_last_downloaded_image")){return e[0].style["background-image"]="url("+t+")"}})}};n.Background=t=function(e){be(t,e);function t(){ae=t.__super__.constructor.apply(this,arguments);return ae}t.prototype._apply=function(e,t,r){var i,o,a,s,u,l,f,d,_,p,h;if(e){if(!e._first_time){t[0].style.background="none"}a={};if(e.background_style==="bgcolor"){a["background-color"]=L.RGBA_to_RGB(e.bgcolor);a["background-color"]=e.bgcolor}else if(e.background_style==="none"&&!e._first_time){a["background-color"]="transparent"}else if(e.background_style==="gradient"){(new b)._apply({style:e.background_gradient_style,direction:e.background_gradient_direction,angle:e.background_gradient_custom_angle,from:e.background_gradient_from,to:e.background_gradient_to,mid:e.background_gradient_mid,shape:e.background_radial_gradient_shape,pos:e.background_radial_gradient_size,xpos:e.background_radial_gradient_xpos,ypos:e.background_radial_gradient_ypos},t)}else if(e.background_style==="image"){l={};if(!e.backdrop_image_paralax){a["background-color"]=e.background_color_if_empty_image}if(e.background_image){if(e.background_size_cover){if(!e.backdrop_image_paralax){F(t,n.optimize_image(e.background_image,t.width()))}}else if(e.crop_responsive&&(r!=null?(_=r.element.root())!=null?_.use_responsive_algorithm():void 0:void 0)){s=r.element.property("background_image");if(r.run_mode()){d=null;h=null;r.autorun(function(){var i,o,a,s;s=r.evaluate_property("width");o=r.evaluate_property("height");a=r.responsive_mode()&&s===r.element.get_width();i=function(){return F(t,n.optimize_image(e.background_image,s,o,{fit:"crop"}))};h=n.optimize_image(e.background_image,s,o);if(e.background_image===d&&!n.downloaded_images[h]||a){return setTimeout(function(){if(h===n.optimize_image(e.background_image,s,o)){return i()}},300)}else{d=e.background_image;return i()}})}else if(!s.is_empty()&&s.is_static()){F(t,e.background_image)}}else if(!e.backdrop_image_paralax){F(t,n.optimize_image(e.background_image))}u=e.repeat_background_vertical&&e.repeat_background_horizontal?"repeat":e.repeat_background_vertical?"repeat-y":e.repeat_background_horizontal?"repeat-x":"no-repeat";a["background-repeat"]=u;if(e.center_background){if(e.is_backdrop){a["background-position"]="center top"}else{a["background-position"]="center"}}else{a["background-position"]=""}if(e.background_size_cover||(r!=null?(p=r.element.root())!=null?p.use_responsive_algorithm():void 0:void 0)&&e.crop_responsive){a["background-size"]="cover";a["-webkit-background-size"]="cover";a["-moz-background-size"]="cover";a["-o-background-size"]="cover"}else{a["background-size"]=""}if(e.backdrop_image_paralax){if(!L.is_on_mobile_or_tablet()){a["background-image"]="none";t.parallax({imageSrc:n.optimize_image(e.background_image,t.width()),speed:e.backdrop_paralax_speed});i=function(){return $(window).trigger("resize.px.parallax")};L.WaitFor(L.page_loaded_key,setTimeout(i,100));$(window).off("resize.parralax");$(window).on("resize.parralax",i);$(window).off("scroll.parralax");$(window).on("scroll.parralax",function(e){if($(window).scrollTop()===0){return i()}});f=null;o=function(){if(c().element.page_done_loading()){return i()}else{return f=setTimeout(o,100)}};o();setTimeout(function(){return clearTimeout(f)},5e3)}else{F(t,n.optimize_image(e.background_image))}}}}return k(t,a)}};t.prototype._uses_properties=["background_style","bgcolor","background_gradient_direction","background_gradient_custom_angle","background_gradient_from","background_gradient_to","background_gradient_mid","background_image","repeat_background_vertical","center_background","repeat_background_horizontal","background_size_cover","background_color_if_empty_image","crop_responsive","background_gradient_style","background_radial_gradient_shape","background_radial_gradient_size","background_radial_gradient_xpos","background_radial_gradient_ypos"];t.prototype.transition_properties={background_style:"background",backdrop_background_style:"background"};t.prototype.field_names={background_style:{"default":"none"},bgcolor:{"default":"#FFFFFF"},background_gradient_direction:{"default":"top"},background_gradient_custom_angle:{"default":45},background_gradient_from:{"default":"#FFFFFF"},background_gradient_to:{"default":"#AAAAAA"},background_gradient_mid:{optional:true},background_gradient_style:{"default":"linear"},background_radial_gradient_shape:{"default":"ellipse"},background_radial_gradient_size:{"default":"farthest-corner"},background_radial_gradient_xpos:{"default":10},background_radial_gradient_ypos:{"default":10},background_image:{},center_background:{},background_size_cover:{},repeat_background_vertical:{},repeat_background_horizontal:{},background_color_if_empty_image:{"default":"rgba(255, 255, 255, 0.0)"},crop_responsive:{no_states:true,"default":true,prop_not_in_style:true}};t.prototype.class_name="Background";return t}(m);n.SimpleGradient=b=function(e){be(t,e);function t(){se=t.__super__.constructor.apply(this,arguments);return se}t.prototype._apply=function(e,t){var n,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y;if(e){c=(g=e.style)===null||g===void 0||g==="linear";r=e.from;i=e.to;o=e.mid;if(c){if(e.direction==="custom"){u=((m=e.angle)!=null?m:45)+"deg"}else{u=(v=e.direction)!=null?v:"top";if(u==="top"||u==="bottom"){_=0;if(u==="bottom"){n=r;r=i;i=n;u="top"}}else if(u==="left"||u==="right"){_=1;if(u==="right"){n=r;r=i;i=n;u="left"}}}}f=L.RGBA_to_ARGB(r);d=L.RGBA_to_ARGB(i);if(o){a=""+r+" 0%, "+o+" 50%, "+i+" 100%"}else{a=""+r+" 0%, "+i+" 100%"}if(c){s="linear-gradient("+u+", "+a+")"}else{if(e.shape==null){e.shape="ellipse"}if(e.pos==null){e.pos="farthest-corner"}if(e.xpos==null){e.xpos=10}if(e.ypos==null){e.ypos=10}s="radial-gradient("+e.shape+" "+e.pos+" at "+e.xpos+"% "+e.ypos+"% ,"+a+")"}t[0].style["background"]=r;y=["-moz-","-webkit-","-o-","-ms-",""];for(p=0,h=y.length;p<h;p++){l=y[p];t[0].style["background"]=l+s}return t.css("filter","progid:DXImageTransform.Microsoft.gradient( startColorstr='"+f+"', endColorstr='"+d+"',GradientType="+_+")")}};t.prototype.class_name="SimpleGradient";return t}(m);D=e("./../lang/elements");for(U in n){j=n[U];if(((le=j.prototype)!=null?le.field_names:void 0)!=null&&!j.prototype.not_in_style){ce=j.prototype.field_names;for(z in ce){C=ce[z];if(!C.prop_not_in_style){D.style_properties[z]=true}}}}N=e;if(L.on_server()){B=N("./../core/property_applications_fields");B.add_fields_to_property_applications()}T=e("./../client_config");R=e("./../outlining");P=e("./../lang/lang");q=e("./../webfonts");I=e("./../imgix");c=e("./../lib");S=e("./../lang/appquery")}).call(this)},{"./../client_config":16,"./../imgix":42,"./../lang/appquery":51,"./../lang/elements":55,"./../lang/lang":57,"./../lib":65,"./../outlining":68,"./../u":72,"./../webfonts":76}],25:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p=this,h=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};f=e("./../u");i=e("./../lang/appquery");l=n;f.safe_register("./core/status_bar",l);d=0;t=e("./../jquery_plugins/nprogress.js");t.configure({showSpinner:false});o=null;l.show_progress_line=function(e){var n,r,a;if(e==null){throw f.error("must pass in what we are waiting on (a key or promise preferably)")}if(o==null){o=(a=i.app().get_public_setting("status_bar_color"))!=null?a:"#29d"}if(d===0){setTimeout(function(){var e;if(d>0){t.start();e=$("#nprogress");e.find(".bar").css("background",o);return e.find(".peg").css("box-shadow","0 0 10px "+o+", 0 0 5px "+o)}},200)}d++;n=setTimeout(function(){return console.log("warning: status bar still waiting on "+e)},10*1e3);r=false;return function(){if(r){return}r=true;d--;clearTimeout(n);if(d===0){return t.done()}}};l.hide_run_mode=function(){return $("#nprogress").hide()};l.show_run_mode=function(){return $("#nprogress").show()};l.show_NProgres_edit_mode=function(e){var n,r;if(!e.attr("id")){e.attr("id","nprogress_receiver")}t.configure({parent:"#nprogress_receiver"});n=setTimeout(function(){return console.log("warning: status bar (edit mode) still waiting on canvas "+e)},10*1e3);t.start();r=false;return function(){if(r){return}r=true;clearTimeout(n);return t.done()}};_=false;c=null;s=false;l.show_general_message=function(e,t){if(t==null){t=100}if(s){return}s=true;c=setTimeout(function(){return $(document).ready(function(){if(_){$(".status-notification .subtitle").text(e);return $(".status-notification").show(100)}})},t);return _=true};l.show_general_message_immediate=function(e,t){if(t==null){t=100}if(s){return}s=true;_=false;$(".status-notification .subtitle").html(e);return $(".status-notification").show(t)};l.hide_general_message=function(){s=false;clearTimeout(c);_=false;return $(".status-notification").hide(100)};l.show_loading_animation=function(e){var t;t=$("<div class=\"loading-animation\">\n    <div class='bubble'></div>\n    <div class='pulse'></div>\n</div>");e.append(t);return function(){return t.remove()}};l.show_simple_status=function(e){return $(document).ready(function(){$(".simple-notification").text(e);return $(".simple-notification").show(100)})};l.color_simple_status=function(e){return $(document).ready(function(){return $(".simple-notification").css("color",e)})};l.hide_simple_status=function(){return $(document).ready(function(){return $(".simple-notification").hide(100)})};a=[];l.spinner_key=f.MakeKeyList();r=null;u=null;l.spinner=function(t){var n,o,s,c,d,_,p;o=t.get_canvas();if(!o[0]){return function(){}}l.spinner_key.garbage_collect();c=l.spinner_key.make(null,"spinner_key");s=t.element.id();if(h.call(a,s)>=0){return function(){}}a.push(s);if(r==null){r=e("./../jquery_plugins/spin.min.js")}if(u==null){u=(_=i.app().get_public_setting("spinner_color"))!=null?_:"black"}d={lines:13,length:10,width:2,radius:10,corners:1,rotate:0,direction:1,color:u,speed:1,trail:70,shadow:false,hwaccel:false,className:"spinner",zIndex:2e9,top:Math.min(Math.max(t.element.get_height(),o.height())/2-10,100),left:o.width()/2-25};n=null;setTimeout(function(){if(p){return n=new r(d).spin(o[0])}},700);p=true;return function(){p=false;if(n!=null){n.stop()}f.array_remove(a,s);return c.turn()}}}).call(this)},{"./../jquery_plugins/nprogress.js":48,"./../jquery_plugins/spin.min.js":49,"./../lang/appquery":51,"./../u":72}],26:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g={}.hasOwnProperty,m=function(e,t){for(var n in t){if(g.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};c=e("events");_=e("./../u");_.safe_register("./core/widgets",n);n.Widget=s=function(e){m(t,e);function t(){p=t.__super__.constructor.apply(this,arguments);return p}t.prototype.get_canvas=function(){return this.canvas};return t}(c.EventEmitter);n.SubMenu=a=function(e){m(t,e);function t(){h=t.__super__.constructor.apply(this,arguments);return h}t.prototype.set_children=function(e){var t,n,r,i;this.children_div.empty();i=[];for(n=0,r=e.length;n<r;n++){t=e[n];i.push(this.add_child(t))}return i};t.prototype.add_child=function(e){return this.children_div.append(e.get_canvas())};return t}(s);n.ModalPopup=i=function(e){m(t,e);function t(e,t){var n,r,i=this;this.title=e;this.true_modal=t;this.canvas=_.div("modal-popup");n=_.div("popup-content",this.canvas);n.append(this.create_header());r=_.div("children",n);this.children_div=_.div("inner-children",r);if(!this.true_modal){this.canvas.on("vclick",function(e){if(_.did_event_pass_through(e,".children")||_.is_on_mobile_or_tablet()){return true}i.hide();return true});$(document).off("keydown.escape-modal-popup");$(document).on("keydown.escape-modal-popup",function(e){if(e.keyCode===27){i.hide()}})}}t.prototype.create_header=function(){var e;e=_.div("popup-title");e.text(this.title);return e};t.prototype.show=function(){var e;$(document.body).append(this.canvas);if(this.canvas.height()>$(window).height()-150){e="absolute";$("body").css("overflow","visible")}else{e="fixed";$("body").css("overflow","hidden")}this.canvas.css({opacity:0,position:e});return _.velocity(this.canvas,"fadeIn",{duration:300})};t.prototype.hide=function(){var e=this;this.emit("hiding");return _.velocity(this.canvas,"fadeOut",{duration:300,complete_cb:function(){e.canvas.remove();$("body").css("overflow","auto");return $(document).off("keydown.escape-modal-popup")}})};return t}(a);n.get_uploaded_file_id=function(e,t){var n;n="f"+(t!=null?t:_.UUID())+"/"+e;if(l.is_dedicated){n=l.environment_name+"/"+n}return n};n.get_uploaded_file_endpoint=function(e,t){var n;n="//"+l.user_file_url+e;if(t){n="https:"+n}return n};o=function(e){return e(null,{})};n.upload_file=function(e,t,n,i,a,s,l,c){var f,p,h,g=this;if(n==null){n=o}h=r().location.get_server_base()+"fileupload";p=function(o,f){var p,g,m,v;if(typeof a==="function"){a()}if(r().is_edit_mode()){d.show_general_message(t)}else{v=d.show_progress_line("image uploader")}g=function(){if(r().is_edit_mode()){return d.hide_general_message()}else{return v()}};p=function(){var t,o=this;t={success:function(e){g();return i(e)},error:function(e){var t;g();if(e.status>=400&&e.status<=499){if(e.responseText.indexOf("Error parsing request body: request entity too large")!==-1){t=_.error({statusCode:400,reason:"FILE_TOO_LARGE"})}else if(e.responseText&&e.getResponseHeader("Content-Type")==="application/json"){t=_.error(JSON.parse(e.responseText))}}if(t==null){t=_.error("Error uploading file: "+e.responseText)}return typeof s==="function"?s(t):void 0},processData:false,type:"post"};return n(function(n,i){var o;if(n){window.alert(_.human_friendly(n));return t.success(null)}else{if(r().is_edit_mode()){_.extend(i,{appname:u.appname(),app_version:u.app_version()})}t.data=JSON.stringify(_.extend(i,e));if((o=t.data).name==null){o.name=c}t.contentType="application/json";return $.ajax(h,t)}})};if(l){m=document.createElement("img");m.src=o.result;m.onerror=function(){g();return typeof s==="function"?s():void 0};return m.onload=function(){var t,n,r,i,o,a,s,u;r=document.createElement("canvas");n=800;t=600;u=m.width;a=m.height;if(u>a){if(u>n){a*=n/u;u=n}}else{if(a>t){u*=t/a;a=t}}r.width=u;r.height=a;i=r.getContext("2d");s=function(){i.drawImage(m,0,0,u,a);e.contents=r.toDataURL("image/png",.7).split(",")[1];return p()};if(window.orientation!=null){o=function(t){var n;n=new FileReader;n.onload=function(e){var n,r,i,o,a,s,u,l;u=new DataView(e.target.result);if(u.getUint16(0,false)!==65496){return t(-2)}r=u.byteLength;a=2;while(a<r){o=u.getUint16(a,false);a+=2;if(o===65505){if(u.getUint32(a+=2,false)!==1165519206){t(-1)}i=u.getUint16(a+=6,false)===18761;a+=u.getUint32(a+4,i);s=u.getUint16(a,i);a+=2;for(n=l=0;0<=s?l<s:l>s;n=0<=s?++l:--l){if(u.getUint16(a+n*12,i)===274){return t(u.getUint16(a+n*12+8,i))}}}else if((o&65280)!==65280){break}else{a+=u.getUint16(a,false)}}return t(-1)};return n.readAsArrayBuffer(e)};return o(function(e){switch(e){case 2:i.translate(r.width,0);i.scale(-1,1);break;case 3:i.translate(r.width,r.height);i.rotate(Math.PI);break;case 4:i.translate(0,r.height);i.scale(1,-1);break;case 5:i.rotate(.5*Math.PI);
i.scale(1,-1);break;case 6:i.rotate(.5*Math.PI);i.translate(0,-r.height);break;case 7:i.rotate(.5*Math.PI);i.translate(r.width,-r.height);i.scale(-1,1);break;case 8:i.rotate(-.5*Math.PI);i.translate(-r.width,0)}return s()})}else{return s()}}}else{if(f){e={contents:f,name:c}}else{e.contents=o.result.split(",")[1]}return p()}};if(e.contents){return p(void 0,e.contents)}else{f=new FileReader;f.onload=function(){return p(f)};return f.readAsDataURL(e)}};n.MakeImageUploader=function(e,t,i,a,s,l,c){var p,h,g,m,v,y,b=this;if(i==null){i=o}if(t==null){t="We're uploading your image..."}if(e[0].files){return e.change(function(){var r,o;o=e[0].files;if(o.length<1){return}r=o[0];return n.upload_file(r,t,i,a,s,l,c)})}else{g=_.UUID();m=null;p=function(){if(r().is_edit_mode()){return d.hide_general_message()}else{return m()}};h={};if(r().is_edit_mode()){_.extend(h,{appname:u.appname(),app_version:u.app_version()})}v=r().location.get_server_base()+"fileupload";return y=typeof window!=="undefined"&&window!==null?new window.ss.SimpleUpload({button:e,url:v,name:"fileupload__"+g,responseType:"json",data:h,autoSubmit:false,onChange:function(){return i(function(e,t){if(e){return window.alert(_.human_friendly(e))}else{_.extend(h,t);return setTimeout(function(){return y.submit()},1)}})},onSubmit:function(e,n,i){var o;if(r().is_edit_mode()){d.show_general_message(t)}else{m=d.show_progress_line("image uploader for ie9")}if(typeof s==="function"){s()}o="file-upload-ie9-hack-"+g;f.on(o,function(e){if(e){p();return a(e)}});return true},onError:function(){p();return typeof l==="function"?l():void 0}}):void 0}};n.ImageUploader=t=function(e){m(t,e);t.prototype.get_class="image-uploader";function t(e){this.file_cb=e;this.canvas=_.input(void 0,void 0,"file");n.MakeImageUploader(this.canvas,void 0,null,this.file_cb)}return t}(s);r=e("./../lib");d=e("./status_bar");f=e("./../notifier_client");l=e("./../client_config");u=e("./../lang/appquery")}).call(this)},{"./../client_config":16,"./../lang/appquery":51,"./../lib":65,"./../notifier_client":67,"./../u":72,"./status_bar":25,events:276}],27:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I={}.hasOwnProperty,P=function(e,t){for(var n in t){if(I.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e},R=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};A=e("./../u");_=e("./db");f=e("./../client_config");a=e("./../lib");l=n;A.safe_register("./db/client_db",l);if(typeof window!=="undefined"&&window!==null){window.client_db=l}h=_.dehydrate_prefix;m=function(){if(!A.cookies_enabled()){return null}return _.get_temp_db(A.readCookie("temp_db"),a().appname())};l.instance=function(e,n,r){var i;if(e==null){e=a().appname()}if(n==null){n=a().app_version()}if(r==null){r=m()}i=A.smush(e,n,r);if(p[i]==null){p[i]=new t(r,e,n)}return p[i]};l.new_instance=function(e,n,r){if(e==null){e=a().appname()}if(n==null){n=a().app_version()}if(r==null){r=m()}return new t(r,e,n)};p={};O=A.Box();g=A.LUID();l.recheck_uid=function(e){if(e==null){e=function(){}}return a.wait_for_lib(function(){var t;if(A.cookies_enabled()){t=A.readCookie(d.uid_cookie_name(a().appname(),a().app_version(),m()))}if(!t){t=g;console.log("USING FAKE_TEMP_UID (legit if we just changed temp_db)")}if(t!==O()){O(t);l.reauth();A.error_environment.user_id=t;A.run_once(30,function(){var e,t;e=a().current_user();t=y.get_user_language_field();if(t!=null){e.child(t).get()}return e.get_email()},function(e,t){if(e){return A.error_environment.user_email="error loading email: "+A.nice_print_error(e)}else{return A.error_environment.user_email=t}})}return e()})};l.current_user=function(e,t,n){l.recheck_uid();return l.instance(e,t,n).get(O())};s={};C={};C.firebase=A.MakeSwitch(null,"firebase ready_key");C.firebase_workflow=A.MakeSwitch(null,"firebase_workflow ready key");l.server_time_offset_key=A.MakeKey(null,"server_time_offset");if(typeof window!=="undefined"&&window!==null){if(!f.main_firebase_off){s.firebase=new window.Firebase(f.firebase_root)}E=!f.notifier_domain||A.is_edit_mode();if(E){s.firebase_workflow=new window.Firebase(f.workflow_firebase_root)}(function(){window.server_time_offset=0;if(f.notifier_domain){return setImmediate(function(){return b.get_server_time_offset(function(e){window.server_time_offset=e;return l.server_time_offset_key.turn()})})}else{return new window.Firebase(f.workflow_firebase_root+"/.info/serverTimeOffset").on("value",function(e){var t;window.server_time_offset=(t=e.val())!=null?t:0;return l.server_time_offset_key.turn()})}})()}l.firebase=function(){if(f.main_firebase_off){throw A.error("main firebase is off")}A.ensure_ready(C.firebase,false);return s.firebase};l.firebase_ready_key=function(){if(f.main_firebase_off){throw A.error("main firebase is off")}l.recheck_uid();return C.firebase};l.get_workflow_firebase=function(){var e;e=A.Promise(null,"get workflow firebase");A.WaitFor(C.firebase_workflow,function(){return e.resolve(s.firebase_workflow)});return e};k=10;w=function(){return setTimeout(function(){var e;k=k*5;if(k>120*1e3){k=120*1e3}e=a().location.post("server://user/hi",{});return e.then(function(){return l.reauth(true)},w)},k)};x=0;l.reauth=function(e){return a.wait_for_lib(function(){A.rebuild_cookies();if(E){return u("firebase_workflow",e)}})};T={};u=function(e,t){var n,r,i,o;if(!A.cookies_enabled()){return}r=d.firebase_cookie_name(a().appname(),e);o=A.readCookie(r);if(typeof o!=="string"){w();if(t){x+=1;i="Reauthed to firebase but cookie did not contain a valid token";n={cookie_name:r,token:o,cookieEnabled:navigator.cookieEnabled,dck:document.cookie};if(x===5){return A.warn(i,n)}else{return console.log(i+": "+JSON.stringify(n))}}}else if(o!==T[e]){T[e]=o;return s[e].authWithCustomToken(o,function(t,n){var r,o;if(t){x+=1;i="failed to authenticate to "+e;if(x>3){A.warn(i,{error:A.nice_print_error(t)})}else{console.log(i+": "+A.nice_print_error(t))}w();return}x=0;setTimeout(function(){return k=10},10*1e3);console.log("authorized successfully for "+e);C[e].turn_on();r=n.expires*1e3-A.timestamp();o=Math.max(3600*1e3,r-3600*1e3);return setTimeout(function(){console.log("firebase token about to expire, refreshing");return w()},o)},function(e){return A.warn("Lost firebase authorization",{error:A.nice_print_error(e)})})}};_.ClientDBNode=r=function(e){P(t,e);function t(){j=t.__super__.constructor.apply(this,arguments);return j}t.prototype._operate=function(e,t){var n;n=this.parent_id();this.db._ensure_loading(n);e=_.dehydrate_tree(e);return t(n,e,this._extract(this.db._get_data(n)))};t.prototype.set=function(e){var t=this;return this._operate(e,function(e,n,r){return t.db._set_local(e,t._path,n)})};t.prototype.push=function(e){var t=this;return this._operate(e,function(e,n,r){if(r==null){r=[]}if(!Array.isArray(r)){return A.warn("path "+t.firebase+" is not an array: "+r)}else if(R.call(r,n)<0){r.push(n);if(f.MAX_LIST_LENGTH&&r.length>f.MAX_LIST_LENGTH){throw A.error({statusCode:400,message:"List at maximum length (1000)"})}return t.set(r)}})};t.prototype.remove=function(e){var t=this;return this._operate(e,function(e,n,r){var i,o,a,s,u;if(r==null){r=[]}if(!Array.isArray(r)){return A.warn("path "+t.firebase+" is not an array: "+r)}else if(R.call(r,n)>=0){A.array_remove(r,n);return t.set(r)}else if(Array.isArray(n)&&(u=A.json_stringify(n),R.call(function(){var e,t,n;n=[];for(e=0,t=r.length;e<t;e++){i=r[e];n.push(A.json_stringify(i))}return n}(),u)>=0)){o=[];for(a=0,s=r.length;a<s;a++){i=r[a];if(A.json_stringify(i)!==A.json_stringify(n)){o.push(i)}}return t.set(o)}})};t.prototype.raw=function(){var e;e=this.parent_id();this.db._ensure_loading(e);A.ensure_ready(this.db._get_ready_key(e));this.db._register_dependency(e);return this._extract(this.db._get_data(e))};t.prototype.dehydrate=function(){return h("ClientDBNode")+this.key()};t.prototype.make_index=function(){return new _.NodeIndex(this)};t.prototype.precache=function(){var e;e=this.parent_id();return this.db._ensure_loading(e)};return t}(_.NodeBase);r.rehydrate=function(e,t){return e.get_node(t)};_.ClientDBObject=i=function(e){P(t,e);function t(e,t){this.id=e;this.db=t}t.prototype.ignore_privacy=function(){return this};t.prototype["delete"]=function(){return this.db._delete_local(this.id)};return t}(r);D=_.ObjectBase;for(v in D){M=D[v];i.prototype[v]=M}t=function(e){P(t,e);t.prototype.DBNODE=r;t.prototype.DBOBJECT=i;t.prototype.GET_BATCH_SIZE=200;function t(e,t,n){this.temp_db=e;this.appname=t;this.app_version=n;this._init();this._gets=[];this._searches=[];this._searches_current_count=0;this.result_cache={};this.result_dependency_cache={};this.watch_search_status={};this._notifier_client=b;this._last_run={};this._next_scheduled={};this._to_percolate=[]}t.prototype.schedule_discard_errors=function(e){var t=this;return setTimeout(function(){var n,r;r=t.init_result_cache(e);return r.ranges=function(){var e,t,i,o;i=r.ranges;o=[];for(e=0,t=i.length;e<t;e++){n=i[e];if(n.state!==_.ERROR){o.push(n)}}return o}()},3e4)};t.prototype.execute_with_dependency=function(e,t,n){var r,i,o,a,s,u,l,c,f,d,_,p=this;r=JSON.stringify(e)+"_"+t+"_"+n;if((d=this.result_dependency_cache)[r]==null){d[r]={}}if(!this.result_dependency_cache[r].current_result){if(((_=A.CurrentNotReadyCatcher)!=null?_.length:void 0)>0){return[]}c=false;i={id:r,invalidate:function(){var o;i.invalidated=true;if(i!==((o=p.result_dependency_cache[r])!=null?o.current_result:void 0)){return}if(!i.dependency.needed()){delete p.result_dependency_cache[r];return}p.result_dependency_cache[r].old_result=p.result_dependency_cache[r].current_result;p.result_dependency_cache[r].current_result=null;return p._set_immediate(function(){return A.run_once(120,function(){return p.execute_with_dependency(e,t,n)})})}};l=A.CurrentNotReadyCatcher;u=A.CurrentAutoRun;try{A.CurrentAutoRun=i;A.CurrentNotReadyCatcher=null;f=this.execute_query(e,t,n)}catch(h){a=h;s=A.not_ready_key(a);if(s&&u){s.turned_dependency().register(u)}throw a}finally{A.CurrentNotReadyCatcher=l;A.CurrentAutoRun=u}if(i.invalidated){throw A.error("assertion error: current_result invalidated too soon",{query:e,from:t,n:n})}if(this.result_dependency_cache[r].old_result){o=this.result_dependency_cache[r].old_result.dependency;if(JSON.stringify(this.result_dependency_cache[r].old_result.results)!==JSON.stringify(f)){o.invalidate()}this.result_dependency_cache[r].old_result=null}else{o=A.Dependency()}i.dependency=o;i.results=f;this.result_dependency_cache[r].current_result=i;c=true}this.result_dependency_cache[r].current_result.dependency.register();return this.result_dependency_cache[r].current_result.results};t.prototype.register_call_dependency=function(e){var t,n;t=JSON.stringify(e);if((n=this.result_cache[t]).dependency==null){n.dependency=A.Dependency()}this.result_cache[t].dependency.register();return this.ensure_watching_plan(e)};t.prototype.invalidate_call_dependency=function(e){var t,n;return(t=this.result_cache[e])!=null?(n=t.dependency)!=null?n.invalidate():void 0:void 0};t.prototype.add_plan_to_watch_search=function(e){var t,n,r,i;n=_.PLANS[e.t].watch_search_call(e);if(!n){return}r=JSON.stringify(n);t=JSON.stringify(e);if((i=this.watch_search_status)[r]==null){i[r]={plans:{}}}return this.watch_search_status[r].plans[t]=true};t.prototype.ensure_watching_plan=function(e){var t,n;this.add_plan_to_watch_search(e);t=_.PLANS[e.t].watch_search_call(e);if(!t){return}n=JSON.stringify(t);if(this.should_watch_search_now(n)){this.do_percolate(t)}return this.ensure_percolate_scheduled(t)};t.prototype.should_watch_search_now=function(e){var t;return((t=this.watch_search_status[e].last_time)!=null?t:0)<Date.now()-_.PERCOLATOR_INTERVAL};t.prototype.ensure_percolate_scheduled=function(e){var t,n=this;t=JSON.stringify(e);if(!this.watch_search_status[t].scheduled){this.watch_search_status[t].scheduled=true;return this._set_timeout(function(){n.watch_search_status[t].scheduled=false;return n.percolate_if_needed(e)},_.PERCOLATOR_INTERVAL-30*1e3)}};t.prototype.percolate_if_needed=function(e){var t,n,r,i,o,a,s,u;i=JSON.stringify(e);t=false;n={};a=this.watch_search_status[i].plans;for(r in a){o=a[r];if((s=this.result_cache[r])!=null?(u=s.dependency)!=null?u.needed():void 0:void 0){t=true;n[r]=true}else{this.invalidate_plan(r)}}this.watch_search_status[i].plans=n;if(!t){return}this.do_percolate(e);return this.ensure_percolate_scheduled(e)};t.prototype.set_perc_id=function(e,t){var n,r;r=JSON.stringify(e);if(t===this.watch_search_status[r].perc_id){return}this.watch_search_status[r].perc_id=t;n=_.get_search_notification_topic(t);return this._notifier_client.on(n,this.notify_maybe_invalid.bind(this,e))};t.prototype.notify_maybe_invalid=function(e,t){var n,r,i,o,a=this;if(t&&this.is_watching(t)){return}o=JSON.stringify(e);if(this._next_scheduled[o]){return}i=this.query_planner().get_stats(e.type,e.constraints);if((i!=null?i.length:void 0)!=null){if(i.length<10){r=200}else if(i.length<50){r=5e3}else if(i.length<1e3){r=1e4}else{r=3e4}}else{r=1e4}n=function(){return a._last_run[o]&&a._last_run[o]>Date.now()-r&&!a.percolator_rate_limit_disabled};if(n()){this._next_scheduled[o]=true;return this._set_timeout(function(){a._next_scheduled[o]=false;a._last_run[o]=Date.now();return a.invalidate_plans(o)},this._last_run[o]+r-Date.now())}else{this._last_run[o]=Date.now();return this.invalidate_plans(o)}};t.prototype._set_timeout=function(e,t){return setTimeout(e,t)};t.prototype._set_immediate=function(e){return setImmediate(e)};t.prototype.wait_for_plan_loading=function(e,t){var n,r,i,o,a,s,u,l=this;i=this.result_cache[e];n=[];u=(s=i!=null?i.ranges:void 0)!=null?s:[];for(o=0,a=u.length;o<a;o++){r=u[o];if(r.state===_.LOADING){n.push(r.loading_key)}}if(n.length>0){return A.WaitFor(n,function(){return l._set_timeout(l.wait_for_plan_loading.bind(l,e,t),5)})}else{return t()}};t.prototype.invalidate_plans=function(e){var t,n,r,i,o=this;r=this.watch_search_status[e].plans;i=[];for(t in r){n=r[t];i.push(function(e){return o.wait_for_plan_loading(e,function(){return o.invalidate_plan(e)})}(t))}return i};t.prototype.do_percolate=function(e){var t;t=JSON.stringify(e);this.watch_search_status[t].last_time=Date.now();this._to_percolate.push(e);if(!this._watch_percolate_scheduled){this._watch_percolate_scheduled=true;return this._set_timeout(this.bulk_watch.bind(this),200)}};t.prototype.bulk_watch=function(){var e,t,n,r,i=this;this._watch_percolate_scheduled=false;t=this._to_percolate;this._to_percolate=[];n=function(){var n,i,o,a;a=[];for(n=0,i=t.length;n<i;n++){o=t[n],r=o.type,e=o.constraints;a.push({type:r,constraints:e})}return a}();return this.elasticsearch("bulk_watch",{appname:this.appname,app_version:this.app_version,temp_db:this.cur_temp_db(),searches:n},function(e,n){var r,o,a,s,u;if(e){return A.warn(e)}else{u=[];for(r=a=0,s=t.length;a<s;r=++a){o=t[r];u.push(i.set_perc_id(o,n[r]))}return u}})};t.prototype.get_appname=function(){return this.appname};t.prototype.get_app_version=function(){return this.app_version};t.prototype.get_temp_db=function(){return _.get_temp_db(this.temp_db,this.appname)};t.prototype.url_to_base=function(e){return new window.Firebase(e)};t.prototype.firebase_ready_key=function(){return C.firebase};t.prototype.elasticsearch=function(e,t,n){if(e==="get"&&!t.update_firebase){this._schedule_multi_get();this._gets.push({id:t.id,cb:n});return}if(e==="search"&&t.n<30){this._searches.push({data:t,cb:n});this._searches_current_count+=t.n;this._schedule_multi_search();return}return a().location.post("server://elasticsearch/"+e,t,n)};t.prototype._schedule_multi_get=function(){var e=this;if(this._multi_get_scheduled){return}this._multi_get_scheduled=true;if(!this._multi_get_switch){this._multi_get_switch=A.MakeSwitch(null,"multi get switch");this._multi_get_switch.turn_on()}return A.WaitFor(this._multi_get_switch,function(){return setTimeout(function(){var t,n,r,i,o;e._multi_get_scheduled=false;o=e._gets.slice(0,e.GET_BATCH_SIZE);e._gets=e._gets.slice(e.GET_BATCH_SIZE);e._multi_get_switch.turn_off();if(e._gets.length>0){e._schedule_multi_get()}r=function(){var e,r,i,a;a=[];for(e=0,r=o.length;e<r;e++){i=o[e],n=i.id,t=i.cb;a.push(n)}return a}();i={appname:e.appname,app_version:e.app_version,temp_db:e.cur_temp_db(),ids:r};return e.elasticsearch("mget",i,function(n,r){var a,s,u,l,c,f,d,_,p,h;e._multi_get_switch.turn_on();if(!n&&((d=r.docs)!=null?d.length:void 0)!==o.length){n=A.error("bad response from mget",{params:i,res:r})}if(n){p=[];for(u=0,c=o.length;u<c;u++){t=o[u].cb;p.push(t(n))}return p}else{_=r.docs;h=[];for(s=l=0,f=_.length;l<f;s=++l){a=_[s];h.push(o[s].cb(null,a))}return h}})},10)})};t.prototype._schedule_multi_search=function(){var e=this;if(this._multi_search_scheduled){if(this._searches.length>30||this._searches_current_count>100){clearTimeout(this._multi_search_timeout);this._do_multi_search()}return}this._multi_search_scheduled=true;return this._multi_search_timeout=setTimeout(function(){return e._do_multi_search()},10)};t.prototype._do_multi_search=function(){var e,t,n,r,i;this._multi_search_scheduled=false;i=this._searches;this._searches=[];this._searches_current_count=0;r=function(){var n,r,o,a;a=[];for(n=0,r=i.length;n<r;n++){o=i[n],t=o.data,e=o.cb;a.push(t)}return a}();n={appname:this.appname,app_version:this.app_version,temp_db:this.cur_temp_db(),index:this.get_elastic_search_index(),searches:r};return this.elasticsearch("msearch",n,function(r,o){var a,s,u,l,c,f,d,_,p,h;if(!r&&((d=o.responses)!=null?d.length:void 0)!==i.length){r=A.error("bad response from msearch",{res:JSON.stringify(o,null,4),params:n})}if(r){p=[];for(u=0,c=i.length;u<c;u++){e=i[u].cb;p.push(e(r))}return p}else{_=o.responses;h=[];for(s=l=0,f=_.length;l<f;s=++l){t=_[s];if(t.error){a=A.error(t.error);a.query_was=i[s].data;h.push(i[s].cb(a))}else{h.push(i[s].cb(null,t))}}return h}})};return t}(_.DB);d=e("./../lang/dataops");c=e("./../client_performance");y=e("./../languages");b=e("./../notifier_client")}).call(this)},{"./../client_config":16,"./../client_performance":17,"./../lang/dataops":54,"./../languages":64,"./../lib":65,"./../notifier_client":67,"./../tests/testing":71,"./../u":72,"./db":28}],28:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,$,K,J,X,Z,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,fe,de,_e,pe,he,ge,me,ve,ye,be,we,xe,ke,Se,Ae,Ee,Me,Te,Ce,je,De,Oe,Ie,Pe,Re,ze,Be,Ne,Le,qe,Ue,Fe,We,Ge,Ve,Ye,He,$e,Ke,Je,Xe,Ze,Qe,et,tt,nt={}.hasOwnProperty,rt=function(e,t){for(var n in t){if(nt.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e},it=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1},ot=[].slice;We=e("./../u");te=n;We.safe_register("./db/db",te);te.Dynamic=u=function(){function e(){}return e}();te.ListWrapper=g=function(e){rt(t,e);function t(e,t){this.db=e;this.query=t;if(!this.db){throw We.error("missing db")}if(!this.query){throw We.error("missing query")}}t.prototype.get_children=function(e,t){var n;if(t<1){return[]}if(e+t>r){t=r-e}n=this.db.execute_with_dependency(this.query,e,t);return this.db.array_to_objects(this.query,n)};t.prototype.length=function(){var e;e={t:"Length",prev:this.query};return this.db.execute_with_dependency(e,0,1)[0]};t.prototype.get_item_value_id=function(){return this.db.get_plan_ret_value(this.query)};t.prototype.filter=function(e){var n;e=X.resolve_constraints(e);e=te.dehydrate_tree(e);if(e.length===0){return this}n={t:"Filter",constraints:e,prev:this.query};return new t(this.db,n)};t.prototype.sort=function(e){var n;e=X.resolve_sorts(e,false);if(e.length===0){return this}n={t:"Sort",sorts_list:e,prev:this.query};return new t(this.db,n)};t.prototype.sort_on_id=function(){return this.sort([{sort_field:"_id"}])};t.prototype.capped=function(e){var n;n={t:"Cap",max:e,prev:this.query};return new t(this.db,n)};t.prototype.offset=function(e){var n;n={t:"Offset",offset:e,prev:this.query};return new t(this.db,n)};t.prototype.dehydrate=function(){return ne("ListWrapper")+JSON.stringify(this.query)};t.prototype.get=function(){return this};t.prototype.all=function(){return this.get_children(0,r)};t.prototype.make_static=function(){return this.db.static_list(this.get_item_value_id(),this.all())};t.prototype.contains=function(e,t){var n;n={t:"Contains",prev:this.query,value_id:t.id(),item:te.dehydrate_tree(e)};return this.db.execute_with_dependency(n,0,1)[0]};t.prototype.position=function(e,t){var n;n={t:"Position",prev:this.query,value_id:t.id(),item:te.dehydrate_tree(e)};return this.db.execute_with_dependency(n,0,1)[0]};t.prototype._length_compare=function(e,t){var n,r;n={t:"Length",prev:this.query};r={t:"Compare",op:e,prev:n,n:t};return this.db.execute_with_dependency(r,0,1)[0]};t.prototype.length_greater_than=function(e){return this._length_compare(">",e)};t.prototype.length_greater_or_equal_than=function(e){return this._length_compare(">=",e)};t.prototype.length_less_than=function(e){return this._length_compare("<",e)};t.prototype.length_less_or_equal_than=function(e){return this._length_compare("<=",e)};t.prototype._numeric_op=function(e){var t,n;n=this.get_item_value_id();if(n!=="number"){return null}t={t:"Numeric",prev:this.query,op:e};return this.db.execute_with_dependency(t,0,1)[0]};t.prototype.sum=function(){return this._numeric_op("sum")};t.prototype.product=function(){return this._numeric_op("product")};t.prototype.average=function(){return this._numeric_op("average")};t.prototype.median=function(){return this._numeric_op("median")};t.prototype.min=function(){return this._numeric_op("min")};t.prototype.max=function(){return this._numeric_op("max")};return t}(u);g.rehydrate=function(e,t){var n;n=JSON.parse(t);return new g(e,n)};Ze=/[\.#\$\[\]\/]/g;he=function(e){if(!e){throw We.error("bad id: "+e)}return e.replace(Ze,"__")};te.id_safe=he;te.TransientCache=I=function(){function e(){this.cache={}}e.prototype.get=function(e,t){var n;if(!this.cache[e]){n=t();this.cache[e]=n}return this.cache[e]};e.prototype.exists=function(e){return this.cache[e]!=null};e.prototype.flush=function(e){return delete this.cache[e]};e.prototype.flush_all=function(){return this.cache={}};return e}();te.dehydrate_prefix=ne=function(e){return ee.HYDRATE_STRING+e+"::"};te.get_temp_db=_e=function(e,t){if(e&&e.indexOf(":")!==-1){if(e.split(":")[0]===t){return e.split(":")[1]}}else{return e}};te.get_page_cookie=function(){return h().appname()+"_"+h().app_version()+"_page_session"};te.NodeBase=w=function(e){rt(t,e);function t(e,t,n){this.parent=e;this._path=t;this.db=n}t.prototype.path=function(){return this._path.join(".")};t.prototype.toString=function(){return"DBNode<"+this.key()+">"};t.prototype.key=function(){return this.parent_id()+"."+this._path.join(".")};t.prototype.child=function(e){var t;if(!this.parent){return new te.StaticNode(void 0)}if(this._path){t=this._path.concat(e.split("."))}return this.parent._child(t)};t.prototype.parent_id=function(){return this.parent._id()};t.prototype.get=function(e){var t,n,r,i,o,a;r=this.raw();if(!e){n=typeof(i=this.parent)._type==="function"?i._type():void 0;t=this._path.join(".");e=(o=Ve.get(n))!=null?(a=o.get_message(t))!=null?a.ret_value_id():void 0:void 0}if(Array.isArray(r)){if(typeof e==="string"){e=e.replace("list.","")}return new g(this.db,{t:"NodeList",type:e,id:this.parent_id(),field:this._path.join(".")})}if(r&&typeof r==="object"){return this}return Ce(this.db,r,e)};t.prototype._extract=function(e){var t,n,r,i,o,a;o=(i=this._path)!=null?i:[];for(n=0,r=o.length;n<r;n++){t=o[n];e=(a=e!=null?e[t]:void 0)!=null?a:null}return e};t.prototype.on_value=function(e){var t,n,r=this;n=void 0;t=this.db.on_value(this.parent_id(),function(t){var i;i=r._extract(t);if(n===void 0||i!==n){e(i)}return n=i});return t};t.prototype.off_value=function(e){return this.db.off_value(this.parent_id(),e)};return t}(u);te.ObjectBase={exists:function(){return this.raw()!=null},_id:function(){return this.id},_type:function(){var e;e=this.db._get_type(this.id);if(!e){this.raw();e=this.db._get_type(this.id)}return e},parent_id:function(){return this.id},dehydrate:function(){return ee.HYDRATE_STRING+this.id},get:function(){return this},key:function(){return this.id},flush:function(){return this.db.flush(this.id)},child:function(e){return this._child(e.split("."))},_child:function(e){return new this.db.DBNODE(this,e,this.db)},get_email:function(e){var t,n,r,i;n=this.child("authentication").child("email").child("email").get();if(n){return n}i=this.child("authentication").raw();for(r in i){t=i[r];if(t.email!=null){return t.email}}return null},is_logged_in:function(){var e;return(e=this.child("user_signed_up").get())!=null?e:false},poll:function(e,t){if(We.running_test()){console.log("Polling turned on, but disabling it because this is a test");return}return this.db._local(this._id()).poll(e,t)}};te.dehydrate_tree=function(e){var t,n,r;if(e==null){e=null}if(typeof e==="function"){throw We.error("cannot dehydrate a function")}else if(typeof(e!=null?e.dehydrate:void 0)==="function"){return e.dehydrate()}else if(e instanceof Date){return e.valueOf()}else if(e&&typeof e==="object"){if(e.constructor!=={}.constructor&&!Array.isArray(e)){throw We.error("trying to dehydrate a class: "+e.constructor.name)}n=Array.isArray(e)?[]:{};for(t in e){if(!nt.call(e,t))continue;r=e[t];n[t]=te.dehydrate_tree(r)}return n}else{return e}};te.rehydrate_tree=je=function(e,t){var n,r,i;if(typeof(e!=null?e.get:void 0)!=="function"){throw We.error("called rehydrate tree with "+e+" for my_db, it should be (my_db, obj)")}if(typeof t==="function"){throw We.error("called rehydrate tree with function: "+t)}if(typeof t==="string"&&t.indexOf(ee.HYDRATE_STRING)===0){return Ce(e,t)}else if(t&&typeof t==="object"){r=Array.isArray(t)?[]:{};for(n in t){if(!nt.call(t,n))continue;i=t[n];r[n]=te.rehydrate_tree(e,i)}return r}else{return t}};Ce=function(e,t){var n;if((t!=null?typeof t.indexOf==="function"?t.indexOf(ee.HYDRATE_STRING):void 0:void 0)===0){t=t.replace(ee.HYDRATE_STRING,"");n=t.split("::");if(n.length>1){if(!te[n[0]]){throw We.error("missing rehydrate key "+n[0])}return te[n[0]].rehydrate(e,n.slice(1).join("::"))}else{return e.get(t)}}else{return t}};Pe=function(e){return e.sort(function(e,t){var n,r,i,o;if(!W(e)&&W(t)){return-1}n=String(e.key)+e.constraint_type+JSON.stringify(te.dehydrate_tree((i=e.value)!=null?i:null));r=String(t.key)+t.constraint_type+JSON.stringify(te.dehydrate_tree((o=t.value)!=null?o:null));if(n<r){return-1}else if(r<n){return 1}else{return 0}})};de=function(e){var t,n;e=function(){var r,i;r=e!=null?e:{};i=[];for(t in r){n=r[t];if(n!=null){i.push(n)}}return i}();Pe(e);return e};te.turn_search_properties_into_a_json=Fe=function(e,t,n){return We.json_stringify(te.dehydrate_tree({type:e,constraints:de(t),sorts_list:n}))};tt=function(e,t,n){if(e instanceof u||(e!=null?e.is_db_proxy:void 0)||(e!=null?e.getTime:void 0)){return e}if(Array.isArray(e)){if(typeof n==="string"){n=n.replace("list.","")}return new M(e,t,n)}if(e&&typeof e==="object"){if(e._id){return new C(e,t,n)}else{return new T(e,t,n)}}return Ce(t,e)};te.StaticNode=T=function(e){rt(t,e);function t(e,t,n){this.data=e;this.db=t;this.value_id=n;if(this.db==null){this.db=h().db_instance()}}t.prototype.get_data=function(){return this.data};t.prototype.set=function(){return console.log("SETTING TO A STATIC NODE... IGNORING THIS")};t.prototype.push=function(){return console.log("PUSHING TO A STATIC NODE.... IGNORING THIS")};t.prototype.raw=function(){return this.data};t.prototype._type=function(){return this.value_id};t.prototype.child=function(e){var n,r,i,o,a,s,u,l,c;n=this.get_data();a=String(e).split(".");if(a.length>1&&typeof n[a[0]]==="object"){r=n;for(s=0,u=a.length;s<u;s++){o=a[s];r=r!=null?r[o]:void 0}}else{r=n!=null?n[e]:void 0}i=(l=Ve.get(this.value_id))!=null?(c=l.get_message(e))!=null?c.ret_value_id():void 0:void 0;if(i==="null"){i=null}return new t(r,this.db,i)};t.prototype.get=function(){return tt(this.get_data(),this.db,this.value_id)};t.prototype.dehydrate=function(){var e,t,n;e=We.json_stringify(te.dehydrate_tree(this.data));if((t=this.db).__StaticNode_rehydrate_cache==null){t.__StaticNode_rehydrate_cache={}}if((n=this.db.__StaticNode_rehydrate_cache)[e]==null){n[e]=this}return ne("StaticNode")+e};return t}(u);T.rehydrate=function(e,t){var n,r;if(t==="undefined"){n=void 0}else{n=JSON.parse(t)}if(e.__StaticNode_rehydrate_cache==null){e.__StaticNode_rehydrate_cache={}}if((r=e.__StaticNode_rehydrate_cache)[t]==null){r[t]=new T(te.rehydrate_tree(e,n),e)}return e.__StaticNode_rehydrate_cache[t]};He=function(e,t){var n;n=te.dehydrate_tree(e);n=We.json_stringify(n);n=(t!=null?t:"")+","+n;return n};et=function(e){var t,n,r;n=e.split(",");r=n[0];if(r.indexOf("{")===0){r=null;t=e}else{if(!r){r=null}t=n.slice(1).join(",")}return{value_id:r,data:t}};te.StaticObject=C=function(e){rt(t,e);function t(){Qe=t.__super__.constructor.apply(this,arguments);return Qe}t.prototype._id=function(){var e;e=this.get_data();if(e!=null?e._id:void 0){if(typeof e._id==="function"){return e._id()}else{return e._id}}if(this.__id==null){this.__id=We.LUID()}return this.__id};t.prototype.get=function(){return this};t.prototype.ignore_privacy=function(){var e=this;if(this.db.ignore_privacy_rules){return this}else{return h.extend({ignore_privacy_rules:true},function(){return new te.StaticObject(e.data,h().db_instance())})}};t.prototype.exists=function(){return false};t.prototype["delete"]=function(){};t.prototype.poll=function(){};t.prototype.is_equal_to=function(e){if(typeof(e!=null?e._id:void 0)!=="function"){return false}return e._id()===this._id()};t.prototype.get_email=function(){return void 0};t.prototype.is_logged_in=function(){return void 0};t.prototype.dehydrate=function(){var e,t,n;e=He(this.data,this.value_id);if((t=this.db).__StaticObject_rehydrate_cache==null){t.__StaticObject_rehydrate_cache={}}if((n=this.db.__StaticObject_rehydrate_cache)[e]==null){n[e]=this}return ne("StaticObject")+e};return t}(T);C.rehydrate=function(e,t){var n,r,i,o;o=et(t),r=o.value_id,n=o.data;if(e.__StaticObject_rehydrate_cache==null){e.__StaticObject_rehydrate_cache={}}if((i=e.__StaticObject_rehydrate_cache)[t]==null){i[t]=new C(te.rehydrate_tree(e,We.json_parse(n)),e,r)}return e.__StaticObject_rehydrate_cache[t]};te.is_list=function(e){return(e!=null?e.all:void 0)&&(e!=null?e.get_children:void 0)};Ie=function(e,t){if(e==null||!e._id()){return 1}if(t==null||!t._id()){return-1}return e._id().localeCompare(t._id(),"en-US")};te.sort_in_memory=function(e,t,n){var r,i;if(t.length===0){if(Ve.get(n).custom_type()!=null){return e.sort(Ie)}else{return e}}else if(t[0].sort_field===X.RANDOM_SORTING){return We.shuffle_array(e)}else{r=function(e){return function(t){var r;if(e.sort_on_id){return t._id()}else if(e.self){return t}else if(e.sort_field){if(typeof t.child!=="function"){if((n!=null?n.slice(0,4):void 0)==="api."){r=Ve.get(n).get_message(e.sort_field);if(r.is_not_found()){throw We.error({statusCode:400,message:"Sorting on this type of thing is currently not supported"})}return r.fn(t)}else{throw We.error("Trying to sort on a bad object",{value_id:n,sort_item:e,string_entry:String(t)})}}return t.child(e.sort_field).get()}else{return null}}};i=function(t){if(!t[0]){return function(t,n){return e.indexOf(t)-e.indexOf(n)}}else{return be(r(t[0]),t[0].descending,i(t.slice(1)))}};return e.sort(i(t))}};ae=function(e,t,n,r){var i,o,a,s,u,l,c,f,d;l=true;a=(f=e!=null?(d=e[A.properties])!=null?d[A.constraints]:void 0:void 0)!=null?f:[];for(s in a){o=a[s];if(!(o[A.key]===X.ADVANCED_SEARCH_CONSTRAINT&&l)){continue}i=t+"."+A.properties+"."+A.constraints+"."+s+"."+A.value;u=We.extend({},r);u.datasources=We.extend({},u.datasources);u.datasources.injected_value=function(){return n};u.datasources.injected_value_value=function(){var e;return(e=n!=null?n._type():void 0)!=null?e:"null"};c=ve.evaluate(o[A.value],u,void 0,null,i);if(!c[0]){
l=false}}return l};Ae=function(e,t,n){var r,i,o;for(i=0,o=t.length;i<o;i++){r=t[i];if(!te.local_constrain(e,r,n)){return false}}return true};F=function(e,t){var n,r,i,o;if(e==="user"&&((r=t.key)==="email"||r==="StripeCustomerID"||r==="user_signed_up")){if(t.key==="email"&&t.constraint_type!=="email_equals"){return false}return true}if(t.key===X.UNIQUE_ID){return(i=t.constraint_type)==="equals"||i==="not equal"}if(t.key===X.ALL_DB_FIELDS){return true}if(t.key===X.ADVANCED_SEARCH_CONSTRAINT){return false}n=Ve.get(e).get_message(t.key);return n.is_lookup()&&(o=n.ret_value_id(),it.call(X.NO_DB_CONSTRAINTS,o)<0)};W=function(e){if(e.key===X.ADVANCED_SEARCH_CONSTRAINT){return true}return K[e.constraint_type]};te.PERCOLATOR_INTERVAL=15*60*1e3;te.use_score_based_sorting=function(e,t){var n,r,i,o,a;if(H.use_postgres){return false}a=t!=null?t:[];for(i=0,o=a.length;i<o;i++){r=a[i];if(r.sort_field){return false}}return it.call(function(){var t,r,i,o;i=e!=null?e:[];o=[];for(t=0,r=i.length;t<r;t++){n=i[t];o.push(n.constraint_type)}return o}(),"contains_all_fields")>=0};te.use_geographic_sorting=function(e,t){var n,r,i,o,a;a=t!=null?t:[];for(i=0,o=a.length;i<o;i++){r=a[i];if(r.sort_field==null||typeof r.sort_field!=="object"){continue}n=Ve.get(e).get_message(r.sort_field.location_field);if(!n||n.ret_value().id()!=="geographic_address"){continue}if(!ue.get_coordinates(r.sort_field.geo_reference)){continue}else{return true}}return false};we=function(e,t){if(We.on_server()&&We.Fiber.current==null){return We.SyncRun(e,t,true)}else{return t()}};te.get_notification_topic=function(e,t){return"id-update-"+e+"-"+t};te.get_search_notification_topic=function(e){return"search-update"+e};m=function(){function e(e,t){var n=this;this.db=e;this.id=t;this.ready_key=We.MakeKey(30,function(){var e;e={is_loading:n._is_loading,watching:n._watching,raw:n.raw,error:n.error!=null,type:n.type,just_created:n.just_created,latest_version:n.latest_version};return"initial data for "+n.id+": "+JSON.stringify(e)});this.dependency=We.Dependency()}e.prototype.is_watching=function(){return this._watching};e.prototype.watch=function(){var e,t,n=this;if(We.on_server()){return}if(this._watching){return}this._watching=true;if(H.use_postgres){e=this.db.id()}else{e=this.db.get_elastic_search_index()}t=te.get_notification_topic(e,this.id);return ke.on(t,function(e){return h().workflow.wait_for_server(function(){return n.set_latest_version(parseInt(e))})})};e.prototype.poll=function(e,t){var n=this;if(t>0){return setTimeout(function(){n.db._reload(n.id);return n.poll(e,t-1)},e)}};e.prototype.set_latest_version=function(e){var t;if(e==null){e=0}if(this.latest_version==null){this.latest_version=0}if(e>this.latest_version){this.latest_version=e;if(this.latest_version>((t=this.version)!=null?t:0)){return this.db._reload(this.id)}}};e.prototype.on_value=function(e){if(this.handlers==null){this.handlers=[]}this.handlers.push(e);this.db._ensure_loading(this.id);if(this.raw!==void 0){e(this.raw)}return e};e.prototype.off_value=function(e){return We.array_remove(this.handlers,e)};e.prototype.dump=function(){var e,t,n,r;e=this.raw;n=this.type;r=this.version;t=this.ready_key.is_turned();return JSON.stringify({raw:e,type:n,version:r,ready:t},null,4)};return e}();G=function(e,t,n){var r,i,o,a;if(te.use_score_based_sorting(t,n)||te.use_geographic_sorting(e,n)){return false}a=n!=null?n:[];for(i=0,o=a.length;i<o;i++){r=a[i];if(r.sort_field===X.RANDOM_SORTING){return false}}return true};U=function(e,t){var n,r,i,o,a;r=[];a=t!=null?t:[];for(i=0,o=a.length;i<o;i++){n=a[i];if(typeof n.sort_field==="string"){r.push(e!=null?e[n.sort_field]:void 0)}else{r.push(0)}}return r};ge=function(e,t,n,r,i){var o,a,s,u,l,c;c=e!=null?e:[];for(a=u=0,l=c.length;u<l;a=++u){o=c[a].descending;if(n[a]===i[a]){continue}if(n[a]==null){return false}if(i[a]==null){return true}if(typeof n[a]==="string"){s=n[a].localeCompare(i[a],"en-US");if(!o){return s<0}else{return s>0}}else{if(!o){return n[a]<i[a]}else{return n[a]>i[a]}}}return t<r};s="dontknow";y=2e3;k=400;oe=function(e,t,n){var r;if(t>0){return function(e){return[]}}r=false;return function(e){if(e==null){e=1}if(e!==1){return[]}if(r){return[]}r=true;return n()}};te.PLANS={All:{get_ret_value:function(e){return e.type},fn:function(){throw We.error("All cannot be executed")}},Static:{fn:function(e,t){var n,i,o=this;n=e.data,i=e.value_id;if(n==null){n=[]}return function(e){var i,o;if(e==null){e=r}o=t+e;i=n.slice(t,o);t=o;return i}},get_ret_value:function(e){return e.value_id}},Transform:{fn:function(e,t){var n,r,i,o,a,s,u=this;i=e.prev,s=e.value_id,n=e.message,o=e.properties;r=this.iterate(i,t);o=te.rehydrate_tree(this,o);n=Ve.get(s).get_message(n);a=function(e,t){if(t%10===0){We.optional_pause()}return n.fn(e,null,o)};return function(e){var t,o,s,l;s=r(e);if(s==null){return[]}s=u.array_to_objects(i,s);l=function(){var e,n,r;r=[];for(t=e=0,n=s.length;e<n;t=++e){o=s[t];r.push(a(o,t))}return r}();return N(n.ret_value_id(),l)}},get_ret_value:function(e){var t,n,r,i;n=e.prev,i=e.value_id,t=e.message,r=e.properties;t=Ve.get(i).get_message(t);return t.ret_value().id()},preserves_length:true,preserves_context:{sorted_above:true}},Numeric:{is_single:true,fn:function(e,t){var n=this;return oe(e,t,function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y;a=e.prev,o=e.op;r=n.all(a);if(r.length===0){return[null]}switch(o){case"sum":s=0;for(u=0,d=r.length;u<d;u++){i=r[u];if(i!=null){s+=i}}return[s];case"product":s=1;for(l=0,_=r.length;l<_;l++){i=r[l];if(i!=null){s*=i}}return[s];case"average":s=0;for(c=0,p=r.length;c<p;c++){i=r[c];if(i!=null){s+=i}}return[s/r.length];case"median":r=[].concat(r);r.sort(function(e,t){return e-t});r=function(){var e,t,n;n=[];for(e=0,t=r.length;e<t;e++){i=r[e];if(i!=null){n.push(i)}}return n}();if(r.length%2===0){return[(r[r.length/2-1]+r[r.length/2])/2]}else{return[r[Math.floor(r.length/2)]]}break;case"min":s=r[0];v=r.slice(1);for(f=0,h=v.length;f<h;f++){t=v[f];if(t<s){s=t}}return[s];case"max":s=r[0];y=r.slice(1);for(m=0,g=y.length;m<g;m++){t=y[m];if(t>s){s=t}}return[s];default:throw We.error("unrecognized op: "+o)}})},get_ret_value:function(){return"number"},simplify:function(e){},adds_context:{sorted_above:true}},Contains:{is_single:true,fn:function(e,t){var n=this;return oe(e,t,function(){var t,r,i,o,a,s,u,l,c,f,d;l=e.value_id,o=e.item,s=e.prev;t=Ve.get(l);o=te.rehydrate_tree(n,o);a=n.iterate(s);while(u=a()){d=n.array_to_objects(s,u);for(i=c=0,f=d.length;c<f;i=++c){r=d[i];if(i%10===0){We.optional_pause()}if(t.equals(r,o)){return[true]}}}return[false]})},get_ret_value:function(){return"sys.bool"},adds_context:{sorted_above:true},simplify:function(e){var t,n;if(te.PLANS[e.prev.t].preserves_items){return{t:"Contains",value_id:e.value_id,item:e.item,prev:e.prev.prev}}else if((n=e.prev.t)==="Concat"||n==="Intersect"){return{t:"Reduce",op:"or",prev:{t:"Concat",prevs:function(){var n,r,i,o;i=e.prev.prevs;o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push(We.extend({},e,{prev:t}))}return o}()}}}else{return null}}},Position:{is_single:true,fn:function(e,t,n){var r=this;return oe(e,t,function(){var t,n,i,o,a,s,u,l,c,f,d,_;c=e.value_id,o=e.item,u=e.prev;t=Ve.get(c);o=te.rehydrate_tree(r,o);s=-1;a=r.iterate(u);while(l=a()){_=r.array_to_objects(u,l);for(i=f=0,d=_.length;f<d;i=++f){n=_[i];if(i%10===0){We.optional_pause()}s++;if(t.equals(n,o)){return[s]}}}return[-1]})},get_ret_value:function(){return"number"}},Compare:{is_single:true,fn:function(e,t){var n=this;return oe(e,t,function(){var t,r,i,o,a;r=e.op,t=e.n,i=e.prev;o=(a=n.execute_get_children(i,0,1))!=null?a[0]:void 0;switch(r){case">":return[o>t];case"<":return[o<t];case">=":return[o>=t];case"<=":return[o<=t];default:throw We.error("unrecognized op",{plan:e})}})},get_ret_value:function(){return"sys.bool"}},NodeList:{fn:function(e,t){var n,r,i,o,a,s,u,l,c=this;i=e.id,r=e.field,u=e.type;if(!i){throw We.error("NodeList missing id",{plan:e})}o=this.get(i);a=(l=o.child(r)._extract(o.raw()))!=null?l:[];if(!Array.isArray(a)){throw We.error("NodeList called on bad field",{plan:e})}n=function(e,t,n){if(n%10===0){We.optional_pause()}if(typeof e!=="string"){return e}if(e.indexOf(ee.HYDRATE_STRING)===-1||e.indexOf("StaticNode")!==-1||e.indexOf("StaticObject")!==-1){return e}i=e.replace(ee.HYDRATE_STRING,"");if(t){return c.get(i).precache()}else{if(c.get(i).exists()){return i}else{return null}}};s=[];return function(e){var r,i,o,u,l,f,d,_,p;if(e==null){e=c.GET_BATCH_SIZE}u=t+e;while(s.length<u&&a.length>0){o=(u-s.length)*1.2;l=a.slice(0,o);a=a.slice(o);for(r=f=0,_=l.length;f<_;r=++f){i=l[r];n(i,true,r)}l=function(){var e,t,o;o=[];for(r=e=0,t=l.length;e<t;r=++e){i=l[r];o.push(n(i,false,r))}return o}();l=function(){var e,t,n;n=[];for(e=0,t=l.length;e<t;e++){i=l[e];if(i!=null){n.push(i)}}return n}();for(r=d=0,p=l.length;d<p;r=++d){i=l[r];if(r%10===0){We.optional_pause()}s.push(i)}}s=s.slice(t,u);t=u;return s}},get_ret_value:function(e){var t,n,r,i;if(e.type){return e.type}if(e.id==null){throw We.error("NodeList missing id",{plan:e})}t=this.get(e.id);n=t._type();if(!n){return"null"}r=(i=Ve.get(n).get_message(e.field).ret_value())!=null?i.id():void 0;if(r==null||r==="null"){return"null"}if(r==="date_range"){return"date"}if(r==="number_range"){return"number"}if(r.slice(0,5)!=="list."){throw We.error("NodeList has non-list value for field: "+r)}return r.slice(5)}},Length:{is_single:true,fn:function(e,t){var n=this;return oe(e,t,function(){var t,i,o,a,s;a=e.prev,t=e.bound;if(!t){t=r}i=0;o=n.iterate(a);while(i<t&&(s=o())){i+=s.length}return[i]})},get_ret_value:function(e){return"number"},simplify:function(e){var t;if(te.PLANS[e.prev.t].preserves_length){return{t:"Length",bound:e.bound,prev:e.prev.prev}}else if(e.prev.t==="Concat"){return{t:"Reduce",op:"+",prev:{t:"Concat",prevs:function(){var n,r,i,o;i=e.prev.prevs;o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push({t:"Length",prev:t})}return o}()}}}else{return null}},adds_context:{sorted_above:true}},Cap:{fn:function(e,t){var n,r,i,o=this;i=e.prev,n=e.max;r=this.iterate(i,t);n-=t;t=0;return function(e){var i,o,a;i=n-t;if(i<1){return[]}if(e!=null){o=Math.min(e,i)}else{o=null}a=r(o);if(!a){return[]}if(a.length>i){a=a.slice(0,i)}t+=a.length;return a}},get_ret_value:function(e){return this.get_plan_ret_value(e.prev)}},Offset:{fn:function(e,t){var n,r,i,o=this;i=e.prev,r=e.offset;r=Math.floor(r);if(r<0){r=0}n=this.iterate(i,t+r);return function(e){var t;return(t=n(e))!=null?t:[]}},get_ret_value:function(e){return this.get_plan_ret_value(e.prev)}},Concat:{fn:function(e,t){var n,r,i,o,a=this;i=e.prevs;r=-1;o=[];n=null;return function(e){var s,u;if(e!=null){u=t+e}else{u=t+1}while(o.length<u){if(n==null){r++;if(r===i.length){break}n=a.iterate(i[r])}s=n();if(s==null){n=null}else{o=o.concat(s)}}if(e!=null){s=o.slice(t,u)}else{s=o.slice(t)}t+=s.length;return s}},validate:function(e){if(!Array.isArray(e.prevs)){throw We.error("Concat must have prevs array",{query:e})}},get_ret_value:function(e){var t,n,r,i,o;o=e.prevs;for(r=0,i=o.length;r<i;r++){t=o[r];n=this.get_plan_ret_value(t);if(n!=null&&n!=="null"){return n}}return"null"},preserves_context:{sorted_above:true},simplify:function(e){var t,n,r,i,o,a,s,u,l,c;n=false;i=[];l=e.prevs;for(o=0,s=l.length;o<s;o++){r=l[o];if(r.t==="Concat"){n=true;c=r.prevs;for(a=0,u=c.length;a<u;a++){t=c[a];i.push(t)}}else{i.push(r)}}if(n===false){return null}return We.extend({},e,{prevs:i})}},Intersect:{fn:function(e,t){var n,r,i,o,a,s,u,l,c,f=this;u=e.prevs;l=[];c=function(){var e,t,n;n=[];for(a=e=0,t=u.length;0<=t?e<t:e>t;a=0<=t?++e:--e){n.push({})}return n}();r={};n=function(e,t,n){var i,o,a,s;if(n%10===0){We.optional_pause()}o=JSON.stringify(e);if(r[o]){return}c[t][o]=true;for(i=a=0,s=u.length;0<=s?a<s:a>s;i=0<=s?++a:--a){if(!c[i][o]){return}}r[o]=true;return l.push(e)};o=function(){var e,t,n;n=[];for(e=0,t=u.length;e<t;e++){s=u[e];n.push(this.iterate(s))}return n}.call(this);a=0;i=0;return function(e){var r,s,c,f,d,_,p;if(e!=null){d=t+e}else{d=t+1}while(l.length<d&&i<u.length){if(o[a]){r=o[a]();if(!r){o[a]=null;i++}else{for(c=_=0,p=r.length;_<p;c=++_){s=r[c];n(s,a,c)}}}a++;if(a===u.length){a=0}}if(e!=null){f=l.slice(t,d)}else{f=l.slice(t)}t+=f.length;return f}},get_ret_value:function(e){var t,n,r,i,o;o=e.prevs;for(r=0,i=o.length;r<i;r++){t=o[r];n=this.get_plan_ret_value(t);if(n!=null&&n!=="null"){return n}}return"null"},validate:function(e){if(!Array.isArray(e.prevs)){throw We.error("Intersect must have prevs array",{query:e})}},preserves_context:{sorted_above:true},simplify:function(e){var t,n,r,i,o,a,s,u,l,c;n=false;i=[];l=e.prevs;for(o=0,s=l.length;o<s;o++){r=l[o];if(r.t==="Intersect"){n=true;c=r.prevs;for(a=0,u=c.length;a<u;a++){t=c[a];i.push(t)}}else{i.push(r)}}if(n===false){return null}return We.extend({},e,{prevs:i})}},Unique:{simplify:function(e){var t,n,r,i,o=this;if(e.prev.t!=="Concat"){return null}t=false;i=function(e){if(e.t==="Unique"){t=true;return e.prev}else{return e}};n=function(){var t,n,o,a;o=e.prev.prevs;a=[];for(t=0,n=o.length;t<n;t++){r=o[t];a.push(i(r))}return a}();if(!t){return null}return{t:"Unique",prev:this.simplify_query(We.extend({},e.prev,{prevs:n}))}},fn:function(e,t){var n,r,i,o,a=this;r=e.prev;i=[];o={};n=this.iterate(r);return function(e){var r,a,s,u,l,c,f;if(e!=null){u=t+e}else{u=t+1}while(i.length<u&&(l=n())){for(r=c=0,f=l.length;c<f;r=++c){a=l[r];if(r%10===0){We.optional_pause()}if(!o[JSON.stringify(a)]){o[JSON.stringify(a)]=true;i.push(a)}}}if(e!=null){s=i.slice(t,u)}else{s=i.slice(t)}t+=s.length;return s}},get_ret_value:function(e){return this.get_plan_ret_value(e.prev)},preserves_items:true,sort_neutral:true,preserves_context:{sorted_above:true}},Reduce:{is_single:true,fn:function(e,t){var n=this;return oe(e,t,function(){var t,r,i,o,a,s,u,l,c,f,d,_;s=e.op,u=e.prev;switch(s){case"+":t=0;r=function(e,t){return[e+t]};break;case"or":t=false;r=function(e,t){return[e||t,e||t]};break;default:throw We.error("unrecognized op "+s)}a=n.iterate(u);while(l=a()){for(i=f=0,d=l.length;f<d;i=++f){o=l[i];if(i%10===0){We.optional_pause()}_=r(t,o),t=_[0],c=_[1];if(c){return[t]}}}return[t]})},get_ret_value:function(e){switch(e.op){case"+":return"number";case"or":return"boolean";default:throw We.error("unrecognized op "+e.op)}},adds_context:{sorted_above:true}},Filter:{fn:function(e,t){var n,r,i,o,a,s=this;i=e.prev,n=e.constraints;o=[];r=this.iterate(i);a=this.get_plan_ret_value(e.prev);return function(e){var u,l,c,f,d,_,p,h;if(e!=null){f=t+e}else{f=t+1}while(o.length<f&&(d=r())){_=s.array_to_objects(i,d);for(u=p=0,h=_.length;p<h;u=++p){l=_[u];if(u%10===0){We.optional_pause()}if(Ae(l,n,a)){o.push(d[u])}}}if(e!=null){c=o.slice(t,f)}else{c=o.slice(t)}t+=c.length;return c}},validate:function(e){if(!Array.isArray(e.constraints)){throw We.error("Filter must have constraints array",{query:e})}},canonicalize:function(e){return Pe(e.constraints)},get_ret_value:function(e){return this.get_plan_ret_value(e.prev)},simplify:function(e){var t,n;if(e.prev.t==="Filter"){return{t:"Filter",constraints:e.constraints.concat(e.prev.constraints),prev:e.prev.prev}}else if((n=e.prev.t)==="Concat"||n==="Intersect"){return{t:e.prev.t,prevs:function(){var n,r,i,o;i=e.prev.prevs;o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push(this.simplify_query(We.extend({},e,{prev:t})))}return o}.call(this)}}else{return null}},sort_neutral:true,preserves_context:{sorted_above:true}},Sort:{fn:function(e,t){var n,i,o,a=this;n=e.prev,o=e.sorts_list;i=this.all(n);i=this.array_to_objects(n,i);te.sort_in_memory(i,o,this.get_plan_ret_value(e.prev));i=this.array_to_ids(n,i);return function(e){var n,o;if(e==null){e=r}o=t+e;n=i.slice(t,o);t=o;return n}},get_ret_value:function(e){return this.get_plan_ret_value(e.prev)},preserves_items:true,preserves_length:true,canonicalize:function(e){return e.sorts_list=X.resolve_sorts(e.sorts_list,true)},adds_context:{sorted_above:true},simplify:function(e,t){if(t.sorted_above){return e.prev}else{return null}}},CallSearch:{watch_search_call:function(e){return{constraints:e.constraints,type:e.type}},load:function(e,t,n,r){var i,o,a,s,u,l,c,f,d,_,p,h,g=this;a=e.constraints,d=e.sorts_list,_=e.type;this.query_planner().update(_,a,d,{loading_to:t+n});l=((p=this.query_planner().get_stats(_,a,d))!=null?p:{}).local_change_buffer;n+=l!=null?l:0;i=t;o=Math.min(n,y);f=[];c={};u=true;s=function(){u=false;return g.elasticsearch("search",{appname:g.appname,app_version:g.app_version,temp_db:g.cur_temp_db(),index:g.get_elastic_search_index(),type:_,constraints:a,sorts_list:d,from:i,n:o,search_path:g.build_search_path(e,t+n)},function(l,p){var h,m,v,y,b,w,x,k,S,A;if(l){r(l);return}m=(S=(A=p.hits)!=null?A.hits:void 0)!=null?S:[];b=[];for(w=x=0,k=m.length;x<k;w=++x){v=m[w];if(w%10===0){We.optional_pause()}y=v._id;b.push(y);g._set_data(y,v._source,v._type,v._version);if(c[y]){We.array_remove(f,y)}c[y]=v._source}f=f.concat(b);h=p.at_end;if(h){g.query_planner().update(_,a,null,{length:t+f.length})}g.query_planner().update(_,a,d,{loaded:t+f.length});if(h||f.length===n){return r(null,{at_end:h,results:f,raw_data:c})}else if(f.length>n){return r(We.error("should never go above n",{results_length:f.length,n:n,plan:e,batch_n:o,from:t,plan:e}))}else{i=i+o;o=Math.min(o,n-f.length);if(We.on_server()){return u=true}else{return s()}}})};h=[];while(u){h.push(s())}return h},get_ret_value:function(e){return e.type},initialize_range:function(e,t,n){var r,i,o,a,s,u,l,c,f,d;t.at_end=n.at_end;t.results=n.results;t.before=[];t.after=[];u=e.type,i=e.constraints,s=e.sorts_list;r=G(u,i,s);t.sort_scores={};f=t.results;d=[];for(o=l=0,c=f.length;l<c;o=++l){a=f[o];if(o%10===0){We.optional_pause()}if(r){d.push(t.sort_scores[a]=U(n.raw_data[a],e.sorts_list))}else{d.push(t.sort_scores[a]=[t.from+o])}}return d},local_change:function(e,t,n,r,i,o,a){var u,l,c,f,d,_,p,h,g;if(e.type!==r){return false}if(o==null){l=false}else{l=true;d=new te.StaticObject(o);g=e.constraints;for(p=0,h=g.length;p<h;p++){u=g[p];if(!te.local_constrain(d,u,r)){l=false;break}}}if(!l){if(!t.sort_scores[n]){return false}delete t.sort_scores[n];We.array_remove(t.before,n);We.array_remove(t.after,n);if(t.results.indexOf(n)===-1){return false}We.array_remove(t.results,n);te.PLANS.CallSearch._adjust_range_length.call(this,e,t);return true}if(!G(r,e.constraints,e.sorts_list)){return s}f=U(o,e.sorts_list);_=t.sort_scores[n]!=null;if(_&&JSON.stringify(t.sort_scores[n])===JSON.stringify(f)){return false}t.sort_scores[n]=f;if(_){We.array_remove(t.before,n);We.array_remove(t.after,n);We.array_remove(t.results,n)}c=function(r){var i,o,a,s;a=0;i=r.length;while(a!==i){o=Math.floor(a+(i-a)/2);if(ge(e.sorts_list,n,f,r[o],t.sort_scores[r[o]])){i=o}else{a=o+1;if(a>i){a=i}}}return[].splice.apply(r,[a,a-a].concat(s=[n])),s};if(t.results.length===0){if(t.from===0&&t.at_end){t.results.push(n)}else{if(t.from!==0){c(t.before)}if(!t.at_end){c(t.after)}}}else if(ge(e.sorts_list,n,f,t.results[0],t.sort_scores[t.results[0]])){if(t.from===0){t.results.unshift(n)}else{c(t.before)}}else if(ge(e.sorts_list,t.results[t.results.length-1],t.sort_scores[t.results[t.results.length-1]],n,f)){if(t.at_end){t.results.push(n)}else{c(t.after)}}else{c(t.results)}te.PLANS.CallSearch._adjust_range_length.call(this,e,t);return true},_adjust_range_length:function(e,t){var n,r,i,o,a,s;if(t.results.length>t.to-t.from){delete t.at_end;return}else if(t.results.length===t.to-t.from||t.at_end){return}i=t.to-(t.from+t.results.length);a=e.type,n=e.constraints,o=e.sorts_list;r=((s=this.query_planner().get_stats(a,n,o))!=null?s:{}).local_change_buffer;i+=r!=null?r:0;this.query_planner().update(a,n,o,{local_change_buffer:i});t.to=t.from+t.results.length;if(t.results.length===0){return this.delete_range(e,t)}},merge_ranges:function(e,t,n){var r,i,o,a,s,u,l,c,f,d,_,p;u=t.results[0];l=t.sort_scores[u];o=n.results[n.results.length-1];a=n.sort_scores[o];c=[];r={};p=n.sort_scores;for(i in p){d=p[i];if((_=t.sort_scores)[i]==null){_[i]=d}}f=t.sort_scores;s=function(t){var n,i,s;n=0;i=0;while(n<t.length&&ge(e.sorts_list,t[n],f[t[n]],u,l)){n++}s=[];while(n<t.length&&(o==null||t[n]===o||ge(e.sorts_list,t[n],f[t[n]],o,a))){if(!r[t[n]]){r[t[n]]=true;while(i<c.length&&ge(e.sorts_list,c[i],f[c[i]],t[n],f[t[n]])){i++}if(i===c.length){c.push(t[n])}else{c.splice(i,0,t[n])}i++}s.push(n++)}return s};s(t.results);s(t.after);s(n.before);s(n.results);t.results=c;t.after=n.after;t.at_end=n.at_end;t.to=n.to;return te.PLANS.CallSearch._adjust_range_length.call(this,e,t)}},CallAggregate:{watch_search_call:function(e){return{constraints:e.constraints,type:e.type}},load:function(e,t,n,r){var i,o,a,s,u,l,c,f=this;if(t!==0||n!==1){throw We.error("CallAggregate weird params",{plan:e,from:t,n:n})}o=e.constraints,c=e.type,i=e.agg_fn,a=e.field;if(a==null){a=void 0}l=JSON.stringify({agg_fn:i,field:a});u={};u[R(i,a)]=true;this.query_planner().update(c,o,null,u);s=[{n:i,field:a}];return this.elasticsearch("aggregate",{appname:this.appname,app_version:this.app_version,temp_db:this.cur_temp_db(),type:c,constraints:o,aggregate:{fns:s},search_path:this.build_search_path(e,i)},function(t,n){var a;if(t){r(t);return}if(n.search_id){f.set_perc_id(te.PLANS.CallAggregate.watch_search_call(e),n.search_id)}a=n.fns[0];if(i==="count"){f.query_planner().update(c,o,null,{length:a})}return r(null,a)})},initialize_range:function(e,t,n){t.at_end=true;return t.results=[n]},local_change:function(e,n,r,i,o,a,u){var l,c,f,d,_,p;if(e.type!==i){return false}c=function(t){var n,r,o,a,s;if(t==null){return false}r=new te.StaticObject(t);s=e.constraints;for(o=0,a=s.length;o<a;o++){n=s[o];if(!te.local_constrain(r,n,i)){return false}}return true};p=c(o);f=c(a);l=p!==f;if(!l&&p&&e.field){l=o[e.field]!==a[e.field]}if(!l){return false}if(!t[e.agg_fn]){return s}if(e.field){_=p?o!=null?o[e.field]:void 0:null;d=f?a!=null?a[e.field]:void 0:null}n.results[0]=t[e.agg_fn](p,f,_,d,n.results[0]);return true},merge_ranges:function(e,t,n){throw We.error("Merge CallAggregate",{plan:e,merge_into:t,merge_from:n})}}};t={count:function(e,t,n,r,i){return i+(e?-1:1)},sum:function(e,t,n,r,i){if(n==null){n=0}if(r==null){r=0}return i+r-n},product:function(e,t,n,r,i){if(n==null){n=1}if(r==null){r=1}return i*r/n}};_=100;v=3;te.global_data_items_loaded=0;R=function(e,t){return"CallAggregate_started_"+e+(t?"_"+t:"")};S=function(){function e(){this.root={}}e.prototype.update=function(e,t,n,r){var i,o,a,s,u,l,c,f,d,_;Pe(t);a=(s=this.root)[e]!=null?(s=this.root)[e]:s[e]={type:e,constraints:[]};for(o=c=0,f=t.length;c<f;o=++c){i=t[o];if(a.children==null){a.children={}}a=(u=a.children)[d=JSON.stringify(i)]!=null?(u=a.children)[d=JSON.stringify(i)]:u[d]={type:e,constraints:t.slice(0,+o+1||9e9)}}if(n!=null){if(a.searches==null){a.searches={}}a=(l=a.searches)[_=JSON.stringify(n)]!=null?(l=a.searches)[_=JSON.stringify(n)]:l[_]={type:e,constraints:t,sorts_list:n}}return We.extend(a,r)};e.prototype.get_stats=function(e,t,n){var r,i,o,a,s,u,l,c;Pe(t);o=this.root[e];if(o==null){return null}for(i=a=0,s=t.length;a<s;i=++a){r=t[i];if(!((u=o.children)!=null?u[JSON.stringify(r)]:void 0)){return null}o=o.children[JSON.stringify(r)]}if(n!=null){if(!((l=o.searches)!=null?l[JSON.stringify(n)]:void 0)){return null}return(c=o.searches)!=null?c[JSON.stringify(n)]:void 0}else{return o}};e.prototype.node_to_search=function(e,t){var n;return{t:"CallSearch",type:e.type,constraints:e.constraints,sorts_list:(n=e.sorts_list)!=null?n:t}};e.prototype.pick_search=function(e,t,n){var r,i,o,a,s,u,l,c=this;Pe(t);l=!G(e,t,n);u=JSON.stringify(n);r=function(e,n,i){var o,a,s,c,f,d,p,h,g,m,b,w,x,k,S,A,E,M,T;d=function(){return i.concat(t.slice(n))};if(t[n]&&!W(t[n])){a=false}else{a=true}if(e.length!=null&&e.length<_&&a){if(!e.searches){return[e,d(),true]}if(e.searches[u]){return[e.searches[u],d(),true]}if(!l){S=e.searches;for(c in S){w=S[c];return[w,d(),true]}}}if(e.children&&t.length>n){o=null;for(s=k=n,A=t.length;n<=A?k<A:k>A;s=n<=A?++k:--k){if(e.children[JSON.stringify(t[s])]){h=e.children[JSON.stringify(t[s])];p=s+1;g=i.concat(t.slice(n,s));m=r(h,p,g);if(m!=null){if(m[2]){return m}if(o==null||m[1].length<o[1].length){o=m}}}else if(!W(t[s])){break}}if(o!=null){return o}}if(e.searches&&a){E=e.searches;for(b in E){w=E[b];if(l&&b!==u){continue}f=w.loading_to;if(e.length!=null&&e.length<w.loading_to){f=e.length}x=f-((M=w.loaded)!=null?M:0);if(x/y>v){continue}if(e.length==null){if(w.loaded<_){return[w,d(),false]}else{continue}}if(w.loading_to>e.length*.5&&e.length-((T=w.loaded)!=null?T:0)<v*y){return[w,d(),false]}if(e.length-w.loaded<y){return[w,d(),false]}}}return null};a=this.root[e]?r(this.root[e],0,[]):null;if(a!=null){o=a[0],i=a[1];s=this.node_to_search(o,n)}else{i=[];s={t:"CallSearch",type:e,constraints:t,sorts_list:n}}return{search:s,leftover:i}};return e}();Le=function(e,t,n){if(t%10===0){We.optional_pause()}if(typeof e._id!=="function"){throw We.error("_id isnt function",{value_id:n,object_type:typeof e,obj_data:We.json_stringify(e,null,true)})}return e._id()};Ye=function(e,t){if(t%10===0){We.optional_pause()}return te.dehydrate_tree(e)};N=function(e,t){var n,r;if(Ve.get(e).custom_type()!=null){return function(){var i,o,a;a=[];for(n=i=0,o=t.length;i<o;n=++i){r=t[n];if(r!=null){a.push(Le(r,n,e))}}return a}()}else{return function(){var e,i,o;o=[];for(n=e=0,i=t.length;e<i;n=++e){r=t[n];o.push(Ye(r,n))}return o}()}};te.LOADING="loading";te.AVAILABLE="available";te.ERROR="error";te.NOT_STARTED="not_started";te.DELETED="deleted";te.PAST_END="past_end";c={t:"Static",value_id:"sys.bool",data:[false]};D={t:"Static",value_id:"sys.bool",data:[true]};te.ADMIN_USER_ID="admin_user";te.NON_AUTHENTICATED_USER_ID="non_authenticated_user";te.get_admin_user_id=function(){return h().db_instance().get_admin_user_id()};Ue=function(e,t){if(e==="user"&&t.key==="email"&&t.constraint_type==="equals"){return We.extend({},t,{constraint_type:"email_equals"})}if(e==="user"&&t.key==="logged_in"){return We.extend({},t,{constraint_type:"user_signed_up"})}return t};te.DB=o=function(){function e(){}e.prototype.query_planner=function(){if(this._query_planner==null){this._query_planner=new S}return this._query_planner};e.prototype.iterate=function(e,t){var n,r,i=this;if(t==null){t=0}if(typeof((r=te.PLANS[e.t])!=null?r.load:void 0)==="function"){return function(n){var r,o,a;if(n!=null){a=t+n}else{r=i.get_ranges(e,t,t+k);if(r===te.PAST_END){return null}a=r[0].to;if(t>=a){a=t+1}}o=i.execute_call_get_children(e,t,a-t);if(o.length===0){return null}t=a;return o}}else{n=te.PLANS[e.t].fn.call(this,e,t);return function(e){var t;t=n(e);if(t.length===0){return null}else{return t}}}};e.prototype.all=function(e){var t;t=this.iterate(e)(r);return t!=null?t:[]};e.prototype.build_search_path=function(e,t){var n,r,i,o;if(this._search_path_cache==null){this._search_path_cache={}}n=JSON.stringify({plan:e,to:t});if((r=this._search_path_cache)[n]==null){r[n]=(i=ve.current_eval_node)!=null?i.serialize():void 0}return JSON.stringify((o=this._search_path_cache[n])!=null?o:null)};e.prototype.get_plan_for_node=function(e,t){var n,r,i,o,a,s,u,l,f,d,_,p,h,g,m,v,b,w,x,k,S,A,E,M,T,C,j,O,I,P,z,B,N,L,q,U,G,V,Y=this;if(t==null){t={}}switch(e.t){case"All":return{t:"CallSearch",type:e.type,constraints:[],sorts_list:(O=t.sorts_list)!=null?O:[]};case"Filter":v=this.get_plan_for_node(e.prev);if(v.t!=="CallSearch"){return We.extend({},e,{prev:v})}if(((z=v.constraints)!=null?z.length:void 0)>0){throw We.error("should not have constraints",{query:e,prev:v})}i=[];a=[];B=e.constraints;for(M=0,C=B.length;M<C;M++){s=B[M];u=Ue(v.type,s);if(F(v.type,u)){i.push(u)}else{a.push(s)}}L=this.query_planner().pick_search(v.type,i,(N=t.sorts_list)!=null?N:[]),k=L.search,p=L.leftover;a.push.apply(a,p);if(a.length===0){return k}return{t:"Filter",constraints:a,prev:k};case"Sort":v=this.get_plan_for_node(e.prev,{sorts_list:e.sorts_list});if(v.t==="CallSearch"){r=v}else if(v.t==="Filter"&&v.prev.t==="CallSearch"){r=v.prev}if(!r){return We.extend({},e,{prev:v})}if(JSON.stringify(r.sorts_list)===JSON.stringify(e.sorts_list)){return v}else{return We.extend({},e,{prev:v})}break;case"Contains":v=this.get_plan_for_node(e.prev);if((q=v.t)!=="CallSearch"&&q!=="Filter"){return We.extend({},e,{prev:v})}if(Ve.get(this.get_plan_ret_value(v)).custom_type()==null){return We.extend({},e,{prev:v})}_=te.rehydrate_tree(this,e.item);if(v.t==="CallSearch"&&v.type!==(_!=null?_._type():void 0)){return c}if(!(_!=null?_.exists():void 0)){return c}d=[];G=(U=v.constraints)!=null?U:[];for(T=0,j=G.length;T<j;T++){s=G[T];if(W(s)){if(!te.local_constrain(_,s,v.type)){return c}}else{d.push(s)}}if(d.length===0){if(v.t==="CallSearch"){return D}else{return We.extend({},e,{prev:v})}}if(v.t==="Filter"){throw We.error("planned filter with a not can_execute_in_memory constraint",{in_db:d,query:e})}d.push({key:X.UNIQUE_ID,constraint_type:"equals",value:_._id()});g={t:"Compare",op:">",n:0,prev:{t:"Length",prev:{t:"Filter",constraints:d,prev:{t:"All",type:v.type}}}};return this.get_plan_for_node(g);case"Compare":v=this.get_plan_for_node(e.prev);if(v.t==="Length"){v={t:"Length",bound:e.n+1,prev:v.prev}}return{t:"Compare",prev:v,op:e.op,n:e.n};case"Length":case"Numeric":if(e.t==="Length"){v=this.get_plan_for_node(e.prev);o=v.t==="CallSearch";l=v;E=function(e){return{t:"Length",prev:Y.query_planner().node_to_search(e)}};n="count";f=void 0}else{A=e.prev;o=A.t==="Transform";if(o){h=Ve.get(A.value_id).get_message(A.message);o=h.ret_value_id()!=="null"&&h.is_lookup()}if(o){v=this.get_plan_for_node(A.prev);o=v.t==="CallSearch"}E=function(t){var n;n=We.extend({},A,{prev:Y.query_planner().node_to_search(t)});return We.extend({},e,{prev:n})};n=e.op;f=A.message}if(o){S=this.query_planner().get_stats(v.type,v.constraints);if(S!=null?S.searches:void 0){if(S.length!=null){V=S.searches;for(w in V){x=V[w];if(x.loaded>=S.length){return E(x)}}}if(!S[R(n)]){I=S.searches;for(w in I){x=I[w];b=x.loading_to-((P=x.loaded)!=null?P:0);if(0<b&&b<y){return E(x)}}}}return{t:"CallAggregate",type:v.type,constraints:v.constraints,agg_fn:n,field:f}}if(l==null){l=this.get_plan_for_node(e.prev)}return We.extend({},e,{prev:l});default:m={};if(e.prev){m.prev=this.get_plan_for_node(e.prev)}if(e.prevs){m.prevs=function(){var t,n,r,i;r=e.prevs;i=[];for(t=0,n=r.length;t<n;t++){v=r[t];i.push(this.get_plan_for_node(v))}return i}.call(this)}return We.extend({},e,m)}};e.prototype.validate_query=function(e){var t,n,r,i,o,a;if(!te.PLANS[e.t]){throw We.error("Unrecognized query",{query:e})}if(typeof(n=te.PLANS[e.t]).validate==="function"){n.validate(e)}if(e.prev!=null){this.validate_query(e.prev)}if(e.prevs!=null){if(!Array.isArray(e.prevs)){throw We.error("Prevs must be array",{query:e})}o=e.prevs;a=[];for(r=0,i=o.length;r<i;r++){t=o[r];a.push(this.validate_query(t))}return a}};e.prototype.build_query_plan=function(e){var t;e=We.json_deep_copy(e);this.validate_query(e);e=this.simplify_query(e);this.canonicalize_query(e);t=this.get_plan_for_node(e);return t};e.prototype.execute_query=function(e,t,n){var r;r=this.build_query_plan(e);return this.execute_get_children(r,t,n)};e.prototype.init_result_cache=function(e){var t;t=JSON.stringify(e);if(!this.result_cache[t]){this.result_cache[t]={plan:e,ranges:[]}}return this.result_cache[t]};e.prototype.get_ranges=function(e,t,n){var r,i,o,a,s,u,l,c,f,d,_,p;if(n<=t){throw We.error("assertion error: to must be strictly greater than from",{plan:e,from:t,to:n})}if(t<0){throw We.error("assertion error: from must be at least 0",{plan:e,from:t,to:n})}u=this.init_result_cache(e);s=u.ranges;l=[];i=t;r=false;for(f=0,_=s.length;f<_;f++){o=s[f];if(i>=n){break}if(o.to<=i){if(o.state===te.AVAILABLE&&o.at_end){return te.PAST_END}continue}if(i<o.from){a=Math.min(o.from,n);l.push({state:te.NOT_STARTED,from:i,to:a});i=a}if(o.from>=n){break}l.push(o);i=o.to;if(o.state===te.AVAILABLE&&o.at_end){r=true;break}}if(i<n){if(!r){l.push({state:te.NOT_STARTED,from:i,to:n})}}c=false;for(d=0,p=l.length;d<p;d++){o=l[d];if(o.state===te.AVAILABLE){if(c){throw We.error("assertion error: adjacent available ranges")}else{c=true}}else{c=false}}return l};e.prototype.get_plan_ret_value=function(e){var t;t=te.PLANS[e.t].get_ret_value.call(this,e);return t};e.prototype.array_to_objects=function(e,t){
var n,r,i,o,a,s,u=this;o=this.get_plan_ret_value(e);if((!o||o==="null")&&(t!=null?t.length:void 0)>0){We.warn("null value_id in array_to_objects",{plan:e,value_id:o,array_length:t.length})}if(typeof o==="object"){if(o.get_message){We.warn("Got value instead of value id",{plan:e})}else{throw We.error("Got object value_id",{plan:e})}}a=function(e,t){if(t%10===0){We.optional_pause()}return u.get(e)};s=function(e,t){if(t%10===0){We.optional_pause()}return tt(e,u,o)};if(Ve.get(o).custom_type()!=null){return function(){var e,i,o;o=[];for(r=e=0,i=t.length;e<i;r=++e){n=t[r];if(n!=null){o.push(a(n,r))}}return o}()}else{return function(){var e,n,o;o=[];for(r=e=0,n=t.length;e<n;r=++e){i=t[r];o.push(s(i,r))}return o}()}};e.prototype.array_to_ids=function(e,t){var n;n=this.get_plan_ret_value(e);if((!n||n==="null")&&(t!=null?t.length:void 0)>0){We.warn("null value_id in array_to_ids",{plan:e,value_id:n,array_length:t.length})}return N(n,t)};e.prototype.execute_get_children=function(e,t,n){var r,i;if(n<=0){throw We.error("must request at least 1 result",{plan:e,from:t,n:n})}if(t<0){throw We.error("cannot call negative from",{plan:e,from:t,n:n})}r=this.iterate(e,t);return(i=r(n))!=null?i:[]};e.prototype.execute_call_get_children=function(e,t,n){var r,i,o,a,s,u,l,c,f,d,_,p,h;i=null;l=t+n;s=this.get_ranges(e,t,l);if(s===te.PAST_END){this.register_call_dependency(e);return[]}if(s.length===1&&s[0].state===te.AVAILABLE){u=t-s[0].from;r=u+n;this.register_call_dependency(e);return s[0].results.slice(u,r)}o=[];c=[];for(f=0,_=s.length;f<_;f++){a=s[f];switch(a.state){case te.LOADING:o.push(a.loading_key);break;case te.AVAILABLE:true;break;case te.ERROR:throw a.err;break;case te.NOT_STARTED:c.push(a);break;default:throw We.error("Unrecognized range state: "+JSON.stringify(a))}}if(c.length>0){if(((h=We.CurrentNotReadyCatcher)!=null?h.length:void 0)>0){return[]}for(d=0,p=c.length;d<p;d++){a=c[d];o.push(this.load_get_children(e,a.from,a.to-a.from))}}i=We.MakeKeySet(o);if(i.is_turned()){return this.execute_call_get_children(e,t,n)}We.ensure_ready(i);if(We.on_client()){return[]}else{throw"retry"}};e.prototype.add_loading_range=function(e,t,n,r){var i,o,a,s,u,l,c,f;l=t+n;u=this.init_result_cache(e);s=u.ranges;for(i=c=0,f=s.length;c<f;i=++c){a=s[i];if(a.from>=l){break}if(a.from>t){throw We.error("adding overlapping range",{plan:e,from:t,n:n,existing_ranges:s})}}o={state:te.LOADING,from:t,to:l,loading_key:r,result_cache:u};s.splice(i,0,o);return o};e.prototype.invalidate_plan=function(e){var t;t=this.result_cache[e];if(!t){return}t.ranges=[];return this.invalidate_call_dependency(e)};e.prototype.handle_results=function(e,t,n,r){var i,o,a,s,u,l,c,f,d,_,p;i=JSON.stringify(e);if(t.state!==te.LOADING&&n){We.warn("Got an error for a non-loading range, throwing error",{plan:e,state:t.state});throw n}if(t.state!==te.LOADING){throw We.error("assertion error: handle_results called on a non-loading range",{plan:e,range_state:t.state})}t.loading_key.turn();delete t.loading_key;if(n){t.state=te.ERROR;t.err=n;return this.schedule_discard_errors(e)}else{t.state=te.AVAILABLE;te.PLANS[e.t].initialize_range.call(this,e,t,r);_=this.local_changes;for(o in _){l=_[o];s=this._local(o);te.PLANS[e.t].local_change.call(this,e,t,o,s.type,l,s.raw,true)}u=[];a=null;p=[].concat(this.result_cache[i].ranges);for(f=0,d=p.length;f<d;f++){c=p[f];if(c.state===te.AVAILABLE){if(a&&a.to===c.from){te.PLANS[e.t].merge_ranges.call(this,e,a,c)}else{a=c;u.push(c)}}else{a=null;u.push(c)}}u=function(){var e,t,n;n=[];for(e=0,t=u.length;e<t;e++){c=u[e];if(c.state!==te.DELETED){n.push(c)}}return n}();return this.result_cache[i].ranges=u}};e.prototype.delete_range=function(e,t){var n;n=JSON.stringify(e);We.array_remove(this.result_cache[n].ranges,t);return t.state=te.DELETED};e.prototype.load_get_children=function(e,t,n){var r,i,o;if(typeof((o=te.PLANS[e.t])!=null?o.load:void 0)!=="function"){throw We.error("no load function for "+e.t)}r=We.MakeKey(null,JSON.stringify({plan:e,from:t,n:n}));i=this.add_loading_range(e,t,n,r);te.PLANS[e.t].load.call(this,e,t,n,this.handle_results.bind(this,e,i));return r};e.prototype.canonicalize_query=function(e){var t,n,r,i;if(te.PLANS[e.t].canonicalize){te.PLANS[e.t].canonicalize(e)}if(e.prev){this.canonicalize_query(e.prev)}if(e.prevs){i=e.prevs;for(n=0,r=i.length;n<r;n++){t=i[n];this.canonicalize_query(t)}}return null};e.prototype.simplify_query=function(e,t){var n,r,i,o,a,s,u,l,c,f,d,_;if(t==null){t={}}r={};for(n in t){u=t[n];if((l=te.PLANS[e.t].preserves_context)!=null?l[n]:void 0){r[n]=u}}if(te.PLANS[e.t].adds_context){c=te.PLANS[e.t].adds_context;for(n in c){u=c[n];r[n]=u}}if(e.prev){e=We.extend({},e,{prev:this.simplify_query(e.prev,r)})}if(e.prevs){e=We.extend({},e,{prevs:function(){var t,n,i,a;i=e.prevs;a=[];for(t=0,n=i.length;t<n;t++){o=i[t];a.push(this.simplify_query(o,r))}return a}.call(this)})}while(true){if(!te.PLANS[e.t]){throw We.error("Unrecognized query type",{query:e})}a=(f=te.PLANS[e.t].simplify)!=null?f.call(this,e,t):void 0;if(a){e=a;continue}if(((d=e.prev)!=null?d.t:void 0)==="Sort"&&te.PLANS[e.t].sort_neutral){s=e.prev.prev;i=We.extend({},e,{prev:s});a=(_=te.PLANS[i.t].simplify)!=null?_.call(this,i,t):void 0;if(a){i=a}e=We.extend({},e.prev,{prev:i});continue}return e}};e.prototype.get_node=function(e){var t,n,r,i;i=e.split("."),t=i[0],r=2<=i.length?ot.call(i,1):[];n=this.get_object(t);return new this.DBNODE(n,r,this)};e.prototype.get_object=function(e){return new this.DBOBJECT(e,this)};e.prototype._init=function(){this._transient=new te.TransientCache(5*60*1e3);return this.result_cache={}};e.prototype._local=function(e){var t=this;return this._transient.get(e,function(){return new m(t,e)})};e.prototype.is_watching=function(e){return this._transient.exists(e)&&this._local(e).is_watching()};e.prototype.flush=function(e){this._local(e).dependency.invalidate();this._transient.flush(e);return this._reload(e)};e.prototype.flush_all=function(){return this._transient.flush_all()};e.prototype._get_data=function(e){var t;t=this._local(e);if(t.error){throw t.error}else if(t.raw){return We.extend({},t.raw)}else{return null}};e.prototype._get_ready_key=function(e){return this._local(e).ready_key};e.prototype._ensure_loading=function(e){if(this._local(e).raw===void 0){return this._reload(e)}};e.prototype._wait_for_process_updates=function(e,t,n){if(t==="local"||!this._get_ready_key(e).is_turned()){return n()}else if(We.on_server()){return n()}else{return h().workflow.wait_for_server(n)}};e.prototype._reload=function(e,t){var n,r,i,o=this;r=this._local(e);if(r._is_loading){return}r._is_loading=true;n=(i=this._local(e).latest_version)!=null?i:0;return this.elasticsearch("get",{id:e,appname:this.appname,app_version:this.app_version,temp_db:this.cur_temp_db(),update_firebase:t},function(t,i){r._is_loading=false;o._handle_get_response(e,t,i);if((i!=null?i._version:void 0)!=null){if(i._version<n){We.warn("Got an out of date version in _reload",{id:e,latest_version:n,version:i._version});return o._reload(e,true)}}})};e.prototype._handle_get_response=function(e,t,n){var r,i,o,a,s;if(t!=null){this._set_error(e,t);return}s=n._version,r=n.found,o=n._source,a=n._type;if(!r){return this._set_data(e,null,null,(i=this._local(e).latest_version)!=null?i:0)}else{return this._set_data(e,o,a,s)}};e.prototype.on_value=function(e,t){return this._local(e).on_value(t)};e.prototype.off_value=function(e,t){return this._local(e).off_value(t)};e.prototype._register_dependency=function(e){return this._local(e).dependency.register()};e.prototype._set_local=function(e,t,n){var r=this;this._ensure_loading(e);return We.WaitFor(this._get_ready_key(e),function(){var i,o,a,s,u,l,c,f;if(t){o=We.json_deep_copy((c=r._local(e).raw)!=null?c:{});s=o;for(i=u=0,l=t.length;u<l;i=++u){a=t[i];if(i===t.length-1){if(s!=null){s[a]=n}}else{if(s[a]==null){s[a]={}}s=s[a]}}}else{o=We.json_deep_copy((f=r._local(e).raw)!=null?f:{});We.extend(o,n)}return r._set_data(e,o,null,"local")})};e.prototype._delete_local=function(e){return this._set_data(e,null,null,"local")};e.prototype._create_local=function(e,t){return this._set_data(e,{},t,"local")};e.prototype._get_type=function(e){return this._local(e).type};e.prototype.ensure_object_updates=function(e){var t,n,r,i;i=[];for(t in e){r=e[t];n=this._local(t);if(this.id&&n.ready_key.is_turned()&&r>n.version){n.ready_key=We.MakeKey(30,"data ensure_object_updates loaded for "+this.id)}i.push(n.set_latest_version(r))}return i};e.prototype._set_error=function(e,t){var n;n=this._local(e);n.error=t;return n.ready_key.turn()};e.prototype._set_data=function(e,t,n,r){var i,o=this;i=We.Promise(null,"db._set_data "+e);if(r!=="local"){te.global_data_items_loaded++}this._wait_for_process_updates(e,r,function(){return we("db_set_data",function(){var a,s,u,l,c,f,d,_,p,h;s=o._local(e);if(!(r==="local"||r>((f=s.version)!=null?f:-1))){return i.resolve()}else{if(s.latest_version>r){o._reload(e);if((d=s._outstanding_set_data_promise)!=null){d.resolve(i)}s._outstanding_set_data_promise=i;return}if(r==="local"&&n!=null){s.just_created=true}if(s.just_created&&r!=="local"){if(t===null){i.resolve();return}else{s.just_created=false}}if(o.local_changes==null){o.local_changes={}}if(r==="local"){o.local_changes[e]=s.raw}else{s.version=r;delete o.local_changes[e]}u=s.raw;s.raw=t;if(n!=null){s.type=n}p=(_=s.handlers)!=null?_:[];for(l=0,c=p.length;l<c;l++){a=p[l];a(t)}if(s.type||s.raw===null){s.error=null;s.ready_key.turn()}s.dependency.invalidate();s.watch();if((h=s._outstanding_set_data_promise)!=null){h.resolve()}i.resolve();if(u!=null||r==="local"){return o.publish_change(e,n!=null?n:s.type,u,t,r==="local")}}})});return i};e.prototype.publish_change=function(e,t,n,r,i){var o,a,u,l,c,f,d,_,p,h,g;p=this.result_cache;g=[];for(o in p){c=p[o];u=c.plan;a=false;h=[].concat(c.ranges);for(d=0,_=h.length;d<_;d++){l=h[d];if(l.state===te.AVAILABLE){f=te.PLANS[u.t].local_change.call(this,u,l,e,t,n,r,i);if(f===s){this.notify_maybe_invalid(te.PLANS[u.t].watch_search_call.call(this,u))}else if(f){a=true}}}if(a){g.push(this.invalidate_call_dependency(o))}else{g.push(void 0)}}return g};e.prototype.cur_temp_db=function(){var e,t;if(this.temp_db){e=_e(this.temp_db,this.get_appname())}else{t=this.get_app_version()}return e};e.prototype.lookup_user=function(e,t){var n,r;n=[{key:e,constraint_type:"equals",value:t}];r=this.find("user",n);return r.get_children(0,1)[0]};e.prototype.find=function(e,t,n){var r;t=te.dehydrate_tree(t);if(e==="user"){t=t.concat([{key:"user_signed_up",constraint_type:"equals",value:true},{key:"_id",constraint_type:"not equal",value:this.get_admin_user_id()},{key:"_id",constraint_type:"not equal",value:te.ADMIN_USER_ID}])}r={t:"All",type:e};if((t!=null?t.length:void 0)>0){r={t:"Filter",constraints:t,prev:r}}if((n!=null?n.length:void 0)>0){r={t:"Sort",sorts_list:n,prev:r}}return new g(this,r)};e.prototype.static_list=function(e,t){var n;if(!e){throw We.error("Value id is required",{value_id:e})}if(t==null){t=[]}if(!Array.isArray(t)){throw We.error("Bad array",{array_type:typeof t,array_str:String(t),value_id:e})}n={t:"Static",data:N(e,t),value_id:e};return new g(this,n)};e.prototype.retrieve=function(e,t){var n,r,i,o,a;n=[];for(r in t){a=t[r];if(a==null){throw We.error("retrieve: value cannot be null for key "+r)}n.push({key:r,value:a,constraint_type:"equals"})}o=this.find(e,n);i=5;while(o.get_children(0,1)[0]==null){i-=1;if(i===0){throw We.error("Retrieve failed for "+e,t)}We.pause(1e3)}return o.get_children(0,1)[0]};e.prototype.get_elastic_search_index=function(){var e;if(!this.appname){throw We.error("Missing appname: "+this.appname)}if(!this.app_version){throw We.error("Missing app_version: "+this.app_version)}e=this.cur_temp_db();if(e){return e+"_"+this.appname+"_"+this.app_version}else{return this.appname+"_"+this.app_version}};e.prototype.get_admin_user_id=function(){return te.ADMIN_USER_ID+"_"+this.get_elastic_search_index()};e.prototype.id=function(){return this.appname+"_"+this.app_version+(this.temp_db?"_"+this.temp_db:"")};e.prototype.create=function(e,t,n){var r,i,o;if(t==null){t={}}if(n&&We.on_server()){if(this.get(n).exists()){throw We.error("cannot create object, id already exists",{id:n,type:e,initial_data:t})}}if(n==null){n=We.UUID()}i=this.get_object(n);if(e==="user"){o=n}else{o=h().current_user()._id()}r={"Created By":ee.HYDRATE_STRING+o,"Created Date":We.timestamp(),"Modified Date":We.timestamp()};We.extend(r,t);this._create_local(n,e);i.set(r);return i};e.prototype.get=function(e){if(!e||typeof e!=="string"){throw We.error("bad id: must be a string",{id_type:typeof e,id_as_string:String(e)})}if(e.indexOf("sample:")===0){return new De.SampleObject(e.replace("sample:",""))}return this.get_object(e)};return e}();$e=function(e,t){if(e===false&&t==null){return true}return Se(e)===Se(t)};K={equals:true,"not equal":true,is_empty:true,is_not_empty:true,"in":true,"not in":true,contains:true,"not contains":true,empty:true,"not empty":true,"greater than":true,"less than":true,"not true":true};te.all_search_constraints=$={equals:$e,"not equal":function(e,t){return!$e(e,t)},is_empty:function(e,t){return t==null||t===""},is_not_empty:function(e,t){return t!=null&&t!==""},"in":function(e,t){return it.call(e!=null?e:[],t)>=0},"not in":function(e,t){return it.call(e!=null?e:[],t)<0},contains:function(e,t){var n;return((n=t!=null?t.indexOf(e):void 0)!=null?n:-1)!==-1},"not contains":function(e,t){var n;return((n=t!=null?t.indexOf(e):void 0)!=null?n:-1)===-1},empty:function(e,t){return!t||t.length===0},"not empty":function(e,t){return(t!=null?t.length:void 0)>0},"greater than":function(e,t){return Se(t)>Se(e)},"less than":function(e,t){return Se(t)<Se(e)},"not true":function(e,t){return t===false||t===null||t===void 0},"text contains":function(e,t){var n,r,i,o,a,s;n=(a=t!=null?t.toLowerCase().split(" "):void 0)!=null?a:[];r=(s=e!=null?e.toLowerCase().split(" "):void 0)!=null?s:["WILL_NEVER_FIND_THIS"];for(i=0,o=r.length;i<o;i++){e=r[i];if(it.call(n,e)<0){return false}}return true},"not text contains":function(e,t){return!$["text contains"](e,t)},geographic_search:function(e,t){var n,r,i,o,a,s;a=e.range,s=e.unit,i=e.origin_address;o=ue.get_coordinates(i);n=ue.get_coordinates(t);if(!n||!o){return false}r=ue.geographic_distance(n,o,s);if(r<=a){return true}else{return false}},contains_all_fields:function(e,t){var n,r,i,o,a,s,u,l,c,f;n=(c=t!=null?t.toLowerCase().split(" "):void 0)!=null?c:[];r=(f=e!=null?e.toLowerCase().split(" "):void 0)!=null?f:["WILL_NEVER_FIND_THIS"];for(a=0,u=r.length;a<u;a++){e=r[a];i=false;for(s=0,l=n.length;s<l;s++){o=n[s];if(o.indexOf(e)!==-1){i=true;break}}if(!i){return false}}return true},prefix_search:function(e,t){var n,r,i,o,a;r=(a=t!=null?t.toLowerCase().split(" "):void 0)!=null?a:[];for(i=0,o=r.length;i<o;i++){n=r[i];if(n.indexOf(e)===0){return true}}return false},match_phrase_prefix:function(e,t){var n,r,i,o,a;r=(a=t!=null?t.toLowerCase().split(" "):void 0)!=null?a:[];for(i=0,o=r.length;i<o;i++){n=r[i];if(n.indexOf(e)===0){return true}}return false},range_contains:function(e,t){if((t!=null?t[0]:void 0)==null||(e!=null?e[0]:void 0)==null){return false}e=Te(e);t=Te(t);return t[0]<=e[0]&&t[1]>=e[1]},range_contains_point:function(e,t){if((t!=null?t[0]:void 0)==null||e==null){return false}t=Te(t);return t[0]<=e&&t[1]>=e},range_contained_by:function(e,t){if((t!=null?t[0]:void 0)==null||(e!=null?e[0]:void 0)==null){return false}e=Te(e);t=Te(t);return e[0]<=t[0]&&e[1]>=t[1]},range_overlaps:function(e,t){if((t!=null?t[0]:void 0)==null||(e!=null?e[0]:void 0)==null){return false}e=Te(e);t=Te(t);return t[0]<=e[1]&&t[1]>=e[0]},range_greater_than:function(e,t){if((t!=null?t[0]:void 0)==null||(e!=null?e[0]:void 0)==null){return false}e=Te(e);t=Te(t);return t[0]>e[1]},range_less_than:function(e,t){if((t!=null?t[0]:void 0)==null||(e!=null?e[0]:void 0)==null){return false}e=Te(e);t=Te(t);return t[1]<e[0]},range_greater_than_point:function(e,t){if((t!=null?t[0]:void 0)==null||e==null){return false}t=Te(t);return t[0]>e},range_less_than_point:function(e,t){if((t!=null?t[0]:void 0)==null||e==null){return false}t=Te(t);return t[1]<e}};Te=function(e){if(e[0]>e[1]){return[e[1],e[0]]}else{return e}};te.local_constrain=function(e,t,n){var r,i,o,a,s,u,l,c,f,d,_,p;if(t.key===X.ADVANCED_SEARCH_CONSTRAINT){i={datasources:{injected_value:function(){return e},injected_value_value:function(){var n,r;return(n=(r=t.self)!=null?r:e!=null?e._type():void 0)!=null?n:"null"}}};_=ve.evaluate(t.value,i,null,null),u=_[0],c=_[1];return u}else{if(t.constraint_type==="email_equals"){o=e.child("authentication").child("email").child("email").get();if(o===t.value){return true}p=B.get_oauth_providers();for(f=0,d=p.length;f<d;f++){s=p[f];o=e.child("authentication").child(s).child("email").get();if(o===t.value){return true}}return false}else{if(t.key==="_id"){l=e._id()}else if(t.key===X.ALL_DB_FIELDS){l=We.json_stringify(e.raw())}else if(typeof e.child!=="function"){if((n!=null?n.slice(0,4):void 0)==="api."){a=Ve.get(n).get_message(t.key);if(a.is_not_found()){throw We.error({statusCode:400,message:"Filtering on this type of thing is currently not supported"})}l=a.fn(e)}else{return false}}else{l=e.child(t.key).raw()}r=$[t.constraint_type];if(!r){throw We.error("bad constraint type "+t.constraint_type)}return r(t.value,l)}}};ie='.?+*|{}[]()"\\';re=function(e){var t,n,r,i,o;n=[];o=[];for(r=0,i=e.length;r<i;r++){t=e[r];if(it.call(ie,t)>=0){o.push(n.push(t))}else{n.push("\\");o.push(n.push(t))}}return o};Se=function(e){if(String(parseFloat(e))===e){return parseFloat(e)}else{return e}};be=function(e,t,n){var r;if(t){r=-1}else{r=1}return function(t,i){var o,a,s,u;o=e(t);a=e(i);o=Se(o);a=Se(a);if(typeof o!==typeof a){if((s=typeof o)==="undefined"||s==="object"||s==="function"){return 1}if((u=typeof a)==="undefined"||u==="object"||u==="function"){return-1}if(typeof o==="string"){return 1*r}if(typeof a==="string"){return-1*r}if(typeof o==="number"){return 1*r}if(typeof a==="number"){return-1*r}}else{if(o===a&&n){return n(t,i)}if(typeof o==="string"){return o.localeCompare(a,"en-US")*r}if(typeof o==="number"){return(o-a)*r}if(typeof o==="boolean"){if(o){return r}else{return-r}}if(o instanceof Date&&a instanceof Date){if(o<a){return-1*r}else{return 1*r}}return 0}}};te.record_firebase_write=function(e,t){var n,r,i,o;r=e.toString().replace("https://","").split("/").slice(0,2).join("/").replace(/[^A-Za-z0-9\.:\-_]/g,".");n=JSON.stringify(t).length;if((i=Y.total_firebase_writes)[r]==null){i[r]=0}Y.total_firebase_writes[r]+=1;if((o=Y.total_firebase_data)[r]==null){o[r]=0}return Y.total_firebase_data[r]+=n};te.guess_value_id=function(e){var t;if(e==null){return null}else if(typeof e==="string"){return t="text"}else if(typeof e==="number"){return t="number"}else if(typeof e._type==="function"){return t=e._type()}else if(typeof e==="boolean"){return t="sys.bool"}else if(e instanceof g){return t="list."+e.get_item_value_id()}else{return null}};te.StaticList=M=function(e){rt(t,e);function t(e,n,r){var i,o,a;if(n==null){n=h().db_instance()}if(r==null){for(o=0,a=e.length;o<a;o++){i=e[o];if(i==null){continue}r=te.guess_value_id(i);if(!r){throw We.error("could not guess value_id",{dehydrated:te.dehydrate_tree(e)})}break}if(r==null){r="null"}}t.__super__.constructor.call(this,n,{t:"Static",data:N(r,e),value_id:r})}return t}(g);M.rehydrate=function(e,t){var n,r,i;i=et(t),r=i.value_id,n=i.data;return new M(te.rehydrate_tree(e,We.json_parse(n)),e,r)};te.TransformList=O=function(e){rt(t,e);function t(e,n){var r,i,o,a,s;s=n.value_id,i=n.message,a=n.properties;o=e.query;r=e.db;a=te.dehydrate_tree(a);t.__super__.constructor.call(this,r,{t:"Transform",prev:o,value_id:s,message:i,properties:a})}return t}(g);O.rehydrate=function(e,t){var n,r,i;i=JSON.parse(t),n=i.source_list,r=i.transform_data;return new O(Ce(e,n),r)};te.ConcatList=i=function(e){rt(t,e);function t(e){var n,r,i,o,a,s;i=function(){var t,n,i,o;i=e.all();o=[];for(t=0,n=i.length;t<n;t++){r=i[t];if(r!==null){o.push(r)}}return o}();n=(a=(s=i[0])!=null?s.db:void 0)!=null?a:h().db_instance();o=function(){var e,t,n;n=[];for(e=0,t=i.length;e<t;e++){r=i[e];n.push(r.query)}return n}();t.__super__.constructor.call(this,n,{t:"Concat",prevs:o})}return t}(g);i.rehydrate=function(e,t){return new i(Ce(e,t))};te.IntersectList=p=function(e){rt(t,e);function t(e){var n,r,i,o,a,s;i=function(){var t,n,i,o;i=e.all();o=[];for(t=0,n=i.length;t<n;t++){r=i[t];if(r!==null){o.push(r)}}return o}();n=(a=(s=i[0])!=null?s.db:void 0)!=null?a:h().db_instance();o=function(){var e,t,n;n=[];for(e=0,t=i.length;e<t;e++){r=i[e];n.push(r.query)}return n}();t.__super__.constructor.call(this,n,{t:"Intersect",prevs:o})}return t}(g);p.rehydrate=function(e,t){return new p(Ce(e,t))};te.UniqueList=P=function(e){rt(t,e);function t(e){var n,r;r=e.query;n=e.db;t.__super__.constructor.call(this,n,{t:"Unique",prev:r})}return t}(g);P.rehydrate=function(e,t){return new P(Ce(e,t))};te.SortedList=E=function(e){rt(t,e);function t(e,n){var r,i,o;o=n.sorts_list;i=e.query;r=e.db;t.__super__.constructor.call(this,r,{t:"Sort",sorts_list:o,prev:i})}return t}(g);E.rehydrate=function(e,t){var n,r,i;i=JSON.parse(t),r=i.source_list,n=i.properties;return new E(Ce(e,r),n)};te.SubList=j=function(e){rt(t,e);function t(e,n){var r,i,o,a,s;o=n.min,i=n.length;s=e.query;r=e.db;a={t:"Offset",offset:o,prev:s};t.__super__.constructor.call(this,r,{t:"Cap",max:i,prev:a})}return t}(g);j.rehydrate=function(e,t){var n,r,i;i=JSON.parse(t),r=i.source_list,n=i.properties;return new j(Ce(e,r),n)};te.FilteredList=d=function(){function e(e,t){return e.filter(t)}return e}();d.rehydrate=function(e,t){var n,r,i;i=JSON.parse(t),r=i.source_list,n=i.constraints;return new d(Ce(e,r),te.rehydrate_tree(e,n))};te.NodeList=x=function(e){rt(t,e);function t(e){var n,r;r=e.parent_id();n=e._path.join(".");t.__super__.constructor.call(this,e.db,{t:"NodeList",id:r,field:n})}return t}(g);x.rehydrate=function(e,t){return new x(e.get_node(t))};te.DBSearch=a=function(){function e(){}return e}();a.rehydrate=function(e,t){var n;n=JSON.parse(t);return e.find(n.type,n.constraints,n.sorts_list)};ee=e("./../lang/dataops");De=e("./sample");ye=e("./../locations");h=e("./../lib");H=e("./../client_config");Ve=e("./../lang/values");ue=e("./../geolocation");z=e("./../app_lib");Y=e("./../client_performance");X=e("./../core/core_expressions");Z=e("./../core/core_values");ve=e("./../lang/lang");B=e("./../lang/appquery");A=e("./../lang/shrink").S;ke=e("./../notifier_client");r=1e12}).call(this)},{"./../app_lib":4,"./../client_config":16,"./../client_performance":17,"./../core/core_expressions":21,"./../core/core_values":23,"./../geolocation":41,"./../lang/appquery":51,"./../lang/dataops":54,"./../lang/lang":57,"./../lang/shrink":61,"./../lang/values":62,"./../lib":65,"./../locations":66,"./../notifier_client":67,"./../tests/testing":71,"./../u":72,"./sample":30}],29:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};f=n;p=function(e,t){var n;if(e==="_id"){if(typeof(t!=null?t._id:void 0)==="function"){return t._id()}else if(Array.isArray(t)){return function(){var r,i,o;o=[];for(r=0,i=t.length;r<i;r++){n=t[r];o.push(p(e,n))}return o}()}else{return t}}else{return i.dehydrate_tree(t)}};h=function(e){var t;if(e==null){e=[]}if(typeof e.all==="function"){e=e.all()}return function(){var n,r,i;i=[];for(n=0,r=e.length;n<r;n++){t=e[n];if(t!=null){i.push(t)}}return i}()};f.equals=function(e,t){if(t==null){return{t:"C",c:e,n:"is_empty"}}return{t:"C",c:e,n:"equals",v:p(e,t)}};f.equals_both=function(e,t){return{t:"F",n:"equals_both",a:{col1:e,col2:t}}};f.not_equals=function(e,t){if(t==null){return{t:"C",c:e,n:"is_not_empty"}}return{t:"C",c:e,n:"not_equals",v:p(e,t)}};f["not true"]=function(e){return f.not_equals(e,true)};f["not equal"]=f.not_equals;f.not_equals_both=function(e,t){return{t:"F",n:"not_equals_both",a:{col1:e,col2:t}}};f.is_empty=function(e){return{t:"C",c:e,n:"is_empty"}};f.is_not_empty=function(e){return{t:"C",c:e,n:"is_not_empty"}};f.empty=f.is_empty;f["not empty"]=f.is_not_empty;f.is_true=function(e){return{t:"C",c:e,n:"equals",v:true}};f.is_false=function(e){return{t:"C",c:e,n:"equals",v:false}};f.contains=function(e,t){if(t==null){return false}return{t:"C",c:e,n:"contains",v:p(e,t)}};f.contains_both=function(e,t){return{t:"F",n:"contains_both",a:{col1:e,col2:t}}};f["in"]=function(e,t){t=h(t);if(t.length===0){return false}return{t:"C",c:e,n:"in",v:p(e,t)}};f.not_contains=function(e,t){if(t==null){return null}return{t:"C",c:e,n:"not_contains",v:p(e,t)}};f["not contains"]=f.not_contains;f.not_contains_both=function(e,t){return{t:"F",n:"not_contains_both",a:{col1:e,col2:t}}};f.not_in=function(e,t){t=h(t);if(t.length===0){return null}return{t:"C",c:e,n:"not_in",v:p(e,t)}};f["not in"]=f.not_in;f["greater than"]=function(e,t){if(t==null){return null}return{t:"C",c:e,n:"greater_than",v:t}};f["less than"]=function(e,t){if(t==null){return null}return{t:"C",c:e,n:"less_than",v:t}};f["text contains"]=function(e,t){if(t==null){return null}return{t:"C",c:e,n:"contains",v:{language:a(),query:t}}};f["not text contains"]=function(e,t){if(t==null){return null}return{t:"C",c:e,n:"not_contains",v:{language:a(),query:t}}};f["contains_all_fields"]=function(e,t){if(t==null){return null}return{t:"C",c:"_all",n:"contains",v:{language:a(),query:t}}};f["prefix_search"]=function(e,t,n){var r;if(t==null){return null}if(n!=null?n.no_language:void 0){r="simple"}else{r=a()}return{t:"C",c:e,n:"prefix",v:{language:r,query:t}}};f["match_phrase_prefix"]=f["prefix_search"];t={miles:1609.344,kms:1e3,km:1e3};f["geographic_search"]=function(e,n){var r,i,a,s,u,l,c,f,d,_;if(n==null){return null}d=n!=null?n:{},c=d.range,f=d.unit,l=d.origin_address;if(l==null||!o.is_hashed(l)){return null}_=o.get_coordinates(l),i=_.latitude,s=_.longitude;a=s;r=i;u=t[f!=null?f:"miles"]*(c!=null?c:1);return{t:"C",c:e,n:"within",v:{lon:a,lat:r,meters:u}}};f["email_equals"]=function(e,t){var n,i,o,a,s;if(t==null||typeof t!=="string"){return false}n={t:"O",a:[]};n.a.push(f.equals("authentication.email.email",t.toLowerCase()));s=r.get_oauth_providers();for(o=0,a=s.length;o<a;o++){i=s[o];n.a.push(f.equals("authentication."+i+".email",t.toLowerCase()))}return n};a=function(){var e;e=u.app_language();if(_[e]){return _[e]}if(w.call(d,e)>=0){return e}return"simple"};_={da_dk:"danish",nl_nl:"dutch",en_us:"english",fi_fi:"finnish",fr_fr:"french",de_de:"german",hu_hu:"hungarian",it_it:"italian",no_no:"norwegian",pt_br:"portuguese",ro_ro:"romanian",ru_ru:"russian",es_es:"spanish",sv_se:"swedish",tr_tr:"turkish"};d=function(){var e;e=[];for(g in _){s=_[g];e.push(s)}return e}();c=["range_contains","range_greater_than","range_less_than"];b=["range_contains","range_contained_by","range_overlaps","range_greater_than","range_less_than"];m=function(e){f[e]=function(t,n){if(n==null){return false}return{t:"C",c:t,n:e,v:n}};if(w.call(c,e)>=0){return f[e+"_point"]=f[e]}};for(v=0,y=b.length;v<y;v++){l=b[v];m(l)}i=e("./db");o=e("./../geolocation");r=e("./../lang/appquery");u=e("./../languages")}).call(this)},{"./../geolocation":41,"./../lang/appquery":51,"./../languages":64,"./db":28}],30:[function(e,t,n){(function(){var t,r,i,o,a,s,u;a=n;o=e("./db");s=e("./../u");o.SampleObject=a.SampleObject=i=function(){function e(e){var t;try{this.value=u.get(e)}catch(n){t=n;this.value=u.get("null")}this.id=e}e.prototype.child=function(e){return new r(this,e)};e.prototype.dehydrate=function(){return o.dehydrate_prefix("SampleObject")+this.value.id()};e.prototype._id=function(){return"sample:"+this.id};e.prototype._type=function(){return this.value.id()};e.prototype.is_equal_to=function(e){return(e!=null?typeof e.dehydrate==="function"?e.dehydrate():void 0:void 0)===this.dehydrate()};e.prototype.precache=function(){};e.prototype.exists=function(){return false};return e}();i.rehydrate=function(e,t){return new i(t)};o.SampleNode=r=function(){function e(e,t,n){var r;this.object=e;this.name=t;this.value=n;if(this.value==null){this.value=(r=this.object.value.get_message(this.name))!=null?r.ret_value():void 0}}e.prototype.get=function(){var e;return(e=this.value)!=null?e.get_sample():void 0};e.prototype.set=function(){};e.prototype.push=function(){};e.prototype.remove=function(){};e.prototype.dehydrate=function(){return o.dehydrate_prefix("SampleNode")+this.value.id()};return e}();r.rehydrate=function(e,t){return new r(null,null,u.get(t))};o.SampleList=a.SampleList=t=function(){function e(e){var t;t=u.get(e);return new o.StaticList([t!=null?t.get_sample():void 0,t!=null?t.get_sample():void 0],null,e)}return e}();t.rehydrate=function(e,n){return new t(n)};u=e("./../lang/values")}).call(this)},{"./../lang/values":62,"./../u":72,"./db":28}],31:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};C=n;P=e("./../u");t="email";o="_social_networks";C.USER_FIELDS=[{display:"email",value:t},{display:"Social Networks",value:o}];C.DATE_FIELDS=[{display:"Created Date",value:"Created Date"},{display:"Modified Date",value:"Modified Date"}];C.CREATOR_FIELD=[{display:"Created By",value:"Created By"}];R=function(e,t,n,r,i){var o,a,s,u,l,c,f,d,_,p;if(r==null){r=true}if(i==null){i=true}a=e===t;o={};for(s in n){f=n[s];if(s!=="stripeauthtoken"&&s!=="authentication"){o[s]=f}else if(s==="authentication"){o[s]={};_=f!=null?f:{};for(c in _){l=_[c];o[s][c]={};p=l!=null?l:{};for(u in p){d=p[u];if(u==="access_token"){if(a){o[s][c][u]=d}}else if(u==="email"){if(r||a){o[s][c][u]=d}}else if(u!=="hashed_pw"&&u!=="salt"&&u!=="refresh_token"){if(i||a){o[s][c][u]=d}}}}}}return o};i={view_all:true,search_for:true,view_attachments:true};b=function(e,t,n){if(e&&t.length>1){return x(e,n)}else{return i[n]}};x=function(e,t){var n;P.optional_pause();return(n=e.get_permissions())!=null?n[t]:void 0};C.can_read_attached=function(e){var t;if(!e){return false}t=r().db_instance().get(e);return C.check_object_access("view_attachments",t)};g=function(e,t){if(e===true){return function(e){return true}}if(!e){return function(e){return false}}return function(n){return r.extend({ignore_privacy_rules:true},function(){var r;r=M.reduce(e,null,n.ignore_privacy(),t);return r===true})}};C.generate_can_search_for=function(e){return g(C.generate_search_rules(e),e)};C.check_object_access=function(e,t){var n,r;if(!t){return false}t=t.ignore_privacy();r=t._type();if(!r){return false}n=z.get(r).custom_type();return C.check_access(n,e,t)};C.check_access=function(e,t,n){if(r().ignore_privacy_rules()){return true}n=n.ignore_privacy();return r.extend({ignore_privacy_rules:true},function(){var r,i,o,a,s,u;r=(u=e!=null?typeof e.privacy_roles==="function"?e.privacy_roles():void 0:void 0)!=null?u:[];i=e!=null?typeof e.privacy_role==="function"?e.privacy_role("everyone"):void 0:void 0;if(b(i,r,t)){return true}s=function(){var e,n,i;i=[];for(e=0,n=r.length;e<n;e++){a=r[e];if(x(a,t)){i.push(a)}}return i}();o=M.reduce(A(s),null,n,e.to_value());return o===true})};C.generate_field_filter=function(e){var t;t=p(e,{permission:"view_all",field_permission:"view_fields"});return l(t)};C.generate_field_modifier=function(e){var t;t=p(e,{permission:"auto_binding",field_permission:"binding_fields"});return f(t)};p=function(e,t){var n,i,o,a,s,u,l;u=t.permission,a=t.field_permission;P.optional_pause();i=z.get(e).custom_type();n=(l=i!=null?typeof i.privacy_roles==="function"?i.privacy_roles():void 0:void 0)!=null?l:[];o=i!=null?typeof i.privacy_role==="function"?i.privacy_role("everyone"):void 0:void 0;P.optional_pause("calculate_field_filter initial");s=r().ignore_privacy_rules();return r.extend({ignore_privacy_rules:true},function(){var t,r,i,l,c,f,d,_,p,h,g,m,v,y,k,S,E,T;g=u==="view_all"?[false,null,void 0]:[true];if(s||b(o,n,u)){m=true}else if(u==="view_all"){h=function(){var e,t,r;r=[];for(e=0,t=n.length;e<t;e++){p=n[e];if(x(p,u)){r.push(p)}}return r}();m=M.reduce(A(h))}if(m!==true){d=function(){
var e,t,r,i,o;o=[];for(e=0,t=n.length;e<t;e++){p=n[e];if((r=x(p,u),B.call(g,r)>=0)&&P.not_empty((i=p.get_permissions())!=null?i[a]:void 0)){o.push(p)}}return o}();P.optional_pause();f=function(){var e,t,n,r,i;i=[];for(e=0,t=d.length;e<t;e++){p=d[e];i.push([M.reduce(w(p)),(n=(r=p.get_permissions())!=null?r[a]:void 0)!=null?n:{}])}return i}();P.optional_pause("reduce field conditions");r={};if(u==="view_all"){i=(k=o.get_permissions())!=null?k[a]:void 0}else if(u==="auto_binding"){if((S=o.get_permissions())!=null?S.auto_binding:void 0){i=(E=o.get_permissions())!=null?E[a]:void 0}}for(_ in i){l=i[_];r[l]=true}for(v=0,y=f.length;v<y;v++){T=f[v],t=T[0],c=T[1];if(t===true){for(_ in c){l=c[_];r[l]=true}}}P.optional_pause("calculate default fields");if(e==="user"&&u==="view_all"){r.authentication=true;r.user_signed_up=true}f=function(){var e,n,r,i;i=[];for(e=0,n=f.length;e<n;e++){r=f[e],t=r[0],c=r[1];if(t&&t!==true){i.push([t,c])}}return i}()}return{type:e,view_all:m,default_fields:r,fields_conditions:f}})};s=function(e){var t,n;for(t in e){n=e[t];return true}return false};l=function(e){var n,i,a,u;a=e.type,u=e.view_all,n=e.default_fields,i=e.fields_conditions;return r.extend({ignore_privacy_rules:true},function(){var e,l,c;P.optional_pause();if(a==="user"){l=r().current_user()._id()}if(u){if(a==="user"){c=function(e,t){return R(l,e,t)}}else{c=function(e,t){return t}}}P.optional_pause();if(u===true){return c}if(!u&&i.length===0&&!s(n)){return function(e,t){return{}}}e=r().db_instance();P.optional_pause();return function(s,f){return r.extend({ignore_privacy_rules:true},function(){var r,d,_,p,h,g,m,y,b,w,x,k,S,A,E;g=new v.StaticObject(f,e);g._id=function(){return s};if(u){y=M.reduce(u,void 0,g,a);if(y===true){return c(s,f)}}if(i.length===0){m=n}else{m=P.extend({},n);for(x=0,k=i.length;x<k;x++){S=i[x],r=S[0],p=S[1];r=M.reduce(r,void 0,g,a);if(r===true){for(h in p){d=p[h];m[d]=true}}}}if(a==="user"&&m[o]){m.StripeCustomerID=true}b={};for(_ in m){w=m[_];b[_]=f[_]}if(a==="user"){return R(l,s,b,(A=m[t])!=null?A:false,(E=m[o])!=null?E:false)}else{return b}})}})};f=function(e){var n,i,a,u,l;u=e.type,l=e.view_all,n=e.default_fields,i=e.fields_conditions;a=l;return r.extend({ignore_privacy_rules:true},function(){var e,l,c;if(u==="user"){c=r().current_user()._id()}if(a){if(u==="user"){l=function(e,n){return n!==t&&n!==o}}else{l=function(e,t){return true}}}if(a===true){return l}if(!a&&i.length===0&&!s(n)){return function(e,t){return false}}e=r().db_instance();return function(t,o){return r.extend({ignore_privacy_rules:true},function(){var r,s,c,f,d,_,p,h,g,m;s=e.get(t).raw();d=new v.StaticObject(s,e);d._id=function(){return t};if(a){_=M.reduce(a,void 0,d,u);if(_===true){return l(t,o)}}if(i.length===0){p=n}else{p=P.extend({},n);for(h=0,g=i.length;h<g;h++){m=i[h],r=m[0],c=m[1];r=M.reduce(r,void 0,d,u);if(r===true){for(f in c){o=c[f];p[o]=true}}}}return p[o]})}})};w=function(e){return P.json_deep_copy(e.condition().json._raw())};A=function(e){var t,n,r,i,o;t=null;for(r=0,i=e.length;r<i;r++){n=e[r];o=w(n);if(!t){t=o}else{M.add_next(t,M.create_message("or_",o))}}return t};C.generate_search_rules=function(e){if(r().ignore_privacy_rules()){return true}return r.extend({ignore_privacy_rules:true},function(){var t,n,r,i;n=z.get(e).custom_type();t=n!=null?n.privacy_roles():void 0;r=n!=null?n.privacy_role("everyone"):void 0;if(b(r,t,"search_for")){return true}i=M.reduce(_(t));if(i==null){i=false}return i})};_=function(e){var t,n,r;t=function(e){var t;return e.name()!=="everyone"&&((t=e.get_permissions())!=null?t.search_for:void 0)&&e.can_search_for()};r=function(){var r,i,o;o=[];for(r=0,i=e.length;r<i;r++){n=e[r];if(t(n)){o.push(n)}}return o}();return A(r)};r=e("./../lib");M=e("./../lang/partial");a=e("./../lang/appquery");z=e("./../lang/values");v=e("./db");m=e("./../client_config")}).call(this)},{"./../client_config":16,"./../lang/appquery":51,"./../lang/lang":57,"./../lang/partial":58,"./../lang/values":62,"./../lib":65,"./../tests/testing":71,"./../u":72,"./db":28}],32:[function(e,t,n){(function(){var t,r,i,o,a,s;s=n;a=e("./../u");s.get_notification_root=function(e){return s.get_root().then(function(t){return t.child("elastic_percolator").child(r.id_safe(e))})};s.get_root=function(){if(a.on_server()){return o.get_workflow_firebase()}else{return t.get_workflow_firebase()}};t=e("./client_db");r=e("./db");if(a.on_server()){i=e;o=i("./server_db")}}).call(this)},{"./../u":72,"./client_db":27,"./db":28}],33:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m;u=n;m=e("./u");i="Failed to establish a connection";u.is_retryable=function(e,t,n){var r;if(n){if(n(t,e)){return true}}if(e){if(m.string_contains(e.message,i)){return true}if(m.string_contains(e.message,"ECONNRESET")){return true}if(m.string_contains(e.message,"ESOCKETTIMEDOUT")){return true}if(m.string_contains(e.message,"ETIMEDOUT")){return true}if(m.string_contains(e.message,"EHOSTUNREACH")){return true}if(m.string_contains(e.message,"ENETUNREACH")){return true}if(m.string_contains(e.message,"socket hang up")){return true}if(m.string_contains(e.message,"SSL3_GET_RECORD:decryption failed or bad record mac")){return true}}if(t){if((r=t.statusCode)===429||r===502||r===503||r===504){return true}}};d=function(e){if(e.length>1e4){return e.slice(0,1e4)}try{return JSON.stringify(JSON.parse(e),null,4)}catch(t){return e}};u.get=function(){var e;e={load_plugin:f.load_plugin,log:function(e){console.log("Server Log: "+e);return t().location.post("server://bug/log",{message:e})},workflow:new o,pageparam:new r,app_language:l.app_language,get_text:l.get_text,test_prod:false,app_indicator:function(e,t,n){if(typeof e==="string"||e==null){return{appname:e!=null?e:this.appname(),app_version:t!=null?t:this.app_version(),temp_db:n!=null?n:this.temp_db()}}if(e.appname==null){e.appname=a.get_appname_from_domain(e.domain)}if(e.app_version==null){e.app_version=this.app_version()}if(e.temp_db==null){e.temp_db=this.temp_db()}return e},temp_db:null,http_request:function(e){return m.Promise(e).then(function(e){var t,n,r,o,a,l,f,_,p,g,v,y,b,w,x,k,S;p={};k=["body","custom_form","formData","custom_retry_handler"];for(w=0,x=k.length;w<x;w++){f=k[w];if(!(e[f]!=null)){continue}p[f]=e[f];delete e[f]}e=m.json_deep_copy(e);for(l in p){b=p[l];e[l]=b}if(e.method==null){e.method="get"}if(e.timeout==null){e.timeout=3e4}_=m.Promise(null,"default_lib.http_request "+e.url);if(m.on_server()){if(e.data){e.body=m.json_stringify(e.data);if(e.headers==null){e.headers={}}e.headers["Content-Type"]="application/json";v=e.data;delete e.data}else if(e.body){g=e.body}if(e.body==null){delete e.body}if(e.body&&e.body.length==null&&typeof e.body.pipe!=="function"){delete e.body}o=e.custom_retry_handler;t=(S=e.max_retries)!=null?S:5;y=t;delete e.max_retries;r=e.custom_form;delete e.custom_form;if(e.followAllRedirects==null){e.followAllRedirects=true}if(e.followOriginalHttpMethod==null){e.followOriginalHttpMethod=true}e.rejectUnauthorized=false;a=function(){var n,l,f,p,g,v,b,w,x,k;b=false;f=function(n,r){var i,s,l;if(b){return}b=true;clearTimeout(g);if(u.is_retryable(n,r,o)&&y>0){if((r!=null?(l=r.headers)!=null?l["retry-after"]:void 0:void 0)!=null){i=r.headers["retry-after"];if(String(parseInt(i))===String(i)){s=parseInt(i)*1e3}else{s=new Date(i).valueOf()-Date.now()}if(s<1e3){s=1e3}}else{s=(t-y)*(t-y)*1e3}}if(s<30*1e3){y--;setTimeout(function(){c.info("http_request (retry): "+e.method+" "+e.url);return a()},s);return}if(n){return _.reject(n)}else{if(r.body){c.verbose("response from "+e.method+" "+e.url+":\n"+d(r.body))}return _.resolve(r)}};g=setTimeout(function(){return f(m.error(i+" after "+e.timeout+" ms to "+e.url))},e.timeout+500);p=h(e,f);p.on("error",f);if(s.api_response_limit){v=0;p.on("data",function(e){v+=e.length;if(v>s.api_response_limit){this.abort();return f(m.error({statusCode:400,message:"Response was too large -- aborted after "+v+" bytes"}))}})}if(r!=null){l=p.form();k=[];for(w=0,x=r.length;w<x;w++){n=r[w];k.push(l.append(n[0],n[1],n[2]))}return k}};c.info("http_request: "+e.method+" "+e.url);if(v){c.verbose("data:\n"+JSON.stringify(v,null,4))}else if(g){c.verbose("body:\n"+g)}a()}else{e.type=e.method.toUpperCase();delete e.method;if(e.dataType==null){e.dataType="jsonp"}if(e.timeout==null){e.timeout=55e3}n=$.ajax(e);n.done(function(e,t,n){return _.resolve({statusCode:n.status,body:m.json_stringify(e)})});n.fail(function(e,t,n){var r;return _.resolve({statusCode:e.status,body:(r=e.responseText)!=null?r:n})})}return _})}};return e};f=e("./lang/plugin_loader");r=e("./client/pageparamservice");o=e("./client/workflowengine");l=e("./languages");t=e("./lib");_=e("querystring");a=e("./app_lib");p=e;if(m.on_server()){h=p("request");c=p("./logger");s=p("./configuration")}}).call(this)},{"./app_lib":4,"./client/pageparamservice":11,"./client/workflowengine":15,"./lang/plugin_loader":59,"./languages":64,"./lib":65,"./tests/testing":71,"./u":72,querystring:285}],34:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};t=n;h=e("./u");c=e("./lang/plugins");p=e("./services");d=["border_style_top","border_roundness_top","border_width_top","border_color_top","border_style_right","border_roundness_right","border_width_right","border_color_right","border_style_bottom","border_roundness_bottom","border_width_bottom","border_color_bottom","border_style_left","border_roundness_left","border_width_left","border_color_left"];s=["salesforce-DeleteInSalesforce","salesforce-UpdateFromSalesforce","salesforce-WriteToSalesforce","salesforce-SalesforceCreateLoanQuote","salesforce-SalesforceDoCreditEstimation","salesforce-SalesforceCreateBankAccount","salesforce-DS_CSV_Import","salesforce-DSSaveInvestor","salesforce-DSGenerateProposal2","Omnivore-CreateOmnivoreTicket","Omnivore-AddItemToOmnivoreTicket","Omnivore-MakeThirdPartyPayment","meta_ForkPlugin","salesforce-DSGenerateLOI","salesforce-DSGenerateProposal","upsert_account","upsert_usage_profile","upsert_production_profile","upsert_pvwatts_profile","run_savings_analysis","zapier-TrigggerZap","localizejs-ChangeLocalizeLanguage","stripe-CreateCoupon","stripe-TransferToSeller","stripe-CreatePayout"];l=["condition","key_info","information","formatting_type","decimal_place","decimal_separator","thousand_separator","currency_symbol","no_language","negative_parenthese","computed_value"];i=["mandatory","disabled","auto_binding","bind_field","alert_message","alert_element","show_alert_on_sucess"];t.for_workflows=function(e,t){var n,r,i;r=p.get_service_and_type(t),n=r[0],i=r[1];if(g.call(s,t)>=0||(n==="apiconnector"||n==="appconnector"||n==="dbconnector"||n==="apiconnector2")||t.indexOf("meta_")===0){return}if(n){if(c.get_plugin(n).documented()){if(n==="Blockspring"){return"Documentation.Plugins."+n}else{return"Documentation.Plugins."+n+"."+i}}}else{if(e){if(t==="APIReturnData"){return"Documentation.API.workflow_api."+t}else{return"Documentation.Actions."+t}}else{if(t==="APIEvent"){return"Documentation.API.workflow_api."+t}else{return"Documentation.Events."+t}}}};t.for_property_editor=function(t,n){var r,o,u,f,_,h,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U;o=e("./core/property_applications");if(h=n.name,g.call(l,h)>=0){return}if((m=n.name)==="switch_element"||m==="element_style"||m==="delete_style"||m==="edit_style"||m==="is_visible"||m==="select_parent"||m==="reveal_in_tree"||m==="lock_in_editor"||m==="unique_id"){return"Documentation.Elements.GeneralConcepts."+n.name}if((T=n.name,g.call(i,T)>=0)&&(typeof t.is_input==="function"?t.is_input():void 0)){return"Documentation.Elements.GeneralInput."+n.name}switch((R=n.pretty)!=null?R.section:void 0){case"Position":case"ShortPosition":case"Position2":r="Dimensions";break;case"Boxshadow":r="BoxShadow"}if(z=n.name,g.call(d,z)>=0){return"Documentation.PropertyApplications.Border."+n.name.split("_").slice(0,2).join("_")}else if((B=n.name)==="min_width"||B==="new_responsive"||B==="fixed_width"||B==="keep_proportion_resize"||B==="max_width"||B==="use_max_width"){return"Documentation.Elements.GeneralConcepts.Responsive."+n.name}else if((N=n.name)==="line_height"||N==="letter_spacing"||N==="word_spacing"){return"Documentation.PropertyApplications.FontSpacing."+n.name}else if((L=n.name)==="vertical_centering"||L==="padding_horizontal"){return"Documentation.PropertyApplications.Padding."+n.name}else if((q=n.name)==="floating_reference"||q==="floating_reference_horizontal"){return"Documentation.Elements.FloatingGroup."+n.name}else if((U=o[r])!=null?U:o[(v=n.pretty)!=null?v.section:void 0]){if((y=n.name)==="prevent_user_from_closing_through_esc"||y==="greyout_color"||y==="greyout_blur"){return"Documentation.Elements.Popup."+n.name}else if((b=n.name)==="collapse_when_hidden"||b==="collapse_animation"||b==="animation_type"){return"Documentation.Elements.Group."+n.name}else if((w=n.name)==="preset_width"){return"Documentation.Elements.Page.preset_width"}else{u=(x=(k=o[r])!=null?k.class_name:void 0)!=null?x:(S=n.pretty)!=null?S.section:void 0;switch(u){case"ShortPosition":case"ShortDimensions":case"Rotation":case"Position":case"Position2":u="Dimensions";break;case"Boxshadow":u="BoxShadow";break;case"PlaceholderColor":u="Font"}return"Documentation.PropertyApplications."+u+"."+n.name}}f=_=null;if(t.type){A=p.get_service_and_type(t.type()),f=A[0],_=A[1];if(!_){return}}if(t instanceof a.GenericElement||t instanceof a.Style){if((E=t.type())==="FakeMultiElement"||E==="GroupWithFocus"){return}if((M=n.name)!=="delete_element"&&M!=="delete_page"&&M!=="delete_custom_definition"&&M!=="edit_custom_definition"&&M!=="backdrop_crop_responsive"&&_!=="AddToAnyShareButtons"){if(_==="CustomElement"){_="CustomDefinition"}if(f){if(c.get_plugin(f).documented()){return"Documentation.Plugins."+f+"."+_+"."+n.name}}else{return"Documentation.Elements."+_+"."+n.name}}}else if(t instanceof a.State){C=p.get_service_and_type(t.context_element().type()),f=C[0],_=C[1];if(f){if(c.get_plugin(f).documented()){return"Documentation.Plugins."+f+"."+_+"."+n.name}}else{return"Documentation.Elements."+_+"."+n.name}}else if(t instanceof a.GenericEvent){if((j=n.name)==="condition"||j==="element_id"||j==="event_color"||j==="wf_folder"||j==="breakpoint"){return"Documentation.Workflow."+n.name}else{if(_==="APIEvent"){return"Documentation.API.workflow_api."+_+"."+n.name}else if(f){if(c.get_plugin(f).documented()){return"Documentation.Plugins."+f+"."+_+"."+n.name}}else{return"Documentation.Events."+_+"."+n.name}}}else if(t instanceof a.Action){if(n.name==="element_id"&&_==="TriggerCustomEventFromReusable"){return"Documentation.Actions.TriggerCustomEventFromReusable.element_id"}if(n.name==="element_id"&&_==="ChangePage"){return"Documentation.Actions.ChangePage"}if((D=n.name)==="condition"||D==="element_id"||D==="breakpoint"){return"Documentation.Workflow."+n.name}else{if((O=t.type(),g.call(s,O)>=0)||(f==="apiconnector"||f==="appconnector")||t.type().indexOf("meta_")===0){}else if(_==="APIReturnData"){return"Documentation.API.workflow_api."+_+"."+n.name}else if((_==="ScheduleAPIEvent"||_==="ScheduleAPIEventOnList")&&((I=n.name)!=="api_event"&&I!=="date"&&I!=="type_of_list"&&I!=="data_source"&&I!=="ignore_privacy_rules"&&I!=="interval")){return"Documentation.Actions."+_+".parameters"}else if(f){if(c.get_plugin(f).documented()){return"Documentation.Plugins."+f+"."+_+"."+n.name}}else{return"Documentation.Actions."+_+"."+n.name}}}else if(t._type==="Search"){return"Documentation.Data.SearchOperator."+n.name}else if((P=t._type)==="GetDataFromAPI"||P==="GetParamFromUrl"){return"Documentation.Data.DataSources."+t._type}};u=["AppSetting"];t.for_datasource=function(e){var t,n,r;if(n=e.type,g.call(u,n)>=0){return}t="Documentation.Data.DataSources."+e.type;if(((r=e.properties)!=null?r.name:void 0)!=null){t+="."+e.properties.name}return t};o=["equals","not_equals","is_empty","is_not_empty"];t.for_value_messages=function(e,t){if(g.call(o,t)>=0){return"Documentation.Data.Messages.GenericMessages."+t}else{if(e==="bool"){e="boolean"}return"Documentation.Data.Messages."+e+"."+t}};r=["Created By","Created Date","Modified Date","_id","id_link","email","logged_in","not_logged_in","email_confirmed"];t.for_value_messages_custom_types=function(e,t){if(g.call(r,t)>=0){if(e==="custom"||t!=="email"&&t!=="logged_in"&&t!=="not_logged_in"&&t!=="email_confirmed"){return"Documentation.Data.Messages.CustomType."+t}else{return"Documentation.Data.Messages.User."+t}}};a=e("./lang/lang")}).call(this)},{"./core/core_actions":18,"./core/core_elements":19,"./core/core_events":20,"./core/core_expressions":21,"./core/core_values":23,"./core/property_applications":24,"./lang/lang":57,"./lang/plugins":60,"./services":70,"./u":72}],35:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};c=e("./../u");i=e("./editor_language").get_text;o=n;d=null;_=null;o.show=function(e,n,r){if(d==null){d=new t}return d.show(e,n,r)};t=function(){function e(){}e.prototype.show=function(e,t,n){var r,i,o,s=this;this.cb=n;this.filters={types:c.Box(e),categories:c.Box(t),built_by:c.Box(null),premium:c.Box(null)};this.real_time_search_box=c.Box(null);this.sort_mode=c.Box("name");this.canvas=c.div(["modal-popup","add-plugin-window"],$(document.body));i=c.div("popup-content",this.canvas);this.canvas.on("vclick",function(e){if(c.did_event_pass_through(e,".children")||c.is_on_mobile_or_tablet()){return true}s.hide();return true});$(document).off("keydown.escape-addplugin");$(document).on("keydown.escape-addplugin",function(e){if(e.keyCode===27){s.hide()}});i.append(this.create_header());r=c.div("children",i);this.sub_child=c.div("inner-children",r);this.autoruns=[];this.sub_child.append(this.create_filter_pane());this.sub_child.append(this.create_plugins_pane());this.sub_child.append(this.create_footer());o=c.div("paid-mention",this.sub_child);this.autorun(function(){var e,t;o.empty();if(a.app_plan(true).legacy_plan){t="You can subscribe to paid plugins on new paid plans only. Legacy plans do not offer this option."}else{t="You can subscribe to paid plugins on paid plans only."}e=l.add_mention(function(){return!a.app_plan(true).can_buy_plugins},o,t);return e.on("vclick",function(){return s.hide()})});$("body").css("overflow","hidden");c.velocity(this.canvas,"fadeIn",{duration:300,complete_cb:function(){return s.search_input.focus()}});$(window).on("resize.add_plugin_scrollbars",function(){return s.update_scrollbars()});return this.update_scrollbars()};e.prototype.add_filter=function(e,t){var n,r;n=[].concat((r=this.filters[e]())!=null?r:[]);n.push(t);return this.filters[e](n)};e.prototype.remove_filter=function(e,t){var n,r;n=[].concat((r=this.filters[e]())!=null?r:[]);c.array_remove(n,t);return this.filters[e](n)};e.prototype.autorun=function(e){return this.autoruns.push(c.autorun(e))};e.prototype.hide=function(){var e,t,n,r,i=this;r=this.autoruns;for(t=0,n=r.length;t<n;t++){e=r[t];e.destroy()}c.velocity(this.canvas,"fadeOut",{duration:300,complete_cb:function(){$("body").css("overflow","auto");i.canvas.remove();return typeof i.cb==="function"?i.cb(_):void 0}});return $(window).off("resize.add_plugin_scrollbars")};e.prototype.create_header=function(){var e;e=c.div("popup-title");e.text(i("install_plugin"));return e};e.prototype.create_filter_pane=function(){var e,t,n,r,o,a,s,u,l,f=this;e=c.div("filter-pane");c.div("filter-title",e,"Filters");this.filter_area=c.div("filter-area",e);t=c.div("filter-pane-inner",this.filter_area);c.div("sort-by",t,"Sort by");o={};l=["name","usage","rating","date","price"];a=function(e){o[e]=c.div("sort-btn "+e,t,e);return o[e].on("vclick",function(){return f.sort_mode(e)})};for(s=0,u=l.length;s<u;s++){r=l[s];a(r)}c.autorun(function(){var e,t,n;n=[];for(t in o){e=o[t];n.push(e.toggleClass("selected",t===f.sort_mode()))}return n});this.search_input=c.input("bubble-ui search-plugin",t,void 0,i("search_plugin"));this.search_input.on("keyup",function(){var e;if(((e=f.search_input.val())!=null?e.length:void 0)>2){return f.real_time_search_box(f.search_input.val())}else{return f.real_time_search_box(null)}});n=c.div("filter-wrapper",t);this.autorun(function(){n.empty();n.append(f.create_filter("types"));n.append(f.create_filter("built_by"));n.append(f.create_filter("categories"));return n.append(f.create_filter("premium"))});return e};e.prototype.create_filter=function(e){var t,n,r,o,a,s,l,f,d,_=this;t=c.div("filter-category");d=u.get_all_tags(e).sort();c.autorun_top(function(){var t,n,r,i;if(!_.filters[e]()||!_.filters[e]().length){i=[];for(n=0,r=d.length;n<r;n++){t=d[n];i.push(_.add_filter(e,t))}return i}});n=c.div("filter-caption open",t);o=c.div("filter-select-all",t);this.autorun(function(){var t;t=_.filters[e]();n.text(i(e));o.off("vclick");if((t!=null?t.length:void 0)===d.length){o.text("("+i("deselect_all").toLowerCase()+")");return o.on("vclick",function(){return _.filters[e]([])})}else{o.text("("+i("select_all").toLowerCase()+")");return o.on("vclick",function(){return _.filters[e](d)})}});r=c.div("filter-list",t);r.show();this.autorun(function(){var t,n,i,o;r.empty();o=[];for(n=0,i=d.length;n<i;n++){t=d[n];o.push(function(t){var n,i;n=c.div("tag-button",r,c.toTitleCase(t));if(p.call((i=_.filters[e]())!=null?i:[],t)>=0){n.addClass("selected");return n.on("vclick",function(){return _.remove_filter(e,t)})}else{return n.on("vclick",function(){return _.add_filter(e,t)})}}(t))}return o});n.on("click",function(){if(n.hasClass("open")){o.hide();c.velocity(r,"slideUp",{duration:200})}else{o.show();c.velocity(r,"slideDown",{duration:200})}return n.toggleClass("open")});s=c.div("filter-more");a=false;l=function(){s.text(i("more"));return a=false};f=function(){s.text(i("hide"));return a=true};f();s.on("vclick",function(){if(a){l();return c.velocity(r,"slideUp",{duration:300})}else{f();return c.velocity(r,"slideDown",{duration:300})}});return t};e.prototype.create_plugins_pane=function(){var e,t=this;this.plugins_pane=c.div("plugin-pane");e=c.div("plugins-pane-inner",this.plugins_pane);this.autorun(function(){var n,r,i,o,a;e.empty();i=function(e,n){var r,i,o,a,s,u,l,c,f;r=function(){var t,r,i,o;t=(i=e.count())!=null?i:0;r=(o=n.count())!=null?o:0;if(t<r){return 1}else{return-1}};if(e.is_testing()&&!n.is_testing()){return-1}else if(!e.is_testing()&&n.is_testing()){return 1}if(t.sort_mode()==="name"){i=e.display().toLowerCase();o=n.display().toLowerCase();if(i<o){return-1}else if(o<i){return 1}return r()}if(t.sort_mode()==="rating"){i=(a=e.all_versions_rating())!=null?a:0;o=(s=n.all_versions_rating())!=null?s:0;if(i<o){return 1}else if(o<i){return-1}return r()}if(t.sort_mode()==="date"){i=(u=e.published_date())!=null?u:0;o=(l=n.published_date())!=null?l:0;if(i<o){return 1}else if(o<i){return-1}return r()}if(t.sort_mode()==="price"){i=(c=e.price())!=null?c:0;o=(f=n.price())!=null?f:0;if(i<o){return 1}else if(o<i){return-1}return r()}else if(t.sort_mode()==="usage"){return r()}};n=u.get_all_plugins().sort(i);for(o=0,a=n.length;o<a;o++){r=n[o];if(t.should_show(r)){e.append(t.create_plugin_box(r.id,r))}}return t.update_scrollbars()});return this.plugins_pane};e.prototype.should_show=function(e){var t,n,r,i,o,a,s,u,l,c,f,d,_,h;d=function(){var e,n;e=this.filters;n=[];for(t in e){s=e[t];n.push(t)}return n}.call(this);for(u=0,c=d.length;u<c;u++){o=d[u];n=this.filters[o]();if(n!=null?n.length:void 0){r=false;_=e.tags(o);for(l=0,f=_.length;l<f;l++){i=_[l];if(p.call(n,i)>=0){r=true}}if(!r){return false}}else{return false}}a=(h=this.real_time_search_box())!=null?h.toLowerCase():void 0;if(a&&e.display().toLowerCase().indexOf(a)===-1&&e.creator_name().toLowerCase().indexOf(a)===-1){return false}return true};e.prototype.create_plugin_box=function(e,t){var n,o,s,u,d,p,h,g,m=this;p=c.div(".plugin-box");h=c.div("plugin-description-wrapper",p);if(t.icon()){u=c.img("plugin-icon",h,t.icon());f.get_image_real_dimensions(t.icon(),function(e){var t;t=e.height/e.width*60;return u.css("margin-top",(80-t)/2)})}c.div("plugin-display",h,t.display());if(!t.is_testing()&&t.published_date()>Date.now()-864e6){c.div("mention-new",h,"NEW")}else if(t.is_testing()){c.div("mention-new testing",h,"TESTING")}if(!t.is_testing()){if(t.price()>0){c.div("plugin-price",h,"$"+t.price()+"/month")}else{c.div("plugin-price",h,"Free")}}if(t.description().length>170){s=t.description().slice(0,165)+"..."}else{s=t.description()}c.div("plugin-description",h,s);o=c.img("plugin-creator-icon",h,t.creator_icon());if(t.creator_url()){h.append($('<a class="plugin-creator" href="'+t.creator_url()+'" target="_blank">'+"By "+t.creator_name()+"</a>"))}else{c.div("plugin-creator",h,"By "+t.creator_name())}if(!t.is_testing()){if(t.count()){c.div("plugin-count",p,c.add_thousand_sep(t.count())+" "+i("use_this_plugin"))}g=function(e){return parseFloat(Math.round(e*10)/10).toFixed(1)};if(t.all_versions_rating()!=null){c.div("plugin-all-version-rating",p,"All versions "+g(t.all_versions_rating())+"/5.0")}if(t.last_version_rating()!=null){c.div("plugin-last-version-rating",p,"Current version "+g(t.last_version_rating())+"/5.0")}if(t.plugin_page_url()){d='<a class="plugin-link" href="'+t.plugin_page_url()+'" target="_blank"">Plugin page</a>';p.append(d)}}n=c.div("plugin-add btn bubble-ui grey submit-button",p);c.autorun(function(){if(a.has_plugin(e)){n.addClass("selected");if(t.price()>0){return n.text("Unsubscribe")}else{return n.text(i("uninstall"))}}else{n.removeClass("selected");if(t.price()>0){if(!a.app_plan(true).can_buy_plugins){n.addClass("disabled")}return n.text("Subscribe")}else{return n.text(i("install"))}}});n.on("vclick",function(){var i;if(n.hasClass("disabled")){return}if(a.has_plugin(e)){if(t.price()>0){l.modify_app_plan({data:{plugin_id:e,remove_plugin:true},no_card_needed:true,message:"Are you sure you want to unsubscribe from this plugin? The application may impact your application's behavior.",cb:function(){r().plugin_editor.plugin_canvas.change_current_plugin(e);a.remove_plugin(e);return _=null}})}else{a.remove_plugin(e);_=null}}else{if(t.is_testing()){i="current"}else{i=t.latest_version()}if(t.price()>0){l.modify_app_plan({data:{plugin_id:e},message:a.app_plan(true).paid_plugin_free?"You can add this plugin for free as the app is on the Agency plan. Keep in mind the customer will have to subscribe to the plugin when the site is transfered.":"Are you sure you want to subscribe to this plugin? The current month will be prorated and you will be charged $"+t.price()+" per month afterwards. Note that installing and uninstalling the plugin will not lead to a full-month charge.",checkout_caption:"Subscribing to a plugin",cb:function(){a.install_plugin(e,i);return _=e}})}else{a.install_plugin(e,i);_=e}}return m.update_scrollbars()});return p};e.prototype.create_footer=function(){var e,t,n=this;t=c.div("bottom-stripe");e=c.div("btn bubble-ui submit-button",t);e.on("vclick",function(){return n.hide()});e.text(i("done"));return t};e.prototype.update_scrollbars=function(){var e;e=$(window).height()-250;this.plugins_pane.css("height",e);return this.filter_area.css("height",e-51)};return e}();u=e("./../lang/plugins");f=e("./../util");a=e("./../lang/appquery");l=e("./subscription");r=e("./../lib");s=e("./../client_config")}).call(this)},{"./../client_config":16,"./../lang/appquery":51,"./../lang/plugins":60,"./../lib":65,"./../u":72,"./../util":74,"./editor_language":37,"./subscription":39}],36:[function(e,t,n){(function(){var t,r;t=n;r=e("./../u");r.safe_register("./editor/css",t);t.MAINWINDOW=".mainwindow";t.MAIN_TABS=".main-tab-bar";t.MAIN_TABS_TAB=t.MAIN_TABS+" .tab";t.VISUAL_TAB=t.MAIN_TABS+" .tabs-1";t.WORKFLOW_TAB=t.MAIN_TABS+" .tabs-2";t.DATA_TAB=t.MAIN_TABS+" .tabs-3";t.STYLES_TAB=t.MAIN_TABS+" .tabs-4";t.PLUGIN_TAB=t.MAIN_TABS+" .tabs-5";t.SETTINGS_TAB=t.MAIN_TABS+" .tabs-6";t.LOGS_TAB=t.MAIN_TABS+" .tabs-7";t.TEMPLATE_CANVAS=t.MAIN_TABS+" .tabs-8";t.VISUAL_CANVAS=".tabcanvas.tabs-1";t.ACTION_CANVAS=".tabcanvas.tabs-2";t.DATA_CANVAS=".tabcanvas.tabs-3";t.STYLES_CANVAS=".tabcanvas.tabs-4";t.PLUGIN_CANVAS=".tabcanvas.tabs-5";t.SETTINGS_CANVAS=".tabcanvas.tabs-6";t.LOGS_CANVAS=".tabcanvas.tabs-7";t.TEMPLATE_CANVAS=".tabcanvas.tabs-8";t.GENERAL_CANVAS=".tabcanvas.tabs-1.general";t.SHAREDTECH_CANVAS=".tabcanvas.tabs-2.sharedtech";t.API_CANVAS=".tabcanvas.tabs-3.api";t.ELEMENTS_CANVAS=".tabcanvas.tabs-4.elements";t.ACTIONS_CANVAS=".tabcanvas.tabs-5.actions";t.VERSIONS_CANVAS=".tabcanvas.tabs-6.versions";t.STATS_CANVAS=".tabcanvas.tabs-7.stats";t.PROPERTY_EDITOR=".property-editor-2";t.APPEARANCE=".tab-1";t.CONDITIONAL=".tab-2";t.TRANSITIONS=".tab-3";t.SLIDABLE_PALETTE=".slidable-palette";t.FEEDBACK_WINDOW=".feedback-window";t.DEDICATED_PALETTE=".dedicated-palette";t.SEARCH_PALETTE=".search-palette";t.IMAGE_EDITOR_PALETTE=".image-editor-palette";t.CONTEXTUAL_VIDEO_PALETTE=".contextual-video-palette";t.PROP_NAME="prop_name";t.PROP_ROW=".row";t.PROP_NAME_SELECTOR=function(e){return t.PROP_ROW+"["+t.PROP_NAME+'="'+e+'"]'};t.HIGHLIGHT_BOX=".highlight-box";t.SPOT=".spot"}).call(this)},{"./../u":72}],37:[function(e,t,n){(function(){var t,r;r=e("./../u");t=n;r.safe_register("./editor/editor_language",t);t.data={};t.get_text=function(e,n){var i;i=r.extract_from_object(t.data,e.split("."));if(!i&&!n){r.warn("Missing editor language "+e)}return i}}).call(this)},{"./../u":72}],38:[function(e,t,n){(function(){var t,r,i,o=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};i=n;i.calculate_lines=function(e){var n,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,$,K,J,X,Z,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,fe;A={elements:{},boxes:{},lines:[]};b=A.elements;u=A.boxes;I=A.lines;d=e.elements();f=[];for(U=0,V=d.length;U<V;U++){c=d[U];if(c.exists()&&c.added_to_container()){k=(te=c.get_height())!=null?te:0;E=(ne=c.get_top())!=null?ne:0;S=(ie=c.get_left())!=null?ie:0;M=(oe=c.get_width())!=null?oe:0;T=(ae=c.get_zindex())!=null?ae:0;R=(se=c.get_min_width())!=null?se:0;P=c.get_max_width();if(R>M){R=M}if(P&&P<M){P=M}x=c.id();f.push(x);B=[];z=[];b[x]={ih:k,it:E,il:S,iw:M,iz:T,mw:R,maxw:P,pushes:B,pushed_by:z};N=c.responsive_show();if(N!=null){b[x].rsw=c.responsive_show_width();if(b[x].rsw){b[x].rs=N}}if(c.get_static_property("wrap_to_previous")){b[x].wtp=true}}}if(f.length===0){return A}f.sort(function(e,t){return b[e].it-b[t].it});h=function(e,t){var n;n={top:b[e].it,top_margin:b[e].it-t,bottom:b[e].it+b[e].ih,contains:[e],boxes:[],topmost:e};I.push(n);return n};w=f[0];m=h(w,0);ue=f.slice(1);for(F=0,Y=ue.length;F<Y;F++){x=ue[F];if(b[x].it<m.bottom){m.contains.push(x);m.bottom=Math.max(m.bottom,b[x].it+b[x].ih)}else{m=h(x,m.bottom)}}n=function(e,t){e.contains.push(t);b[t].box=e.box_id;if(b[t].il+b[t].iw>e.right){e.right=b[t].il+b[t].iw;e.rightmost=t}return e.min_bottom=Math.max(e.min_bottom,b[t].it+b[t].ih)};r=0;for(O=W=0,H=I.length;W<H;O=++W){D=I[O];p=function(e,i){var o,a,s,l;s=u[r]={box_id:r,top:D.top,bottom:D.bottom,min_bottom:b[e].it+b[e].ih,left:b[e].il,left_margin:b[e].il-i,right:0,contains:[],first:e,line_idx:O,rightmost:e,leftmost:e};n(s,e);D.boxes.push(r);r++;a=t.element(e);s.collapse_margin=(l=a.get_static_property("collapse_margin"))!=null?l:null;o=a.get_static_property("responsive_alignment");if(o==="left"||o==="right"){s.align=o}return s};D.contains.sort(function(e,t){return b[e].il-b[t].il});w=D.contains[0];g=p(w,0);le=D.contains.slice(1);for(G=0,$=le.length;G<$;G++){x=le[G];if(b[x].il<g.right){n(g,x)}else{g=p(x,g.right)}}D.boxes_length=D.boxes.length;ce=D.boxes;for(s=Z=0,K=ce.length;Z<K;s=++Z){a=ce[s];o=u[a];fe=o.contains;for(Q=0,J=fe.length;Q<J;Q++){x=fe[Q];b[x].it-=o.top;b[x].il-=o.left}o.contains.sort(function(e,t){return b[e].it-b[t].it});j={};j[o.contains[0]]=true;re=o.contains.slice(1);for(ee=0,X=re.length;ee<X;ee++){x=re[ee];B={};i={};_=function(e){if(b[x].it<b[e].it+b[e].ih/2){return false}return b[x].il+b[x].iw>=b[e].il&&b[x].il<=b[e].il+b[e].iw};L=function(){var e;e=[];for(C in j){q=j[C];e.push(C);
}return e}();l=function(e){var t,n,r,o,a,s,u,f;s=b[e].pushes;for(o=0,n=s.length;o<n;o++){c=s[o];if(i[c]==null&&B[c]==null){l(c)}if(B[c]||i[c]){i[e]=true;return}}B[e]=_(e);if(!B[e]){u=b[e].pushed_by;f=[];for(a=0,r=u.length;a<r;a++){t=u[a];f.push(L.push(t))}return f}};while(L[0]!=null){y=L.shift();if(i[y]==null&&B[y]==null){l(y)}}for(y in B){v=B[y];if(v){b[y].pushes.push(x);b[x].pushed_by.push(y);delete j[y]}}j[x]=true}o.bottoms=function(){var e;e=[];for(C in j){q=j[C];e.push(C)}return e}();o.ih=o.bottom-o.top;o.iw=o.right-o.left;o.line_gap=o.bottom-o.min_bottom;if(s===D.boxes.length-1){o.right_margin=e.get_container_width()-o.right}delete o.bottom;delete o.top;delete o.left;delete o.right;delete o.min_bottom}delete D.contains}A.lines_length=I.length;return A};i.build_push_tree=function(e,t){var n,i,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,$,K,J,X,Z,Q,ee,te,ne;y={};P={};l=e.elements();u=[];for(N=0,F=l.length;N<F;N++){s=l[N];if(s.exists()&&s.added_to_container()){m=($=s.get_height())!=null?$:0;b=(K=s.get_top())!=null?K:0;v=(J=s.get_left())!=null?J:0;w=(X=s.get_width())!=null?X:0;x=(Z=s.get_zindex())!=null?Z:0;T=[];E=[];g=s.id();u.push(g);y[g]={ih:m,it:b,il:v,iw:w,iz:x,pushes:T,pushed_by:E};P[g]={min_x:v,max_x:v+w}}}i=function(){var e,n,r,i,o,a,s,l,c;e=0;l=t!=null?t:{};for(r=i=0,a=l.length;i<a;r=++i){g=l[r];e++;c=["ih","it","il","iw","iz"];for(o=0,s=c.length;o<s;o++){n=c[o];if(t[g][n]!==y[g][n]){return true}}}if(e!==u.length){return true}return false}();if(!i){return null}u.sort(function(e,t){return y[e].it-y[t].it});S={};S[u[0]]=true;Q=u.slice(1);for(L=0,W=Q.length;L<W;L++){g=Q[L];T={};n={};c=function(e){if(y[g].it<y[e].it+y[e].ih/2){return false}return y[g].il+y[g].iw>=y[e].il&&y[g].il<=y[e].il+y[e].iw};A=function(e){return y[g].il+y[g].iw>=P[e].min_x&&y[g].il<=P[e].max_x};R=function(){var e;e=[];for(k in S){z=S[k];e.push(k)}return e}();a=function(e){var t,r,i,o,u,l,f,d;l=y[e].pushes;for(r=0,o=l.length;r<o;r++){s=l[r];if(n[s]==null&&T[s]==null){a(s)}if(T[s]||n[s]){n[e]=true;return}}T[e]=c(e);if(!T[e]){f=y[e].pushed_by;d=[];for(i=0,u=f.length;i<u;i++){t=f[i];if(A(t)){d.push(R.push(t))}else{d.push(void 0)}}return d}};while(R[0]!=null){d=R.shift();if(n[d]==null&&T[d]==null){a(d)}}for(d in T){f=T[d];if(f){y[d].pushes.push(g);y[g].pushed_by.push(d);delete S[d];P[g].min_x=Math.min(P[g].min_x,P[d].min_x);P[g].max_x=Math.max(P[g].max_x,P[d].max_x)}}S[g]=true}if(o.call(e.E.get_private_messages(),"movement_in_stripe")>=0){O=(ee=typeof(B=r.get_stripes(e)).raw==="function"?B.raw():void 0)!=null?ee:[];if(O.length){D=0;I=[];for(h=q=0,G=O.length;q<G;h=++q){j=O[h];if(j.floating===true&&j.floating_reference!=="top"){I.push({})}else{I.push({top:D,height:j.stripe_height});D+=j.stripe_height}}p={};for(g in y){_=y[g];for(h=U=0,V=I.length;U<V;h=++U){j=I[h];if(!j.top===void 0){continue}if(j.top<=(te=_.it+_.ih)&&te<j.top+j.height){p[g]=h}}}for(g in y){_=y[g];C=true;ne=_.pushes;for(H=0,Y=ne.length;H<Y;H++){M=ne[H];if(p[M]===p[g]){C=false;break}}if(C){_.pushes_stripe=p[g]}}}}y.container_bottoms=function(){var e;e=[];for(k in S){z=S[k];e.push(k)}return e}();return y};r=e("./../core/core_elements");t=e("./../lang/appquery")}).call(this)},{"./../core/core_elements":19,"./../lang/appquery":51}],39:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c;u=n;l=e("./../u");r=e("./../lang/appquery");i=e("./../client_config");u.send_to_plan=function(){$(".tab.tabs-6").click();return t().settings_editor.settings_canvas.open_tab("Plan")};u.add_mention=function(e,t,n){var i;i=l.div("explanation need-to-subscribe warning-icon bubble-ui clickable",t);i.on("vclick",u.send_to_plan);l.autorun(function(){var t;if(typeof e==="function"){t=e()}else{t=!r.app_plan(true)[e]}if(t){return i.html(n+" Click here to get to the Plan tab and adjust your application plan.")}else{return i.hide()}});return i};if(typeof window!=="undefined"&&window!==null){if((c=window.meta_keys)!=null?c.stripe_public_key:void 0){s=window.StripeCheckout.configure({key:window.meta_keys.stripe_public_key,name:"Bubble",locale:"auto",zipCode:true,billingAddress:false,image:"http://s3.amazonaws.com/appforest_uf/f1445491137863x121037015924230220/apple_touch_icon_180x180.png"})}}u.modify_app_plan=function(e){var n,u,c,f,d;c=e.data,f=e.message,u=e.checkout_caption,d=e.no_card_needed,n=e.cb;c.appname=r.appname();return l.run_once(30,function(){var e,n,a;if(d||!i.plugins_live_here){return"no_need_card"}n=r.app_plan(true);if(n.paying_user_id===t().current_user()._id()||!n.paying_user_id){if(((a=n.card_data)!=null?a.last4:void 0)==null){return"need_card"}else{return"no_need_card"}}else if(t().current_user_rights().admin){if(c.transfer){e=o.services.stripe.get_call("GetStripeCard").execute(t().current_user(),{force_edit_mode:true});if((e!=null?e.last4:void 0)==null){return"need_card"}else{return"no_need_card"}}else{return"no_need_card"}}else{return"impossible"}},function(e,i){var o;if(e||i==="impossible"){l.warn(e);window.MessagePanel({title:u,message:"There was an issue subscribing you to a plan, please try again."})}o=function(e){a.show_general_message_immediate("We are updating your subscription...");if(e!=null){c.token=e.id}return t().location.post("server://appeditor/subscribe_app_plan",c,function(e,t){a.hide_general_message();r.invalidate_app_plan();if(e){window.MessagePanel({title:u,message:e.message});return}if(typeof n==="function"){n()}window.MessagePanel({title:u,message:c.transfer?"The subscription was sucessfully transfered to your account.":"Your application's subscription has been successfully updated."});if(c.transfer){return mixpanel.track("User transferred app",{app:c.appname})}else{return mixpanel.track("User subscribed to plan",{app:c.appname,plan:c.plan,adjust_capacity:c.adjust_capacity})}})};if(i==="need_card"){return s.open({description:u,currency:"USD",panelLabel:"Subscribe",email:t().current_user().get_email(),token:function(e){return o(e)}})}else if(f){return window.ConfirmPanel({title:u,message:f,cb_yes:function(){return o()}})}else{return o()}})};t=e("./../lib");a=e("./../core/status_bar");o=e("./../services")}).call(this)},{"./../client_config":16,"./../core/status_bar":25,"./../lang/appquery":51,"./../lib":65,"./../services":70,"./../u":72}],40:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,$,K,J,X,Z,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,fe,de,_e,pe,he,ge,me,ve,ye,be,we,xe,ke,Se,Ae,Ee,Me,Te,Ce,je,De,Oe,Ie=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1},Pe={}.hasOwnProperty,Re=function(e,t){for(var n in t){if(Pe.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e},ze=function(e,t){return function(){return e.apply(t,arguments)}};V=n;se=e("./u");se.safe_register("./external",V);V.methods={get:"GET",post:"POST",put:"PUT",patch:"PATCH",delete_method:"DELETE"};V.method_uses_body=function(e){var t;return(t=e!=null?e.toUpperCase():void 0)==="PUT"||t==="PATCH"||t==="POST"};he={};me={};ge={};q={};L=function(e,t,n){var r,i,o;i=function(t){var r;if(n.fields){r=n.fields(t)}else{r=ae.add_fields_from_parameters(n.parameters,[])}ae.add_key_button(e,r);return r};r={display:function(e){return n.human},category:(o=n.category)!=null?o:"plugins",fields:i,field_names:K.DETECT_FIELD_NAMES,data_to_refresh:null,return_value:function(){return n.get_value_id()},get_doc_link:function(){return n.get_doc_link()},call:n};if(n.must_proxy()){r.run=function(e,t,r,i){return r.get_server_outcome(e,function(e,t){var r;if(e){return i(e)}else{if(typeof(r=ue.get(n.value_id).V).notify_server_action==="function"){r.notify_server_action(t,n)}return i(null,t)}})};r.server_method="external_call_server_action"}else{throw se.error("action.run for external action run from the client not built yet!!!")}return r};l=function(){function e(e,t){this.id=e;this.data=t}e.prototype._raw=function(){if(!this.data){se.logger().warn("missing element plugin data for "+this.id);return null}return this.data};e.prototype.display=function(){var e,t;return(e=(t=this._raw())!=null?t.display:void 0)!=null?e:"missing element plugin data for "+this.id};e.prototype.category=function(){var e,t;return(e=(t=this._raw())!=null?t.category:void 0)!=null?e:"missing element plugin data for "+this.id};e.prototype.icon=function(){var e,t;return(e=(t=this._raw())!=null?t.icon:void 0)!=null?e:"missing element plugin data for "+this.id};e.prototype.name=function(){var e;return(e=this._raw())!=null?e.plugin_name:void 0};return e}();V.Service=x=function(){function e(){}e.prototype.display=function(){return this.human};e.prototype.toUniqueString=function(){return"service_"+this.name+"_"+this.version};e.prototype.get_authenticator=function(e,t){if(typeof this.authenticator==="function"){return this.authenticator(e,t)}else{return this.authenticator}};e.prototype.get_key=function(e){var t,n,r,i;t=this.get_keys();if(!t[e]){throw se.error({statusCode:403,message:"could not find key "+e+" for service "+this.name+" / "+this.human})}n=I.app_version()==="test"||R.env!==R.PROD_ENV;if(t[e].type==="client_safe"){if(n){return(r=I.app().get_public_setting(this.name+"_"+e+"_test"))!=null?r:I.app().get_public_setting(this.name+"_"+e)}else{return I.app().get_public_setting(this.name+"_"+e)}}else{if(n){return(i=I.app().get_private_setting(this.name+"_"+e+"_test"))!=null?i:I.app().get_private_setting(this.name+"_"+e)}else{return I.app().get_private_setting(this.name+"_"+e)}}};e.prototype.get_keys=function(){return this._get_raw_list("keys")};e.prototype.get_keys_for_editor=function(){var e,t,n,r;t=se.extend({},this.get_keys());if(this.name!=="stripe"){for(e in t){n=t[e];if(!((r=n.editor)===null||r===void 0||r==="MultilineTextBox")){continue}t[e+"_test"]=se.extend({},n);t[e+"_test"].caption=n.caption+" - dev."}}return t};e.prototype.has_keys=function(){var e,t,n;n=this.get_keys();for(e in n){t=n[e];return true}return false};e.prototype.get_public_key=function(){return this.get_key("appid")};e.prototype.get_secret_key=function(){return this.get_key("appsecret")};e.prototype.are_keys_missing=function(){var e,t,n,r,i;e=this.get_authenticator();if(e.are_keys_missing!=null){return e.are_keys_missing()}i=this.get_keys();for(r in i){t=i[r];if(!(t.editor!=="Checkbox")){continue}if(t.type==="secure"){n=I.get_private_setting(this.name+"_"+r)}else{n=I.get_public_setting(this.name+"_"+r)}if(!n&&!t.optional){return true}}};e.prototype.has_custom_settings=function(){return this.get_settings_panel!=null};e.prototype.has_html_header=function(){return this.html_header!=null};e.prototype._get_raw_list=function(e){if(typeof this[e]==="function"){return this[e]()}else{return this[e]}};e.prototype.get_values=function(){var e,t,n;n=this._get_raw_list("values");for(t in n){e=n[t];e.name=t;e.full_name="api."+this.name+"."+t;e._service=this}return n};e.prototype.get_call_class=function(e){return this._get_raw_list("calls")[e]};e.prototype.get_calls=function(){var e,t,n,r;n=this._get_raw_list("calls");r=[];for(e in n){t=n[e];r.push(e)}return r};e.prototype.get_call=function(e){return this._intanciate_call(e,this.get_call_class(e))};e.prototype._intanciate_call=function(e,t){var n,r,i;if(typeof t!=="function"){if(this.dynamic_calls){return}else{if(d().is_edit_mode()){se.warn("call "+e+" on "+this.name+" is not a class");return}else{throw se.error({statusCode:400,message:"The call "+e+" on "+((i=this.display())!=null?i:this.name)+" is not defined"})}}}n=new t(this);r=this.name+ae.PLUGIN_SEPERATOR+e;n.name=e;n.full_name=r;n.service_name=this.name;return n};e.prototype.get_actions=function(){var e,t,n,r,i,o,a,s;t=[];s=this.get_action_calls();for(o=0,a=s.length;o<a;o++){n=s[o];t.push(this.name+ae.PLUGIN_SEPERATOR+n)}r=this._get_raw_list("actions");for(e in r){i=r[e];t.push(this.name+ae.PLUGIN_SEPERATOR+e)}return t};e.prototype.get_action=function(e){var t,n,r,i,o,a,s,u=this;a=ae.get_service_and_type(e),o=a[0],n=a[1];i=this._get_raw_list("actions");if(i!=null?i[n]:void 0){t=i[n];if(t.fields==null){t.fields=function(e){var n;n=t._fields(e);ae.add_key_button(u.name,n);return n}}}else{if((s=Ie.call(this.get_calls(),n)>=0)!=null?s:[]){r=this.get_call(n);t=L(this.name,n,r)}}if(!t){return null}t.is_plugin=true;t.service=this.name;if(t.category==null){t.category="plugins"}return t};e.prototype.get_events=function(){var e,t,n;t=this._get_raw_list("events");return function(){var r;r=[];for(e in t){n=t[e];r.push(e)}return r}()};e.prototype.get_event=function(e){var t,n,r,i,o;if(!q[e]){o=ae.get_service_and_type(e),i=o[0],n=o[1];r=this._get_raw_list("events");t=r[n];if(!t){return null}if(t.element_name){B.make_element_event(e,t,true)}else{throw se.error("Trying to implement a non element event in a service - not supported yet")}t.is_plugin=true;t.service=this.name;q[e]=t}return q[e]};e.prototype.get_elements_visual_edit=function(){var e,t,n,r;n=this.get_elements();r=[];for(t in n){e=n[t];r.push(new l(t,e))}return r};e.prototype.get_elements=function(){var e,t,n,r,i;i=this._get_raw_list("elements");n={};for(t in i){e=i[t];r=this.name+ae.PLUGIN_SEPERATOR+t;e.plugin_name=r;n[r]=e}return n};e.prototype.get_element=function(e){var t,n,r,i,o,a,s,u;if(!q[e]){s=ae.get_service_and_type(e),a=s[0],n=s[1];r=this._get_raw_list("elements");t=r!=null?r[n]:void 0;if(!t){return null}t.is_plugin=true;t.service=this.name;z.make_element(e,t,true);u=t.field_names;for(o in u){i=u[o];if(i.in_style){G.style_properties[o]=true}}q[e]=t}return q[e]};e.prototype.get_public_values=function(){var e,t,n,r,i,o;t=this._get_raw_list("public_values");e=this.get_values();o=t!=null?t:[];for(r=0,i=o.length;r<i;r++){n=o[r];if(!e[n]){throw se.error("Could not find value "+n+" in "+this.name)}}return t!=null?t:[]};e.prototype.get_public_calls=function(){var e;e=this._get_raw_list("public_calls");return e!=null?e:[]};e.prototype.get_user_calls=function(){var e;e=this._get_raw_list("user_calls");return e!=null?e:[]};e.prototype.get_action_calls=function(){var e;e=this._get_raw_list("action_calls");return e!=null?e:[]};e.prototype.get_server_actions=function(){var e;return(e=this.server_actions)!=null?e:[]};e.prototype.get_oauth_providers=function(){var e;return(e=this._get_raw_list("oauth_providers"))!=null?e:[]};e.prototype.get_oauth_providers_simple=function(){var e,t,n,r,i,o;r=this.get_oauth_providers();o=[];for(t=0,n=r.length;t<n;t++){e=r[t];o.push((i=e.id)!=null?i:e)}return o};e.prototype.is_oauth_provider=function(){return this.get_oauth_providers().length>0};e.prototype.is_storage_provider=function(){return this.file_upload!=null};e.prototype.is_video_service=function(){return this._is_video_service};e.prototype.response_to_data=function(e,t,n,r){var i,o,a,s,u,l,c,f,d,_,p,h,g,m,v;d=e.path,h=e.url,p=e.uri,l=e.method,i=e.data,a=e.form,u=e.json,s=e.headers;if(n==null){n="json"}if(t.statusCode<200||t.statusCode>299||this.errors_on_200){f=typeof this.get_error_message==="function"?this.get_error_message(t,r):void 0;if(f){throw se.error({statusCode:400,message:f})}else if(!this.errors_on_200){if(this.not_production_critical&&F.is_retryable(null,t)){throw X(this.display(),t.statusCode+": "+t.body)}c="Error connecting to "+((g=this.display())!=null?g:this.name)+" ("+t.statusCode+")";i={body:t.body.slice(0,1e4),path:d,method:l,data:i,url:h,uri:p,headers:s};throw se.error(c,i)}}if(!t.body){return null}if((m=n.toLowerCase())!=="json"&&m!=="querystring"&&m!=="raw"){throw se.error("unrecognized data_type:"+n)}try{se.optional_pause("about to parse api response");_=function(){switch(n.toLowerCase()){case"json":return se.incremental_json_parse(t.body);case"querystring":return ne.parse(t.body);case"raw":return t.body}}();se.optional_pause("finished parsing api response");return _}catch(y){o=y;throw se.error({statusCode:400,message:"Error parsing data from "+((v=this.display())!=null?v:this.name)+": "+t.body.slice(0,1e4)})}};return e}();Q={access_type:true,scope:true,data_type:true,prompt:true,additional_query_url_to_delete:true,add_to_url:true,add_to_header:true,header_key:true,expires_in:true,add_basic_authentication:true,key_prefix:true,grant_type:true,use_cliend_id_secret:true,use_username_password:true,expiration_calc_fn:true};V.Authenticator=r=function(){function e(e){this.params=e}e.prototype.id=function(){return this.service_name()};e.prototype.get_property=function(e,t){var n,r,i;n=(r=(i=this.params)!=null?i[e]:void 0)!=null?r:this.service()[e];if(!n&&!Q[e]){if(t){return null}throw se.error("could not find property "+e+" for authenticator of service "+this.id()+", and property "+e+" is not set as optional")}if(typeof n==="function"){n=n(this)}return n};e.prototype.display=function(){var e;return(e=this._display)!=null?e:te.get_plugin(this.service_name()).display()};e.prototype.service=function(){if(!this._service){throw se.error("this authenticator doesnt have @_service set.  should set it in add_service in services.coffee")}return this._service};e.prototype.service_name=function(){return this.service().name};e.prototype.edit_mode_login=function(){return false};e.prototype.get_key=function(e){return this.service().get_key(e)};e.prototype.get_public_key=function(){return this.service().get_public_key()};e.prototype.get_secret_key=function(){return this.service().get_secret_key()};e.prototype.get_user_authentication_node=function(e){return e.child("authentication").child(this.id())};e.prototype.get_service_id=function(e){return this.get_user_authentication_node(e).child("id").get()};e.prototype.are_keys_missing=function(){var e,t,n,r;r=this.service().get_keys();for(n in r){e=r[n];if(!(e.editor!=="Checkbox")){continue}if(e.type==="secure"){t=I.get_private_setting(this.service().name+"_"+n)}else{t=I.get_public_setting(this.service().name+"_"+n)}if(!t&&!e.optional){return true}}};return e}();V.NoAuth=_=function(e){Re(t,e);function t(){be=t.__super__.constructor.apply(this,arguments);return be}t.prototype.must_proxy=function(){return false};t.prototype.add_authentication=function(e){return e};t.prototype.is_authenticated=function(){return true};return t}(r);V.PrivateKey=b=function(e){Re(t,e);function t(){we=t.__super__.constructor.apply(this,arguments);return we}t.prototype.must_proxy=function(){return true};t.prototype.add_authentication=function(e,t){if(t==null){t=this.get_secret_key()}if(this.params.key_prefix){t=this.params.key_prefix+t}if(!this.params.token_param_name){throw se.error("PrivateKey authenticator missing token_param_name")}if(this.params.add_to_url){if(e.url[e.url.length-1]!=="?"){e.url+="?"}e.url+=this.params.token_param_name+"="+t}else if(this.params.add_to_header){if(e.headers==null){e.headers={}}e.headers[this.params.token_param_name]=t}else{if(e.data==null){e.data={}}e.data[this.params.token_param_name]=t}return e};t.prototype.is_authenticated=function(){return true};return t}(r);V.PLUGIN_OAUTH_REDIRECT="sys/pluginoauth";V.EditModeOauth2=u=function(e){Re(t,e);function t(){Se=t.__super__.constructor.apply(this,arguments);return Se}t.prototype.must_proxy=function(){return true};t.prototype._get_access_token=function(){return this.service().get_key("access_token")};t.prototype.are_keys_missing=function(){return!(this._get_access_token()!=null||this.get_secret_key()!=null)};t.prototype.is_authenticated=function(){return true};t.prototype.add_authentication=function(e){var t,n;if(e.data==null){e.data={}}t=(n=this._get_access_token())!=null?n:this.get_secret_key();if(t!=null){if(this.params.add_to_url){if(e.url[e.url.length-1]!=="?"){e.url+="?"}e.url+=this.get_property("token_param_name")+"="+t;if(this.get_property("additional_url_param")){e.url+="&"+this.get_property("additional_url_param")}}else{e.data[this.get_property("token_param_name")]=t}}else{e.dont_do_call=true;e.message="The authentication for "+this.service().display()+" is missing, please authenticate in the Editor."}return e};t.prototype.get_call_back_name=function(){return this.service_name()+"OauthComplete"};t.prototype.get_redirect_url=function(){return d().location.get_base_for_meta()+"/api/1.1/"+V.PLUGIN_OAUTH_REDIRECT+"?provider="+this.service_name()};t.prototype.edit_mode_login=function(){return true};t.prototype.login=function(){var e,t,n,r;t={client_id:R.public_plugin_keys[this.service_name()],redirect_uri:this.get_redirect_url(),response_type:"code"};n=this.get_property("meta_authentication_url");e=n+"?"+ne.stringify(t);window.open(e);r=this.service_name()+"_access_token";return window[this.get_call_back_name()]=function(e){return I.set_setting(false,r,e)}};t.prototype.get_access_token=function(e){var t,n,r,i;t={client_id:R.public_plugin_keys[this.service_name()],client_secret:R.private_plugin_keys[this.service_name()],grant_type:"authorization_code",redirect_uri:this.get_redirect_url(),code:e};n={method:"POST",url:this.get_property("meta_generate_token_from_code_uri"),form:t};r=d().http_request(n).block();i=this.service().response_to_data(n,r);if(!i.access_token){throw se.error("missing access_token getting data (Oauth2 edit mode)",{service_id:this.service_name(),result:i})}return i.access_token};t.prototype.get_html_save_token=function(e){return'<html><head><title>Bubble</title></head>\n    <body>\n        <script>\n            window.opener["'+this.get_call_back_name()+'"]("'+e+'");\n            window.close();\n        </script>\n    </body>\n</html>'};return t}(r);S=function(e,t,n){var r,i,o;if(!t){o=n.get_public_key();i=n.get_secret_key()}else{o=t.user;i=t.pw}r=se.base64(o+":"+i);if(e.headers==null){e.headers={}}return e.headers["Authorization"]="Basic "+r};V.BasicAuth=i=function(e){Re(t,e);function t(){Ae=t.__super__.constructor.apply(this,arguments);return Ae}t.prototype.must_proxy=function(){return true};t.prototype.add_authentication=function(e,t){S(e,t,this);return e};t.prototype.is_authenticated=function(){return true};return t}(r);Oe={};V.Salesforce=w=function(e){Re(t,e);function t(){Ee=t.__super__.constructor.apply(this,arguments);return Ee}t.prototype.must_proxy=function(){return true};t.prototype.get_token=function(){var e,t,n,r,i,o,a,s,u,l,c,f,_,p,h,g,m,v;l="_"+I.app_version();a={};g=["username","password","app_id","app_secret"];for(p=0,h=g.length;p<h;p++){s=g[p];o=s+l;a[s]=this.get_key(o);if(!a[s]){throw se.error({statusCode:400,message:"Sorry, it looks like this is app is missing a Salesforce credential: "+this.service().keys[o].caption})}}r=function(){var e;e=[];for(i in a){_=a[i];e.push(i+":"+_)}return e}().join(",");if(!Oe[r]||se.running_test()){if(I.app_version()==="live"){t=(m=this.get_key("login_domain_live"))!=null?m:"login.salesforce.com"}else{t=(v=this.get_key("login_domain_test"))!=null?v:"test.salesforce.com"}n="https://"+t+"/services/oauth2/token";e=ne.stringify({grant_type:"password",client_id:a.app_id,client_secret:a.app_secret,username:a.username,password:a.password});u={url:n,method:"POST",body:e,timeout:5e3,headers:{"Content-Type":"application/x-www-form-urlencoded"}};Oe[r]={promise:d().http_request(u),post_options:u};Oe[r].promise.callback(function(e,t){var n,i,o;if(!e){try{n=this.service().response_to_data(u,t);if(!n.access_token){e="access_token missing"}}catch(a){i=a;e=i}}o=e?5e3:5*60*1e3;return setTimeout(function(){return Oe[r]=null},o)})}c=Oe[r].promise.block();f=this.service().response_to_data(Oe[r].post_options,c);return f.access_token};t.prototype.add_authentication=function(e,t){var n;n=t!=null?t:this.get_token();if(e.headers==null){e.headers={}}e.headers.Authorization="Bearer "+n;return e};t.prototype.is_authenticated=function(){return true};return t}(r);pe={};V.BoxAuthentication=o=function(e){Re(t,e);function t(){Me=t.__super__.constructor.apply(this,arguments);return Me}t.prototype.must_proxy=function(){return true};t.prototype.build_token=function(e){var t,n,r,i,o,a,s,u,l,c,f;i=function(){var t;t=[];for(s in e){f=e[s];t.push(s+":"+f)}return t}().join(",");n=!e.user_id;if(!pe[i]||se.running_test()){o={typ:"JWT",alg:"RS256",kid:e.public_key_id};t={iss:e.apikey,sub:n?e.enterprise_id:e.user_id,box_sub_type:n?"enterprise":"user",aud:this.get_property("claims_aud"),jti:se.UUID(),exp:Math.floor(Date.now()/1e3+55)};a=A.generate_jws(o,t);r={client_id:e.appid,client_secret:e.appsecret,grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:a};u={method:"POST",url:this.get_property("generate_token_from_code_uri"),form:r};l=d().http_request(u).block();c=this.service().response_to_data(u,l);pe[i]=c.access_token;setTimeout(function(){return pe[i]=null},c.expires_in*1e3)}return pe[i]};t.prototype.get_token=function(){var e,t,n,r,i,o;t={};o=this.service().keys;for(n in o){i=o[n];t[n]=this.get_key(n);if(!t[n]&&n!=="user_id"){throw se.error({statusCode:400,message:"Sorry, it looks like this is app is missing a "+this.service().display()+" credential: "+this.service().keys[n].caption})}}if(!t.user_id){e=this.build_token(t);r=ae.services.box.get_call("create_user").execute(null,null,e).id;d().app().get_private_setting_node(this.service().name+"_user_id").json.set(r);t.user_id=r}return this.build_token(t)};t.prototype.add_authentication=function(e,t){var n;n=t!=null?t:this.get_token();if(e.headers==null){e.headers={}}e.headers.Authorization="Bearer "+n;return e};return t}(r);ye={};V.Oauth2PWFlow=m=function(e){Re(t,e);function t(){Te=t.__super__.constructor.apply(this,arguments);return Te}t.prototype.must_proxy=function(){return true};t.prototype.build_token_request=function(){var e,t,n,r;e={grant_type:this.get_property("grant_type")};n={client_secret:this.get_secret_key(),client_id:this.get_public_key()};if(this.get_property("use_cliend_id_secret")){e.client_id=n.client_id;e.client_secret=n.client_secret}if(this.get_property("use_username_password")){e.username=n.client_id;e.password=n.client_secret}t=this.get_property("generate_token_from_code_uri");r={method:"POST",url:t,form:e};if(typeof this.add_shared_params_and_headers==="function"){this.add_shared_params_and_headers(r)}return r};t.prototype.get_hash=function(){var e,t,n;t={client_secret:this.get_secret_key(),client_id:this.get_public_key()};return this.service_name()+"_"+function(){var r;r=[];for(e in t){n=t[e];r.push(e+":"+n)}return r}().join(",")};t.prototype.get_token=function(){var e,t,n,r,i,o,a,s,u;e=Date.now();n=this.get_hash();if(!((s=ye[n])!=null?s.expiration:void 0)||ye[n].expiration<e-3e5){r=this.build_token_request();t=this.get_property("data_type");i=d().http_request(r).block();o=this.service().response_to_data(r,i,t);if(!o.access_token){throw se.error("missing access_token getting data (Oauth2PWFlow)",{service_id:this.service_name(),result:o})}ye[n]={access_token:o.access_token,expiration:(u=typeof(a=this.get_property("expiration_calc_fn"))==="function"?a(o):void 0)!=null?u:e+o.expires_in}}return ye[n].access_token};t.prototype.add_authentication=function(e,t){var n;n=t!=null?t:this.get_token();if(e.headers==null){e.headers={}}e.headers.Authorization="Bearer "+n;return e};t.prototype.is_authenticated=function(){return true};return t}(r);V.Oauth2Custom=g=function(e){Re(t,e);function t(){Ce=t.__super__.constructor.apply(this,arguments);return Ce}t.prototype._get_token_request=function(){return this.service().get_call("token_call").build()};t.prototype.build_token_request=function(){var e;e=this._get_token_request();e.url=this.get_property("base_url")+e.path;delete e.path;if(typeof this.add_shared_params_and_headers==="function"){this.add_shared_params_and_headers(e)}return e};t.prototype.get_hash=function(){return this.service_name()+"_"+se.json_stringify(this.build_token_request())};return t}(m);V.JWT=f=function(e){Re(t,e);function t(){je=t.__super__.constructor.apply(this,arguments);return je}t.prototype.get_hash=function(){var e,t,n;t={iss:this.get_key("iss"),aud:this.get_property("generate_token_from_code_uri"),scope:this.get_property("scope")};return this.service_name()+"_"+function(){var r;r=[];for(e in t){n=t[e];r.push(e+":"+n)}return r}().join(",")};t.prototype.build_token_request=function(){var e,t,n,r,i,o;r=Math.round(Date.now()/1e3);n={typ:"JWT",alg:"RS256"};e={iss:this.get_key("iss"),scope:this.get_property("scope"),aud:this.get_property("generate_token_from_code_uri"),iat:r,exp:r+3600};i=$.sign({header:n,privateKey:this.get_key("private_key"),payload:JSON.stringify(e)});t={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:i};o={method:"POST",url:this.get_property("generate_token_from_code_uri"),form:t};return o};return t}(m);v=function(e){Re(t,e);function t(){De=t.__super__.constructor.apply(this,arguments);return De}t.prototype.get_oauth_user_data_call=function(){return this.service().get_call("oauth_user_data_call")};t.prototype.get_oauth_user_data=function(e){var t,n;t=this.get_token_data(e);n=this.get_oauth_user_data_call(e).execute(null,null,t);n.id=String(n.id);return se.extend({},n,t)};t.prototype.build_validity_request=function(e){return this.get_oauth_user_data_call().build_request(null,null,e)};t.prototype.is_still_valid=function(e){var t,n,r,i,o;i=this.build_validity_request(e);try{r=d().http_request(i).block();t=null}catch(a){t=a;r=null}if(r&&(200<=(o=r.statusCode)&&o<300)){return true}if(F.is_retryable(t,r)){if(t){n=se.nice_print_error(t)}else{n=r.statusCode+": "+r.body}se.warn("Temporarily unable to validate Oauth connection to "+this.service().display(),{reason:n},"warn");return true}return false};t.prototype._get_user_id=function(){return this.get_service_id(d().current_user())};t.prototype.tested=function(){return true};return t}(r);V.Oauth2=h=function(e){Re(t,e);function t(){xe=t.__super__.constructor.apply(this,arguments);return xe}t.prototype.oauth_version=function(){return"2"};t.prototype.must_proxy=function(){return false};t.prototype._get_access_token=function(){return this.get_user_authentication_node(d().current_user()).child("access_token").get()};t.prototype.is_authenticated=function(){return this._get_access_token()!=null&&this._get_user_id()!=null};t.prototype.add_authentication=function(e,t){var n,r,i,o,a,s=this;i=this.get_property("token_param_name");n=(o=t!=null?t.access_token:void 0)!=null?o:(a=e.data)!=null?a[i]:void 0;r=function(t){var n,r,o,a;if(s.get_property("add_to_url")){if(e.url.indexOf("?")!==-1){e.url+="&"}else{if(e.url[e.url.length-1]!=="?"){e.url+="?"}}e.url+=i+"="+t}else if(s.get_property("add_to_header")){if(e.headers==null){e.headers={}}n=s.get_property("header_key");if(n){a=n.split(":"),r=a[0],o=a[1];r=r.trim();if(o!=null){e.headers[r]=o.trim()+" "+t}else{e.headers[r]=t}}else{e.headers["Authorization"]="Bearer "+t}}else{if(e.data==null){e.data={}}e.data[i]=t}return e};if(n!=null){return r(n)}n=se.run_once(30,function(){return s._get_access_token()});return n.then(function(e){return r(e)})};t.prototype.login=function(e,t,n){var r,i,o,a,s,u,l,c,f,_;c=document.location.href;if(c[c.length-1]==="?"){c=c.slice(0,c.length-1)}if(n){u=J.parse(c);delete u.search;delete u.hash;delete u.query;c=J.format(u)}_=J.parse(document.location.href,true).query;_.oauth_provider=this.id();if(e&&t){_.resume_key=d().workflow.make_resume_key(e,t)}_.used_redirect_url=c;_=se.json_stringify(_);o={client_id:this.get_public_key(),redirect_uri:c,response_type:"code",state:_};s=this.get_property("expires_in");if(s){o.expires_in=s}r=this.get_property("access_type");if(r){o.access_type=r}l=this.get_property("prompt");if(l){o.prompt=l}f=this.get_property("scope");if(f){o.scope=f}a=this.get_property("authentication_url");if(a.indexOf("?")===-1){i=a+"?"+ne.stringify(o)}else{i=a+"&"+ne.stringify(o)}return d().workflow.wait_for_safe(e,function(){return document.location.href=i})};t.prototype.get_data_for_login=function(e){var t,n;return{oauth_provider:this.id(),code:(t=e.code)!=null?t:"",redirect_uri:(n=e.used_redirect_url)!=null?n:""}};t.prototype.get_token_data=function(e){var t,n,r,i,o,a,s,u,l,c,f;t=e.code,s=e.redirect_uri,f=e.temp_id;c=this.get_secret_key();a=this.get_public_key();r={client_id:a,client_secret:c,grant_type:"authorization_code",redirect_uri:s,code:t};i=this.get_property("generate_token_from_code_uri");o={method:"POST",url:i,form:r};if(this.get_property("add_basic_authentication")){
S(o,void 0,this)}n=this.get_property("data_type");if(typeof this.add_shared_params_and_headers==="function"){this.add_shared_params_and_headers(o)}u=d().http_request(o).block();l=this.service().response_to_data(o,u,n);if(!l.access_token){throw se.error("missing access_token getting data Oauth2",{service_id:this.id(),result:l})}return l};t.prototype.get_token_from_refresh=function(e){var t,n,r,i,o;n={client_id:this.get_public_key(),client_secret:this.get_secret_key(),grant_type:"refresh_token",refresh_token:e};r={method:"POST",url:this.get_property("generate_token_from_code_uri"),form:n};t=this.get_property("data_type");if(this.get_property("add_basic_authentication")){S(r,void 0,this)}if(typeof this.add_shared_params_and_headers==="function"){this.add_shared_params_and_headers(r)}i=d().http_request(r).block();o=this.service().response_to_data(r,i,t);if(!o.access_token){throw se.error("missing access_token getting data Oauth2 refresh token",{service_id:this.id(),result:o})}return o};t.prototype.generate_validity_object=function(e){return{access_token:e.access_token,refresh_token:e.refresh_token}};return t}(v);V.Oauth1=p=function(e){Re(t,e);function t(){ke=t.__super__.constructor.apply(this,arguments);return ke}t.prototype.oauth_version=function(){return"1"};t.prototype.must_proxy=function(){return true};t.prototype.get_oauth_user_data=function(e){var t,n;t=this.get_token_data(e);n=this.get_oauth_user_data_call().execute(null,t,t);n.id=String(n.id);return se.extend({},n,t)};t.prototype.requesttemporarycredentials=function(e){var t,n,r,i,o,a,s;r=J.parse(d().location.base_url,true);s=se.json_deep_copy(r.query);s.oauth_provider=this.id();s.run_id=e.run_id;delete r.search;delete r.hash;r.query=s;n=J.format(r);t={oauth_callback:n};i={url:this.get_property("request_token_url"),method:"POST",data:t};this.add_auth_header(i);o=d().http_request(i).block();a=this.service().response_to_data(i,o,this.get_property("data_type"));d().KeyValueDB().put("small",a.oauth_token,a.oauth_token_secret,60*60*24);return a.oauth_token};t.prototype.add_auth_header=function(e,t,n){var r,i;r=Z({consumer:{"public":I.app().get_public_setting(this.service_name()+"_appid"),secret:I.app().get_private_setting(this.service_name()+"_appsecret")},signature_method:"HMAC-SHA1"});if(n||t){i={secret:n,"public":t}}return e.headers=r.toHeader(r.authorize(e,i))};t.prototype.login=function(e,t,n){var r,i,o=this;r=this.get_property("authorize_url");i={};i[this.get_property("token_param_name")]=n;se.local_storage_put(e.run_id,d().workflow.make_resume_key(e,t));return d().workflow.wait_for_safe(e,function(){return document.location.href=r+"?"+ne.stringify(i)})};t.prototype.add_authentication=function(e,t){var n,r,i=this;if(e.headers){return e}r=t!=null?t.oauth_token_secret:void 0;n=t!=null?t.oauth_token:void 0;if(r!=null&&n!=null){this.add_auth_header(e,n,r);return e}r=se.run_once(30,function(){return{oauth_token_secret:i._get_oauth_token_secret(),oauth_token:i._get_oauth_token()}});return r.then(function(t){var n,r;r=t.oauth_token_secret,n=t.oauth_token;if(!r||!n){return e}i.add_auth_header(e,n,r);return e})};t.prototype.get_data_for_login=function(e){var t,n;return{oauth_provider:this.id(),oauth_token:(t=e.oauth_token)!=null?t:"",oauth_verifier:(n=e.oauth_verifier)!=null?n:""}};t.prototype.get_token_data=function(e){var t,n,r,i,o;t=this.get_property("access_token_url");n=this.get_property("data_type");r={url:t,method:"POST",data:e};this.add_auth_header(r,e.oauth_token,d().KeyValueDB().get("small",e.oauth_token));i=d().http_request(r).block();o=this.service().response_to_data(r,i,n);return o};t.prototype._get_oauth_token_secret=function(){return this.get_user_authentication_node(d().current_user()).child("oauth_token_secret").get()};t.prototype._get_oauth_token=function(){return this.get_user_authentication_node(d().current_user()).child("oauth_token").get()};t.prototype.is_authenticated=function(){return this._get_oauth_token()!=null&&this._get_oauth_token_secret()!=null&&this._get_user_id()!=null};t.prototype.generate_validity_object=function(e){return{oauth_token:e.oauth_token,oauth_token_secret:e.oauth_token_secret,provider_user_id:e.user_id}};t.prototype.build_validity_request=function(e){return this.get_oauth_user_data_call().build_request(null,{user_id:e.provider_user_id},e)};return t}(v);Y=function(e){var t,n,r,i,o,a,s,u;a=e.call.split("."),o=a[0],n=a[1];t=ae.get_service(o).get_call(n);r=(s=e.caption)!=null?s:se.toTitleCase(n);i={ret_value:t.get_value_id(),fn:V.make_call_fn(t)};if(typeof r==="function"){i.description=r}else{i.description="'s "+r}if(t.field_names){i.field_names=t.field_names;i.fields=t.fields;i.description_for_sliding_palette=(u=t.description_for_sliding_palette)!=null?u:t.human;i.spot_data="SlidableSpot"}return i};ie=function(e){var t;try{return se.json_stringify(e)}catch(n){t=n;return t}};V.ExternalValue=c=function(){function e(){}e.prototype._fields=function(){var e;if(typeof this.fields==="function"){return this.fields()}else{return(e=this.fields)!=null?e:{}}};e.prototype.flatten_raw=function(e){var t,n,r,i,o,a,s,u,l;if(!e){return{}}o={};t=0;s=this._fields();for(n in s){r=s[n];t++;if(t%5===0){se.optional_pause()}if(r.extract){a=r.extract(e)}else if(r.no_key){a=e}else{i=(u=r.path)!=null?u:[n];a=se.extract_from_object(e,i)}if(r.post_call_processing){a=r.post_call_processing(a)}if(r.cast_on_fetch&&a!=null){a=ue.get((l=r.ret_value)!=null?l:"text").cast(a)}if(a!=null){o[n]=a}}se.optional_pause("finished flatten raw");return o};e.prototype.get_message_names=function(){var e,t,n,r;n=this._fields();r=[];for(e in n){t=n[e];r.push(e)}return r};e.prototype.get_message=function(e){var t,n,r,i,o,a;r=this._fields()[e];if(!r){return}if(r.call){return Y(r)}else{n=(i=r.fn)!=null?i:this.lookup_fn(e);t=(o=r.caption)!=null?o:se.toTitleCase(e);return{description:"'s "+t,ret_value:(a=r.ret_value)!=null?a:"text",fn:n,fields:r.fields,field_names:r.field_names,spot_data:r.spot_data,description_for_sliding_palette:r.description_for_sliding_palette}}};return e}();V.StructValue=k=function(e){Re(t,e);function t(e,t,n){this.human=e;this.fields=t;if(n==null){n={}}if(!this.fields){this.fields={};this.no_extract=true}se.extend(this,n)}t.prototype.storable=true;t.prototype.bindable=true;t.prototype.display=function(){return this.human};t.prototype.editable=function(){return false};t.prototype.short_id=function(){return this.name};t.prototype.equals=function(e,t){return(e!=null?e._id():void 0)===(t!=null?t._id():void 0)};t.prototype.get_sample=function(){return new oe.SampleObject(this.full_name)};t.prototype.cast=function(e){if(typeof(e!=null?e.child:void 0)==="function"){return e}else{return null}};t.prototype.lookup_fn=function(e){return ue.lookup_fn(e)};t.prototype.extract=function(e){var t;if(this.no_extract){return e}t=this.flatten_raw(e);if(!t._id){t._id=se.incremental_json_digest(t)}return t};t.prototype.convert_to_bubble_instance=function(e){if(Array.isArray(e)){return new U.StaticList(e,void 0,this.full_name)}else if(e!=null&&typeof e==="object"){return new U.StaticObject(e,void 0,this.full_name)}else{return e}};return t}(c);s=2*60*1e3;ce={};de={};le=false;fe={};_e={};W=function(e,t){var n,r,i;for(n in t){i=t[n];r=e[n];if(r&&i&&typeof r==="function"&&typeof i==="function"){if(!W(r,i)){return false}}else{if(r!==i){return false}}}return true};ve=function(e){return _e[e]!=null?_e[e]:_e[e]=se.MakeSwitch(null,"api data loaded for "+e)};D=function(e,t,n,r){var i,o,a;if(n.partial){i=C(e,t);if(i&&!i.partial&&!i.err&&W(i.data,n.data)){return}}o=e+"_"+t;de[o]=r;ce[o]=n;if((a=fe[o])!=null){a.invalidate()}ve(o);if(n.partial){_e[o].turn_off()}else{_e[o].turn_on()}if(se.on_server()){if(!le){le=true;return setTimeout(E,s)}}};T=function(e,t){var n;C(e,t);n=e+"_"+t;ve(n);return se.ensure_ready(_e[n])};j=function(e,t){var n;n=e+"_"+t;ve(n);return _e[n]};M=function(e,t){var n,r,i;n=e+"_"+t;ce[n]=null;if((r=fe[n])!=null){r.invalidate()}return(i=_e[n])!=null?i.turn_off():void 0};E=function(){var e,t,n,r,i,o,a,s,u;le=false;n=Date.now();r={};o={};i={};a={};for(t in de){e=de[t];if(n<e){o[t]=e;r[t]=ce[t];i[t]=fe[t];a[t]=_e[t]}else{if((s=fe[t])!=null){s.invalidate()}if((u=_e[t])!=null){u.turn_on()}}}ce=r;de=o;fe=i;return _e=a};C=function(e,t){var n,r,i;n=e+"_"+t;r=ce[n];if(r!=null&&Date.now()>de[n]){if((i=_e[n])!=null){i.turn_off()}ce[n]=null;return null}if(fe[n]==null){fe[n]=se.Dependency()}fe[n].register();if(r!=null?r.err:void 0){throw r.err}return r};V.APIValue=t=function(e){Re(t,e);function t(e){this.human=e.human,this.uid_field=e.uid_field,this.build_call_from_uid=e.build_call_from_uid,this.data_container=e.data_container,this.fields=e.fields,this.cache_time=e.cache_time;if(this.cache_time==null){this.cache_time=s}this._is_executing={}}t.prototype.convert_to_bubble_instance=function(e){var t,n;n=function(e){if(e!=null){return String(e)}else{return e}};if(Array.isArray(e)){return d().db_instance().static_list(this.full_name,function(){var r,i,o;o=[];for(r=0,i=e.length;r<i;r++){t=e[r];o.push(n(t!=null?t[this.uid_field]:void 0))}return o}.call(this))}else{return n(e!=null?e[this.uid_field]:void 0)}};t.prototype.execute_my_call=function(e){var t,n,r,i,o,a,s,u=this;if(this._is_executing[e]){return}this._is_executing[e]=true;a=this.build_call_from_uid(e),n=a.name,r=a.prev,i=a.properties;s=null;o=setTimeout(function(){return se.warn("APIValue "+u.human+" took too long too load",{uid:e,_returned:s,call_name:n})},29*1e3);se.WaitFor(j(this.full_name,e),function(){return clearTimeout(o)});t=this._service.get_call(n);t.execute_async(r,i).callback(function(t,n){u._is_executing[e]=false;s={err:t,value:n};if(t){return D(u.full_name,e,{err:t},Date.now()+u.cache_time)}});return null};t.prototype.lookup_fn=function(e){var t=this;return function(n,r){var i,o,a;if(!n){return null}o=(a=typeof n._id==="function"?n._id():void 0)!=null?a:n;i=C(t.full_name,o);if(i){if(i.data[e]!=null||!i.partial){return i.data[e]}}t.execute_my_call(o);T(t.full_name,o);i=C(t.full_name,o);return i!=null?i.data[e]:void 0}};t.prototype.storable=true;t.prototype.bindable=true;t.prototype.display=function(){return this.human};t.prototype.editable=function(){return false};t.prototype.service=function(){return this._service};t.prototype.short_id=function(){return this.name};t.prototype.equals=function(e,t){return String(e)===String(t)};t.prototype.get_sample=function(){return null};t.prototype.cast=function(e){if(typeof e==="number"){return String(e)}else{return e}};t.prototype.extract=function(e){return this.flatten_raw(e)};t.prototype.notify=function(e,t){var n,r;r=e!=null?e[this.uid_field]:void 0;if(r==null){return}if(t.invalidate){return M(this.full_name,r)}else{if(t.partial){n={data:e,partial:true}}else{n={data:e}}return D(this.full_name,r,n,Date.now()+this.cache_time)}};t.prototype.notify_server_action=function(e,t){var n,r,i,o,a,s,u=this;r=function(e){var t,n,r;if((r=typeof e)==="string"||r==="number"){n={};n[u.uid_field]=e;t={invalidate:true};return u.notify(n,t)}};if(typeof(e!=null?e.all:void 0)==="function"){a=e.all();s=[];for(i=0,o=a.length;i<o;i++){n=a[i];s.push(r(n))}return s}else{return r(e)}};return t}(c);V.PassThroughValue=y=function(){function e(){}e.prototype.display=function(){return"Pass Through"};e.prototype.extract=function(e){return e};return e}();V.make_call_fn=function(e){return function(t,n,r){var i;if(n){throw se.error("724 - This line should be unreachable")}if(!t){return}if(e.is_authenticated()){i=e.execute(t,r);return N.convert_api_call_to_db_object(i,e)}}};H=function(e){var t,n;return!e.method||((t=(n=e.method)!=null?n.toLowerCase():void 0)==="get"||t==="delete")};P=function(e){if(H(e)){if(e.data){if(e.url.indexOf("?")===-1){return e.url+"?"+ne.stringify(e.data)}else{return e.url+"&"+ne.stringify(e.data)}}}return e.url};ee={data_type_for_ajax_call:true};X=function(e,t){se.warn("Retries timed out hitting "+e,{reason:t},"warn");return se.error({statusCode:400,message:"Sorry, "+e+" is temporarily unavailable"})};V.Call=a=function(){function e(e){this._service=e;this._execute_async=ze(this._execute_async,this)}e.prototype.service=function(){return this._service};e.prototype.display=function(){return this.human};e.prototype.get_value_id=function(){if(this.is_list){return"list."+this.value_id}else{return this.value_id}};e.prototype.get_authenticator=function(){return this.service().get_authenticator()};e.prototype.is_authenticated=function(){return this.get_authenticator().is_authenticated()};e.prototype.must_proxy=function(){var e;return(e=this._must_proxy)!=null?e:this.get_authenticator().must_proxy()};e.prototype.get_key=function(e){var t,n;return(t=(n=this.override_key)!=null?n[e]:void 0)!=null?t:this.service().get_key(e)};e.prototype.get_property=function(e,t){var n,r,i;if(this[e]){r=this[e];n=this}else{i=this.service();if(i[e]){r=i[e];n=i}}if(!r&&!ee[e]){if(t){return null}throw se.error("call "+this.human+" missing property "+e)}if(typeof r==="function"){r=r.call(n)}return r};e.prototype.execute=function(e,t,n){var r,i,o,a,s=this;r=function(){return s.execute_async(e,t,n)};if(((a=se.CurrentNotReadyCatcher)!=null?a.length:void 0)>0){return null}if(se.on_server()){return r().block()}else{i=se.json_stringify(U.dehydrate_tree({full_name:this.full_name,prev:e,properties:t,authentication:n}));if(!me[i]){me[i]=se.MakeKey(null,"Call.execute key for "+i);o=r();me[i].name=o.toString.bind(o);o.then(function(e){var t;he[i]=e;return(t=me[i])!=null?t.turn():void 0},function(e){var t;ge[i]=e;if((t=me[i])!=null){t.turn()}return null})}se.ensure_ready(me[i]);if(ge[i]){throw ge[i]}else{return he[i]}}};e.prototype.execute_async=function(e,t,n){var r,i,o,a,s=this;a={prev:e,properties:t};if(!se.on_server()&&this.must_proxy()){return this.proxy_request(e,t,n).then(function(e){s.notify_value(e);return e})}o=this.build_request(e,t,n);i=this._execute_async({req:o,test_info:a,prev:e,properties:t,authentication:n});if(this.service().handle_request_failures){r=this.service().handle_request_failures}else{r=function(r){var i;if(r.statusCode){return r}else if(s.service().not_production_critical&&F.is_retryable(r)){return X(s.service().display(),se.nice_print_error(r))}else{i=s.service();return se.error("execute_async error",{err:se.nice_print_error(r),prev:e,properties:t,authentication:n,service_display:i.display(),service_name:i.name})}}}i=i.then(function(e){return e},r);return i};e.prototype._execute_async=function(e){var t,n,r,i,o,a,s,u=this;i=e.req,o=e.test_info,n=e.prev,r=e.properties,t=e.authentication;if(i.dont_do_call){if((a=this.name,Ie.call(this.service().get_action_calls(),a)>=0)&&!i.no_error){throw se.error({statusCode:400,message:(s=i.message)!=null?s:d().get_text("CORE","MISSING_INFO")+this.human,reason:"MISSING_INFO"})}else{return se.Promise(null)}}if(i.override_output){this.notify_value(i.results);return se.Promise(i.results)}return se.Promise(i).block_promise(12e5).then(function(e){return d().http_request(e).block_promise(12e5).then(function(i){var a,s,l,c,f,d,_;f=typeof u.modify_and_retry==="function"?u.modify_and_retry(e,i):void 0;if(f){e=f;return u._execute_async({req:e,test_info:o,prev:n,properties:r,authentication:t})}a=u.service().response_to_data(e,i,u.get_property("return_type",true),u);se.optional_pause("response to data finished");o.result_call=a;_=u.extract_data(a,r);se.optional_pause("extract data finished");o.result_processed=_;u.notify_value(_);se.optional_pause("notify value finished");return _})})};e.prototype.build_request=function(e,t,n){var r,i,o,a,s,u;a=this.build(e,t);if(a.dont_do_call||a.override_output){return a}o=this.get_property("data_type_for_ajax_call");if(o){a.dataType=o}i=this.get_property("custom_retry_handler",true);if(i){a.custom_retry_handler=i}if(this.get_property("return_type",true)==="raw"){a.encoding=null}if(a.method==null){a.method="get"}a.method=a.method.toLowerCase();if(a.url&&a.path){throw se.error("call "+this.name+" @build() call returned an object with both a url and a path: do one or the other")}if(!a.url){a.url=this.get_property("base_url")+((u=a.path)!=null?u:"");delete a.path}r=this.get_authenticator();if(typeof r.add_shared_params_and_headers==="function"){r.add_shared_params_and_headers(a)}s=se.Promise(r.add_authentication(a,n));return s.block_promise().then(function(e){if(H(e)){e.url=P(e);delete e.data}return e})};e.prototype.proxy_request=function(e,t,n){e=U.dehydrate_tree(e);t=U.dehydrate_tree(t);return d().location.post("server://apiservice/DoAPICallFromServer",{service_name:this.service().name,version:this.service().version,call_name:this.name,prev:e,properties:t,authentication:n})};e.prototype.extract_data=function(e,t){var n,r,i,o,a,s,u,l,c=this;se.optional_pause();if(this.post_processing){e=this.post_processing(e,t)}if(this.data_container){n=se.extract_from_object(e,this.data_container)}else{n=e}se.optional_pause();s=ue.get(this.value_id);se.optional_pause();o=function(e){var t,n,r;t=(n=(r=s.V)!=null?typeof r.extract==="function"?r.extract(e):void 0:void 0)!=null?n:e;return t};if(Array.isArray(n)){a=[];se.optional_pause();for(i=u=0,l=n.length;u<l;i=++u){r=n[i];a.push(o(r));if(i%5===0){se.optional_pause()}}}else{a=o(n)}return a};e.prototype.notify_value=function(e){var t,n,r,i,o,a,s;if(!e){return}r=ue.get(this.value_id);if(typeof((a=r.V)!=null?a.notify:void 0)!=="function"){return}if(Array.isArray(e)){s=[];for(t=i=0,o=e.length;i<o;t=++i){n=e[t];if(t%5===0){se.optional_pause()}s.push(r.V.notify(n,this))}return s}else{return r.V.notify(e,this)}};e.prototype.get_doc_link=function(){return this.doc_link};return e}();d=e("./lib");J=e("url");I=e("./lang/appquery");ne=e("querystring");ue=e("./lang/values");U=e("./db/db");ae=e("./services");te=e("./lang/plugins");N=e("./core/core_expressions");R=e("./client_config");oe=e("./db/sample");K=e("./lang/lang");z=e("./core/core_elements");G=e("./lang/elements");B=e("./core/core_events");O=e("./apiconnectorbase");F=e("./default_lib");re=e;if(se.on_server()){A=re("./api");R=re("./configuration");Z=re("oauth-1.0a");$=re("jws")}}).call(this)},{"./apiconnectorbase":3,"./client_config":16,"./core/core_elements":19,"./core/core_events":20,"./core/core_expressions":21,"./db/db":28,"./db/sample":30,"./default_lib":33,"./lang/appquery":51,"./lang/elements":55,"./lang/lang":57,"./lang/plugins":60,"./lang/values":62,"./lib":65,"./services":70,"./u":72,querystring:285,url:299}],41:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};v=n;N=e("./u");N.safe_register("./geolocation",v);I=e;if(N.on_server()){d=I("./configuration")}else{d=e("./client_config")}h=e("./db/db");r=e("./lib");m=e("ngeohash");T=e("./languages");O=e("querystring");f=e("./lang/appquery");t=15;v.SAMPLE_VALUE='dr5reynw2rhp4np/175 Varick Street, New York, NY 10014, USA/{"street number":"175","street":"Varick Street","neighborhood":"Lower Manhattan","city":"New York","state":"New York","country":"United States","zip code":"10014"}';o=60;i="You have exceeded the limit of "+o+" Google Geocode API calls per second.  To increase this limit, please enter your own API key in Settings -> General -> General services API Keys";E=null;A=function(){var e,t;if(r().is_edit_mode()){return d.google_map_key}e=(t=f.get_public_setting("general_keys.google_map_key"))!=null?t.trim():void 0;if(e===null||e===void 0||e===""){return d.google_map_key}return e};v.load_google_map_api=function(){var e,t,n=this;if(!E){E=N.MakeKey(null,"google_map_api_loaded");window.initialize_google_map_api=function(){return E.turn()};t=document.createElement("script");t.type="text/javascript";e={v:3,callback:"initialize_google_map_api"};if(!z()){e.libraries="places"}N.run_once(30,function(){return A()},function(n,i){var o;o=r().app_language(true);if(o){o=T.get_iso_code(o).split("_")[0];e.language=o}if(i){e.key=i}t.src="https://maps.googleapis.com/maps/api/js?"+O.stringify(e);return document.getElementsByTagName("head")[0].appendChild(t)})}return E};j=function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)};v.get_hash=S=function(e,n,r){var i,o;i=e.latitude,o=e.longitude;n=n!=null?typeof n.replace==="function"?n.replace(/\//g,""):void 0:void 0;if(i==null||o==null){throw N.error("getting empty latitude or longitude for "+n)}if(r){r=JSON.stringify(r)}else{r=""}return m.encode(j(i,5),j(o,5),t)+"/"+(n!=null?n:"")+"/"+r};v.extract_hash=function(e){return e.split("/")[0]};v.get_coordinates=w=function(e){var t,n,r,i;if(!e||e.split==null){return}t=e.split("/")[0];i=m.decode(t),n=i.latitude,r=i.longitude;return{latitude:j(n,5),longitude:j(r,5)}};v.get_address=function(e){var t,n,r;if(!e||!e.split){return""}if(e.split("/")[1]){return e.split("/")[1]}t=w(e);return(n=(r=y(t))!=null?r.split("/")[1]:void 0)!=null?n:""};v.get_address_components=function(e){var t,n;e=v.get_address_coordinates(e);if(!e||!e.split){return""}if(!e.split("/")[2]){n=v.get_coordinates(e);e=y(n)}t=e!=null?e.split("/").slice(2).join("/"):void 0;if(t){return N.json_parse(t)}else{return{}}};v.is_hashed=M=function(e){if(!e||e.indexOf==null){return false}if(e.indexOf("/")!==t&&e.length!==t){return false}if(e.split("/")[0].indexOf(" ")!==-1){return false}return true};v.types_to_save=B={"room number":{google_field:"room"},floor:{},"street number":{google_field:"street_number"},street:{google_field:"route"},neighborhood:{},premise:{},subpremise:{},city:{google_field:["locality","sublocality"]},"state code":{google_field:"administrative_area_level_1","short":true},state:{google_field:"administrative_area_level_1"},county:{google_field:"administrative_area_level_2"},"zip code":{google_field:"postal_code"},country:{},"country code":{google_field:"country","short":true}};b=function(e){var t,n,r,i,o,a;o={};for(t in B){n=B[t];i=(a=n.google_field)!=null?a:t;if(!Array.isArray(i)){i=[i]}r=function(){var t,r,o,a,s,u,l;for(o=0,s=i.length;o<s;o++){r=i[o];l=e.address_components;for(a=0,u=l.length;a<u;a++){t=l[a];if(U.call(t.types,r)>=0){if(n.short){return t.short_name}else{return t.long_name}}}}};o[t]=r()}return o};z=function(){var e,t,n;if(e=f.appname(),U.call(d.hard_code,e)>=0){return false}return(t=(n=f.get_public_setting("general_keys.google_map_key"))!=null?n.trim():void 0)===null||t===void 0||t===""};x=function(e){var t,n,r,i;switch(e.request_type){case"geocode":t="https://maps.googleapis.com/maps/api/geocode/json?address="+encodeURIComponent(e.address);break;case"geocode_latlong":t="https://maps.googleapis.com/maps/api/geocode/json?latlng="+e.latitude+","+e.longitude;break;case"autocomplete":t="https://maps.googleapis.com/maps/api/place/queryautocomplete/json?input="+encodeURIComponent(e.input)+"&types="+e.types[0]}n=(r=e.language)!=null?r.split("_")[0]:void 0;if(((i=e.request_type)==="geocode"||i==="autocomplete")&&n!=null){t+="&language="+n}return t};D=function(e,t){e.language=r().app_language();return r().location.post("server://api/1.1/places",e,function(e,n){if(e){r().show_error_to_user({type:"general",error:e});t();return}return t(n)})};v.low_level_google_api_from_server=function(e,t,n){var r,a;r=Math.floor(Date.now()/1e3/60);a="google_gelocation_api_rate_limit_"+e.headers.host+"_"+r;return P.get_async("small",a,function(r,s){var u,l,c;if(r){N.error("error fetching rate limit from redis",{error:N.nice_print_error(r)});return}if(parseInt(s!=null?s:0)+1>o){n(N.error({statusCode:400,message:i}));return}u=e.body;if((c=u.request_type)==="geocode"||c==="geocode_latlong"||c==="autocomplete"){l=x(u)+("&key="+d.google_geocode_key)}else{n(N.error({statusCode:400,message:"Unrecognized request type for Google Places proxy"}));return}R.get(l).pipe(t);if(s==null){P.setex_async("small",a,60,1,function(e){if(e){return N.warn("error creating geocoding rate limit from redis",{error:N.nice_print_error(e)})}})}else{P.incr_async("small",a,function(e){if(e){return N.warn("error incrementing geocoding rate limit from redis",{error:N.nice_print_error(e)})}})}return d.increment(null,"shared_geocode_key_usage")})};k=function(){var e,t;e=(t=f.get_private_setting("general_keys.google_geocode_key"))!=null?t.trim():void 0;if(e===null||e===void 0||e===""){if(!N.running_test()&&r().appname()!=="meta"&&!c.per_minute_rate_limit("geocode_key",o)){throw N.error({statusCode:400,message:i})}d.increment(null,"shared_geocode_key_usage");return d.google_geocode_key}return e};a={};s={};p=function(e){return function(t,n){if(t!=null?t.body:void 0){try{if(JSON.parse(t.body).status==="OVER_QUERY_LIMIT"){N.warn("Hitting OVER_QUERY_LIMIT for google geocode",{key:e},"warn");return true}}catch(r){n=r}}}};q=function(e,t,n){var i,o,u,l,c,f,d,_,h,g;c=N.json_stringify(t);u=function(e){var t,n,r,i,o,s;n=e.formatted_address;t=b(e);return a[n]=a[c]=S({latitude:(o=typeof(r=e.geometry.location).lat==="function"?r.lat():void 0)!=null?o:e.geometry.location.lat,longitude:(s=typeof(i=e.geometry.location).lng==="function"?i.lng():void 0)!=null?s:e.geometry.location.lng},n,t)};t.request_type=e;if(N.on_server()){if(!a[c]){l=k();d={url:x(t)+("&key="+l)};d.custom_retry_handler=p(l);try{_=r().http_request(d).block();f=_;_=JSON.parse(_.body)}catch(m){i=m;N.extend(t,{key:l,err:N.nice_print_error(i)});throw N.error("Hard error requesting google geocode",t)}if(_.status==="OK"){u(_.results[0])}else if(_.status==="ZERO_RESULTS"){a[c]=null}else{N.extend(t,{key:l,response_body:f.body,response_status_code:f.statusCode});N.warn("Error requesting google geocode",t)}}return a[c]}else{if(!s[c]){s[c]=N.MakeKey(null,"address_localization_keys");o=function(e){a[c]=null;s[c].turn();if(n){return alert("There was an error converting the address "+c+" into a geographic location. Error message: "+e)}};h=function(e){u(e);return s[c].turn()};if(z()){D(t,function(e){if(!e||e.status!=="OK"){return o(e.status)}else{return h(e.results[0])}})}else{if((typeof google!=="undefined"&&google!==null?(g=google.maps)!=null?g.Geocoder:void 0:void 0)==null){v.load_google_map_api()}N.WaitFor(v.load_google_map_api(),function(){var e,n,r,i;r=new google.maps.Geocoder;e=5;i=e;n=function(){var a;if(t.address!=null){a={address:t.address}}else if(t.latitude!=null&&t.longitude!=null){a={latLng:new google.maps.LatLng(t.latitude,t.longitude)}}return r.geocode(a,function(t,r){if(r===google.maps.GeocoderStatus.OK){return h(t[0])}else if(r===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&i>0){i--;return setTimeout(n,(e-i)*(e-i)*1e3)}else{return o(r)}})};return n()})}}N.ensure_ready(s[c]);return a[c]}};v.get_address_coordinates=function(e,t){if(!e||typeof e!=="string"||M(e)){return e}return q("geocode",{address:e},t)};v.get_address_from_location=y=function(e){var t,n;t=e.latitude,n=e.longitude;if(t==null||n==null){return}return q("geocode_latlong",{latitude:t,longitude:n})};L=null;_=N.Box(null);v.get_current_geographic_position=function(){var e,t;if(navigator.geolocation){if(!L){L=N.MakeKey(Infinity,"waiting_for_current_location_watcher");t=function(e){if(!_()||g(w(_()),e.coords)>.01){return _(S(e.coords))}};e=function(){return navigator.geolocation.watchPosition(t,function(e){return console.log(e)},{enableHighAccuracy:true})};navigator.geolocation.getCurrentPosition(function(n){t(n);L.turn();return e()},function(t){var n;if(typeof(n=r()).show_error_to_user==="function"){n.show_error_to_user({error:t,type:"general"})}L.turn();return e()},{enableHighAccuracy:false})}N.ensure_ready(L);return _()}else{return null}};u={};l={};v.get_timezone=function(e){var t,n,i,o,a,s,c,f;if(!M(e)){return""}f=w(e),n=f.latitude,i=f.longitude;t=n+"_"+i;c=parseInt(Date.now()/1e3);if(N.on_server()){if(!u[t]){a={url:"https://maps.googleapis.com/maps/api/timezone/json?location="+n+","+i+"&timestamp="+c+"&key="+k()};a.custom_retry_handler=p(k());s=r().http_request(a).block();s=JSON.parse(s.body);if(s.status==="OK"){u[t]=s}}return u[t]}else{if(!l[t]){l[t]=N.MakeKey(null,"address_timezone_key");a={url:"https://maps.googleapis.com/maps/api/timezone/json?location="+n+","+i+"&timestamp="+c,dataType:"json"};o=r().http_request(a);o.then(function(e){e=JSON.parse(e.body);if(e.status==="OK"){u[t]=e}else{N.warn("Timezone fetching issue "+JSON.stringify(e))}return l[t].turn()})}N.ensure_ready(l[t]);return u[t]}};C={};v.get_address_place_autocomplete=function(e,t,n){var r,i;if(C[e]){n(C[e]);return}if(z()){return D({input:e,types:t,request_type:"autocomplete"},function(t){if(!t||t.status!=="OK"){n([])}else{C[e]=t.predictions;return n(t.predictions)}})}else{if((typeof google!=="undefined"&&google!==null?(r=google.maps)!=null?(i=r.places)!=null?i.AutocompleteService:void 0:void 0:void 0)==null){v.load_google_map_api()}return N.WaitFor(v.load_google_map_api(),function(){var r;r=new google.maps.places.AutocompleteService;return r.getPlacePredictions({input:e,types:t},function(t,r){if(r===google.maps.places.PlacesServiceStatus.OK){C[e]=t;return n(t)}else{return n([])}})})}};v.geographic_distance=g=function(e,t,n){var r,i,o,a,s,u,l,c,f;if(n==="miles"){r=3958}else{r=6371}f=function(e){return e*Math.PI/180};s=f(t.latitude-e.latitude);u=f(t.longitude-e.longitude);l=f(e.latitude);c=f(t.latitude);i=Math.sin(s/2)*Math.sin(s/2)+Math.sin(u/2)*Math.sin(u/2)*Math.cos(l)*Math.cos(c);o=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i));a=r*o;return a};if(N.on_server()){c=I("./api");R=I("request");P=I("./redis")}else{c=null}}).call(this)},{"./client_config":16,"./db/db":28,"./lang/appquery":51,"./languages":64,"./lib":65,"./u":72,ngeohash:306,querystring:285}],42:[function(e,t,n){(function(){var t,r,i,o,a,s;s=e("./u");o=n;i=function(e,n){e=e.replace("http://","").replace("https://","");if(e.indexOf("//")===0){e=e.replace("//","")}if(r.always_proxy_user_files){return t().location.parsed_url().host+"/user/iop/http://"+s.fixedEncodeURIComponent(e)+"?"+a.stringify(n)}else{return r.image_optimization_service+"/http://"+s.fixedEncodeURIComponent(e)+"?"+a.stringify(n)}};o.get_reduced_file_url=function(e,t,n,r){var o,u,l,c;if(t){t=t*1.3}if(n){n=n*1.3}u={w:(l=t!=null?t.toString():void 0)!=null?l:null,h:(c=n!=null?n.toString():void 0)!=null?c:null};if(r){s.extend(u,r)}o=e.split("?")[1];if(o){o=a.parse(o);s.extend(u,o)}if(u.fit==null){u.fit="max"}return i(e.split("?")[0],u)};o.get_image_json_data=function(e,n){var r,o,u;u={fm:"json"};o=e.split("?")[1];if(o){s.extend(u,a.parse(o))}e=t().location.parsed_url().protocol+"//"+i(e.split("?")[0],u);r=$.ajax(e);r.done(function(e,t,r){var i,o,a;if((a=e.Orientation)===6||a===8){o=e.PixelHeight;i=e.PixelWidth}else{o=e.PixelWidth;i=e.PixelHeight}return n({width:o,height:i})});return r.fail(function(e,t,r){return n(null)})};o.add_processing_options=function(e,t){var n,r,i,o,u,l;if((e!=null?e.split:void 0)==null){return""}r={};n=e.split("?")[1];if(n){s.extend(r,a.parse(n))}if(t.auto_enhance){r.auto="enhance"}if(t.red_eye){if(t.auto){r.auto+=",redeye"}else{r.auto="redeye"}}if(t.extract_face){r.fit="facearea"}else if(t.crop_to_fit){r.fit="crop"}l=["blur","sepia"];for(o=0,u=l.length;o<u;o++){i=l[o];if(t[i]){r[i]=t[i+"_level"]}}if(t.pixel){r["px"]=t.pixel_level}if(t.mono){r.mono=s.rgb_to_hex(t.mono_level).code.split("#")[1]}if(t.mask){r.mask="ellipse"}if(t.q!=null){r.q=t.q}if(t.fm){r.fm=t.fm}return e.split("?")[0]+"?"+a.stringify(r)};t=e("./lib");r=e("./client_config");a=e("querystring")}).call(this)},{"./client_config":16,"./lib":65,"./u":72,querystring:285}],43:[function(e,t,n){/*
 *	jQuery dotdotdot 1.5.6
 *
 *	Copyright (c) 2013 Fred Heusschen
 *	www.frebsite.nl
 *
 *	Plugin website:
 *	dotdotdot.frebsite.nl
 *
 *	Dual licensed under the MIT and GPL licenses.
 *	http://en.wikipedia.org/wiki/MIT_License
 *	http://en.wikipedia.org/wiki/GNU_General_Public_License
 */
(function(e){if(e.fn.dotdotdot){return}e.fn.dotdotdot=function(i){if(this.length==0){d(true,'No element found for "'+this.selector+'".');return this}if(this.length>1){return this.each(function(){e(this).dotdotdot(i)})}var a=this;if(a.data("dotdotdot")){a.trigger("destroy.dot")}a.bind_events=function(){a.bind("update.dot",function(t,i){t.preventDefault();t.stopPropagation();l.maxHeight=typeof l.height=="number"?l.height:f(a);l.maxHeight+=l.tolerance;if(typeof i!="undefined"){if(typeof i=="string"||i instanceof HTMLElement){i=e("<div />").append(i).contents()}if(i instanceof e){u=i}}g=a.wrapInner('<div class="dotdotdot" />').children();g.empty().append(u.clone(true)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var s=false,c=false;if(_.afterElement){s=_.afterElement.clone(true);_.afterElement.remove()}if(o(g,l)){if(l.wrap=="children"){c=n(g,l,s)}else{c=r(g,a,g,l,s)}}g.replaceWith(g.contents());g=null;if(e.isFunction(l.callback)){l.callback.call(a[0],c,u)}_.isTruncated=c;return c}).bind("isTruncated.dot",function(e,t){e.preventDefault();e.stopPropagation();if(typeof t=="function"){t.call(a[0],_.isTruncated)}return _.isTruncated}).bind("originalContent.dot",function(e,t){e.preventDefault();e.stopPropagation();if(typeof t=="function"){t.call(a[0],u)}return u}).bind("destroy.dot",function(e){e.preventDefault();e.stopPropagation();a.unwatch().unbind_events().empty().append(u).data("dotdotdot",false)});return a};a.unbind_events=function(){a.unbind(".dot");return a};a.watch=function(){a.unwatch();if(l.watch=="window"){var t=e(window),n=t.width(),r=t.height();t.bind("resize.dot"+_.dotId,function(){if(n!=t.width()||r!=t.height()||!l.windowResizeFix){n=t.width();r=t.height();if(h){clearInterval(h)}h=setTimeout(function(){a.trigger("update.dot")},10)}})}else{p=s(a);h=setInterval(function(){var e=s(a);if(p.width!=e.width||p.height!=e.height){a.trigger("update.dot");p=s(a)}},100)}return a};a.unwatch=function(){e(window).unbind("resize.dot"+_.dotId);if(h){clearInterval(h)}return a};var u=a.contents(),l=e.extend(true,{},e.fn.dotdotdot.defaults,i),_={},p={},h=null,g=null;_.afterElement=c(l.after,a);_.isTruncated=false;_.dotId=t++;a.data("dotdotdot",true).bind_events().trigger("update.dot");if(l.watch){a.watch()}return a};e.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:false,windowResizeFix:true,debug:false};var t=1;function n(e,t,n){var r=e.children(),i=false;e.empty();for(var a=0,s=r.length;a<s;a++){var u=r.eq(a);e.append(u);if(n){e.append(n)}if(o(e,t)){u.remove();i=true;break}else{if(n){n.remove()}}}return i}function r(t,n,a,s,u){var l=t.contents(),c=false;t.empty();var f="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style";for(var d=0,_=l.length;d<_;d++){if(c){break}var p=l[d],h=e(p);if(typeof p=="undefined"){continue}t.append(h);if(u){t[t.is(f)?"after":"append"](u)}if(p.nodeType==3){if(o(a,s)){c=i(h,n,a,s,u)}}else{c=r(h,n,a,s,u)}if(!c){if(u){u.remove()}}}return c}function i(e,t,n,r,s){var c=false,f=e[0];if(typeof f=="undefined"){return false}var d=r.wrap=="letter"?"":" ",_=l(f).split(d),p=-1,h=-1,g=0,m=_.length-1;while(g<=m){var v=Math.floor((g+m)/2);if(v==h){break}h=v;u(f,_.slice(0,h+1).join(d)+r.ellipsis);if(!o(n,r)){p=h;g=h}else{m=h}}if(p!=-1&&!(_.length==1&&_[0].length==0)){var y=a(_.slice(0,p+1).join(d),r);c=true;u(f,y)}else{var b=e.parent();e.remove();var w=s?s.length:0;if(b.contents().size()>w){var x=b.contents().eq(-1-w);c=i(x,t,n,r,s)}else{var f=b.prev().contents().eq(-1)[0];if(typeof f!="undefined"){var y=a(l(f),r);u(f,y);b.remove();c=true}}}return c}function o(e,t){return e.innerHeight()>t.maxHeight}function a(t,n){while(e.inArray(t.slice(-1),n.lastCharacter.remove)>-1){t=t.slice(0,-1)}if(e.inArray(t.slice(-1),n.lastCharacter.noEllipsis)<0){t+=n.ellipsis}return t}function s(e){return{width:e.innerWidth(),height:e.innerHeight()}}function u(e,t){if(e.innerText){e.innerText=t}else if(e.nodeValue){e.nodeValue=t}else if(e.textContent){e.textContent=t}}function l(e){if(e.innerText){return e.innerText}else if(e.nodeValue){return e.nodeValue}else if(e.textContent){return e.textContent}else{return""}}function c(t,n){if(typeof t=="undefined"){return false}if(!t){return false}if(typeof t=="string"){t=e(t,n);return t.length?t:false}if(typeof t=="object"){return typeof t.jquery=="undefined"?false:t}return false}function f(e){var t=e.innerHeight(),n=["paddingTop","paddingBottom"];for(var r=0,i=n.length;r<i;r++){var o=parseInt(e.css(n[r]),10);if(isNaN(o)){o=0}t-=o}return t}function d(e,t){if(!e){return false}if(typeof t=="string"){t="dotdotdot: "+t}else{t=["dotdotdot:",t]}if(typeof window.console!="undefined"){if(typeof window.console.log!="undefined"){window.console.log(t)}}return false}var _=e.fn.html;e.fn.html=function(e){if(typeof e!="undefined"){if(this.data("dotdotdot")){if(typeof e!="function"){return this.trigger("update",[e])}}return _.call(this,e)}return _.call(this)};var p=e.fn.text;e.fn.text=function(t){if(typeof t!="undefined"){if(this.data("dotdotdot")){var n=e("<div />");n.text(t);t=n.html();n.remove();return this.trigger("update",[t])}return p.call(this,t)}return p.call(this)}})(jQuery)},{}],44:[function(e,t,n){!function(e){"use strict";function t(e){var t=e.length,r=n.type(e);return"function"!==r&&!n.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===r||0===t||"number"==typeof t&&t>0&&t-1 in e))}if(!e.jQuery){var n=function(e,t){return new n.fn.init(e,t)};n.isWindow=function(e){return e&&e===e.window},n.type=function(e){return e?"object"==typeof e||"function"==typeof e?i[a.call(e)]||"object":typeof e:e+""},n.isArray=Array.isArray||function(e){return"array"===n.type(e)},n.isPlainObject=function(e){var t;if(!e||"object"!==n.type(e)||e.nodeType||n.isWindow(e))return!1;try{if(e.constructor&&!o.call(e,"constructor")&&!o.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}for(t in e);return void 0===t||o.call(e,t)},n.each=function(e,n,r){var i,o=0,a=e.length,s=t(e);if(r){if(s)for(;o<a&&(i=n.apply(e[o],r),i!==!1);o++);else for(o in e)if(e.hasOwnProperty(o)&&(i=n.apply(e[o],r),i===!1))break}else if(s)for(;o<a&&(i=n.call(e[o],o,e[o]),i!==!1);o++);else for(o in e)if(e.hasOwnProperty(o)&&(i=n.call(e[o],o,e[o]),i===!1))break;return e},n.data=function(e,t,i){if(void 0===i){var o=e[n.expando],a=o&&r[o];if(void 0===t)return a;if(a&&t in a)return a[t]}else if(void 0!==t){var s=e[n.expando]||(e[n.expando]=++n.uuid);return r[s]=r[s]||{},r[s][t]=i,i}},n.removeData=function(e,t){var i=e[n.expando],o=i&&r[i];o&&(t?n.each(t,function(e,t){delete o[t]}):delete r[i])},n.extend=function(){var e,t,r,i,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[u]||{},u++),"object"!=typeof s&&"function"!==n.type(s)&&(s={}),u===l&&(s=this,u--);u<l;u++)if(o=arguments[u])for(i in o)o.hasOwnProperty(i)&&(e=s[i],r=o[i],s!==r&&(c&&r&&(n.isPlainObject(r)||(t=n.isArray(r)))?(t?(t=!1,a=e&&n.isArray(e)?e:[]):a=e&&n.isPlainObject(e)?e:{},s[i]=n.extend(c,a,r)):void 0!==r&&(s[i]=r)));return s},n.queue=function(e,r,i){function o(e,n){var r=n||[];return e&&(t(Object(e))?!function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;)e[i++]=t[r++];if(n!==n)for(;void 0!==t[r];)e[i++]=t[r++];return e.length=i,e}(r,"string"==typeof e?[e]:e):[].push.call(r,e)),r}if(e){r=(r||"fx")+"queue";var a=n.data(e,r);return i?(!a||n.isArray(i)?a=n.data(e,r,o(i)):a.push(i),a):a||[]}},n.dequeue=function(e,t){n.each(e.nodeType?[e]:e,function(e,r){t=t||"fx";var i=n.queue(r,t),o=i.shift();"inprogress"===o&&(o=i.shift()),o&&("fx"===t&&i.unshift("inprogress"),o.call(r,function(){n.dequeue(r,t)}))})},n.fn=n.prototype={init:function(e){if(e.nodeType)return this[0]=e,this;throw new Error("Not a DOM node.")},offset:function(){var t=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:t.top+(e.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(e.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function e(e){for(var t=e.offsetParent;t&&"html"!==t.nodeName.toLowerCase()&&t.style&&"static"===t.style.position;)t=t.offsetParent;return t||document}var t=this[0],r=e(t),i=this.offset(),o=/^(?:body|html)$/i.test(r.nodeName)?{top:0,left:0}:n(r).offset();return i.top-=parseFloat(t.style.marginTop)||0,i.left-=parseFloat(t.style.marginLeft)||0,r.style&&(o.top+=parseFloat(r.style.borderTopWidth)||0,o.left+=parseFloat(r.style.borderLeftWidth)||0),{top:i.top-o.top,left:i.left-o.left}}};var r={};n.expando="velocity"+(new Date).getTime(),n.uuid=0;for(var i={},o=i.hasOwnProperty,a=i.toString,s="Boolean Number String Function Array Date RegExp Object Error".split(" "),u=0;u<s.length;u++)i["[object "+s[u]+"]"]=s[u].toLowerCase();n.fn.init.prototype=n.fn,e.Velocity={Utilities:n}}}(window),function(e){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=e():"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";return function(e,t,n,r){function i(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r}function o(e){return v.isWrapped(e)?e=[].slice.call(e):v.isNode(e)&&(e=[e]),e}function a(e){var t=p.data(e,"velocity");return null===t?r:t}function s(e,t){var n=a(e);n&&n.delayTimer&&!n.delayPaused&&(n.delayRemaining=n.delay-t+n.delayBegin,n.delayPaused=!0,clearTimeout(n.delayTimer.setTimeout))}function u(e,t){var n=a(e);n&&n.delayTimer&&n.delayPaused&&(n.delayPaused=!1,n.delayTimer.setTimeout=setTimeout(n.delayTimer.next,n.delayRemaining))}function l(e){return function(t){return Math.round(t*e)*(1/e)}}function c(e,n,r,i){function o(e,t){return 1-3*t+3*e}function a(e,t){return 3*t-6*e}function s(e){return 3*e}function u(e,t,n){return((o(t,n)*e+a(t,n))*e+s(t))*e}function l(e,t,n){return 3*o(t,n)*e*e+2*a(t,n)*e+s(t)}function c(t,n){for(var i=0;i<h;++i){var o=l(n,e,r);if(0===o)return n;var a=u(n,e,r)-t;n-=a/o}return n}function f(){for(var t=0;t<y;++t)k[t]=u(t*b,e,r)}function d(t,n,i){var o,a,s=0;do a=n+(i-n)/2,o=u(a,e,r)-t,o>0?i=a:n=a;while(Math.abs(o)>m&&++s<v);return a}function _(t){for(var n=0,i=1,o=y-1;i!==o&&k[i]<=t;++i)n+=b;--i;var a=(t-k[i])/(k[i+1]-k[i]),s=n+a*b,u=l(s,e,r);return u>=g?c(t,s):0===u?s:d(t,n,n+b)}function p(){S=!0,e===n&&r===i||f()}var h=4,g=.001,m=1e-7,v=10,y=11,b=1/(y-1),w="Float32Array"in t;if(4!==arguments.length)return!1;for(var x=0;x<4;++x)if("number"!=typeof arguments[x]||isNaN(arguments[x])||!isFinite(arguments[x]))return!1;e=Math.min(e,1),r=Math.min(r,1),e=Math.max(e,0),r=Math.max(r,0);var k=w?new Float32Array(y):new Array(y),S=!1,A=function(t){return S||p(),e===n&&r===i?t:0===t?0:1===t?1:u(_(t),n,i)};A.getControlPoints=function(){return[{x:e,y:n},{x:r,y:i}]};var E="generateBezier("+[e,n,r,i]+")";return A.toString=function(){return E},A}function f(e,t){var n=e;return v.isString(e)?x.Easings[e]||(n=!1):n=v.isArray(e)&&1===e.length?l.apply(null,e):v.isArray(e)&&2===e.length?k.apply(null,e.concat([t])):!(!v.isArray(e)||4!==e.length)&&c.apply(null,e),n===!1&&(n=x.Easings[x.defaults.easing]?x.defaults.easing:w),n}function d(e){if(e){var t=x.timestamp&&e!==!0?e:m.now(),n=x.State.calls.length;n>1e4&&(x.State.calls=i(x.State.calls),n=x.State.calls.length);for(var o=0;o<n;o++)if(x.State.calls[o]){var s=x.State.calls[o],u=s[0],l=s[2],c=s[3],f=!!c,g=null,y=s[5],b=s[6];if(c||(c=x.State.calls[o][3]=t-16),y){if(y.resume!==!0)continue;c=s[3]=Math.round(t-b-16),s[5]=null}b=s[6]=t-c;for(var w=Math.min(b/l.duration,1),k=0,A=u.length;k<A;k++){var M=u[k],T=M.element;if(a(T)){var C=!1;if(l.display!==r&&null!==l.display&&"none"!==l.display){if("flex"===l.display){var j=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];p.each(j,function(e,t){S.setPropertyValue(T,"display",t)})}S.setPropertyValue(T,"display",l.display)}l.visibility!==r&&"hidden"!==l.visibility&&S.setPropertyValue(T,"visibility",l.visibility);for(var D in M)if(M.hasOwnProperty(D)&&"element"!==D){var O,I=M[D],P=v.isString(I.easing)?x.Easings[I.easing]:I.easing;if(v.isString(I.pattern)){var R=1===w?function(e,t,n){var r=I.endValue[t];return n?Math.round(r):r}:function(e,t,n){var r=I.startValue[t],i=I.endValue[t]-r,o=r+i*P(w,l,i);return n?Math.round(o):o};O=I.pattern.replace(/{(\d+)(!)?}/g,R)}else if(1===w)O=I.endValue;else{var z=I.endValue-I.startValue;O=I.startValue+z*P(w,l,z)}if(!f&&O===I.currentValue)continue;if(I.currentValue=O,"tween"===D)g=O;else{var B;if(S.Hooks.registered[D]){B=S.Hooks.getRoot(D);var N=a(T).rootPropertyValueCache[B];N&&(I.rootPropertyValue=N)}var L=S.setPropertyValue(T,D,I.currentValue+(h<9&&0===parseFloat(O)?"":I.unitType),I.rootPropertyValue,I.scrollData);S.Hooks.registered[D]&&(S.Normalizations.registered[B]?a(T).rootPropertyValueCache[B]=S.Normalizations.registered[B]("extract",null,L[1]):a(T).rootPropertyValueCache[B]=L[1]),"transform"===L[0]&&(C=!0)}}l.mobileHA&&a(T).transformCache.translate3d===r&&(a(T).transformCache.translate3d="(0px, 0px, 0px)",C=!0),C&&S.flushTransformCache(T)}}l.display!==r&&"none"!==l.display&&(x.State.calls[o][2].display=!1),l.visibility!==r&&"hidden"!==l.visibility&&(x.State.calls[o][2].visibility=!1),l.progress&&l.progress.call(s[1],s[1],w,Math.max(0,c+l.duration-t),c,g),1===w&&_(o)}}x.State.isTicking&&E(d)}function _(e,t){if(!x.State.calls[e])return!1;for(var n=x.State.calls[e][0],i=x.State.calls[e][1],o=x.State.calls[e][2],s=x.State.calls[e][4],u=!1,l=0,c=n.length;l<c;l++){var f=n[l].element;t||o.loop||("none"===o.display&&S.setPropertyValue(f,"display",o.display),"hidden"===o.visibility&&S.setPropertyValue(f,"visibility",o.visibility));var d=a(f);if(o.loop!==!0&&(p.queue(f)[1]===r||!/\.velocityQueueEntryFlag/i.test(p.queue(f)[1]))&&d){d.isAnimating=!1,d.rootPropertyValueCache={};var _=!1;p.each(S.Lists.transforms3D,function(e,t){var n=/^scale/.test(t)?1:0,i=d.transformCache[t];d.transformCache[t]!==r&&new RegExp("^\\("+n+"[^.]").test(i)&&(_=!0,delete d.transformCache[t])}),o.mobileHA&&(_=!0,delete d.transformCache.translate3d),_&&S.flushTransformCache(f),S.Values.removeClass(f,"velocity-animating")}if(!t&&o.complete&&!o.loop&&l===c-1)try{o.complete.call(i,i)}catch(h){setTimeout(function(){throw h},1)}s&&o.loop!==!0&&s(i),d&&o.loop===!0&&!t&&(p.each(d.tweensContainer,function(e,t){if(/^rotate/.test(e)&&(parseFloat(t.startValue)-parseFloat(t.endValue))%360===0){var n=t.startValue;t.startValue=t.endValue,t.endValue=n}/^backgroundPosition/.test(e)&&100===parseFloat(t.endValue)&&"%"===t.unitType&&(t.endValue=0,t.startValue=100)}),x(f,"reverse",{loop:!0,delay:o.delay})),o.queue!==!1&&p.dequeue(f,o.queue)}x.State.calls[e]=!1;for(var g=0,m=x.State.calls.length;g<m;g++)if(x.State.calls[g]!==!1){u=!0;break}u===!1&&(x.State.isTicking=!1,delete x.State.calls,x.State.calls=[])}var p,h=function(){if(n.documentMode)return n.documentMode;for(var e=7;e>4;e--){var t=n.createElement("div");if(t.innerHTML="<!--[if IE "+e+"]><span></span><![endif]-->",t.getElementsByTagName("span").length)return t=null,e}return r}(),g=function(){var e=0;return t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(t){var n,r=(new Date).getTime();return n=Math.max(0,16-(r-e)),e=r+n,setTimeout(function(){t(r+n)},n)}}(),m=function(){var e=t.performance||{};if(!e.hasOwnProperty("now")){var n=e.timing&&e.timing.domComplete?e.timing.domComplete:(new Date).getTime();e.now=function(){return(new Date).getTime()-n}}return e}(),v={isNumber:function(e){return"number"==typeof e},isString:function(e){return"string"==typeof e},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},isNode:function(e){return e&&e.nodeType},isNodeList:function(e){return"object"==typeof e&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(e))&&e.length!==r&&(0===e.length||"object"==typeof e[0]&&e[0].nodeType>0)},isWrapped:function(e){return e&&(v.isArray(e)||v.isNumber(e.length)&&!v.isString(e)&&!v.isFunction(e))},isSVG:function(e){return t.SVGElement&&e instanceof t.SVGElement},isEmptyObject:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}},y=!1;if(e.fn&&e.fn.jquery?(p=e,y=!0):p=t.Velocity.Utilities,h<=8&&!y)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(h<=7)return void(jQuery.fn.velocity=jQuery.fn.animate);var b=400,w="swing",x={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:t.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:n.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[],delayedElements:{count:0}},CSS:{},Utilities:p,Redirects:{},Easings:{},Promise:t.Promise,defaults:{queue:"",duration:b,easing:w,begin:r,complete:r,progress:r,display:r,visibility:r,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0,promiseRejectEmpty:!0},init:function(e){p.data(e,"velocity",{isSVG:v.isSVG(e),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:4,patch:0},debug:!1,timestamp:!0,pauseAll:function(e){var t=(new Date).getTime();p.each(x.State.calls,function(t,n){if(n){if(e!==r&&(n[2].queue!==e||n[2].queue===!1))return!0;n[5]={resume:!1}}}),p.each(x.State.delayedElements,function(e,n){n&&s(n,t)})},resumeAll:function(e){var t=(new Date).getTime();p.each(x.State.calls,function(t,n){if(n){if(e!==r&&(n[2].queue!==e||n[2].queue===!1))return!0;n[5]&&(n[5].resume=!0)}}),p.each(x.State.delayedElements,function(e,n){n&&u(n,t)})}};t.pageYOffset!==r?(x.State.scrollAnchor=t,x.State.scrollPropertyLeft="pageXOffset",x.State.scrollPropertyTop="pageYOffset"):(x.State.scrollAnchor=n.documentElement||n.body.parentNode||n.body,x.State.scrollPropertyLeft="scrollLeft",x.State.scrollPropertyTop="scrollTop");var k=function(){function e(e){return-e.tension*e.x-e.friction*e.v}function t(t,n,r){var i={x:t.x+r.dx*n,v:t.v+r.dv*n,tension:t.tension,friction:t.friction};return{dx:i.v,dv:e(i)}}function n(n,r){var i={dx:n.v,dv:e(n)},o=t(n,.5*r,i),a=t(n,.5*r,o),s=t(n,r,a),u=1/6*(i.dx+2*(o.dx+a.dx)+s.dx),l=1/6*(i.dv+2*(o.dv+a.dv)+s.dv);return n.x=n.x+u*r,n.v=n.v+l*r,n}return function r(e,t,i){var o,a,s,u={x:-1,v:0,tension:null,friction:null},l=[0],c=0,f=1e-4,d=.016;for(e=parseFloat(e)||500,t=parseFloat(t)||20,i=i||null,u.tension=e,u.friction=t,o=null!==i,o?(c=r(e,t),a=c/i*d):a=d;;)if(s=n(s||u,a),l.push(1+s.x),c+=16,!(Math.abs(s.x)>f&&Math.abs(s.v)>f))break;return o?function(e){return l[e*(l.length-1)|0]}:c}}();x.Easings={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},spring:function(e){return 1-Math.cos(4.5*e*Math.PI)*Math.exp(6*-e)}},p.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(e,t){x.Easings[t[0]]=c.apply(null,t[1])});var S=x.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"],units:["%","em","ex","ch","rem","vw","vh","vmin","vmax","cm","mm","Q","in","pc","pt","px","deg","grad","rad","turn","s","ms"],colorNames:{aliceblue:"240,248,255",antiquewhite:"250,235,215",aquamarine:"127,255,212",aqua:"0,255,255",azure:"240,255,255",beige:"245,245,220",bisque:"255,228,196",black:"0,0,0",blanchedalmond:"255,235,205",blueviolet:"138,43,226",blue:"0,0,255",brown:"165,42,42",burlywood:"222,184,135",cadetblue:"95,158,160",chartreuse:"127,255,0",chocolate:"210,105,30",coral:"255,127,80",cornflowerblue:"100,149,237",cornsilk:"255,248,220",crimson:"220,20,60",cyan:"0,255,255",darkblue:"0,0,139",darkcyan:"0,139,139",darkgoldenrod:"184,134,11",darkgray:"169,169,169",darkgrey:"169,169,169",darkgreen:"0,100,0",darkkhaki:"189,183,107",darkmagenta:"139,0,139",darkolivegreen:"85,107,47",darkorange:"255,140,0",darkorchid:"153,50,204",darkred:"139,0,0",darksalmon:"233,150,122",darkseagreen:"143,188,143",darkslateblue:"72,61,139",darkslategray:"47,79,79",darkturquoise:"0,206,209",darkviolet:"148,0,211",deeppink:"255,20,147",deepskyblue:"0,191,255",dimgray:"105,105,105",dimgrey:"105,105,105",dodgerblue:"30,144,255",firebrick:"178,34,34",floralwhite:"255,250,240",forestgreen:"34,139,34",fuchsia:"255,0,255",gainsboro:"220,220,220",ghostwhite:"248,248,255",gold:"255,215,0",goldenrod:"218,165,32",gray:"128,128,128",grey:"128,128,128",greenyellow:"173,255,47",green:"0,128,0",honeydew:"240,255,240",hotpink:"255,105,180",indianred:"205,92,92",indigo:"75,0,130",ivory:"255,255,240",khaki:"240,230,140",lavenderblush:"255,240,245",lavender:"230,230,250",lawngreen:"124,252,0",lemonchiffon:"255,250,205",lightblue:"173,216,230",lightcoral:"240,128,128",lightcyan:"224,255,255",lightgoldenrodyellow:"250,250,210",lightgray:"211,211,211",lightgrey:"211,211,211",lightgreen:"144,238,144",lightpink:"255,182,193",lightsalmon:"255,160,122",lightseagreen:"32,178,170",lightskyblue:"135,206,250",lightslategray:"119,136,153",lightsteelblue:"176,196,222",lightyellow:"255,255,224",limegreen:"50,205,50",lime:"0,255,0",linen:"250,240,230",magenta:"255,0,255",maroon:"128,0,0",mediumaquamarine:"102,205,170",mediumblue:"0,0,205",mediumorchid:"186,85,211",mediumpurple:"147,112,219",mediumseagreen:"60,179,113",mediumslateblue:"123,104,238",mediumspringgreen:"0,250,154",mediumturquoise:"72,209,204",mediumvioletred:"199,21,133",midnightblue:"25,25,112",mintcream:"245,255,250",mistyrose:"255,228,225",moccasin:"255,228,181",navajowhite:"255,222,173",navy:"0,0,128",oldlace:"253,245,230",olivedrab:"107,142,35",olive:"128,128,0",orangered:"255,69,0",orange:"255,165,0",orchid:"218,112,214",palegoldenrod:"238,232,170",palegreen:"152,251,152",paleturquoise:"175,238,238",palevioletred:"219,112,147",papayawhip:"255,239,213",peachpuff:"255,218,185",peru:"205,133,63",pink:"255,192,203",plum:"221,160,221",powderblue:"176,224,230",purple:"128,0,128",red:"255,0,0",rosybrown:"188,143,143",royalblue:"65,105,225",saddlebrown:"139,69,19",salmon:"250,128,114",sandybrown:"244,164,96",seagreen:"46,139,87",seashell:"255,245,238",sienna:"160,82,45",silver:"192,192,192",skyblue:"135,206,235",slateblue:"106,90,205",slategray:"112,128,144",snow:"255,250,250",springgreen:"0,255,127",steelblue:"70,130,180",tan:"210,180,140",teal:"0,128,128",thistle:"216,191,216",tomato:"255,99,71",turquoise:"64,224,208",violet:"238,130,238",wheat:"245,222,179",whitesmoke:"245,245,245",white:"255,255,255",yellowgreen:"154,205,50",yellow:"255,255,0"}},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var e=0;e<S.Lists.colors.length;e++){var t="color"===S.Lists.colors[e]?"0 0 0 1":"255 255 255 1";S.Hooks.templates[S.Lists.colors[e]]=["Red Green Blue Alpha",t]}var n,r,i;if(h)for(n in S.Hooks.templates)if(S.Hooks.templates.hasOwnProperty(n)){r=S.Hooks.templates[n],i=r[0].split(" ");var o=r[1].match(S.RegEx.valueSplit);"Color"===i[0]&&(i.push(i.shift()),o.push(o.shift()),S.Hooks.templates[n]=[i.join(" "),o.join(" ")])}for(n in S.Hooks.templates)if(S.Hooks.templates.hasOwnProperty(n)){r=S.Hooks.templates[n],i=r[0].split(" ");for(var a in i)if(i.hasOwnProperty(a)){var s=n+i[a],u=a;S.Hooks.registered[s]=[n,u]}}},getRoot:function(e){var t=S.Hooks.registered[e];return t?t[0]:e},getUnit:function(e,t){var n=(e.substr(t||0,5).match(/^[a-z%]+/)||[])[0]||"";return n&&S.Lists.units.indexOf(n)>=0?n:""},fixColors:function(e){return e.replace(/(rgba?\(\s*)?(\b[a-z]+\b)/g,function(e,t,n){return S.Lists.colorNames.hasOwnProperty(n)?(t?t:"rgba(")+S.Lists.colorNames[n]+(t?"":",1)"):t+n})},cleanRootPropertyValue:function(e,t){return S.RegEx.valueUnwrap.test(t)&&(t=t.match(S.RegEx.valueUnwrap)[1]),S.Values.isCSSNullValue(t)&&(t=S.Hooks.templates[e][1]),t},extractValue:function(e,t){var n=S.Hooks.registered[e];if(n){var r=n[0],i=n[1];return t=S.Hooks.cleanRootPropertyValue(r,t),t.toString().match(S.RegEx.valueSplit)[i]}return t},injectValue:function(e,t,n){var r=S.Hooks.registered[e];if(r){var i,o,a=r[0],s=r[1];return n=S.Hooks.cleanRootPropertyValue(a,n),i=n.toString().match(S.RegEx.valueSplit),i[s]=t,o=i.join(" ")}return n}},Normalizations:{registered:{clip:function(e,t,n){switch(e){case"name":return"clip";case"extract":var r;return S.RegEx.wrappedValueAlreadyExtracted.test(n)?r=n:(r=n.toString().match(S.RegEx.valueUnwrap),r=r?r[1].replace(/,(\s+)?/g," "):n),r;case"inject":return"rect("+n+")"}},blur:function(e,t,n){switch(e){case"name":return x.State.isFirefox?"filter":"-webkit-filter";case"extract":var r=parseFloat(n);if(!r&&0!==r){var i=n.toString().match(/blur\(([0-9]+[A-z]+)\)/i);r=i?i[1]:0}return r;case"inject":return parseFloat(n)?"blur("+n+")":"none"}},opacity:function(e,t,n){if(h<=8)switch(e){case"name":return"filter";case"extract":var r=n.toString().match(/alpha\(opacity=(.*)\)/i);return n=r?r[1]/100:1;case"inject":return t.style.zoom=1,parseFloat(n)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(n),10)+")"}else switch(e){case"name":return"opacity";case"extract":return n;case"inject":return n}}},register:function(){function e(e,t,n){var r="border-box"===S.getPropertyValue(t,"boxSizing").toString().toLowerCase();if(r===(n||!1)){var i,o,a=0,s="width"===e?["Left","Right"]:["Top","Bottom"],u=["padding"+s[0],"padding"+s[1],"border"+s[0]+"Width","border"+s[1]+"Width"];for(i=0;i<u.length;i++)o=parseFloat(S.getPropertyValue(t,u[i])),isNaN(o)||(a+=o);return n?-a:a}return 0}function t(t,n){return function(r,i,o){switch(r){case"name":return t;case"extract":return parseFloat(o)+e(t,i,n);case"inject":return parseFloat(o)-e(t,i,n)+"px"}}}h&&!(h>9)||x.State.isGingerbread||(S.Lists.transformsBase=S.Lists.transformsBase.concat(S.Lists.transforms3D));for(var n=0;n<S.Lists.transformsBase.length;n++)!function(){var e=S.Lists.transformsBase[n];S.Normalizations.registered[e]=function(t,n,i){switch(t){case"name":return"transform";case"extract":return a(n)===r||a(n).transformCache[e]===r?/^scale/i.test(e)?1:0:a(n).transformCache[e].replace(/[()]/g,"");case"inject":var o=!1;switch(e.substr(0,e.length-1)){case"translate":o=!/(%|px|em|rem|vw|vh|\d)$/i.test(i);break;case"scal":case"scale":x.State.isAndroid&&a(n).transformCache[e]===r&&i<1&&(i=1),o=!/(\d)$/i.test(i);break;case"skew":o=!/(deg|\d)$/i.test(i);break;case"rotate":o=!/(deg|\d)$/i.test(i)}return o||(a(n).transformCache[e]="("+i+")"),a(n).transformCache[e]}}}();for(var i=0;i<S.Lists.colors.length;i++)!function(){var e=S.Lists.colors[i];S.Normalizations.registered[e]=function(t,n,i){switch(t){case"name":return e;case"extract":var o;if(S.RegEx.wrappedValueAlreadyExtracted.test(i))o=i;else{var a,s={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(i)?a=s[i]!==r?s[i]:s.black:S.RegEx.isHex.test(i)?a="rgb("+S.Values.hexToRgb(i).join(" ")+")":/^rgba?\(/i.test(i)||(a=s.black),o=(a||i).toString().match(S.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return(!h||h>8)&&3===o.split(" ").length&&(o+=" 1"),o;case"inject":return/^rgb/.test(i)?i:(h<=8?4===i.split(" ").length&&(i=i.split(/\s+/).slice(0,3).join(" ")):3===i.split(" ").length&&(i+=" 1"),(h<=8?"rgb":"rgba")+"("+i.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")")}}}();S.Normalizations.registered.innerWidth=t("width",!0),S.Normalizations.registered.innerHeight=t("height",!0),S.Normalizations.registered.outerWidth=t("width"),S.Normalizations.registered.outerHeight=t("height")}},Names:{camelCase:function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})},SVGAttribute:function(e){var t="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(h||x.State.isAndroid&&!x.State.isChrome)&&(t+="|transform"),new RegExp("^("+t+")$","i").test(e)},prefixCheck:function(e){if(x.State.prefixMatches[e])return[x.State.prefixMatches[e],!0];for(var t=["","Webkit","Moz","ms","O"],n=0,r=t.length;n<r;n++){var i;if(i=0===n?e:t[n]+e.replace(/^\w/,function(e){return e.toUpperCase()}),v.isString(x.State.prefixElement.style[i]))return x.State.prefixMatches[e]=i,[i,!0]}return[e,!1]}},Values:{hexToRgb:function(e){var t,n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return e=e.replace(n,function(e,t,n,r){return t+t+n+n+r+r}),t=r.exec(e),t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[0,0,0]},isCSSNullValue:function(e){return!e||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(e)},getUnitType:function(e){return/^(rotate|skew)/i.test(e)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(e)?"":"px"},getDisplayType:function(e){var t=e&&e.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(t)?"inline":/^(li)$/i.test(t)?"list-item":/^(tr)$/i.test(t)?"table-row":/^(table)$/i.test(t)?"table":/^(tbody)$/i.test(t)?"table-row-group":"block"},addClass:function(e,t){if(e)if(e.classList)e.classList.add(t);else if(v.isString(e.className))e.className+=(e.className.length?" ":"")+t;else{var n=e.getAttribute(h<=7?"className":"class")||"";e.setAttribute("class",n+(n?" ":"")+t)}},removeClass:function(e,t){if(e)if(e.classList)e.classList.remove(t);else if(v.isString(e.className))e.className=e.className.toString().replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," ");else{var n=e.getAttribute(h<=7?"className":"class")||"";e.setAttribute("class",n.replace(new RegExp("(^|s)"+t.split(" ").join("|")+"(s|$)","gi")," "))}}},getPropertyValue:function(e,n,i,o){function s(e,n){var i=0;if(h<=8)i=p.css(e,n);else{var u=!1;/^(width|height)$/.test(n)&&0===S.getPropertyValue(e,"display")&&(u=!0,S.setPropertyValue(e,"display",S.Values.getDisplayType(e)));var l=function(){u&&S.setPropertyValue(e,"display","none")};if(!o){if("height"===n&&"border-box"!==S.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var c=e.offsetHeight-(parseFloat(S.getPropertyValue(e,"borderTopWidth"))||0)-(parseFloat(S.getPropertyValue(e,"borderBottomWidth"))||0)-(parseFloat(S.getPropertyValue(e,"paddingTop"))||0)-(parseFloat(S.getPropertyValue(e,"paddingBottom"))||0);return l(),c}if("width"===n&&"border-box"!==S.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var f=e.offsetWidth-(parseFloat(S.getPropertyValue(e,"borderLeftWidth"))||0)-(parseFloat(S.getPropertyValue(e,"borderRightWidth"))||0)-(parseFloat(S.getPropertyValue(e,"paddingLeft"))||0)-(parseFloat(S.getPropertyValue(e,"paddingRight"))||0);
return l(),f}}var d;d=a(e)===r?t.getComputedStyle(e,null):a(e).computedStyle?a(e).computedStyle:a(e).computedStyle=t.getComputedStyle(e,null),"borderColor"===n&&(n="borderTopColor"),i=9===h&&"filter"===n?d.getPropertyValue(n):d[n],""!==i&&null!==i||(i=e.style[n]),l()}if("auto"===i&&/^(top|right|bottom|left)$/i.test(n)){var _=s(e,"position");("fixed"===_||"absolute"===_&&/top|left/i.test(n))&&(i=p(e).position()[n]+"px")}return i}var u;if(S.Hooks.registered[n]){var l=n,c=S.Hooks.getRoot(l);i===r&&(i=S.getPropertyValue(e,S.Names.prefixCheck(c)[0])),S.Normalizations.registered[c]&&(i=S.Normalizations.registered[c]("extract",e,i)),u=S.Hooks.extractValue(l,i)}else if(S.Normalizations.registered[n]){var f,d;f=S.Normalizations.registered[n]("name",e),"transform"!==f&&(d=s(e,S.Names.prefixCheck(f)[0]),S.Values.isCSSNullValue(d)&&S.Hooks.templates[n]&&(d=S.Hooks.templates[n][1])),u=S.Normalizations.registered[n]("extract",e,d)}if(!/^[\d-]/.test(u)){var _=a(e);if(_&&_.isSVG&&S.Names.SVGAttribute(n))if(/^(height|width)$/i.test(n))try{u=e.getBBox()[n]}catch(g){u=0}else u=e.getAttribute(n);else u=s(e,S.Names.prefixCheck(n)[0])}return S.Values.isCSSNullValue(u)&&(u=0),x.debug>=2&&console.log("Get "+n+": "+u),u},setPropertyValue:function(e,n,r,i,o){var s=n;if("scroll"===n)o.container?o.container["scroll"+o.direction]=r:"Left"===o.direction?t.scrollTo(r,o.alternateValue):t.scrollTo(o.alternateValue,r);else if(S.Normalizations.registered[n]&&"transform"===S.Normalizations.registered[n]("name",e))S.Normalizations.registered[n]("inject",e,r),s="transform",r=a(e).transformCache[n];else{if(S.Hooks.registered[n]){var u=n,l=S.Hooks.getRoot(n);i=i||S.getPropertyValue(e,l),r=S.Hooks.injectValue(u,r,i),n=l}if(S.Normalizations.registered[n]&&(r=S.Normalizations.registered[n]("inject",e,r),n=S.Normalizations.registered[n]("name",e)),s=S.Names.prefixCheck(n)[0],h<=8)try{e.style[s]=r}catch(c){x.debug&&console.log("Browser does not support ["+r+"] for ["+s+"]")}else{var f=a(e);f&&f.isSVG&&S.Names.SVGAttribute(n)?e.setAttribute(n,r):e.style[s]=r}x.debug>=2&&console.log("Set "+n+" ("+s+"): "+r)}return[s,r]},flushTransformCache:function(e){var t="",n=a(e);if((h||x.State.isAndroid&&!x.State.isChrome)&&n&&n.isSVG){var r=function(t){return parseFloat(S.getPropertyValue(e,t))},i={translate:[r("translateX"),r("translateY")],skewX:[r("skewX")],skewY:[r("skewY")],scale:1!==r("scale")?[r("scale"),r("scale")]:[r("scaleX"),r("scaleY")],rotate:[r("rotateZ"),0,0]};p.each(a(e).transformCache,function(e){/^translate/i.test(e)?e="translate":/^scale/i.test(e)?e="scale":/^rotate/i.test(e)&&(e="rotate"),i[e]&&(t+=e+"("+i[e].join(" ")+") ",delete i[e])})}else{var o,s;p.each(a(e).transformCache,function(n){return o=a(e).transformCache[n],"transformPerspective"===n?(s=o,!0):(9===h&&"rotateZ"===n&&(n="rotate"),void(t+=n+o+" "))}),s&&(t="perspective"+s+" "+t)}S.setPropertyValue(e,"transform",t)}};S.Hooks.register(),S.Normalizations.register(),x.hook=function(e,t,n){var i;return e=o(e),p.each(e,function(e,o){if(a(o)===r&&x.init(o),n===r)i===r&&(i=S.getPropertyValue(o,t));else{var s=S.setPropertyValue(o,t,n);"transform"===s[0]&&x.CSS.flushTransformCache(o),i=s}}),i};var A=function(){function e(){return c?E.promise||null:h}function i(e,i){function o(o){var c,_;if(u.begin&&0===T)try{u.begin.call(m,m)}catch(h){setTimeout(function(){throw h},1)}if("scroll"===D){var g,b,k,A=/^x$/i.test(u.axis)?"Left":"Top",C=parseFloat(u.offset)||0;u.container?v.isWrapped(u.container)||v.isNode(u.container)?(u.container=u.container[0]||u.container,g=u.container["scroll"+A],k=g+p(e).position()[A.toLowerCase()]+C):u.container=null:(g=x.State.scrollAnchor[x.State["scrollProperty"+A]],b=x.State.scrollAnchor[x.State["scrollProperty"+("Left"===A?"Top":"Left")]],k=p(e).offset()[A.toLowerCase()]+C),l={scroll:{rootPropertyValue:!1,startValue:g,currentValue:g,endValue:k,unitType:"",easing:u.easing,scrollData:{container:u.container,direction:A,alternateValue:b}},element:e},x.debug&&console.log("tweensContainer (scroll): ",l.scroll,e)}else if("reverse"===D){if(c=a(e),!c)return;if(!c.tweensContainer)return void p.dequeue(e,u.queue);"none"===c.opts.display&&(c.opts.display="auto"),"hidden"===c.opts.visibility&&(c.opts.visibility="visible"),c.opts.loop=!1,c.opts.begin=null,c.opts.complete=null,w.easing||delete u.easing,w.duration||delete u.duration,u=p.extend({},c.opts,u),_=p.extend(!0,{},c?c.tweensContainer:null);for(var j in _)if(_.hasOwnProperty(j)&&"element"!==j){var O=_[j].startValue;_[j].startValue=_[j].currentValue=_[j].endValue,_[j].endValue=O,v.isEmptyObject(w)||(_[j].easing=u.easing),x.debug&&console.log("reverse tweensContainer ("+j+"): "+JSON.stringify(_[j]),e)}l=_}else if("start"===D){c=a(e),c&&c.tweensContainer&&c.isAnimating===!0&&(_=c.tweensContainer);var I=function(t,n){var r,o,a;return v.isFunction(t)&&(t=t.call(e,i,M)),v.isArray(t)?(r=t[0],!v.isArray(t[1])&&/^[\d-]/.test(t[1])||v.isFunction(t[1])||S.RegEx.isHex.test(t[1])?a=t[1]:v.isString(t[1])&&!S.RegEx.isHex.test(t[1])&&x.Easings[t[1]]||v.isArray(t[1])?(o=n?t[1]:f(t[1],u.duration),a=t[2]):a=t[1]||t[2]):r=t,n||(o=o||u.easing),v.isFunction(r)&&(r=r.call(e,i,M)),v.isFunction(a)&&(a=a.call(e,i,M)),[r||0,o,a]},P=function(i,o){var a,f=S.Hooks.getRoot(i),d=!1,h=o[0],g=o[1],m=o[2];if(!(c&&c.isSVG||"tween"===f||S.Names.prefixCheck(f)[1]!==!1||S.Normalizations.registered[f]!==r))return void(x.debug&&console.log("Skipping ["+f+"] due to a lack of browser support."));(u.display!==r&&null!==u.display&&"none"!==u.display||u.visibility!==r&&"hidden"!==u.visibility)&&/opacity|filter/.test(i)&&!m&&0!==h&&(m=0),u._cacheValues&&_&&_[i]?(m===r&&(m=_[i].endValue+_[i].unitType),d=c.rootPropertyValueCache[f]):S.Hooks.registered[i]?m===r?(d=S.getPropertyValue(e,f),m=S.getPropertyValue(e,i,d)):d=S.Hooks.templates[f][1]:m===r&&(m=S.getPropertyValue(e,i));var y,b,w,k=!1,A=function(e,t){var n,r;return r=(t||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(e){return n=e,""}),n||(n=S.Values.getUnitType(e)),[r,n]};if(m!==h&&v.isString(m)&&v.isString(h)){a="";var E=0,M=0,T=[],C=[],j=0,D=0,O=0;for(m=S.Hooks.fixColors(m),h=S.Hooks.fixColors(h);E<m.length&&M<h.length;){var I=m[E],P=h[M];if(/[\d\.]/.test(I)&&/[\d\.]/.test(P)){for(var R=I,z=P,N=".",L=".";++E<m.length;){if(I=m[E],I===N)N="..";else if(!/\d/.test(I))break;R+=I}for(;++M<h.length;){if(P=h[M],P===L)L="..";else if(!/\d/.test(P))break;z+=P}var q=S.Hooks.getUnit(m,E),U=S.Hooks.getUnit(h,M);if(E+=q.length,M+=U.length,q===U)R===z?a+=R+q:(a+="{"+T.length+(D?"!":"")+"}"+q,T.push(parseFloat(R)),C.push(parseFloat(z)));else{var F=parseFloat(R),W=parseFloat(z);a+=(j<5?"calc":"")+"("+(F?"{"+T.length+(D?"!":"")+"}":"0")+q+" + "+(W?"{"+(T.length+1)+(D?"!":"")+"}":"0")+U+")",F&&(T.push(parseFloat(R)),T.push(parseFloat(0))),W&&(C.push(parseFloat(0)),C.push(parseFloat(z)))}}else{if(I!==P){j=0;break}a+=I,E++,M++,0===j&&"c"===I||1===j&&"a"===I||2===j&&"l"===I||3===j&&"c"===I||j>=4&&"("===I?j++:(j&&j<5||j>=4&&")"===I&&--j<5)&&(j=0),0===D&&"r"===I||1===D&&"g"===I||2===D&&"b"===I||3===D&&"a"===I||D>=3&&"("===I?(3===D&&"a"===I&&(O=1),D++):O&&","===I?++O>3&&(D=O=0):(O&&D<(O?5:4)||D>=(O?4:3)&&")"===I&&--D<(O?5:4))&&(D=O=0)}}E===m.length&&M===h.length||(x.debug&&console.error('Trying to pattern match mis-matched strings ["'+h+'", "'+m+'"]'),a=r),a&&(T.length?(x.debug&&console.log('Pattern found "'+a+'" -> ',T,C,"["+m+","+h+"]"),m=T,h=C,b=w=""):a=r)}a||(y=A(i,m),m=y[0],w=y[1],y=A(i,h),h=y[0].replace(/^([+-\/*])=/,function(e,t){return k=t,""}),b=y[1],m=parseFloat(m)||0,h=parseFloat(h)||0,"%"===b&&(/^(fontSize|lineHeight)$/.test(i)?(h/=100,b="em"):/^scale/.test(i)?(h/=100,b=""):/(Red|Green|Blue)$/i.test(i)&&(h=h/100*255,b="")));var G=function(){var r={myParent:e.parentNode||n.body,position:S.getPropertyValue(e,"position"),fontSize:S.getPropertyValue(e,"fontSize")},i=r.position===B.lastPosition&&r.myParent===B.lastParent,o=r.fontSize===B.lastFontSize;B.lastParent=r.myParent,B.lastPosition=r.position,B.lastFontSize=r.fontSize;var a=100,s={};if(o&&i)s.emToPx=B.lastEmToPx,s.percentToPxWidth=B.lastPercentToPxWidth,s.percentToPxHeight=B.lastPercentToPxHeight;else{var u=c&&c.isSVG?n.createElementNS("http://www.w3.org/2000/svg","rect"):n.createElement("div");x.init(u),r.myParent.appendChild(u),p.each(["overflow","overflowX","overflowY"],function(e,t){x.CSS.setPropertyValue(u,t,"hidden")}),x.CSS.setPropertyValue(u,"position",r.position),x.CSS.setPropertyValue(u,"fontSize",r.fontSize),x.CSS.setPropertyValue(u,"boxSizing","content-box"),p.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(e,t){x.CSS.setPropertyValue(u,t,a+"%")}),x.CSS.setPropertyValue(u,"paddingLeft",a+"em"),s.percentToPxWidth=B.lastPercentToPxWidth=(parseFloat(S.getPropertyValue(u,"width",null,!0))||1)/a,s.percentToPxHeight=B.lastPercentToPxHeight=(parseFloat(S.getPropertyValue(u,"height",null,!0))||1)/a,s.emToPx=B.lastEmToPx=(parseFloat(S.getPropertyValue(u,"paddingLeft"))||1)/a,r.myParent.removeChild(u)}return null===B.remToPx&&(B.remToPx=parseFloat(S.getPropertyValue(n.body,"fontSize"))||16),null===B.vwToPx&&(B.vwToPx=parseFloat(t.innerWidth)/100,B.vhToPx=parseFloat(t.innerHeight)/100),s.remToPx=B.remToPx,s.vwToPx=B.vwToPx,s.vhToPx=B.vhToPx,x.debug>=1&&console.log("Unit ratios: "+JSON.stringify(s),e),s};if(/[\/*]/.test(k))b=w;else if(w!==b&&0!==m)if(0===h)b=w;else{s=s||G();var V=/margin|padding|left|right|width|text|word|letter/i.test(i)||/X$/.test(i)||"x"===i?"x":"y";switch(w){case"%":m*="x"===V?s.percentToPxWidth:s.percentToPxHeight;break;case"px":break;default:m*=s[w+"ToPx"]}switch(b){case"%":m*=1/("x"===V?s.percentToPxWidth:s.percentToPxHeight);break;case"px":break;default:m*=1/s[b+"ToPx"]}}switch(k){case"+":h=m+h;break;case"-":h=m-h;break;case"*":h=m*h;break;case"/":h=m/h}l[i]={rootPropertyValue:d,startValue:m,currentValue:m,endValue:h,unitType:b,easing:g},a&&(l[i].pattern=a),x.debug&&console.log("tweensContainer ("+i+"): "+JSON.stringify(l[i]),e)};for(var R in y)if(y.hasOwnProperty(R)){var z=S.Names.camelCase(R),L=I(y[R]);if(S.Lists.colors.indexOf(z)>=0){var q=L[0],U=L[1],F=L[2];if(S.RegEx.isHex.test(q)){for(var W=["Red","Green","Blue"],G=S.Values.hexToRgb(q),V=F?S.Values.hexToRgb(F):r,Y=0;Y<W.length;Y++){var H=[G[Y]];U&&H.push(U),V!==r&&H.push(V[Y]),P(z+W[Y],H)}continue}}P(z,L)}l.element=e}l.element&&(S.Values.addClass(e,"velocity-animating"),N.push(l),c=a(e),c&&(""===u.queue&&(c.tweensContainer=l,c.opts=u),c.isAnimating=!0),T===M-1?(x.State.calls.push([N,m,u,null,E.resolver,null,0]),x.State.isTicking===!1&&(x.State.isTicking=!0,d())):T++)}var s,u=p.extend({},x.defaults,w),l={};switch(a(e)===r&&x.init(e),parseFloat(u.delay)&&u.queue!==!1&&p.queue(e,u.queue,function(t){x.velocityQueueEntryFlag=!0;var n=x.State.delayedElements.count++;x.State.delayedElements[n]=e;var r=function(e){return function(){x.State.delayedElements[e]=!1,t()}}(n);a(e).delayBegin=(new Date).getTime(),a(e).delay=parseFloat(u.delay),a(e).delayTimer={setTimeout:setTimeout(t,parseFloat(u.delay)),next:r}}),u.duration.toString().toLowerCase()){case"fast":u.duration=200;break;case"normal":u.duration=b;break;case"slow":u.duration=600;break;default:u.duration=parseFloat(u.duration)||1}if(x.mock!==!1&&(x.mock===!0?u.duration=u.delay=1:(u.duration*=parseFloat(x.mock)||1,u.delay*=parseFloat(x.mock)||1)),u.easing=f(u.easing,u.duration),u.begin&&!v.isFunction(u.begin)&&(u.begin=null),u.progress&&!v.isFunction(u.progress)&&(u.progress=null),u.complete&&!v.isFunction(u.complete)&&(u.complete=null),u.display!==r&&null!==u.display&&(u.display=u.display.toString().toLowerCase(),"auto"===u.display&&(u.display=x.CSS.Values.getDisplayType(e))),u.visibility!==r&&null!==u.visibility&&(u.visibility=u.visibility.toString().toLowerCase()),u.mobileHA=u.mobileHA&&x.State.isMobile&&!x.State.isGingerbread,u.queue===!1)if(u.delay){var c=x.State.delayedElements.count++;x.State.delayedElements[c]=e;var _=function(e){return function(){x.State.delayedElements[e]=!1,o()}}(c);a(e).delayBegin=(new Date).getTime(),a(e).delay=parseFloat(u.delay),a(e).delayTimer={setTimeout:setTimeout(o,parseFloat(u.delay)),next:_}}else o();else p.queue(e,u.queue,function(e,t){return t===!0?(E.promise&&E.resolver(m),!0):(x.velocityQueueEntryFlag=!0,void o(e))});""!==u.queue&&"fx"!==u.queue||"inprogress"===p.queue(e)[0]||p.dequeue(e)}var l,c,h,g,m,y,w,k=arguments[0]&&(arguments[0].p||p.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||v.isString(arguments[0].properties));v.isWrapped(this)?(c=!1,g=0,m=this,h=this):(c=!0,g=1,m=k?arguments[0].elements||arguments[0].e:arguments[0]);var E={promise:null,resolver:null,rejecter:null};if(c&&x.Promise&&(E.promise=new x.Promise(function(e,t){E.resolver=e,E.rejecter=t})),k?(y=arguments[0].properties||arguments[0].p,w=arguments[0].options||arguments[0].o):(y=arguments[g],w=arguments[g+1]),m=o(m),!m)return void(E.promise&&(y&&w&&w.promiseRejectEmpty===!1?E.resolver():E.rejecter()));var M=m.length,T=0;if(!/^(stop|finish|finishAll|pause|resume)$/i.test(y)&&!p.isPlainObject(w)){var C=g+1;w={};for(var j=C;j<arguments.length;j++)v.isArray(arguments[j])||!/^(fast|normal|slow)$/i.test(arguments[j])&&!/^\d/.test(arguments[j])?v.isString(arguments[j])||v.isArray(arguments[j])?w.easing=arguments[j]:v.isFunction(arguments[j])&&(w.complete=arguments[j]):w.duration=arguments[j]}var D;switch(y){case"scroll":D="scroll";break;case"reverse":D="reverse";break;case"pause":var O=(new Date).getTime();return p.each(m,function(e,t){s(t,O)}),p.each(x.State.calls,function(e,t){var n=!1;t&&p.each(t[1],function(e,i){var o=w===r?"":w;return o!==!0&&t[2].queue!==o&&(w!==r||t[2].queue!==!1)||(p.each(m,function(e,r){if(r===i)return t[5]={resume:!1},n=!0,!1}),!n&&void 0)})}),e();case"resume":return p.each(m,function(e,t){u(t,O)}),p.each(x.State.calls,function(e,t){var n=!1;t&&p.each(t[1],function(e,i){var o=w===r?"":w;return o!==!0&&t[2].queue!==o&&(w!==r||t[2].queue!==!1)||(!t[5]||(p.each(m,function(e,r){if(r===i)return t[5].resume=!0,n=!0,!1}),!n&&void 0))})}),e();case"finish":case"finishAll":case"stop":p.each(m,function(e,t){a(t)&&a(t).delayTimer&&(clearTimeout(a(t).delayTimer.setTimeout),a(t).delayTimer.next&&a(t).delayTimer.next(),delete a(t).delayTimer),"finishAll"!==y||w!==!0&&!v.isString(w)||(p.each(p.queue(t,v.isString(w)?w:""),function(e,t){v.isFunction(t)&&t()}),p.queue(t,v.isString(w)?w:"",[]))});var I=[];return p.each(x.State.calls,function(e,t){t&&p.each(t[1],function(n,i){var o=w===r?"":w;return o!==!0&&t[2].queue!==o&&(w!==r||t[2].queue!==!1)||void p.each(m,function(n,r){if(r===i)if((w===!0||v.isString(w))&&(p.each(p.queue(r,v.isString(w)?w:""),function(e,t){v.isFunction(t)&&t(null,!0)}),p.queue(r,v.isString(w)?w:"",[])),"stop"===y){var s=a(r);s&&s.tweensContainer&&o!==!1&&p.each(s.tweensContainer,function(e,t){t.endValue=t.currentValue}),I.push(e)}else"finish"!==y&&"finishAll"!==y||(t[2].duration=1)})})}),"stop"===y&&(p.each(I,function(e,t){_(t,!0)}),E.promise&&E.resolver(m)),e();default:if(!p.isPlainObject(y)||v.isEmptyObject(y)){if(v.isString(y)&&x.Redirects[y]){l=p.extend({},w);var P=l.duration,R=l.delay||0;return l.backwards===!0&&(m=p.extend(!0,[],m).reverse()),p.each(m,function(e,t){parseFloat(l.stagger)?l.delay=R+parseFloat(l.stagger)*e:v.isFunction(l.stagger)&&(l.delay=R+l.stagger.call(t,e,M)),l.drag&&(l.duration=parseFloat(P)||(/^(callout|transition)/.test(y)?1e3:b),l.duration=Math.max(l.duration*(l.backwards?1-e/M:(e+1)/M),.75*l.duration,200)),x.Redirects[y].call(t,t,l||{},e,M,m,E.promise?E:r)}),e()}var z="Velocity: First argument ("+y+") was not a property map, a known action, or a registered redirect. Aborting.";return E.promise?E.rejecter(new Error(z)):console.log(z),e()}D="start"}var B={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},N=[];p.each(m,function(e,t){v.isNode(t)&&i(t,e)}),l=p.extend({},x.defaults,w),l.loop=parseInt(l.loop,10);var L=2*l.loop-1;if(l.loop)for(var q=0;q<L;q++){var U={delay:l.delay,progress:l.progress};q===L-1&&(U.display=l.display,U.visibility=l.visibility,U.complete=l.complete),A(m,"reverse",U)}return e()};x=p.extend(A,x),x.animate=A;var E=t.requestAnimationFrame||g;if(!x.State.isMobile&&n.hidden!==r){var M=function(){n.hidden?(E=function(e){return setTimeout(function(){e(!0)},16)},d()):E=t.requestAnimationFrame||g};M(),n.addEventListener("visibilitychange",M)}return e.Velocity=x,e!==t&&(e.fn.velocity=A,e.fn.velocity.defaults=x.defaults),p.each(["Down","Up"],function(e,t){x.Redirects["slide"+t]=function(e,n,i,o,a,s){var u=p.extend({},n),l=u.begin,c=u.complete,f={},d={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""};u.display===r&&(u.display="Down"===t?"inline"===x.CSS.Values.getDisplayType(e)?"inline-block":"block":"none"),u.begin=function(){0===i&&l&&l.call(a,a);for(var n in d)if(d.hasOwnProperty(n)){f[n]=e.style[n];var r=S.getPropertyValue(e,n);d[n]="Down"===t?[r,0]:[0,r]}f.overflow=e.style.overflow,e.style.overflow="hidden"},u.complete=function(){for(var t in f)f.hasOwnProperty(t)&&(e.style[t]=f[t]);i===o-1&&(c&&c.call(a,a),s&&s.resolver(a))},x(e,d,u)}}),p.each(["In","Out"],function(e,t){x.Redirects["fade"+t]=function(e,n,i,o,a,s){var u=p.extend({},n),l=u.complete,c={opacity:"In"===t?1:0};0!==i&&(u.begin=null),i!==o-1?u.complete=null:u.complete=function(){l&&l.call(a,a),s&&s.resolver(a)},u.display===r&&(u.display="In"===t?"auto":"none"),x(this,c,u)}}),x}(window.jQuery||window.Zepto||window,window,window?window.document:void 0)})},{}],45:[function(e,t,n){!function(r){"use strict";"function"==typeof e&&"object"==typeof n?t.exports=r():"function"==typeof define&&define.amd?define(["velocity"],r):r()}(function(){"use strict";return function(e,t,n,r){function i(e,t){var n=[];return!(!e||!t)&&(a.each([e,t],function(e,t){var r=[];a.each(t,function(e,t){for(;t.toString().length<5;)t="0"+t;r.push(t)}),n.push(r.join(""))}),parseFloat(n[0])>parseFloat(n[1]))}var o=e.Velocity;if(!o||!o.Utilities)return void(t.console&&console.log("Velocity UI Pack: Velocity must be loaded first. Aborting."));var a=o.Utilities,s=o.version,u={major:1,minor:1,patch:0};if(i(u,s)){var l="Velocity UI Pack: You need to update Velocity (velocity.js) to a newer version. Visit http://github.com/julianshapiro/velocity.";throw alert(l),new Error(l)}o.RegisterEffect=o.RegisterUI=function(e,t){function n(e,t,n,r){var i,s=0;a.each(e.nodeType?[e]:e,function(e,t){r&&(n+=e*r),i=t.parentNode;var u=["height","paddingTop","paddingBottom","marginTop","marginBottom"];"border-box"===o.CSS.getPropertyValue(t,"boxSizing").toString().toLowerCase()&&(u=["height"]),a.each(u,function(e,n){s+=parseFloat(o.CSS.getPropertyValue(t,n))})}),o.animate(i,{height:("In"===t?"+":"-")+"="+s},{queue:!1,easing:"ease-in-out",duration:n*("In"===t?.6:1)})}return o.Redirects[e]=function(i,s,u,l,c,f,d){var _=u===l-1;d=d||t.loop,"function"==typeof t.defaultDuration?t.defaultDuration=t.defaultDuration.call(c,c):t.defaultDuration=parseFloat(t.defaultDuration);for(var p=0;p<t.calls.length;p++){var h=t.calls[p],g=h[0],m=1e3,v=h[1],y=h[2]||{},b={};if(s.duration!==r?m=s.duration:t.defaultDuration!==r&&(m=t.defaultDuration),b.duration=m*(v||1),b.queue=s.queue||"",b.easing=y.easing||"ease",b.delay=parseFloat(y.delay)||0,b.loop=!t.loop&&y.loop,b._cacheValues=y._cacheValues||!0,0===p){if(b.delay+=parseFloat(s.delay)||0,0===u&&(b.begin=function(){s.begin&&s.begin.call(c,c);var t=e.match(/(In|Out)$/);t&&"In"===t[0]&&g.opacity!==r&&a.each(c.nodeType?[c]:c,function(e,t){o.CSS.setPropertyValue(t,"opacity",0)}),s.animateParentHeight&&t&&n(c,t[0],m+b.delay,s.stagger)}),null!==s.display)if(s.display!==r&&"none"!==s.display)b.display=s.display;else if(/In$/.test(e)){var w=o.CSS.Values.getDisplayType(i);b.display="inline"===w?"inline-block":w}s.visibility&&"hidden"!==s.visibility&&(b.visibility=s.visibility)}if(p===t.calls.length-1){var x=function(){s.display!==r&&"none"!==s.display||!/Out$/.test(e)||a.each(c.nodeType?[c]:c,function(e,t){o.CSS.setPropertyValue(t,"display","none")}),s.complete&&s.complete.call(c,c),f&&f.resolver(c||i)};b.complete=function(){if(d&&o.Redirects[e](i,s,u,l,c,f,d===!0||Math.max(0,d-1)),t.reset){for(var n in t.reset)if(t.reset.hasOwnProperty(n)){var a=t.reset[n];o.CSS.Hooks.registered[n]!==r||"string"!=typeof a&&"number"!=typeof a||(t.reset[n]=[t.reset[n],t.reset[n]])}var p={duration:0,queue:!1};_&&(p.complete=x),o.animate(i,t.reset,p)}else _&&x()},"hidden"===s.visibility&&(b.visibility=s.visibility)}o.animate(i,g,b)}},o},o.RegisterEffect.packagedEffects={"callout.bounce":{defaultDuration:550,calls:[[{translateY:-30},.25],[{translateY:0},.125],[{translateY:-15},.125],[{translateY:0},.25]]},"callout.shake":{defaultDuration:800,calls:[[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:11},.125],[{translateX:-11},.125],[{translateX:0},.125]]},"callout.flash":{defaultDuration:1100,calls:[[{opacity:[0,"easeInOutQuad",1]},.25],[{opacity:[1,"easeInOutQuad"]},.25],[{opacity:[0,"easeInOutQuad"]},.25],[{opacity:[1,"easeInOutQuad"]},.25]]},"callout.pulse":{defaultDuration:825,calls:[[{scaleX:1.1,scaleY:1.1},.5,{easing:"easeInExpo"}],[{scaleX:1,scaleY:1},.5]]},"callout.swing":{defaultDuration:950,calls:[[{rotateZ:15},.2],[{rotateZ:-10},.2],[{rotateZ:5},.2],[{rotateZ:-5},.2],[{rotateZ:0},.2]]},"callout.tada":{defaultDuration:1e3,calls:[[{scaleX:.9,scaleY:.9,rotateZ:-3},.1],[{scaleX:1.1,scaleY:1.1,rotateZ:3},.1],[{scaleX:1.1,scaleY:1.1,rotateZ:-3},.1],["reverse",.125],["reverse",.125],["reverse",.125],["reverse",.125],["reverse",.125],[{scaleX:1,scaleY:1,rotateZ:0},.2]]},"transition.fadeIn":{defaultDuration:500,calls:[[{opacity:[1,0]}]]},"transition.fadeOut":{defaultDuration:500,calls:[[{opacity:[0,1]}]]},"transition.flipXIn":{defaultDuration:700,calls:[[{opacity:[1,0],transformPerspective:[800,800],rotateY:[0,-55]}]],reset:{transformPerspective:0}},"transition.flipXOut":{defaultDuration:700,calls:[[{opacity:[0,1],transformPerspective:[800,800],rotateY:55}]],reset:{transformPerspective:0,rotateY:0}},"transition.flipYIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],rotateX:[0,-45]}]],reset:{transformPerspective:0}},"transition.flipYOut":{defaultDuration:800,calls:[[{opacity:[0,1],transformPerspective:[800,800],rotateX:25}]],reset:{transformPerspective:0,rotateX:0}},"transition.flipBounceXIn":{defaultDuration:900,calls:[[{opacity:[.725,0],transformPerspective:[400,400],rotateY:[-10,90]},.5],[{opacity:.8,rotateY:10},.25],[{opacity:1,rotateY:0},.25]],reset:{transformPerspective:0}},"transition.flipBounceXOut":{defaultDuration:800,calls:[[{opacity:[.9,1],transformPerspective:[400,400],rotateY:-10},.5],[{opacity:0,rotateY:90},.5]],reset:{transformPerspective:0,rotateY:0}},"transition.flipBounceYIn":{defaultDuration:850,calls:[[{opacity:[.725,0],transformPerspective:[400,400],rotateX:[-10,90]},.5],[{opacity:.8,rotateX:10},.25],[{opacity:1,rotateX:0},.25]],reset:{transformPerspective:0}},"transition.flipBounceYOut":{defaultDuration:800,calls:[[{opacity:[.9,1],transformPerspective:[400,400],rotateX:-15},.5],[{opacity:0,rotateX:90},.5]],reset:{transformPerspective:0,rotateX:0}},"transition.swoopIn":{defaultDuration:850,calls:[[{opacity:[1,0],transformOriginX:["100%","50%"],transformOriginY:["100%","100%"],scaleX:[1,0],scaleY:[1,0],translateX:[0,-700],translateZ:0}]],reset:{transformOriginX:"50%",transformOriginY:"50%"}},"transition.swoopOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformOriginX:["50%","100%"],transformOriginY:["100%","100%"],scaleX:0,scaleY:0,translateX:-700,translateZ:0}]],reset:{transformOriginX:"50%",transformOriginY:"50%",scaleX:1,scaleY:1,translateX:0}},"transition.whirlIn":{defaultDuration:850,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,0],scaleY:[1,0],rotateY:[0,160]},1,{easing:"easeInOutSine"}]]},"transition.whirlOut":{defaultDuration:750,calls:[[{opacity:[0,"easeInOutQuint",1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:0,scaleY:0,rotateY:160},1,{easing:"swing"}]],reset:{scaleX:1,scaleY:1,rotateY:0}},"transition.shrinkIn":{defaultDuration:750,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,1.5],scaleY:[1,1.5],translateZ:0}]]},"transition.shrinkOut":{defaultDuration:600,calls:[[{opacity:[0,1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:1.3,scaleY:1.3,translateZ:0}]],reset:{scaleX:1,scaleY:1}},"transition.expandIn":{defaultDuration:700,calls:[[{opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:[1,.625],scaleY:[1,.625],translateZ:0}]]},"transition.expandOut":{defaultDuration:700,calls:[[{opacity:[0,1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],scaleX:.5,scaleY:.5,translateZ:0}]],reset:{scaleX:1,scaleY:1}},"transition.bounceIn":{defaultDuration:800,calls:[[{opacity:[1,0],scaleX:[1.05,.3],scaleY:[1.05,.3]},.4],[{scaleX:.9,scaleY:.9,translateZ:0},.2],[{scaleX:1,scaleY:1},.5]]},"transition.bounceOut":{defaultDuration:800,calls:[[{scaleX:.95,scaleY:.95},.35],[{scaleX:1.1,scaleY:1.1,translateZ:0},.35],[{opacity:[0,1],scaleX:.3,scaleY:.3},.3]],reset:{scaleX:1,scaleY:1}},"transition.bounceUpIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateY:[-30,1e3]},.6,{easing:"easeOutCirc"}],[{translateY:10},.2],[{translateY:0},.2]]},"transition.bounceUpOut":{defaultDuration:1e3,calls:[[{translateY:20},.2],[{opacity:[0,"easeInCirc",1],translateY:-1e3},.8]],reset:{translateY:0}},"transition.bounceDownIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateY:[30,-1e3]},.6,{easing:"easeOutCirc"}],[{translateY:-10},.2],[{translateY:0},.2]]},"transition.bounceDownOut":{defaultDuration:1e3,calls:[[{translateY:-20},.2],[{opacity:[0,"easeInCirc",1],translateY:1e3},.8]],reset:{translateY:0}},"transition.bounceLeftIn":{defaultDuration:750,calls:[[{opacity:[1,0],translateX:[30,-1250]},.6,{easing:"easeOutCirc"}],[{translateX:-10},.2],[{translateX:0},.2]]},"transition.bounceLeftOut":{defaultDuration:750,calls:[[{translateX:30},.2],[{opacity:[0,"easeInCirc",1],translateX:-1250},.8]],reset:{translateX:0}},"transition.bounceRightIn":{defaultDuration:750,calls:[[{opacity:[1,0],translateX:[-30,1250]},.6,{easing:"easeOutCirc"}],[{translateX:10},.2],[{translateX:0},.2]]},"transition.bounceRightOut":{defaultDuration:750,calls:[[{translateX:-30},.2],[{opacity:[0,"easeInCirc",1],translateX:1250},.8]],reset:{translateX:0}},"transition.slideUpIn":{defaultDuration:900,calls:[[{opacity:[1,0],translateY:[0,20],translateZ:0}]]},"transition.slideUpOut":{defaultDuration:900,calls:[[{opacity:[0,1],translateY:-20,translateZ:0}]],reset:{translateY:0}},"transition.slideDownIn":{defaultDuration:900,calls:[[{opacity:[1,0],translateY:[0,-20],translateZ:0}]]},"transition.slideDownOut":{defaultDuration:900,calls:[[{opacity:[0,1],translateY:20,translateZ:0}]],reset:{translateY:0}},"transition.slideLeftIn":{defaultDuration:1e3,calls:[[{opacity:[1,0],translateX:[0,-20],translateZ:0}]]},"transition.slideLeftOut":{defaultDuration:1050,calls:[[{opacity:[0,1],translateX:-20,translateZ:0}]],reset:{translateX:0}},"transition.slideRightIn":{defaultDuration:1e3,calls:[[{opacity:[1,0],translateX:[0,20],translateZ:0}]]},"transition.slideRightOut":{defaultDuration:1050,calls:[[{opacity:[0,1],translateX:20,translateZ:0}]],reset:{translateX:0}},"transition.slideUpBigIn":{defaultDuration:850,calls:[[{opacity:[1,0],translateY:[0,75],translateZ:0}]]},"transition.slideUpBigOut":{defaultDuration:800,calls:[[{opacity:[0,1],translateY:-75,translateZ:0}]],reset:{translateY:0}},"transition.slideDownBigIn":{defaultDuration:850,calls:[[{opacity:[1,0],translateY:[0,-75],translateZ:0}]]},"transition.slideDownBigOut":{defaultDuration:800,calls:[[{opacity:[0,1],translateY:75,translateZ:0}]],reset:{translateY:0}},"transition.slideLeftBigIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateX:[0,-75],translateZ:0}]]},"transition.slideLeftBigOut":{defaultDuration:750,calls:[[{opacity:[0,1],translateX:-75,translateZ:0}]],reset:{translateX:0}},"transition.slideRightBigIn":{defaultDuration:800,calls:[[{opacity:[1,0],translateX:[0,75],translateZ:0}]]},"transition.slideRightBigOut":{defaultDuration:750,calls:[[{opacity:[0,1],translateX:75,translateZ:0}]],reset:{translateX:0}},"transition.perspectiveUpIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:["100%","100%"],rotateX:[0,-180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveUpOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:["100%","100%"],rotateX:-180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateX:0}},"transition.perspectiveDownIn":{defaultDuration:800,calls:[[{opacity:[1,0],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[0,0],rotateX:[0,180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveDownOut":{defaultDuration:850,calls:[[{opacity:[0,1],transformPerspective:[800,800],transformOriginX:[0,0],transformOriginY:[0,0],rotateX:180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateX:0}},"transition.perspectiveLeftIn":{defaultDuration:950,calls:[[{opacity:[1,0],transformPerspective:[2e3,2e3],transformOriginX:[0,0],transformOriginY:[0,0],rotateY:[0,-180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveLeftOut":{defaultDuration:950,calls:[[{opacity:[0,1],transformPerspective:[2e3,2e3],transformOriginX:[0,0],transformOriginY:[0,0],rotateY:-180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateY:0}},"transition.perspectiveRightIn":{defaultDuration:950,calls:[[{opacity:[1,0],transformPerspective:[2e3,2e3],transformOriginX:["100%","100%"],transformOriginY:[0,0],rotateY:[0,180]}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%"}},"transition.perspectiveRightOut":{defaultDuration:950,calls:[[{opacity:[0,1],transformPerspective:[2e3,2e3],transformOriginX:["100%","100%"],transformOriginY:[0,0],rotateY:180}]],reset:{transformPerspective:0,transformOriginX:"50%",transformOriginY:"50%",rotateY:0}}};for(var c in o.RegisterEffect.packagedEffects)o.RegisterEffect.packagedEffects.hasOwnProperty(c)&&o.RegisterEffect(c,o.RegisterEffect.packagedEffects[c]);o.RunSequence=function(e){var t=a.extend(!0,[],e);t.length>1&&(a.each(t.reverse(),function(e,n){var r=t[e+1];if(r){var i=n.o||n.options,s=r.o||r.options,u=i&&i.sequenceQueue===!1?"begin":"complete",l=s&&s[u],c={};c[u]=function(){var e=r.e||r.elements,t=e.nodeType?[e]:e;l&&l.call(t,t),o(n)},r.o?r.o=a.extend({},s,c):r.options=a.extend({},s,c)}}),t.reverse()),o(t[0])}}(window.jQuery||window.Zepto||window,window,window?window.document:void 0)})},{}],46:[function(e,t,n){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.moment=r()}(this,function(){"use strict";function n(){return hr.apply(null,arguments)}function r(e){hr=e}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function o(e){return"[object Object]"===Object.prototype.toString.call(e)}function a(e){var t;for(t in e)return!1;return!0}function s(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function u(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){for(var n in t)l(t,n)&&(e[n]=t[n]);return l(t,"toString")&&(e.toString=t.toString),l(t,"valueOf")&&(e.valueOf=t.valueOf),e}function f(e,t,n,r){return vt(e,t,n,r,!0).utc()}function d(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],
meridiem:null}}function _(e){return null==e._pf&&(e._pf=d()),e._pf}function p(e){if(null==e._isValid){var t=_(e),n=gr.call(t.parsedDateParts,function(e){return null!=e});e._isValid=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n),e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function h(e){var t=f(NaN);return null!=e?c(_(t),e):_(t).userInvalidated=!0,t}function g(e){return void 0===e}function m(e,t){var n,r,i;if(g(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),g(t._i)||(e._i=t._i),g(t._f)||(e._f=t._f),g(t._l)||(e._l=t._l),g(t._strict)||(e._strict=t._strict),g(t._tzm)||(e._tzm=t._tzm),g(t._isUTC)||(e._isUTC=t._isUTC),g(t._offset)||(e._offset=t._offset),g(t._pf)||(e._pf=_(t)),g(t._locale)||(e._locale=t._locale),mr.length>0)for(n in mr)r=mr[n],i=t[r],g(i)||(e[r]=i);return e}function v(e){m(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),vr===!1&&(vr=!0,n.updateOffset(this),vr=!1)}function y(e){return e instanceof v||null!=e&&null!=e._isAMomentObject}function b(e){return 0>e?Math.ceil(e)||0:Math.floor(e)}function w(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=b(t)),n}function x(e,t,n){var r,i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(r=0;i>r;r++)(n&&e[r]!==t[r]||!n&&w(e[r])!==w(t[r]))&&a++;return a+o}function k(e){n.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function S(e,t){var r=!0;return c(function(){return null!=n.deprecationHandler&&n.deprecationHandler(null,e),r&&(k(e+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),r=!1),t.apply(this,arguments)},t)}function A(e,t){null!=n.deprecationHandler&&n.deprecationHandler(e,t),yr[e]||(k(t),yr[e]=!0)}function E(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function M(e){var t,n;for(n in e)t=e[n],E(t)?this[n]=t:this["_"+n]=t;this._config=e,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function T(e,t){var n,r=c({},e);for(n in t)l(t,n)&&(o(e[n])&&o(t[n])?(r[n]={},c(r[n],e[n]),c(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)l(e,n)&&!l(t,n)&&o(e[n])&&(r[n]=c({},r[n]));return r}function C(e){null!=e&&this.set(e)}function j(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return E(r)?r.call(t,n):r}function D(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function O(){return this._invalidDate}function I(e){return this._ordinal.replace("%d",e)}function P(e,t,n,r){var i=this._relativeTime[n];return E(i)?i(e,t,n,r):i.replace(/%d/i,e)}function R(e,t){var n=this._relativeTime[e>0?"future":"past"];return E(n)?n(t):n.replace(/%s/i,t)}function z(e,t){var n=e.toLowerCase();Tr[n]=Tr[n+"s"]=Tr[t]=e}function B(e){return"string"==typeof e?Tr[e]||Tr[e.toLowerCase()]:void 0}function N(e){var t,n,r={};for(n in e)l(e,n)&&(t=B(n),t&&(r[t]=e[n]));return r}function L(e,t){Cr[e]=t}function q(e){var t=[];for(var n in e)t.push({unit:n,priority:Cr[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function U(e,t){return function(r){return null!=r?(W(this,e,r),n.updateOffset(this,t),this):F(this,e)}}function F(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function W(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function G(e){return e=B(e),E(this[e])?this[e]():this}function V(e,t){if("object"==typeof e){e=N(e);for(var n=q(e),r=0;r<n.length;r++)this[n[r].unit](e[n[r].unit])}else if(e=B(e),E(this[e]))return this[e](t);return this}function Y(e,t,n){var r=""+Math.abs(e),i=t-r.length,o=e>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}function H(e,t,n,r){var i=r;"string"==typeof r&&(i=function(){return this[r]()}),e&&(Ir[e]=i),t&&(Ir[t[0]]=function(){return Y(i.apply(this,arguments),t[1],t[2])}),n&&(Ir[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function $(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function K(e){var t,n,r=e.match(jr);for(t=0,n=r.length;n>t;t++)Ir[r[t]]?r[t]=Ir[r[t]]:r[t]=$(r[t]);return function(t){var i,o="";for(i=0;n>i;i++)o+=r[i]instanceof Function?r[i].call(t,e):r[i];return o}}function J(e,t){return e.isValid()?(t=X(t,e.localeData()),Or[t]=Or[t]||K(t),Or[t](e)):e.localeData().invalidDate()}function X(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(Dr.lastIndex=0;r>=0&&Dr.test(e);)e=e.replace(Dr,n),Dr.lastIndex=0,r-=1;return e}function Z(e,t,n){Xr[e]=E(t)?t:function(e,r){return e&&n?n:t}}function Q(e,t){return l(Xr,e)?Xr[e](t._strict,t._locale):new RegExp(ee(e))}function ee(e){return te(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i}))}function te(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ne(e,t){var n,r=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(r=function(e,n){n[t]=w(e)}),n=0;n<e.length;n++)Zr[e[n]]=r}function re(e,t){ne(e,function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)})}function ie(e,t,n){null!=t&&l(Zr,e)&&Zr[e](t,n._a,n,e)}function oe(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function ae(e,t){return i(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||ui).test(t)?"format":"standalone"][e.month()]}function se(e,t){return i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[ui.test(t)?"format":"standalone"][e.month()]}function ue(e,t,n){var r,i,o,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;12>r;++r)o=f([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===t?(i=wr.call(this._shortMonthsParse,a),-1!==i?i:null):(i=wr.call(this._longMonthsParse,a),-1!==i?i:null):"MMM"===t?(i=wr.call(this._shortMonthsParse,a),-1!==i?i:(i=wr.call(this._longMonthsParse,a),-1!==i?i:null)):(i=wr.call(this._longMonthsParse,a),-1!==i?i:(i=wr.call(this._shortMonthsParse,a),-1!==i?i:null))}function le(e,t,n){var r,i,o;if(this._monthsParseExact)return ue.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;12>r;r++){if(i=f([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function ce(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=w(t);else if(t=e.localeData().monthsParse(t),"number"!=typeof t)return e;return n=Math.min(e.date(),oe(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function fe(e){return null!=e?(ce(this,e),n.updateOffset(this,!0),this):F(this,"Month")}function de(){return oe(this.year(),this.month())}function _e(e){return this._monthsParseExact?(l(this,"_monthsRegex")||he.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,"_monthsShortRegex")||(this._monthsShortRegex=fi),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function pe(e){return this._monthsParseExact?(l(this,"_monthsRegex")||he.call(this),e?this._monthsStrictRegex:this._monthsRegex):(l(this,"_monthsRegex")||(this._monthsRegex=di),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function he(){function e(e,t){return t.length-e.length}var t,n,r=[],i=[],o=[];for(t=0;12>t;t++)n=f([2e3,t]),r.push(this.monthsShort(n,"")),i.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(r.sort(e),i.sort(e),o.sort(e),t=0;12>t;t++)r[t]=te(r[t]),i[t]=te(i[t]);for(t=0;24>t;t++)o[t]=te(o[t]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function ge(e){return me(e)?366:365}function me(e){return e%4===0&&e%100!==0||e%400===0}function ve(){return me(this.year())}function ye(e,t,n,r,i,o,a){var s=new Date(e,t,n,r,i,o,a);return 100>e&&e>=0&&isFinite(s.getFullYear())&&s.setFullYear(e),s}function be(e){var t=new Date(Date.UTC.apply(null,arguments));return 100>e&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function we(e,t,n){var r=7+t-n,i=(7+be(e,0,r).getUTCDay()-t)%7;return-i+r-1}function xe(e,t,n,r,i){var o,a,s=(7+n-r)%7,u=we(e,r,i),l=1+7*(t-1)+s+u;return 0>=l?(o=e-1,a=ge(o)+l):l>ge(e)?(o=e+1,a=l-ge(e)):(o=e,a=l),{year:o,dayOfYear:a}}function ke(e,t,n){var r,i,o=we(e.year(),t,n),a=Math.floor((e.dayOfYear()-o-1)/7)+1;return 1>a?(i=e.year()-1,r=a+Se(i,t,n)):a>Se(e.year(),t,n)?(r=a-Se(e.year(),t,n),i=e.year()+1):(i=e.year(),r=a),{week:r,year:i}}function Se(e,t,n){var r=we(e,t,n),i=we(e+1,t,n);return(ge(e)-r+i)/7}function Ae(e){return ke(e,this._week.dow,this._week.doy).week}function Ee(){return this._week.dow}function Me(){return this._week.doy}function Te(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Ce(e){var t=ke(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function je(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function De(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Oe(e,t){return i(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]}function Ie(e){return this._weekdaysShort[e.day()]}function Pe(e){return this._weekdaysMin[e.day()]}function Re(e,t,n){var r,i,o,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;7>r;++r)o=f([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===t?(i=wr.call(this._weekdaysParse,a),-1!==i?i:null):"ddd"===t?(i=wr.call(this._shortWeekdaysParse,a),-1!==i?i:null):(i=wr.call(this._minWeekdaysParse,a),-1!==i?i:null):"dddd"===t?(i=wr.call(this._weekdaysParse,a),-1!==i?i:(i=wr.call(this._shortWeekdaysParse,a),-1!==i?i:(i=wr.call(this._minWeekdaysParse,a),-1!==i?i:null))):"ddd"===t?(i=wr.call(this._shortWeekdaysParse,a),-1!==i?i:(i=wr.call(this._weekdaysParse,a),-1!==i?i:(i=wr.call(this._minWeekdaysParse,a),-1!==i?i:null))):(i=wr.call(this._minWeekdaysParse,a),-1!==i?i:(i=wr.call(this._weekdaysParse,a),-1!==i?i:(i=wr.call(this._shortWeekdaysParse,a),-1!==i?i:null)))}function ze(e,t,n){var r,i,o;if(this._weekdaysParseExact)return Re.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;7>r;r++){if(i=f([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function Be(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=je(e,this.localeData()),this.add(e-t,"d")):t}function Ne(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Le(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=De(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function qe(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||We.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,"_weekdaysRegex")||(this._weekdaysRegex=vi),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Ue(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||We.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=yi),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Fe(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||We.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=bi),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function We(){function e(e,t){return t.length-e.length}var t,n,r,i,o,a=[],s=[],u=[],l=[];for(t=0;7>t;t++)n=f([2e3,1]).day(t),r=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),o=this.weekdays(n,""),a.push(r),s.push(i),u.push(o),l.push(r),l.push(i),l.push(o);for(a.sort(e),s.sort(e),u.sort(e),l.sort(e),t=0;7>t;t++)s[t]=te(s[t]),u[t]=te(u[t]),l[t]=te(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Ge(){return this.hours()%12||12}function Ve(){return this.hours()||24}function Ye(e,t){H(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function He(e,t){return t._meridiemParse}function $e(e){return"p"===(e+"").toLowerCase().charAt(0)}function Ke(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function Je(e){return e?e.toLowerCase().replace("_","-"):e}function Xe(e){for(var t,n,r,i,o=0;o<e.length;){for(i=Je(e[o]).split("-"),t=i.length,n=Je(e[o+1]),n=n?n.split("-"):null;t>0;){if(r=Ze(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&x(i,n,!0)>=t-1)break;t--}o++}return null}function Ze(n){var r=null;if(!Ai[n]&&"undefined"!=typeof t&&t&&t.exports)try{r=wi._abbr,e("./locale/"+n),Qe(r)}catch(i){}return Ai[n]}function Qe(e,t){var n;return e&&(n=g(t)?nt(e):et(e,t),n&&(wi=n)),wi._abbr}function et(e,t){if(null!==t){var n=Si;return t.abbr=e,null!=Ai[e]?(A("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ai[e]._config):null!=t.parentLocale&&(null!=Ai[t.parentLocale]?n=Ai[t.parentLocale]._config:A("parentLocaleUndefined","specified parentLocale is not defined yet. See http://momentjs.com/guides/#/warnings/parent-locale/")),Ai[e]=new C(T(n,t)),Qe(e),Ai[e]}return delete Ai[e],null}function tt(e,t){if(null!=t){var n,r=Si;null!=Ai[e]&&(r=Ai[e]._config),t=T(r,t),n=new C(t),n.parentLocale=Ai[e],Ai[e]=n,Qe(e)}else null!=Ai[e]&&(null!=Ai[e].parentLocale?Ai[e]=Ai[e].parentLocale:null!=Ai[e]&&delete Ai[e]);return Ai[e]}function nt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return wi;if(!i(e)){if(t=Ze(e))return t;e=[e]}return Xe(e)}function rt(){return br(Ai)}function it(e){var t,n=e._a;return n&&-2===_(e).overflow&&(t=n[ei]<0||n[ei]>11?ei:n[ti]<1||n[ti]>oe(n[Qr],n[ei])?ti:n[ni]<0||n[ni]>24||24===n[ni]&&(0!==n[ri]||0!==n[ii]||0!==n[oi])?ni:n[ri]<0||n[ri]>59?ri:n[ii]<0||n[ii]>59?ii:n[oi]<0||n[oi]>999?oi:-1,_(e)._overflowDayOfYear&&(Qr>t||t>ti)&&(t=ti),_(e)._overflowWeeks&&-1===t&&(t=ai),_(e)._overflowWeekday&&-1===t&&(t=si),_(e).overflow=t),e}function ot(e){var t,n,r,i,o,a,s=e._i,u=Ei.exec(s)||Mi.exec(s);if(u){for(_(e).iso=!0,t=0,n=Ci.length;n>t;t++)if(Ci[t][1].exec(u[1])){i=Ci[t][0],r=Ci[t][2]!==!1;break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=ji.length;n>t;t++)if(ji[t][1].exec(u[3])){o=(u[2]||" ")+ji[t][0];break}if(null==o)return void(e._isValid=!1)}if(!r&&null!=o)return void(e._isValid=!1);if(u[4]){if(!Ti.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=i+(o||"")+(a||""),ft(e)}else e._isValid=!1}function at(e){var t=Di.exec(e._i);return null!==t?void(e._d=new Date(+t[1])):(ot(e),void(e._isValid===!1&&(delete e._isValid,n.createFromInputFallback(e))))}function st(e,t,n){return null!=e?e:null!=t?t:n}function ut(e){var t=new Date(n.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function lt(e){var t,n,r,i,o=[];if(!e._d){for(r=ut(e),e._w&&null==e._a[ti]&&null==e._a[ei]&&ct(e),e._dayOfYear&&(i=st(e._a[Qr],r[Qr]),e._dayOfYear>ge(i)&&(_(e)._overflowDayOfYear=!0),n=be(i,0,e._dayOfYear),e._a[ei]=n.getUTCMonth(),e._a[ti]=n.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=o[t]=r[t];for(;7>t;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ni]&&0===e._a[ri]&&0===e._a[ii]&&0===e._a[oi]&&(e._nextDay=!0,e._a[ni]=0),e._d=(e._useUTC?be:ye).apply(null,o),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ni]=24)}}function ct(e){var t,n,r,i,o,a,s,u;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(o=1,a=4,n=st(t.GG,e._a[Qr],ke(yt(),1,4).year),r=st(t.W,1),i=st(t.E,1),(1>i||i>7)&&(u=!0)):(o=e._locale._week.dow,a=e._locale._week.doy,n=st(t.gg,e._a[Qr],ke(yt(),o,a).year),r=st(t.w,1),null!=t.d?(i=t.d,(0>i||i>6)&&(u=!0)):null!=t.e?(i=t.e+o,(t.e<0||t.e>6)&&(u=!0)):i=o),1>r||r>Se(n,o,a)?_(e)._overflowWeeks=!0:null!=u?_(e)._overflowWeekday=!0:(s=xe(n,r,i,o,a),e._a[Qr]=s.year,e._dayOfYear=s.dayOfYear)}function ft(e){if(e._f===n.ISO_8601)return void ot(e);e._a=[],_(e).empty=!0;var t,r,i,o,a,s=""+e._i,u=s.length,l=0;for(i=X(e._f,e._locale).match(jr)||[],t=0;t<i.length;t++)o=i[t],r=(s.match(Q(o,e))||[])[0],r&&(a=s.substr(0,s.indexOf(r)),a.length>0&&_(e).unusedInput.push(a),s=s.slice(s.indexOf(r)+r.length),l+=r.length),Ir[o]?(r?_(e).empty=!1:_(e).unusedTokens.push(o),ie(o,r,e)):e._strict&&!r&&_(e).unusedTokens.push(o);_(e).charsLeftOver=u-l,s.length>0&&_(e).unusedInput.push(s),e._a[ni]<=12&&_(e).bigHour===!0&&e._a[ni]>0&&(_(e).bigHour=void 0),_(e).parsedDateParts=e._a.slice(0),_(e).meridiem=e._meridiem,e._a[ni]=dt(e._locale,e._a[ni],e._meridiem),lt(e),it(e)}function dt(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(r=e.isPM(n),r&&12>t&&(t+=12),r||12!==t||(t=0),t):t}function _t(e){var t,n,r,i,o;if(0===e._f.length)return _(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)o=0,t=m({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],ft(t),p(t)&&(o+=_(t).charsLeftOver,o+=10*_(t).unusedTokens.length,_(t).score=o,(null==r||r>o)&&(r=o,n=t));c(e,n||t)}function pt(e){if(!e._d){var t=N(e._i);e._a=u([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),lt(e)}}function ht(e){var t=new v(it(gt(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function gt(e){var t=e._i,n=e._f;return e._locale=e._locale||nt(e._l),null===t||void 0===n&&""===t?h({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),y(t)?new v(it(t)):(i(n)?_t(e):s(t)?e._d=t:n?ft(e):mt(e),p(e)||(e._d=null),e))}function mt(e){var t=e._i;void 0===t?e._d=new Date(n.now()):s(t)?e._d=new Date(t.valueOf()):"string"==typeof t?at(e):i(t)?(e._a=u(t.slice(0),function(e){return parseInt(e,10)}),lt(e)):"object"==typeof t?pt(e):"number"==typeof t?e._d=new Date(t):n.createFromInputFallback(e)}function vt(e,t,n,r,s){var u={};return"boolean"==typeof n&&(r=n,n=void 0),(o(e)&&a(e)||i(e)&&0===e.length)&&(e=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=s,u._l=n,u._i=e,u._f=t,u._strict=r,ht(u)}function yt(e,t,n,r){return vt(e,t,n,r,!1)}function bt(e,t){var n,r;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return yt();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function wt(){var e=[].slice.call(arguments,0);return bt("isBefore",e)}function xt(){var e=[].slice.call(arguments,0);return bt("isAfter",e)}function kt(e){var t=N(e),n=t.year||0,r=t.quarter||0,i=t.month||0,o=t.week||0,a=t.day||0,s=t.hour||0,u=t.minute||0,l=t.second||0,c=t.millisecond||0;this._milliseconds=+c+1e3*l+6e4*u+1e3*s*60*60,this._days=+a+7*o,this._months=+i+3*r+12*n,this._data={},this._locale=nt(),this._bubble()}function St(e){return e instanceof kt}function At(e,t){H(e,0,0,function(){var e=this.utcOffset(),n="+";return 0>e&&(e=-e,n="-"),n+Y(~~(e/60),2)+t+Y(~~e%60,2)})}function Et(e,t){var n=(t||"").match(e)||[],r=n[n.length-1]||[],i=(r+"").match(Ri)||["-",0,0],o=+(60*i[1])+w(i[2]);return"+"===i[0]?o:-o}function Mt(e,t){var r,i;return t._isUTC?(r=t.clone(),i=(y(e)||s(e)?e.valueOf():yt(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),n.updateOffset(r,!1),r):yt(e).local()}function Tt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Ct(e,t){var r,i=this._offset||0;return this.isValid()?null!=e?("string"==typeof e?e=Et($r,e):Math.abs(e)<16&&(e=60*e),!this._isUTC&&t&&(r=Tt(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),i!==e&&(!t||this._changeInProgress?Yt(this,qt(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?i:Tt(this):null!=e?this:NaN}function jt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Dt(e){return this.utcOffset(0,e)}function Ot(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Tt(this),"m")),this}function It(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Et(Hr,this._i)),this}function Pt(e){return this.isValid()?(e=e?yt(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Rt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function zt(){if(!g(this._isDSTShifted))return this._isDSTShifted;var e={};if(m(e,this),e=gt(e),e._a){var t=e._isUTC?f(e._a):yt(e._a);this._isDSTShifted=this.isValid()&&x(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Bt(){return this.isValid()?!this._isUTC:!1}function Nt(){return this.isValid()?this._isUTC:!1}function Lt(){return this.isValid()?this._isUTC&&0===this._offset:!1}function qt(e,t){var n,r,i,o=e,a=null;return St(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(a=zi.exec(e))?(n="-"===a[1]?-1:1,o={y:0,d:w(a[ti])*n,h:w(a[ni])*n,m:w(a[ri])*n,s:w(a[ii])*n,ms:w(a[oi])*n}):(a=Bi.exec(e))?(n="-"===a[1]?-1:1,o={y:Ut(a[2],n),M:Ut(a[3],n),w:Ut(a[4],n),d:Ut(a[5],n),h:Ut(a[6],n),m:Ut(a[7],n),s:Ut(a[8],n)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(i=Wt(yt(o.from),yt(o.to)),o={},o.ms=i.milliseconds,o.M=i.months),r=new kt(o),St(e)&&l(e,"_locale")&&(r._locale=e._locale),r}function Ut(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Ft(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Wt(e,t){var n;return e.isValid()&&t.isValid()?(t=Mt(t,e),e.isBefore(t)?n=Ft(e,t):(n=Ft(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Gt(e){return 0>e?-1*Math.round(-1*e):Math.round(e)}function Vt(e,t){return function(n,r){var i,o;return null===r||isNaN(+r)||(A(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),n="string"==typeof n?+n:n,i=qt(n,r),Yt(this,i,e),this}}function Yt(e,t,r,i){var o=t._milliseconds,a=Gt(t._days),s=Gt(t._months);e.isValid()&&(i=null==i?!0:i,o&&e._d.setTime(e._d.valueOf()+o*r),a&&W(e,"Date",F(e,"Date")+a*r),s&&ce(e,F(e,"Month")+s*r),i&&n.updateOffset(e,a||s))}function Ht(e,t){var n=e.diff(t,"days",!0);return-6>n?"sameElse":-1>n?"lastWeek":0>n?"lastDay":1>n?"sameDay":2>n?"nextDay":7>n?"nextWeek":"sameElse"}function $t(e,t){var r=e||yt(),i=Mt(r,this).startOf("day"),o=n.calendarFormat(this,i)||"sameElse",a=t&&(E(t[o])?t[o].call(this,r):t[o]);return this.format(a||this.localeData().calendar(o,this,yt(r)))}function Kt(){return new v(this)}function Jt(e,t){var n=y(e)?e:yt(e);return this.isValid()&&n.isValid()?(t=B(g(t)?"millisecond":t),"millisecond"===t?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf()):!1}function Xt(e,t){var n=y(e)?e:yt(e);return this.isValid()&&n.isValid()?(t=B(g(t)?"millisecond":t),"millisecond"===t?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf()):!1}function Zt(e,t,n,r){return r=r||"()",("("===r[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===r[1]?this.isBefore(t,n):!this.isAfter(t,n))}function Qt(e,t){var n,r=y(e)?e:yt(e);return this.isValid()&&r.isValid()?(t=B(t||"millisecond"),"millisecond"===t?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function en(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function tn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function nn(e,t,n){var r,i,o,a;return this.isValid()?(r=Mt(e,this),r.isValid()?(i=6e4*(r.utcOffset()-this.utcOffset()),t=B(t),"year"===t||"month"===t||"quarter"===t?(a=rn(this,r),"quarter"===t?a/=3:"year"===t&&(a/=12)):(o=this-r,a="second"===t?o/1e3:"minute"===t?o/6e4:"hour"===t?o/36e5:"day"===t?(o-i)/864e5:"week"===t?(o-i)/6048e5:o),n?a:b(a)):NaN):NaN}function rn(e,t){var n,r,i=12*(t.year()-e.year())+(t.month()-e.month()),o=e.clone().add(i,"months");return 0>t-o?(n=e.clone().add(i-1,"months"),r=(t-o)/(o-n)):(n=e.clone().add(i+1,"months"),r=(t-o)/(n-o)),-(i+r)||0}function on(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function an(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?E(Date.prototype.toISOString)?this.toDate().toISOString():J(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):J(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function sn(e){e||(e=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var t=J(this,e);return this.localeData().postformat(t)}function un(e,t){return this.isValid()&&(y(e)&&e.isValid()||yt(e).isValid())?qt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ln(e){return this.from(yt(),e)}function cn(e,t){return this.isValid()&&(y(e)&&e.isValid()||yt(e).isValid())?qt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function fn(e){return this.to(yt(),e)}function dn(e){var t;return void 0===e?this._locale._abbr:(t=nt(e),null!=t&&(this._locale=t),this)}function _n(){return this._locale}function pn(e){switch(e=B(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function hn(e){return e=B(e),void 0===e||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function gn(){return this._d.valueOf()-6e4*(this._offset||0)}function mn(){return Math.floor(this.valueOf()/1e3)}function vn(){return new Date(this.valueOf())}function yn(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function bn(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function wn(){return this.isValid()?this.toISOString():null}function xn(){return p(this)}function kn(){return c({},_(this))}function Sn(){return _(this).overflow}function An(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function En(e,t){H(0,[e,e.length],0,t)}function Mn(e){return Dn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Tn(e){return Dn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Cn(){return Se(this.year(),1,4)}function jn(){var e=this.localeData()._week;return Se(this.year(),e.dow,e.doy)}function Dn(e,t,n,r,i){var o;return null==e?ke(this,r,i).year:(o=Se(e,r,i),t>o&&(t=o),On.call(this,e,t,n,r,i))}function On(e,t,n,r,i){var o=xe(e,t,n,r,i),a=be(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function In(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Pn(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function Rn(e,t){t[oi]=w(1e3*("0."+e))}function zn(){return this._isUTC?"UTC":""}function Bn(){return this._isUTC?"Coordinated Universal Time":""}function Nn(e){return yt(1e3*e)}function Ln(){return yt.apply(null,arguments).parseZone()}function qn(e){return e}function Un(e,t,n,r){var i=nt(),o=f().set(r,t);return i[n](o,e)}function Fn(e,t,n){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return Un(e,t,n,"month");var r,i=[];for(r=0;12>r;r++)i[r]=Un(e,r,n,"month");return i}function Wn(e,t,n,r){"boolean"==typeof e?("number"==typeof t&&(n=t,t=void 0),t=t||""):(t=e,n=t,e=!1,"number"==typeof t&&(n=t,t=void 0),t=t||"");var i=nt(),o=e?i._week.dow:0;if(null!=n)return Un(t,(n+o)%7,r,"day");var a,s=[];for(a=0;7>a;a++)s[a]=Un(t,(a+o)%7,r,"day");return s}function Gn(e,t){return Fn(e,t,"months")}function Vn(e,t){return Fn(e,t,"monthsShort")}function Yn(e,t,n){return Wn(e,t,n,"weekdays")}function Hn(e,t,n){return Wn(e,t,n,"weekdaysShort")}function $n(e,t,n){return Wn(e,t,n,"weekdaysMin")}function Kn(){var e=this._data;return this._milliseconds=Ki(this._milliseconds),this._days=Ki(this._days),this._months=Ki(this._months),e.milliseconds=Ki(e.milliseconds),e.seconds=Ki(e.seconds),e.minutes=Ki(e.minutes),e.hours=Ki(e.hours),e.months=Ki(e.months),e.years=Ki(e.years),this}function Jn(e,t,n,r){var i=qt(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function Xn(e,t){return Jn(this,e,t,1)}function Zn(e,t){return Jn(this,e,t,-1)}function Qn(e){return 0>e?Math.floor(e):Math.ceil(e)}function er(){var e,t,n,r,i,o=this._milliseconds,a=this._days,s=this._months,u=this._data;return o>=0&&a>=0&&s>=0||0>=o&&0>=a&&0>=s||(o+=864e5*Qn(nr(s)+a),a=0,s=0),u.milliseconds=o%1e3,e=b(o/1e3),u.seconds=e%60,t=b(e/60),u.minutes=t%60,n=b(t/60),u.hours=n%24,a+=b(n/24),i=b(tr(a)),s+=i,a-=Qn(nr(i)),r=b(s/12),s%=12,u.days=a,u.months=s,u.years=r,this}function tr(e){return 4800*e/146097}function nr(e){return 146097*e/4800}function rr(e){var t,n,r=this._milliseconds;if(e=B(e),"month"===e||"year"===e)return t=this._days+r/864e5,n=this._months+tr(t),"month"===e?n:n/12;switch(t=this._days+Math.round(nr(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function ir(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*w(this._months/12);
}function or(e){return function(){return this.as(e)}}function ar(e){return e=B(e),this[e+"s"]()}function sr(e){return function(){return this._data[e]}}function ur(){return b(this.days()/7)}function lr(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function cr(e,t,n){var r=qt(e).abs(),i=fo(r.as("s")),o=fo(r.as("m")),a=fo(r.as("h")),s=fo(r.as("d")),u=fo(r.as("M")),l=fo(r.as("y")),c=i<_o.s&&["s",i]||1>=o&&["m"]||o<_o.m&&["mm",o]||1>=a&&["h"]||a<_o.h&&["hh",a]||1>=s&&["d"]||s<_o.d&&["dd",s]||1>=u&&["M"]||u<_o.M&&["MM",u]||1>=l&&["y"]||["yy",l];return c[2]=t,c[3]=+e>0,c[4]=n,lr.apply(null,c)}function fr(e){return void 0===e?fo:"function"==typeof e?(fo=e,!0):!1}function dr(e,t){return void 0===_o[e]?!1:void 0===t?_o[e]:(_o[e]=t,!0)}function _r(e){var t=this.localeData(),n=cr(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function pr(){var e,t,n,r=po(this._milliseconds)/1e3,i=po(this._days),o=po(this._months);e=b(r/60),t=b(e/60),r%=60,e%=60,n=b(o/12),o%=12;var a=n,s=o,u=i,l=t,c=e,f=r,d=this.asSeconds();return d?(0>d?"-":"")+"P"+(a?a+"Y":"")+(s?s+"M":"")+(u?u+"D":"")+(l||c||f?"T":"")+(l?l+"H":"")+(c?c+"M":"")+(f?f+"S":""):"P0D"}var hr,gr;gr=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,r=0;n>r;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var mr=n.momentProperties=[],vr=!1,yr={};n.suppressDeprecationWarnings=!1,n.deprecationHandler=null;var br;br=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)l(e,t)&&n.push(t);return n};var wr,xr={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},kr={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Sr="Invalid date",Ar="%d",Er=/\d{1,2}/,Mr={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Tr={},Cr={},jr=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Dr=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Or={},Ir={},Pr=/\d/,Rr=/\d\d/,zr=/\d{3}/,Br=/\d{4}/,Nr=/[+-]?\d{6}/,Lr=/\d\d?/,qr=/\d\d\d\d?/,Ur=/\d\d\d\d\d\d?/,Fr=/\d{1,3}/,Wr=/\d{1,4}/,Gr=/[+-]?\d{1,6}/,Vr=/\d+/,Yr=/[+-]?\d+/,Hr=/Z|[+-]\d\d:?\d\d/gi,$r=/Z|[+-]\d\d(?::?\d\d)?/gi,Kr=/[+-]?\d+(\.\d{1,3})?/,Jr=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Xr={},Zr={},Qr=0,ei=1,ti=2,ni=3,ri=4,ii=5,oi=6,ai=7,si=8;wr=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},H("M",["MM",2],"Mo",function(){return this.month()+1}),H("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),H("MMMM",0,0,function(e){return this.localeData().months(this,e)}),z("month","M"),L("month",8),Z("M",Lr),Z("MM",Lr,Rr),Z("MMM",function(e,t){return t.monthsShortRegex(e)}),Z("MMMM",function(e,t){return t.monthsRegex(e)}),ne(["M","MM"],function(e,t){t[ei]=w(e)-1}),ne(["MMM","MMMM"],function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[ei]=i:_(n).invalidMonth=e});var ui=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,li="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ci="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),fi=Jr,di=Jr;H("Y",0,0,function(){var e=this.year();return 9999>=e?""+e:"+"+e}),H(0,["YY",2],0,function(){return this.year()%100}),H(0,["YYYY",4],0,"year"),H(0,["YYYYY",5],0,"year"),H(0,["YYYYYY",6,!0],0,"year"),z("year","y"),L("year",1),Z("Y",Yr),Z("YY",Lr,Rr),Z("YYYY",Wr,Br),Z("YYYYY",Gr,Nr),Z("YYYYYY",Gr,Nr),ne(["YYYYY","YYYYYY"],Qr),ne("YYYY",function(e,t){t[Qr]=2===e.length?n.parseTwoDigitYear(e):w(e)}),ne("YY",function(e,t){t[Qr]=n.parseTwoDigitYear(e)}),ne("Y",function(e,t){t[Qr]=parseInt(e,10)}),n.parseTwoDigitYear=function(e){return w(e)+(w(e)>68?1900:2e3)};var _i=U("FullYear",!0);H("w",["ww",2],"wo","week"),H("W",["WW",2],"Wo","isoWeek"),z("week","w"),z("isoWeek","W"),L("week",5),L("isoWeek",5),Z("w",Lr),Z("ww",Lr,Rr),Z("W",Lr),Z("WW",Lr,Rr),re(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=w(e)});var pi={dow:0,doy:6};H("d",0,"do","day"),H("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),H("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),H("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),H("e",0,0,"weekday"),H("E",0,0,"isoWeekday"),z("day","d"),z("weekday","e"),z("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),Z("d",Lr),Z("e",Lr),Z("E",Lr),Z("dd",function(e,t){return t.weekdaysMinRegex(e)}),Z("ddd",function(e,t){return t.weekdaysShortRegex(e)}),Z("dddd",function(e,t){return t.weekdaysRegex(e)}),re(["dd","ddd","dddd"],function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:_(n).invalidWeekday=e}),re(["d","e","E"],function(e,t,n,r){t[r]=w(e)});var hi="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),gi="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),mi="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),vi=Jr,yi=Jr,bi=Jr;H("H",["HH",2],0,"hour"),H("h",["hh",2],0,Ge),H("k",["kk",2],0,Ve),H("hmm",0,0,function(){return""+Ge.apply(this)+Y(this.minutes(),2)}),H("hmmss",0,0,function(){return""+Ge.apply(this)+Y(this.minutes(),2)+Y(this.seconds(),2)}),H("Hmm",0,0,function(){return""+this.hours()+Y(this.minutes(),2)}),H("Hmmss",0,0,function(){return""+this.hours()+Y(this.minutes(),2)+Y(this.seconds(),2)}),Ye("a",!0),Ye("A",!1),z("hour","h"),L("hour",13),Z("a",He),Z("A",He),Z("H",Lr),Z("h",Lr),Z("HH",Lr,Rr),Z("hh",Lr,Rr),Z("hmm",qr),Z("hmmss",Ur),Z("Hmm",qr),Z("Hmmss",Ur),ne(["H","HH"],ni),ne(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),ne(["h","hh"],function(e,t,n){t[ni]=w(e),_(n).bigHour=!0}),ne("hmm",function(e,t,n){var r=e.length-2;t[ni]=w(e.substr(0,r)),t[ri]=w(e.substr(r)),_(n).bigHour=!0}),ne("hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[ni]=w(e.substr(0,r)),t[ri]=w(e.substr(r,2)),t[ii]=w(e.substr(i)),_(n).bigHour=!0}),ne("Hmm",function(e,t,n){var r=e.length-2;t[ni]=w(e.substr(0,r)),t[ri]=w(e.substr(r))}),ne("Hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[ni]=w(e.substr(0,r)),t[ri]=w(e.substr(r,2)),t[ii]=w(e.substr(i))});var wi,xi=/[ap]\.?m?\.?/i,ki=U("Hours",!0),Si={calendar:xr,longDateFormat:kr,invalidDate:Sr,ordinal:Ar,ordinalParse:Er,relativeTime:Mr,months:li,monthsShort:ci,week:pi,weekdays:hi,weekdaysMin:mi,weekdaysShort:gi,meridiemParse:xi},Ai={},Ei=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Mi=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Ti=/Z|[+-]\d\d(?::?\d\d)?/,Ci=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],ji=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Di=/^\/?Date\((\-?\d+)/i;n.createFromInputFallback=S("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),n.ISO_8601=function(){};var Oi=S("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=yt.apply(null,arguments);return this.isValid()&&e.isValid()?this>e?this:e:h()}),Ii=S("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=yt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:h()}),Pi=function(){return Date.now?Date.now():+new Date};At("Z",":"),At("ZZ",""),Z("Z",$r),Z("ZZ",$r),ne(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Et($r,e)});var Ri=/([\+\-]|\d\d)/gi;n.updateOffset=function(){};var zi=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,Bi=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;qt.fn=kt.prototype;var Ni=Vt(1,"add"),Li=Vt(-1,"subtract");n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var qi=S("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});H(0,["gg",2],0,function(){return this.weekYear()%100}),H(0,["GG",2],0,function(){return this.isoWeekYear()%100}),En("gggg","weekYear"),En("ggggg","weekYear"),En("GGGG","isoWeekYear"),En("GGGGG","isoWeekYear"),z("weekYear","gg"),z("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),Z("G",Yr),Z("g",Yr),Z("GG",Lr,Rr),Z("gg",Lr,Rr),Z("GGGG",Wr,Br),Z("gggg",Wr,Br),Z("GGGGG",Gr,Nr),Z("ggggg",Gr,Nr),re(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=w(e)}),re(["gg","GG"],function(e,t,r,i){t[i]=n.parseTwoDigitYear(e)}),H("Q",0,"Qo","quarter"),z("quarter","Q"),L("quarter",7),Z("Q",Pr),ne("Q",function(e,t){t[ei]=3*(w(e)-1)}),H("D",["DD",2],"Do","date"),z("date","D"),L("date",9),Z("D",Lr),Z("DD",Lr,Rr),Z("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),ne(["D","DD"],ti),ne("Do",function(e,t){t[ti]=w(e.match(Lr)[0],10)});var Ui=U("Date",!0);H("DDD",["DDDD",3],"DDDo","dayOfYear"),z("dayOfYear","DDD"),L("dayOfYear",4),Z("DDD",Fr),Z("DDDD",zr),ne(["DDD","DDDD"],function(e,t,n){n._dayOfYear=w(e)}),H("m",["mm",2],0,"minute"),z("minute","m"),L("minute",14),Z("m",Lr),Z("mm",Lr,Rr),ne(["m","mm"],ri);var Fi=U("Minutes",!1);H("s",["ss",2],0,"second"),z("second","s"),L("second",15),Z("s",Lr),Z("ss",Lr,Rr),ne(["s","ss"],ii);var Wi=U("Seconds",!1);H("S",0,0,function(){return~~(this.millisecond()/100)}),H(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),H(0,["SSS",3],0,"millisecond"),H(0,["SSSS",4],0,function(){return 10*this.millisecond()}),H(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),H(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),H(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),H(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),H(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),z("millisecond","ms"),L("millisecond",16),Z("S",Fr,Pr),Z("SS",Fr,Rr),Z("SSS",Fr,zr);var Gi;for(Gi="SSSS";Gi.length<=9;Gi+="S")Z(Gi,Vr);for(Gi="S";Gi.length<=9;Gi+="S")ne(Gi,Rn);var Vi=U("Milliseconds",!1);H("z",0,0,"zoneAbbr"),H("zz",0,0,"zoneName");var Yi=v.prototype;Yi.add=Ni,Yi.calendar=$t,Yi.clone=Kt,Yi.diff=nn,Yi.endOf=hn,Yi.format=sn,Yi.from=un,Yi.fromNow=ln,Yi.to=cn,Yi.toNow=fn,Yi.get=G,Yi.invalidAt=Sn,Yi.isAfter=Jt,Yi.isBefore=Xt,Yi.isBetween=Zt,Yi.isSame=Qt,Yi.isSameOrAfter=en,Yi.isSameOrBefore=tn,Yi.isValid=xn,Yi.lang=qi,Yi.locale=dn,Yi.localeData=_n,Yi.max=Ii,Yi.min=Oi,Yi.parsingFlags=kn,Yi.set=V,Yi.startOf=pn,Yi.subtract=Li,Yi.toArray=yn,Yi.toObject=bn,Yi.toDate=vn,Yi.toISOString=an,Yi.toJSON=wn,Yi.toString=on,Yi.unix=mn,Yi.valueOf=gn,Yi.creationData=An,Yi.year=_i,Yi.isLeapYear=ve,Yi.weekYear=Mn,Yi.isoWeekYear=Tn,Yi.quarter=Yi.quarters=In,Yi.month=fe,Yi.daysInMonth=de,Yi.week=Yi.weeks=Te,Yi.isoWeek=Yi.isoWeeks=Ce,Yi.weeksInYear=jn,Yi.isoWeeksInYear=Cn,Yi.date=Ui,Yi.day=Yi.days=Be,Yi.weekday=Ne,Yi.isoWeekday=Le,Yi.dayOfYear=Pn,Yi.hour=Yi.hours=ki,Yi.minute=Yi.minutes=Fi,Yi.second=Yi.seconds=Wi,Yi.millisecond=Yi.milliseconds=Vi,Yi.utcOffset=Ct,Yi.utc=Dt,Yi.local=Ot,Yi.parseZone=It,Yi.hasAlignedHourOffset=Pt,Yi.isDST=Rt,Yi.isLocal=Bt,Yi.isUtcOffset=Nt,Yi.isUtc=Lt,Yi.isUTC=Lt,Yi.zoneAbbr=zn,Yi.zoneName=Bn,Yi.dates=S("dates accessor is deprecated. Use date instead.",Ui),Yi.months=S("months accessor is deprecated. Use month instead",fe),Yi.years=S("years accessor is deprecated. Use year instead",_i),Yi.zone=S("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",jt),Yi.isDSTShifted=S("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",zt);var Hi=Yi,$i=C.prototype;$i.calendar=j,$i.longDateFormat=D,$i.invalidDate=O,$i.ordinal=I,$i.preparse=qn,$i.postformat=qn,$i.relativeTime=P,$i.pastFuture=R,$i.set=M,$i.months=ae,$i.monthsShort=se,$i.monthsParse=le,$i.monthsRegex=pe,$i.monthsShortRegex=_e,$i.week=Ae,$i.firstDayOfYear=Me,$i.firstDayOfWeek=Ee,$i.weekdays=Oe,$i.weekdaysMin=Pe,$i.weekdaysShort=Ie,$i.weekdaysParse=ze,$i.weekdaysRegex=qe,$i.weekdaysShortRegex=Ue,$i.weekdaysMinRegex=Fe,$i.isPM=$e,$i.meridiem=Ke,Qe("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===w(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),n.lang=S("moment.lang is deprecated. Use moment.locale instead.",Qe),n.langData=S("moment.langData is deprecated. Use moment.localeData instead.",nt);var Ki=Math.abs,Ji=or("ms"),Xi=or("s"),Zi=or("m"),Qi=or("h"),eo=or("d"),to=or("w"),no=or("M"),ro=or("y"),io=sr("milliseconds"),oo=sr("seconds"),ao=sr("minutes"),so=sr("hours"),uo=sr("days"),lo=sr("months"),co=sr("years"),fo=Math.round,_o={s:45,m:45,h:22,d:26,M:11},po=Math.abs,ho=kt.prototype;ho.abs=Kn,ho.add=Xn,ho.subtract=Zn,ho.as=rr,ho.asMilliseconds=Ji,ho.asSeconds=Xi,ho.asMinutes=Zi,ho.asHours=Qi,ho.asDays=eo,ho.asWeeks=to,ho.asMonths=no,ho.asYears=ro,ho.valueOf=ir,ho._bubble=er,ho.get=ar,ho.milliseconds=io,ho.seconds=oo,ho.minutes=ao,ho.hours=so,ho.days=uo,ho.weeks=ur,ho.months=lo,ho.years=co,ho.humanize=_r,ho.toISOString=pr,ho.toString=pr,ho.toJSON=pr,ho.locale=dn,ho.localeData=_n,ho.toIsoString=S("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",pr),ho.lang=qi,H("X",0,0,"unix"),H("x",0,0,"valueOf"),Z("x",Yr),Z("X",Kr),ne("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),ne("x",function(e,t,n){n._d=new Date(w(e))}),n.version="2.14.1",r(yt),n.fn=Hi,n.min=wt,n.max=xt,n.now=Pi,n.utc=f,n.unix=Nn,n.months=Gn,n.isDate=s,n.locale=Qe,n.invalid=h,n.duration=qt,n.isMoment=y,n.weekdays=Yn,n.parseZone=Ln,n.localeData=nt,n.isDuration=St,n.monthsShort=Vn,n.weekdaysMin=$n,n.defineLocale=et,n.updateLocale=tt,n.locales=rt,n.weekdaysShort=Hn,n.normalizeUnits=B,n.relativeTimeRounding=fr,n.relativeTimeThreshold=dr,n.calendarFormat=Ht,n.prototype=Hi;var go=n;return go})},{}],47:[function(e,t,n){!function(n,r){"use strict";"function"==typeof define&&define.amd?define(["moment"],r):"object"==typeof t&&t.exports?t.exports=r(e("./moment.js")):r(n.moment)}(this,function(e){"use strict";function t(e){return e>96?e-87:e>64?e-29:e-48}function n(e){var n,r=0,i=e.split("."),o=i[0],a=i[1]||"",s=1,u=0,l=1;for(45===e.charCodeAt(0)&&(r=1,l=-1),r;r<o.length;r++)n=t(o.charCodeAt(r)),u=60*u+n;for(r=0;r<a.length;r++)s/=60,n=t(a.charCodeAt(r)),u+=n*s;return u*l}function r(e){for(var t=0;t<e.length;t++)e[t]=n(e[t])}function i(e,t){for(var n=0;t>n;n++)e[n]=Math.round((e[n-1]||0)+6e4*e[n]);e[t-1]=1/0}function o(e,t){var n,r=[];for(n=0;n<t.length;n++)r[n]=e[t[n]];return r}function a(e){var t=e.split("|"),n=t[2].split(" "),a=t[3].split(""),s=t[4].split(" ");return r(n),r(a),r(s),i(s,a.length),{name:t[0],abbrs:o(t[1].split(" "),a),offsets:o(n,a),untils:s,population:0|t[5]}}function s(e){e&&this._set(a(e))}function u(e){var t=e.toTimeString(),n=t.match(/\([a-z ]+\)/i);n&&n[0]?(n=n[0].match(/[A-Z]/g),n=n?n.join(""):void 0):(n=t.match(/[A-Z]{3,5}/g),n=n?n[0]:void 0),"GMT"===n&&(n=void 0),this.at=+e,this.abbr=n,this.offset=e.getTimezoneOffset()}function l(e){this.zone=e,this.offsetScore=0,this.abbrScore=0}function c(e,t){for(var n,r;r=6e4*((t.at-e.at)/12e4|0);)n=new u(new Date(e.at+r)),n.offset===e.offset?e=n:t=n;return e}function f(){var e,t,n,r=(new Date).getFullYear()-2,i=new u(new Date(r,0,1)),o=[i];for(n=1;48>n;n++)t=new u(new Date(r,n,1)),t.offset!==i.offset&&(e=c(i,t),o.push(e),o.push(new u(new Date(e.at+6e4)))),i=t;for(n=0;4>n;n++)o.push(new u(new Date(r+n,0,1))),o.push(new u(new Date(r+n,6,1)));return o}function d(e,t){return e.offsetScore!==t.offsetScore?e.offsetScore-t.offsetScore:e.abbrScore!==t.abbrScore?e.abbrScore-t.abbrScore:t.zone.population-e.zone.population}function _(e,t){var n,i;for(r(t),n=0;n<t.length;n++)i=t[n],P[i]=P[i]||{},P[i][e]=!0}function p(e){var t,n,r,i=e.length,o={},a=[];for(t=0;i>t;t++){r=P[e[t].offset]||{};for(n in r)r.hasOwnProperty(n)&&(o[n]=!0)}for(t in o)o.hasOwnProperty(t)&&a.push(I[t]);return a}function h(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e){var t=I[m(e)];if(t)return t;A("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(n){}var r,i,o,a=f(),s=a.length,u=p(a),c=[];for(i=0;i<u.length;i++){for(r=new l(y(u[i]),s),o=0;s>o;o++)r.scoreOffsetAt(a[o]);c.push(r)}return c.sort(d),c.length>0?c[0].zone.name:void 0}function g(e){return C&&!e||(C=h()),C}function m(e){return(e||"").toLowerCase().replace(/\//g,"_")}function v(e){var t,n,r,i;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)r=e[t].split("|"),n=r[0],i=m(n),D[i]=e[t],I[i]=n,r[5]&&_(i,r[2].split(" "))}function y(e,t){e=m(e);var n,r=D[e];return r instanceof s?r:"string"==typeof r?(r=new s(r),D[e]=r,r):O[e]&&t!==y&&(n=y(O[e],y))?(r=D[e]=new s,r._set(n),r.name=I[e],r):null}function b(){var e,t=[];for(e in I)I.hasOwnProperty(e)&&(D[e]||D[O[e]])&&I[e]&&t.push(I[e]);return t.sort()}function w(e){var t,n,r,i;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)n=e[t].split("|"),r=m(n[0]),i=m(n[1]),O[r]=i,I[r]=n[0],O[i]=r,I[i]=n[1]}function x(e){v(e.zones),w(e.links),E.dataVersion=e.version}function k(e){return k.didShowError||(k.didShowError=!0,A("moment.tz.zoneExists('"+e+"') has been deprecated in favor of !moment.tz.zone('"+e+"')")),!!y(e)}function S(e){return!(!e._a||void 0!==e._tzm)}function A(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}function E(t){var n=Array.prototype.slice.call(arguments,0,-1),r=arguments[arguments.length-1],i=y(r),o=e.utc.apply(null,n);return i&&!e.isMoment(t)&&S(o)&&o.add(i.parse(o),"minutes"),o.tz(r),o}function M(e){return function(){return this._z?this._z.abbr(this):e.call(this)}}function T(e){return function(){return this._z=null,e.apply(this,arguments)}}if(void 0!==e.tz)return A("Moment Timezone "+e.tz.version+" was already loaded "+(e.tz.dataVersion?"with data from ":"without any data")+e.tz.dataVersion),e;var C,j="0.5.4",D={},O={},I={},P={},R=e.version.split("."),z=+R[0],B=+R[1];(2>z||2===z&&6>B)&&A("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+e.version+". See momentjs.com"),s.prototype={_set:function(e){this.name=e.name,this.abbrs=e.abbrs,this.untils=e.untils,this.offsets=e.offsets,this.population=e.population},_index:function(e){var t,n=+e,r=this.untils;for(t=0;t<r.length;t++)if(n<r[t])return t},parse:function(e){var t,n,r,i,o=+e,a=this.offsets,s=this.untils,u=s.length-1;for(i=0;u>i;i++)if(t=a[i],n=a[i+1],r=a[i?i-1:i],n>t&&E.moveAmbiguousForward?t=n:t>r&&E.moveInvalidForward&&(t=r),o<s[i]-6e4*t)return a[i];return a[u]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){return this.offsets[this._index(e)]}},l.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.offset(e.at)-e.offset),this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr&&this.abbrScore++},E.version=j,E.dataVersion="",E._zones=D,E._links=O,E._names=I,E.add=v,E.link=w,E.load=x,E.zone=y,E.zoneExists=k,E.guess=g,E.names=b,E.Zone=s,E.unpack=a,E.unpackBase60=n,E.needsOffset=S,E.moveInvalidForward=!0,E.moveAmbiguousForward=!1;var N=e.fn;e.tz=E,e.defaultZone=null,e.updateOffset=function(t,n){var r,i=e.defaultZone;void 0===t._z&&(i&&S(t)&&!t._isUTC&&(t._d=e.utc(t._a)._d,t.utc().add(i.parse(t),"minutes")),t._z=i),t._z&&(r=t._z.offset(t),Math.abs(r)<16&&(r/=60),void 0!==t.utcOffset?t.utcOffset(-r,n):t.zone(r,n))},N.tz=function(t){return t?(this._z=y(t),this._z?e.updateOffset(this):A("Moment Timezone has no data for "+t+". See http://momentjs.com/timezone/docs/#/data-loading/."),this):this._z?this._z.name:void 0},N.zoneName=M(N.zoneName),N.zoneAbbr=M(N.zoneAbbr),N.utc=T(N.utc),e.tz.setDefault=function(t){return(2>z||2===z&&9>B)&&A("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+e.version+"."),e.defaultZone=t?y(t):null,e};var L=e.momentProperties;return"[object Array]"===Object.prototype.toString.call(L)?(L.push("_z"),L.push("_a")):L&&(L._z=null),x({version:"2016d",zones:["Africa/Abidjan|GMT|0|0||48e5","Africa/Khartoum|EAT|-30|0||51e5","Africa/Algiers|CET|-10|0||26e5","Africa/Lagos|WAT|-10|0||17e6","Africa/Maputo|CAT|-20|0||26e5","Africa/Cairo|EET EEST|-20 -30|010101010|1Cby0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0|15e6","Africa/Casablanca|WET WEST|0 -10|01010101010101010101010101010101010101010|1Cco0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 Rc0 11A0 e00 e00 U00 11A0 8o0 e00 11A0|32e5","Europe/Paris|CET CEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e6","Africa/Johannesburg|SAST|-20|0||84e5","Africa/Tripoli|EET CET CEST|-20 -10 -20|0120|1IlA0 TA0 1o00|11e5","Africa/Windhoek|WAST WAT|-20 -10|01010101010101010101010|1C1c0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0|32e4","America/Adak|HST HDT|a0 90|01010101010101010101010|1BR00 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1BQX0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Santo_Domingo|AST|40|0||29e5","America/Araguaina|BRT BRST|30 20|010|1IdD0 Lz0|14e4","America/Argentina/Buenos_Aires|ART|30|0|","America/Asuncion|PYST PYT|30 40|01010101010101010101010|1C430 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0|28e5","America/Panama|EST|50|0||15e5","America/Bahia|BRT BRST|30 20|010|1FJf0 Rb0|27e5","America/Bahia_Banderas|MST CDT CST|70 50 60|01212121212121212121212|1C1l0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|84e3","America/Fortaleza|BRT|30|0||34e5","America/Managua|CST|60|0||22e5","America/Manaus|AMT|40|0||19e5","America/Bogota|COT|50|0||90e5","America/Denver|MST MDT|70 60|01010101010101010101010|1BQV0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Campo_Grande|AMST AMT|30 40|01010101010101010101010|1BIr0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10|77e4","America/Cancun|CST CDT EST|60 50 50|010101010102|1C1k0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 Dd0|63e4","America/Caracas|VET VET|4u 40|01|1QMT0|29e5","America/Cayenne|GFT|30|0||58e3","America/Chicago|CST CDT|60 50|01010101010101010101010|1BQU0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1C1l0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|81e4","America/Phoenix|MST|70|0||42e5","America/Los_Angeles|PST PDT|80 70|01010101010101010101010|1BQW0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/New_York|EST EDT|50 40|01010101010101010101010|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Rio_Branco|AMT ACT|40 50|01|1KLE0|31e4","America/Fort_Nelson|PST PDT MST|80 70 70|010101010102|1BQW0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0|39e2","America/Halifax|AST ADT|40 30|01010101010101010101010|1BQS0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Godthab|WGT WGST|30 20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e3","America/Goose_Bay|AST ADT|40 30|01010101010101010101010|1BQQ1 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|76e2","America/Grand_Turk|EST EDT AST|50 40 40|0101010101012|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Guayaquil|ECT|50|0||27e5","America/Guyana|GYT|40|0||80e4","America/Havana|CST CDT|50 40|01010101010101010101010|1BQR0 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/La_Paz|BOT|40|0||19e5","America/Lima|PET|50|0||11e6","America/Mexico_City|CST CDT|60 50|01010101010101010101010|1C1k0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|20e6","America/Metlakatla|PST AKST AKDT|80 90 80|012121212121|1PAa0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Miquelon|PMST PMDT|30 20|01010101010101010101010|1BQR0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Montevideo|UYST UYT|20 30|010101010101|1BQQ0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0|17e5","America/Noronha|FNT|20|0||30e2","America/North_Dakota/Beulah|MST MDT CST CDT|70 60 60 50|01232323232323232323232|1BQV0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Paramaribo|SRT|30|0||24e4","America/Port-au-Prince|EST EDT|50 40|010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","America/Santiago|CLST CLT|30 40|010101010101010101010|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|62e5","America/Sao_Paulo|BRST BRT|20 30|01010101010101010101010|1BIq0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10|20e6","America/Scoresbysund|EGT EGST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|452","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1BQPv 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","Antarctica/Casey|CAST AWST|-b0 -80|0101|1BN30 40P0 KL0|10","Antarctica/Davis|DAVT DAVT|-50 -70|0101|1BPw0 3Wn0 KN0|70","Antarctica/DumontDUrville|DDUT|-a0|0||80","Antarctica/Macquarie|AEDT MIST|-b0 -b0|01|1C140|1","Antarctica/Mawson|MAWT|-50|0||60","Pacific/Auckland|NZDT NZST|-d0 -c0|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|14e5","Antarctica/Rothera|ROTT|30|0||130","Antarctica/Syowa|SYOT|-30|0||20","Antarctica/Troll|UTC CEST|0 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|40","Antarctica/Vostok|VOST|-60|0||25","Asia/Baghdad|AST|-30|0||66e5","Asia/Almaty|+06|-60|0||15e5","Asia/Amman|EET EEST|-20 -30|010101010101010101010|1BVy0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0|25e5","Asia/Anadyr|ANAT ANAST ANAT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0|13e3","Asia/Aqtobe|+05|-50|0||27e4","Asia/Ashgabat|TMT|-50|0||41e4","Asia/Baku|AZT AZST|-40 -50|0101010101010|1BWo0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|27e5","Asia/Bangkok|ICT|-70|0||15e6","Asia/Barnaul|+06 +07|-60 -70|010101|1BWk0 1qM0 WM0 8Hz0 3rd0","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1BWm0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0|22e5","Asia/Bishkek|KGT|-60|0||87e4","Asia/Brunei|BNT|-80|0||42e4","Asia/Kolkata|IST|-5u|0||15e6","Asia/Chita|YAKT YAKST YAKT IRKT|-90 -a0 -a0 -80|010230|1BWh0 1qM0 WM0 8Hz0 3re0|33e4","Asia/Choibalsan|CHOT CHOST|-80 -90|0101010101010|1O8G0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|38e3","Asia/Shanghai|CST|-80|0||23e6","Asia/Dhaka|BDT|-60|0||16e6","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1C0m0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0|26e5","Asia/Dili|TLT|-90|0||19e4","Asia/Dubai|GST|-40|0||39e5","Asia/Dushanbe|TJT|-50|0||76e4","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1BVW1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0|18e5","Asia/Hebron|EET EEST|-20 -30|0101010101010101010101010|1BVy0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1ny0 1220 1qm0 1220 1ny0 1220 1ny0 1220 1ny0|25e4","Asia/Hong_Kong|HKT|-80|0||73e5","Asia/Hovd|HOVT HOVST|-70 -80|0101010101010|1O8H0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|IRKT IRKST IRKT|-80 -90 -90|01020|1BWi0 1qM0 WM0 8Hz0|60e4","Europe/Istanbul|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1tA0 U00 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|13e6","Asia/Jakarta|WIB|-70|0||31e6","Asia/Jayapura|WIT|-90|0||26e4","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1BVA0 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0|81e4","Asia/Kabul|AFT|-4u|0||46e5","Asia/Kamchatka|PETT PETST PETT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0|18e4","Asia/Karachi|PKT|-50|0||24e6","Asia/Urumqi|XJT|-60|0||32e5","Asia/Kathmandu|NPT|-5J|0||12e5","Asia/Khandyga|VLAT VLAST VLAT YAKT YAKT|-a0 -b0 -b0 -a0 -90|010234|1BWg0 1qM0 WM0 17V0 7zD0|66e2","Asia/Krasnoyarsk|KRAT KRAST KRAT|-70 -80 -80|01020|1BWj0 1qM0 WM0 8Hz0|10e5","Asia/Kuala_Lumpur|MYT|-80|0||71e5","Asia/Magadan|MAGT MAGST MAGT MAGT|-b0 -c0 -c0 -a0|010230|1BWf0 1qM0 WM0 8Hz0 3Cq0|95e3","Asia/Makassar|WITA|-80|0||15e5","Asia/Manila|PHT|-80|0||24e6","Europe/Athens|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|35e5","Asia/Novokuznetsk|KRAT NOVST NOVT NOVT|-70 -70 -60 -70|01230|1BWj0 1qN0 WM0 8Hz0|55e4","Asia/Novosibirsk|NOVT NOVST NOVT|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0|15e5","Asia/Omsk|OMST OMSST OMST|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0|12e5","Asia/Pyongyang|KST KST|-90 -8u|01|1P4D0|29e5","Asia/Rangoon|MMT|-6u|0||48e5","Asia/Sakhalin|SAKT SAKST SAKT|-a0 -b0 -b0|010202|1BWg0 1qM0 WM0 8Hz0 3rd0|58e4","Asia/Tashkent|UZT|-50|0||23e5","Asia/Seoul|KST|-90|0||23e6","Asia/Singapore|SGT|-80|0||56e5","Asia/Srednekolymsk|MAGT MAGST MAGT SRET|-b0 -c0 -c0 -b0|01023|1BWf0 1qM0 WM0 8Hz0|35e2","Asia/Tbilisi|GET|-40|0||11e5","Asia/Tehran|IRST IRDT|-3u -4u|01010101010101010101010|1BTUu 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0|14e6","Asia/Thimphu|BTT|-60|0||79e3","Asia/Tokyo|JST|-90|0||38e6","Asia/Tomsk|+06 +07|-60 -70|010101|1BWk0 1qM0 WM0 8Hz0 3Qp0|10e5","Asia/Ulaanbaatar|ULAT ULAST|-80 -90|0101010101010|1O8G0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|12e5","Asia/Ust-Nera|MAGT MAGST MAGT VLAT VLAT|-b0 -c0 -c0 -b0 -a0|010234|1BWf0 1qM0 WM0 17V0 7zD0|65e2","Asia/Vladivostok|VLAT VLAST VLAT|-a0 -b0 -b0|01020|1BWg0 1qM0 WM0 8Hz0|60e4","Asia/Yakutsk|YAKT YAKST YAKT|-90 -a0 -a0|01020|1BWh0 1qM0 WM0 8Hz0|28e4","Asia/Yekaterinburg|YEKT YEKST YEKT|-50 -60 -60|01020|1BWl0 1qM0 WM0 8Hz0|14e5","Asia/Yerevan|AMT AMST|-40 -50|01010|1BWm0 1qM0 WM0 1qM0|13e5","Atlantic/Azores|AZOT AZOST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|25e4","Europe/Lisbon|WET WEST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e5","Atlantic/Cape_Verde|CVT|10|0||50e4","Atlantic/South_Georgia|GST|20|0||30","Atlantic/Stanley|FKST FKT|30 40|010|1C6R0 U10|21e2","Australia/Sydney|AEDT AEST|-b0 -a0|01010101010101010101010|1C140 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|40e5","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1C14u 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|11e5","Australia/Brisbane|AEST|-a0|0||20e5","Australia/Darwin|ACST|-9u|0||12e4","Australia/Eucla|ACWST|-8J|0||368","Australia/Lord_Howe|LHDT LHST|-b0 -au|01010101010101010101010|1C130 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu|347","Australia/Perth|AWST|-80|0||18e5","Pacific/Easter|EASST EAST|50 60|010101010101010101010|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|30e2","Europe/Dublin|GMT IST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Etc/GMT+1|GMT+1|10|0|","Etc/GMT+10|GMT+10|a0|0|","Etc/GMT+11|GMT+11|b0|0|","Etc/GMT+12|GMT+12|c0|0|","Etc/GMT+2|GMT+2|20|0|","Etc/GMT+3|GMT+3|30|0|","Etc/GMT+4|GMT+4|40|0|","Etc/GMT+5|GMT+5|50|0|","Etc/GMT+6|GMT+6|60|0|","Etc/GMT+7|GMT+7|70|0|","Etc/GMT+8|GMT+8|80|0|","Etc/GMT+9|GMT+9|90|0|","Etc/GMT-1|GMT-1|-10|0|","Etc/GMT-10|GMT-10|-a0|0|","Etc/GMT-11|GMT-11|-b0|0|","Etc/GMT-12|GMT-12|-c0|0|","Etc/GMT-13|GMT-13|-d0|0|","Etc/GMT-14|GMT-14|-e0|0|","Etc/GMT-2|GMT-2|-20|0|","Etc/GMT-3|GMT-3|-30|0|","Etc/GMT-4|GMT-4|-40|0|","Etc/GMT-5|GMT-5|-50|0|","Etc/GMT-6|GMT-6|-60|0|","Etc/GMT-7|GMT-7|-70|0|","Etc/GMT-8|GMT-8|-80|0|","Etc/GMT-9|GMT-9|-90|0|","Etc/UCT|UCT|0|0|","Etc/UTC|UTC|0|0|","Europe/Astrakhan|+03 +04|-30 -40|010101|1BWn0 1qM0 WM0 8Hz0 3rd0","Europe/London|GMT BST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|10e6","Europe/Chisinau|EET EEST|-20 -30|01010101010101010101010|1BWo0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|67e4","Europe/Kaliningrad|EET EEST FET|-20 -30 -30|01020|1BWo0 1qM0 WM0 8Hz0|44e4","Europe/Kirov|+03 +04|-30 -40|01010|1BWn0 1qM0 WM0 8Hz0|48e4","Europe/Minsk|EET EEST FET MSK|-20 -30 -30 -30|01023|1BWo0 1qM0 WM0 8Hy0|19e5","Europe/Moscow|MSK MSD MSK|-30 -40 -40|01020|1BWn0 1qM0 WM0 8Hz0|16e6","Europe/Samara|SAMT SAMST SAMT|-40 -40 -30|0120|1BWm0 1qN0 WM0|12e5","Europe/Simferopol|EET EEST MSK MSK|-20 -30 -40 -30|01010101023|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0|33e4","Pacific/Honolulu|HST|a0|0||37e4","Indian/Chagos|IOT|-60|0||30e2","Indian/Christmas|CXT|-70|0||21e2","Indian/Cocos|CCT|-6u|0||596","Indian/Kerguelen|TFT|-50|0||130","Indian/Mahe|SCT|-40|0||79e3","Indian/Maldives|MVT|-50|0||35e4","Indian/Mauritius|MUT|-40|0||15e4","Indian/Reunion|RET|-40|0||84e4","Pacific/Majuro|MHT|-c0|0||28e3","MET|MET MEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Pacific/Chatham|CHADT CHAST|-dJ -cJ|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|600","Pacific/Apia|SST SDT WSDT WSST|b0 a0 -e0 -d0|01012323232323232323232|1Dbn0 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|37e3","Pacific/Bougainville|PGT BST|-a0 -b0|01|1NwE0|18e4","Pacific/Chuuk|CHUT|-a0|0||49e3","Pacific/Efate|VUT|-b0|0||66e3","Pacific/Enderbury|PHOT|-d0|0||1","Pacific/Fakaofo|TKT TKT|b0 -d0|01|1Gfn0|483","Pacific/Fiji|FJST FJT|-d0 -c0|01010101010101010101010|1BWe0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0|88e4","Pacific/Funafuti|TVT|-c0|0||45e2","Pacific/Galapagos|GALT|60|0||25e3","Pacific/Gambier|GAMT|90|0||125","Pacific/Guadalcanal|SBT|-b0|0||11e4","Pacific/Guam|ChST|-a0|0||17e4","Pacific/Kiritimati|LINT|-e0|0||51e2","Pacific/Kosrae|KOST|-b0|0||66e2","Pacific/Marquesas|MART|9u|0||86e2","Pacific/Pago_Pago|SST|b0|0||37e2","Pacific/Nauru|NRT|-c0|0||10e3","Pacific/Niue|NUT|b0|0||12e2","Pacific/Norfolk|NFT NFT|-bu -b0|01|1PoCu|25e4","Pacific/Noumea|NCT|-b0|0||98e3","Pacific/Palau|PWT|-90|0||21e3","Pacific/Pitcairn|PST|80|0||56","Pacific/Pohnpei|PONT|-b0|0||34e3","Pacific/Port_Moresby|PGT|-a0|0||25e4","Pacific/Rarotonga|CKT|a0|0||13e3","Pacific/Tahiti|TAHT|a0|0||18e4","Pacific/Tarawa|GILT|-c0|0||29e3","Pacific/Tongatapu|TOT|-d0|0||75e3","Pacific/Wake|WAKT|-c0|0||16e3","Pacific/Wallis|WFT|-c0|0||94"],
links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Sao_Tome","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Algiers|Africa/Tunis","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Khartoum|Africa/Addis_Ababa","Africa/Khartoum|Africa/Asmara","Africa/Khartoum|Africa/Asmera","Africa/Khartoum|Africa/Dar_es_Salaam","Africa/Khartoum|Africa/Djibouti","Africa/Khartoum|Africa/Juba","Africa/Khartoum|Africa/Kampala","Africa/Khartoum|Africa/Mogadishu","Africa/Khartoum|Africa/Nairobi","Africa/Khartoum|Indian/Antananarivo","Africa/Khartoum|Indian/Comoro","Africa/Khartoum|Indian/Mayotte","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Ndjamena","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Argentina/Buenos_Aires|America/Argentina/Catamarca","America/Argentina/Buenos_Aires|America/Argentina/ComodRivadavia","America/Argentina/Buenos_Aires|America/Argentina/Cordoba","America/Argentina/Buenos_Aires|America/Argentina/Jujuy","America/Argentina/Buenos_Aires|America/Argentina/La_Rioja","America/Argentina/Buenos_Aires|America/Argentina/Mendoza","America/Argentina/Buenos_Aires|America/Argentina/Rio_Gallegos","America/Argentina/Buenos_Aires|America/Argentina/Salta","America/Argentina/Buenos_Aires|America/Argentina/San_Juan","America/Argentina/Buenos_Aires|America/Argentina/San_Luis","America/Argentina/Buenos_Aires|America/Argentina/Tucuman","America/Argentina/Buenos_Aires|America/Argentina/Ushuaia","America/Argentina/Buenos_Aires|America/Buenos_Aires","America/Argentina/Buenos_Aires|America/Catamarca","America/Argentina/Buenos_Aires|America/Cordoba","America/Argentina/Buenos_Aires|America/Jujuy","America/Argentina/Buenos_Aires|America/Mendoza","America/Argentina/Buenos_Aires|America/Rosario","America/Campo_Grande|America/Cuiaba","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Denver|America/Boise","America/Denver|America/Cambridge_Bay","America/Denver|America/Edmonton","America/Denver|America/Inuvik","America/Denver|America/Ojinaga","America/Denver|America/Shiprock","America/Denver|America/Yellowknife","America/Denver|Canada/Mountain","America/Denver|MST7MDT","America/Denver|Navajo","America/Denver|US/Mountain","America/Fortaleza|America/Belem","America/Fortaleza|America/Maceio","America/Fortaleza|America/Recife","America/Fortaleza|America/Santarem","America/Halifax|America/Glace_Bay","America/Halifax|America/Moncton","America/Halifax|America/Thule","America/Halifax|Atlantic/Bermuda","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/Los_Angeles|America/Dawson","America/Los_Angeles|America/Ensenada","America/Los_Angeles|America/Santa_Isabel","America/Los_Angeles|America/Tijuana","America/Los_Angeles|America/Vancouver","America/Los_Angeles|America/Whitehorse","America/Los_Angeles|Canada/Pacific","America/Los_Angeles|Canada/Yukon","America/Los_Angeles|Mexico/BajaNorte","America/Los_Angeles|PST8PDT","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Managua|America/Belize","America/Managua|America/Costa_Rica","America/Managua|America/El_Salvador","America/Managua|America/Guatemala","America/Managua|America/Regina","America/Managua|America/Swift_Current","America/Managua|America/Tegucigalpa","America/Managua|Canada/East-Saskatchewan","America/Managua|Canada/Saskatchewan","America/Manaus|America/Boa_Vista","America/Manaus|America/Porto_Velho","America/Manaus|Brazil/West","America/Mexico_City|America/Merida","America/Mexico_City|America/Monterrey","America/Mexico_City|Mexico/General","America/New_York|America/Detroit","America/New_York|America/Fort_Wayne","America/New_York|America/Indiana/Indianapolis","America/New_York|America/Indiana/Marengo","America/New_York|America/Indiana/Petersburg","America/New_York|America/Indiana/Vevay","America/New_York|America/Indiana/Vincennes","America/New_York|America/Indiana/Winamac","America/New_York|America/Indianapolis","America/New_York|America/Iqaluit","America/New_York|America/Kentucky/Louisville","America/New_York|America/Kentucky/Monticello","America/New_York|America/Louisville","America/New_York|America/Montreal","America/New_York|America/Nassau","America/New_York|America/Nipigon","America/New_York|America/Pangnirtung","America/New_York|America/Thunder_Bay","America/New_York|America/Toronto","America/New_York|Canada/Eastern","America/New_York|EST5EDT","America/New_York|US/East-Indiana","America/New_York|US/Eastern","America/New_York|US/Michigan","America/Noronha|Brazil/DeNoronha","America/Panama|America/Atikokan","America/Panama|America/Cayman","America/Panama|America/Coral_Harbour","America/Panama|America/Jamaica","America/Panama|EST","America/Panama|Jamaica","America/Phoenix|America/Creston","America/Phoenix|America/Dawson_Creek","America/Phoenix|America/Hermosillo","America/Phoenix|MST","America/Phoenix|US/Arizona","America/Rio_Branco|America/Eirunepe","America/Rio_Branco|America/Porto_Acre","America/Rio_Branco|Brazil/Acre","America/Santiago|Antarctica/Palmer","America/Santiago|Chile/Continental","America/Santo_Domingo|America/Anguilla","America/Santo_Domingo|America/Antigua","America/Santo_Domingo|America/Aruba","America/Santo_Domingo|America/Barbados","America/Santo_Domingo|America/Blanc-Sablon","America/Santo_Domingo|America/Curacao","America/Santo_Domingo|America/Dominica","America/Santo_Domingo|America/Grenada","America/Santo_Domingo|America/Guadeloupe","America/Santo_Domingo|America/Kralendijk","America/Santo_Domingo|America/Lower_Princes","America/Santo_Domingo|America/Marigot","America/Santo_Domingo|America/Martinique","America/Santo_Domingo|America/Montserrat","America/Santo_Domingo|America/Port_of_Spain","America/Santo_Domingo|America/Puerto_Rico","America/Santo_Domingo|America/St_Barthelemy","America/Santo_Domingo|America/St_Kitts","America/Santo_Domingo|America/St_Lucia","America/Santo_Domingo|America/St_Thomas","America/Santo_Domingo|America/St_Vincent","America/Santo_Domingo|America/Tortola","America/Santo_Domingo|America/Virgin","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","Asia/Almaty|Asia/Qyzylorda","Asia/Aqtobe|Asia/Aqtau","Asia/Aqtobe|Asia/Oral","Asia/Ashgabat|Asia/Ashkhabad","Asia/Baghdad|Asia/Aden","Asia/Baghdad|Asia/Bahrain","Asia/Baghdad|Asia/Kuwait","Asia/Baghdad|Asia/Qatar","Asia/Baghdad|Asia/Riyadh","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Dhaka|Asia/Dacca","Asia/Dubai|Asia/Muscat","Asia/Hong_Kong|Hongkong","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kolkata|Asia/Colombo","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Makassar|Asia/Ujung_Pandang","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|Asia/Macao","Asia/Shanghai|Asia/Macau","Asia/Shanghai|Asia/Taipei","Asia/Shanghai|PRC","Asia/Shanghai|ROC","Asia/Singapore|Singapore","Asia/Tashkent|Asia/Samarkand","Asia/Tehran|Iran","Asia/Thimphu|Asia/Thimbu","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Urumqi|Asia/Kashgar","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/Lord_Howe|Australia/LHI","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/Currie","Australia/Sydney|Australia/Hobart","Australia/Sydney|Australia/Melbourne","Australia/Sydney|Australia/NSW","Australia/Sydney|Australia/Tasmania","Australia/Sydney|Australia/Victoria","Etc/UCT|UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Astrakhan|Europe/Ulyanovsk","Europe/Athens|Asia/Nicosia","Europe/Athens|EET","Europe/Athens|Europe/Bucharest","Europe/Athens|Europe/Helsinki","Europe/Athens|Europe/Kiev","Europe/Athens|Europe/Mariehamn","Europe/Athens|Europe/Nicosia","Europe/Athens|Europe/Riga","Europe/Athens|Europe/Sofia","Europe/Athens|Europe/Tallinn","Europe/Athens|Europe/Uzhgorod","Europe/Athens|Europe/Vilnius","Europe/Athens|Europe/Zaporozhye","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Atlantic/Canary","Europe/Lisbon|Atlantic/Faeroe","Europe/Lisbon|Atlantic/Faroe","Europe/Lisbon|Atlantic/Madeira","Europe/Lisbon|Portugal","Europe/Lisbon|WET","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|Europe/Volgograd","Europe/Moscow|W-SU","Europe/Paris|Africa/Ceuta","Europe/Paris|Arctic/Longyearbyen","Europe/Paris|Atlantic/Jan_Mayen","Europe/Paris|CET","Europe/Paris|Europe/Amsterdam","Europe/Paris|Europe/Andorra","Europe/Paris|Europe/Belgrade","Europe/Paris|Europe/Berlin","Europe/Paris|Europe/Bratislava","Europe/Paris|Europe/Brussels","Europe/Paris|Europe/Budapest","Europe/Paris|Europe/Busingen","Europe/Paris|Europe/Copenhagen","Europe/Paris|Europe/Gibraltar","Europe/Paris|Europe/Ljubljana","Europe/Paris|Europe/Luxembourg","Europe/Paris|Europe/Madrid","Europe/Paris|Europe/Malta","Europe/Paris|Europe/Monaco","Europe/Paris|Europe/Oslo","Europe/Paris|Europe/Podgorica","Europe/Paris|Europe/Prague","Europe/Paris|Europe/Rome","Europe/Paris|Europe/San_Marino","Europe/Paris|Europe/Sarajevo","Europe/Paris|Europe/Skopje","Europe/Paris|Europe/Stockholm","Europe/Paris|Europe/Tirane","Europe/Paris|Europe/Vaduz","Europe/Paris|Europe/Vatican","Europe/Paris|Europe/Vienna","Europe/Paris|Europe/Warsaw","Europe/Paris|Europe/Zagreb","Europe/Paris|Europe/Zurich","Europe/Paris|Poland","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Chuuk|Pacific/Truk","Pacific/Chuuk|Pacific/Yap","Pacific/Easter|Chile/EasterIsland","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|HST","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Majuro|Kwajalein","Pacific/Majuro|Pacific/Kwajalein","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pohnpei|Pacific/Ponape"]}),e})},{"./moment.js":46}],48:[function(e,t,n){(function(e,r){if(typeof define==="function"&&define.amd){define(r)}else if(typeof n==="object"){t.exports=r()}else{e.NProgress=r()}})(this,function(){var e={};e.version="0.1.6";var t=e.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:true,trickleRate:.02,trickleSpeed:800,showSpinner:true,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};e.configure=function(e){var n,r;for(n in e){r=e[n];if(r!==undefined&&e.hasOwnProperty(n))t[n]=r}return this};e.status=null;e.set=function(r){var s=e.isStarted();r=n(r,t.minimum,1);e.status=r===1?null:r;var u=e.render(!s),l=u.querySelector(t.barSelector),c=t.speed,f=t.easing;u.offsetWidth;o(function(n){if(t.positionUsing==="")t.positionUsing=e.getPositioningCSS();a(l,i(r,c,f));if(r===1){a(u,{transition:"none",opacity:1});u.offsetWidth;setTimeout(function(){a(u,{transition:"all "+c+"ms linear",opacity:0});setTimeout(function(){e.remove();n()},c)},c)}else{setTimeout(n,c)}});return this};e.isStarted=function(){return typeof e.status==="number"};e.start=function(){if(!e.status)e.set(0);var n=function(){setTimeout(function(){if(!e.status)return;e.trickle();n()},t.trickleSpeed)};if(t.trickle)n();return this};e.done=function(t){if(!t&&!e.status)return this;return e.inc(.3+.5*Math.random()).set(1)};e.inc=function(t){var r=e.status;if(!r){return e.start()}else{if(typeof t!=="number"){t=(1-r)*n(Math.random()*r,.1,.95)}r=n(r+t,0,.994);return e.set(r)}};e.trickle=function(){return e.inc(Math.random()*t.trickleRate)};(function(){var t=0,n=0;e.promise=function(r){if(!r||r.state()=="resolved"){return this}if(n==0){e.start()}t++;n++;r.always(function(){n--;if(n==0){t=0;e.done()}else{e.set((t-n)/t)}});return this}})();e.render=function(n){if(e.isRendered())return document.getElementById("nprogress");u(document.documentElement,"nprogress-busy");var i=document.createElement("div");i.id="nprogress";i.innerHTML=t.template;var o=i.querySelector(t.barSelector),s=n?"-100":r(e.status||0),l=document.querySelector(t.parent),c;a(o,{transition:"all 0 linear",transform:"translate3d("+s+"%,0,0)"});if(!t.showSpinner){c=i.querySelector(t.spinnerSelector);c&&f(c)}if(l!=document.body){u(l,"nprogress-custom-parent")}l.appendChild(i);return i};e.remove=function(){l(document.documentElement,"nprogress-busy");l(document.querySelector(t.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&f(e)};e.isRendered=function(){return!!document.getElementById("nprogress")};e.getPositioningCSS=function(){var e=document.body.style;var t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";if(t+"Perspective"in e){return"translate3d"}else if(t+"Transform"in e){return"translate"}else{return"margin"}};function n(e,t,n){if(e<t)return t;if(e>n)return n;return e}function r(e){return(-1+e)*100}function i(e,n,i){var o;if(t.positionUsing==="translate3d"){o={transform:"translate3d("+r(e)+"%,0,0)"}}else if(t.positionUsing==="translate"){o={transform:"translate("+r(e)+"%,0)"}}else{o={"margin-left":r(e)+"%"}}o.transition="all "+n+"ms "+i;return o}var o=function(){var e=[];function t(){var n=e.shift();if(n){n(t)}}return function(n){e.push(n);if(e.length==1)t()}}();var a=function(){var e=["Webkit","O","Moz","ms"],t={};function n(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function r(t){var n=document.body.style;if(t in n)return t;var r=e.length,i=t.charAt(0).toUpperCase()+t.slice(1),o;while(r--){o=e[r]+i;if(o in n)return o}return t}function i(e){e=n(e);return t[e]||(t[e]=r(e))}function o(e,t,n){t=i(t);e.style[t]=n}return function(e,t){var n=arguments,r,i;if(n.length==2){for(r in t){i=t[r];if(i!==undefined&&t.hasOwnProperty(r))o(e,r,i)}}else{o(e,n[1],n[2])}}}();function s(e,t){var n=typeof e=="string"?e:c(e);return n.indexOf(" "+t+" ")>=0}function u(e,t){var n=c(e),r=n+t;if(s(n,t))return;e.className=r.substring(1)}function l(e,t){var n=c(e),r;if(!s(e,t))return;r=n.replace(" "+t+" "," ");e.className=r.substring(1,r.length-1)}function c(e){return(" "+(e.className||"")+" ").replace(/\s+/gi," ")}function f(e){e&&e.parentNode&&e.parentNode.removeChild(e)}return e})},{}],49:[function(e,t,n){(function(e,r){if(typeof n=="object")t.exports=r();else if(typeof define=="function"&&define.amd)define(r);else e.Spinner=r()})(this,function(){"use strict";var e=["webkit","Moz","ms","O"],t={},n;function r(e,t){var n=document.createElement(e||"div"),r;for(r in t)n[r]=t[r];return n}function i(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}var o=function(){var e=r("style",{type:"text/css"});i(document.getElementsByTagName("head")[0],e);return e.sheet||e.styleSheet}();function a(e,r,i,a){var s=["opacity",r,~~(e*100),i,a].join("-"),u=.01+i/a*100,l=Math.max(1-(1-e)/r*(100-u),e),c=n.substring(0,n.indexOf("Animation")).toLowerCase(),f=c&&"-"+c+"-"||"";if(!t[s]){o.insertRule("@"+f+"keyframes "+s+"{"+"0%{opacity:"+l+"}"+u+"%{opacity:"+e+"}"+(u+.01)+"%{opacity:1}"+(u+r)%100+"%{opacity:"+e+"}"+"100%{opacity:"+l+"}"+"}",o.cssRules.length);t[s]=1}return s}function s(t,n){var r=t.style,i,o;if(r[n]!==undefined)return n;n=n.charAt(0).toUpperCase()+n.slice(1);for(o=0;o<e.length;o++){i=e[o]+n;if(r[i]!==undefined)return i}}function u(e,t){for(var n in t)e.style[s(e,n)||n]=t[n];return e}function l(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)if(e[r]===undefined)e[r]=n[r]}return e}function c(e){var t={x:e.offsetLeft,y:e.offsetTop};while(e=e.offsetParent)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}var f={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};function d(e){if(typeof this=="undefined")return new d(e);this.opts=l(e||{},d.defaults,f)}d.defaults={};l(d.prototype,{spin:function(e){this.stop();var t=this,i=t.opts,o=t.el=u(r(0,{className:i.className}),{position:i.position,width:0,zIndex:i.zIndex}),a=i.radius+i.length+i.width,s,l;if(e){e.insertBefore(o,e.firstChild||null);l=c(e);s=c(o);u(o,{left:(i.left=="auto"?l.x-s.x+(e.offsetWidth>>1):parseInt(i.left,10)+a)+"px",top:(i.top=="auto"?l.y-s.y+(e.offsetHeight>>1):parseInt(i.top,10)+a)+"px"})}o.setAttribute("role","progressbar");t.lines(o,t.opts);if(!n){var f=0,d=(i.lines-1)*(1-i.direction)/2,_,p=i.fps,h=p/i.speed,g=(1-i.opacity)/(h*i.trail/100),m=h/i.lines;(function v(){f++;for(var e=0;e<i.lines;e++){_=Math.max(1-(f+(i.lines-e)*m)%h*g,i.opacity);t.opacity(o,e*i.direction+d,_,i)}t.timeout=t.el&&setTimeout(v,~~(1e3/p))})()}return t},stop:function(){var e=this.el;if(e){clearTimeout(this.timeout);if(e.parentNode)e.parentNode.removeChild(e);this.el=undefined}return this},lines:function(e,t){var o=0,s=(t.lines-1)*(1-t.direction)/2,l;function c(e,n){return u(r(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*o+t.rotate)+"deg) translate("+t.radius+"px"+",0)",borderRadius:(t.corners*t.width>>1)+"px"})}for(;o<t.lines;o++){l=u(r(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:n&&a(t.opacity,t.trail,s+o*t.direction,t.lines)+" "+1/t.speed+"s linear infinite"});if(t.shadow)i(l,u(c("#000","0 0 4px "+"#000"),{top:2+"px"}));i(e,i(l,c(t.color,"0 0 1px rgba(0,0,0,.1)")))}return e},opacity:function(e,t,n){if(t<e.childNodes.length)e.childNodes[t].style.opacity=n}});function _(){function e(e,t){return r("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}o.addRule(".spin-vml","behavior:url(#default#VML)");d.prototype.lines=function(t,n){var r=n.length+n.width,o=2*r;function a(){return u(e("group",{coordsize:o+" "+o,coordorigin:-r+" "+-r}),{width:o,height:o})}var s=-(n.width+n.length)*2+"px",l=u(a(),{position:"absolute",top:s,left:s}),c;function f(t,o,s){i(l,i(u(a(),{rotation:360/n.lines*t+"deg",left:~~o}),i(u(e("roundrect",{arcsize:n.corners}),{width:r,height:n.width,left:n.radius,top:-n.width>>1,filter:s}),e("fill",{color:n.color,opacity:n.opacity}),e("stroke",{opacity:0}))))}if(n.shadow)for(c=1;c<=n.lines;c++)f(c,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(c=1;c<=n.lines;c++)f(c);return i(t,l)};d.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0;if(i&&t+r<i.childNodes.length){i=i.childNodes[t+r];i=i&&i.firstChild;i=i&&i.firstChild;if(i)i.opacity=n}}}var p=u(r("group"),{behavior:"url(#default#VML)"});if(!s(p,"transform")&&p.adj)_();else n=s(p,"animation");return d})},{}],50:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W={}.hasOwnProperty,G=function(e,t){for(var n in t){if(W.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e},V=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};v=n;R=e("./../u");j=e("./lang");z=e("./../util");j.add("FakeApplication",r=function(){function e(e){this.version_json=e}e.prototype.domain=function(){return this.version_json.child("primary_domain").get()};e.prototype.appname=function(){return this.version_json.child("_id").get()};return e}());j.add("Application",r=function(){function e(e){this._appname=e}e.prototype.appname=function(){return this._appname};e.prototype.domain=function(){return l().app_domain()};return e}());j.SECURABLE="securable_";j.add("ApplicationVersion",i=function(e){G(t,e);function t(e){var n=this;t.__super__.constructor.call(this,e);this._styles_cache={};e.register_indexer("app_fonts",function(){var e,t,r,i,o,a,s,u;e=[];u=n.json._child("_index")._child("fonts_used").children();for(a=0,s=u.length;a<s;a++){r=u[a];if(r._child_names().length>0){e.push(r._name())}}e=B.clean_list(e);t=R.to_object(function(){var t,n,r;r=[];for(t=0,n=e.length;t<n;t++){i=e[t];r.push([i,true])}return r}());o=["app_fonts"];return[o,t]});e.register_indexer("oauth_providers",function(){var e;e=["oauth_providers"];return[e,R.json_stringify(n.find_oauth_providers())]});e.register_indexer("user_calls",function(){var e;e=["user_calls"];return[e,R.json_stringify(n.find_user_calls())]});e.register_indexer("html_header_plugins",function(){var e;e=["html_header_plugins"];return[e,R.json_stringify(n.find_html_header_plugins())]})}t.prototype.application=function(){return this.json.application()};t.prototype.appname=function(){return this.application().appname()};t.prototype.app_version=function(){return this.json.app_version()};t.prototype.creation_date=function(){return this.json.child("creation_date").get()};t.prototype.domain=function(){return this.application().domain()};t.prototype.invalidate_app_plan=function(){l().location.wipe_request_cache("server://appeditor/get_app_plan","post",{appname:this.appname(),ignore_team:true});l().location.wipe_request_cache("server://appeditor/get_app_plan","post",{appname:this.appname(),ignore_team:false});this._plan_invalidation_box_true(!this._plan_invalidation_box_true());return this._plan_invalidation_box_false(!this._plan_invalidation_box_false())};t.prototype.app_plan=function(e){var t,n;if(e==null){e=false}if(l().is_edit_mode()){if(this[n="_plan_invalidation_box_"+e]==null){this[n]=R.Box(false)}this["_plan_invalidation_box_"+e]();t=l().location.request_synchronous("server://appeditor/get_app_plan","post",{appname:this.appname(),ignore_team:e});if(t!=null){if(t.display==null){t.display=R.toTitleCase(t.id)}}return t}else{return l().app_plan()}};t.prototype.display=function(){var e;return(e=this.domain())!=null?e:this.appname()};t.prototype.home_url=function(){var e,t;e=new D.Location((t=typeof document!=="undefined"&&document!==null?document.location.href:void 0)!=null?t:"https://"+z.get_meta_hostname("bubble.is"));return e.format_pieces({domain:this.domain(),appname:this.appname(),app_version:this.app_version(),version_explicit:"default"})};t.prototype.admin_email=function(){var e,t,n;n=this.admin_email_hostname();e=this.get_public_setting("admin_email");if(n!=="bubble.is"||this.appname()==="meta"){t=e.trim()+"@"+n}else{t=w.ADMIN_NO_REPLY}return t};t.prototype.admin_email_hostname=function(){var e,t,n,r,i;if(this.get_public_setting("app_topdomain")){return this.get_public_setting("app_topdomain")}e=(r=this.domain())!=null?r:"bubble.is";i=R.get_domain_components(e),n=i.top_domain,t=i.subdomains;if(z.is_on_amazon(n)){e="bubble.is"}return n};t.prototype.published=function(){return this.json.child("published").get()};t.prototype.find_oauth_providers=function(){var e,t,n,r,i,o,a,s,u;t=[];s=this.json.child("settings").child("client_safe").child("plugins").raw();for(r in s){i=s[r];if(!i){continue}n=I.get_service(r,i);if(n!=null?n.is_oauth_provider():void 0){u=n.get_oauth_providers_simple();for(o=0,a=u.length;o<a;o++){e=u[o];t.push(e)}}}return t};t.prototype.get_oauth_providers=function(){var e;e=this.json.read_index("oauth_providers");if(e!=null){return R.json_parse(e)}return this.find_oauth_providers()};t.prototype.find_html_header_plugins=function(){var e,t,n,r,i,o,a,s,u,l,c;t=[];l=this.json.child("settings").child("client_safe").child("plugins").raw();for(a in l){u=l[a];if(!(u!==true)){continue}o=I.get_service(a,u);if(o!=null?o.has_html_header():void 0){i=o!=null?o.get_html_header():void 0;s=i.snippet;c=i.params;for(r in c){n=c[r].key;e=o.get_key("header_"+r);if(e===null||e===void 0||e===""){return t}s=s.replace("_*_"+n+"_*_",e)}t.push(s)}}return t};t.prototype.get_html_header_plugins=function(){var e;return R.json_parse((e=this.json.read_index("html_header_plugins"))!=null?e:"[]")};t.prototype.find_user_calls=function(){var e,t,n,r,i,o,a,s,u,l;r=[];s=this.json.child("settings").child("client_safe").child("plugins").raw();for(n in s){i=s[n];if(!i){continue}t=I.get_service(n,i);l=(u=t!=null?t.get_user_calls():void 0)!=null?u:[];for(o=0,a=l.length;o<a;o++){e=l[o];r.push(n+I.PLUGIN_SEPERATOR+e)}}return r};t.prototype.get_user_calls=function(){var e;e=this.json.read_index("user_calls");if(e!=null){return R.json_parse(e)}return this.find_user_calls()};t.prototype._get_stripe_version=function(){if(w.env!==w.PROD_ENV){return"test"}else{return this.app_version()}};t.prototype.stripe_client_id=function(){return this.get_public_setting("stripe_client_id_"+this._get_stripe_version())};t.prototype.stripe_public_key=function(){return this.get_public_setting("stripe_public_key_"+this._get_stripe_version())};t.prototype.stripe_private_key=function(){return this.get_private_setting("stripe_private_key_"+this._get_stripe_version())};t.prototype.get_public_setting_node=function(e){var t,n,r,i,o;if(!e){throw R.error("missing name")}r=e.split(".");t=this.json.child("settings").child("client_safe");for(i=0,o=r.length;i<o;i++){n=r[i];t=t.child(n)}return j.new_expression(t,this)};t.prototype.get_public_setting=function(e){var t,n,r,i;t=this.appname();if((n=w.public_app_settings_override)!=null?(r=n[t])!=null?r[e]:void 0:void 0){return w.public_app_settings_override[t][e]}return(i=this.get_public_setting_node(e).get_static())!=null?i:this.settings_default(true,e)};t.prototype.get_private_setting_node=function(e){var t,n,r,i,o;if(!e){throw R.error("missing name")}r=e.split(".");t=this.json.child("settings").child("secure");for(i=0,o=r.length;i<o;i++){n=r[i];t=t.child(n)}return j.new_expression(t,this)};t.prototype.get_private_setting=function(e){var t,n,r,i;t=this.appname();if((n=w.private_app_settings_override)!=null?(r=n[t])!=null?r[e]:void 0:void 0){return w.private_app_settings_override[t][e]}return(i=this.get_private_setting_node(e).get_static())!=null?i:this.settings_default(false,e)};t.prototype.settings_default=function(e,t){var n;if(e&&t==="admin_email"){return"admin"}else if(e&&t==="app_language"){return"en_us"}else{return(n=I.defaults_for_services_settings[t])!=null?n:null}};t.prototype._id=function(){return this.appname()};t.prototype.id=function(){return this.appname()};t.prototype.is_template=function(){return this.json.child("is_template").get()};t.prototype.from_template=function(){var e;return(e=this.template_id())!==null&&e!==void 0&&e!==""};t.prototype.template_id=function(){return this.json.child("template_id").get()};t.prototype.page=function(e){if(!e){return null}return new j.Page(this.json.by_id(e))};t.prototype.pages=function(e){var t,n,r,i,o,a,s,u;n=function(){var e,t;e=this.json.read_index("page_name_to_path");t=[];for(r in e){a=e[r];if((a!=null?typeof a.split==="function"?a.split(".").length:void 0:void 0)===2){t.push(this.json.by_path(a))}}return t}.call(this);for(s=0,u=n.length;s<u;s++){t=n[s];t.child("id").pre_cache();t.child("type").pre_cache()}o=function(){var e,r,i;i=[];for(e=0,r=n.length;e<r;e++){t=n[e];i.push(j.new_element(t))}return i}();o=function(){var e,t,n;n=[];for(e=0,t=o.length;e<t;e++){i=o[e];if(i.exists()&&i.type()==="Page"){n.push(i)}}return n}();o.sort(function(e,t){var n,r;n=e.json.name();r=t.json.name();if(n<r){return-1}else if(r<n){return 1}else{return 0}});return j.filter_array(e,o)};t.prototype.custom_definition=function(e){if(!e){return null}return new j.CustomDefinition(this.json.by_id(e))};t.prototype.custom_definitions=function(e){var t;return j.filter_array(e,function(){var e,n,r,i;r=this.json.child("element_definitions").children();i=[];for(e=0,n=r.length;e<n;e++){t=r[e];i.push(new j.CustomDefinition(t))}return i}.call(this))};t.prototype.api=function(){return new j.API(this.json.child("api"))};t.prototype.roots=function(e){return this.pages().concat(this.custom_definitions()).filter(e)};t.prototype.all_elements=function(){var e,t;t=this.roots();e=t.find_elements();return t.concat(e)};t.prototype.custom_type=function(e){var t;if(!e){return null}if(e.indexOf("custom.")===0){throw R.error("This is a value id, not a custom type: "+e+".  Please do values.get(id).custom_type() instead.")}if(e.indexOf(j.SECURABLE)===0){t=e.split(j.SECURABLE);return this.securable_type(t[1],t[2])}return new j.CustomType(this.json.child("user_types").child(e))};t.prototype.securable_type=function(e,t){return new j.SecurableType(e,t,this.json.child("user_types").child(j.SECURABLE+e+j.SECURABLE+t))};t.prototype.custom_types=function(e,t){var n,r,i,o,a,s;i=[];n=false;s=this.json.child("user_types").children();for(o=0,a=s.length;o<a;o++){r=s[o];if(r.name().indexOf(j.SECURABLE)!==0){if(r.name()==="user"){n=true}i.push(new j.CustomType(r))}}if(!n){i.push(new j.CustomType(this.json.child("user_types").child("user")))}if(t){i.push.apply(i,p)}return j.filter_array(e,i)};t.prototype.element=function(e){if(!e){return null}return j.new_element(this.json.by_id(e))};t.prototype.workflow_item=function(e){if(!e){return null}return j.new_workflow_item(this.json.by_id(e))};t.prototype.event=function(e){if(!e){return null}return j.new_workflow_item(this.json.by_id(e))};t.prototype.action=function(e){if(!e){return null}return j.new_workflow_item(this.json.by_id(e))};t.prototype.by_id=function(e){var t,n,r,i,o;if(!e){return null}t=this.json.by_id(e);if(!t.exists()){return null}if((n=(r=t.parent())!=null?r.name():void 0)==="workflows"||n==="actions"||((i=t.parent())!=null?(o=i.parent())!=null?o.name():void 0:void 0)==="actions"){return this.workflow_item(e)}else{return this.element(e)}};t.prototype.get_page_by_name=function(e){var t;if(!e){return null}t=this.json.by_index("page_name_to_path",e);if(t){return new j.Page(t)}else{return null}};t.prototype.get_custom_by_name=function(e){
var t;t=v.custom_name_to_id(e);if(t){return this.custom_definition(t)}else{return null}};t.prototype.last_change=function(){var e;return(e=this.json.child("last_change").get())!=null?e:"no_last_change"};t.prototype.favicon=function(){return this.json.child("favicon").get()};t.prototype.plugin_special=function(){return this.json.child("plugin_special").get()};t.prototype.get_undostack=function(){return this.json.get_undostack()};t.prototype.find_actions=function(e){var t;return j.filter_array(e,function(){var n,r,i,o;i=this._find(e);o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push(j.new_workflow_item(t))}return o}.call(this))};t.prototype.find_elements=function(e){var t;if(e==="Page"){return this.pages(e)}else if(e==="CustomDefinition"){return this.custom_definitions(e)}else{return j.filter_array(e,function(){var n,r,i,o;i=this._find(e);o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push(j.new_element(t))}return o}.call(this))}};t.prototype.find_events=function(e){var t;return j.filter_array(e,function(){var n,r,i,o;i=this._find(e);o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push(j.new_workflow_item(t))}return o}.call(this))};t.prototype._find=function(e){var t,n,r;y.app().json.child("pages").raw();y.app().json.child("element_definitions").raw();y.app().json.child("api").raw();e=j.make_filter(e);if(!e._type){throw R.error("Can only use application.find_ functions with a given type")}t=this.json.read_index("type_to_path",e._type);return function(){var e;e=[];for(n in t){r=t[n];if(n!=="remove"){e.push(this.json.by_path(r))}}return e}.call(this)};t.prototype.has_plugin=function(e){var t;return(t=this.get_public_setting("plugins"))!=null?t[e]:void 0};t.prototype.remove_plugin=function(e){var t,n;t=(n=this.get_public_setting("plugins"))!=null?n:{};delete t[e];this.set_setting(true,"plugins",t);return this.commit()};t.prototype.install_plugin=function(e,t){var n,r;n=(r=this.get_public_setting("plugins"))!=null?r:{};n[e]=t!=null?t:true;this.set_setting(true,"plugins",n);this.commit();if(!w.plugins_live_here&&!O.is_hardcoded(e)){return l().location.post("server://appeditor/copy_plugin_meta_data",{plugin_id:e,raw:O.get_plugin(e).data})}};t.prototype.list_plugins=function(){var e,t,n,r;n=this.list_plugins_version();r=[];for(e in n){t=n[e];r.push(e)}return r};t.prototype.list_plugins_version=function(){return this.get_public_setting("plugins")};t.prototype.check_for_errors=function(e){return{children:this.custom_types().concat(this.styles())}};t.prototype.new_page=function(e,t,n){var r,i,o,a,s,u;a=y.uid();u=l().appchange.validate_page_name(e),i=u[0],e=u[1];if(i){throw R.error(i)}if(t){n=y.page(t).raw()}if(!n){n={type:"Page",properties:{}};n.properties.new_responsive=true;n.properties.fixed_width=true;if(y.get_public_setting("default_page_title")){n.properties.title=j.RAW.TextExpression([y.get_public_setting("default_page_title")])}if(y.get_public_setting("default_page_preset_width")){s=y.get_public_setting("default_page_preset_width");n.properties.preset_width=s;if(x.preset_page_widths[s].width!=null){n.properties.width=x.preset_page_widths[s].width}}}o=j.RAW.copy(n,a).new_data;o.name=e;r=(new l).changes.Change("CreateElement",{container:"pages",id:a,data:o});return r.execute()};t.prototype.new_custom=function(e,t,n){var r,i,o,a,s;a=y.uid();s=l().appchange.validate_custom_name(e),i=s[0],e=s[1];if(i){throw R.error(i)}if(t){n=y.custom_definition(t).raw()}if(!n){n={type:"CustomDefinition",properties:{width:200,height:200,element_type:"Group"}}}o=j.RAW.copy(n,a).new_data;o.name=e;r=(new l).changes.Change("CreateElement",{container:"element_definitions",id:a,data:o});r.execute();return a};t.prototype.create_custom_type=function(e,t){var n;n=(new l).changes.Change("WriteCustom",{name:e,data:{display:t}});return n.execute()};t.prototype.change_favicon=function(e){var t,n;n=this.favicon();if(e!==n){t=(new l).changes.Change("ChangeAppSetting",{path:"favicon",value:e,old_value:n});return t.execute()}};t.prototype.set_setting=function(e,t,n){var r,i,o;i=e?this.get_public_setting_node(t):this.get_private_setting_node(t);o=i.raw();if(n!==o){r=(new l).changes.Change("ChangeAppSetting",{path:i.path(),value:n,old_value:o});return r.execute()}};t.prototype.styles=function(){var e,t,n,r,i;r=this.json.child("styles").children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(new j.Style(e))}return i};t.prototype.style=function(e){var t;if((t=this._styles_cache)[e]==null){t[e]=new j.Style(this.json.child("styles").child(e))}return this._styles_cache[e]};t.prototype.create_new_style=function(e,t,n,r,i,o){var a,s,u,c,f,d,_;if(o){if((d=this.style(o))!=null?d.exists():void 0){o=void 0}}if(!o){a=t+"_"+e.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase();f="";c=function(){return a+"_"+f};while((_=this.style(c()))!=null?_.exists():void 0){f=(f||0)+1}o=c()}u={display:e,type:t,properties:n,states:r,transitions:i,id:o};s=(new l).changes.Change("CreateStyle",{name:o,data:u});s.execute();this.commit();return o};t.prototype.delete_style=function(e){var t,n,r;r=y.style(e);n=r.raw();t=(new l).changes.Change("DeleteStyle",{name:e,data:n});t.execute();return this.commit()};t.prototype.set_style_default=function(e,t){var n,r;n=(r=this.get_public_setting("default_styles"))!=null?r:{};n[e]=t;this.set_setting(true,"default_styles",n);return this.commit()};t.prototype.get_style_default=function(e){var t;return(t=this.get_public_setting("default_styles"))!=null?t[e]:void 0};t.prototype.apply_theme=function(e,t){var n,r,i,o,a,s;r={};s=this.styles();for(o=0,a=s.length;o<a;o++){i=s[o];if(i.from_theme()){r[i.id()]=i.json.raw()}}n=(new l).changes.Change("ApplyTheme",{theme_id:e,theme_data:t,old_theme:r});n.execute();return this.commit()};t.prototype.comments=function(){var e,t,n,r,i,o,a,s,u,l,c,f,d,_,p,h,g;r=[];a={};n=this.json.child("comments").children();for(s=0,f=n.length;s<f;s++){t=n[s];a[t]=t.child("type").get()}i=function(e,t){var n,r,i,o,s,u;r=a[e];i=a[t];u=["Element","Event","Action","CustomType","CustomField","PrivacyRole","Style"];for(o=0,s=u.length;o<s;o++){n=u[o];if(r===n&&i!==n){return-1}if(i===n&&r!==n){return 1}}};h=n.sort(i);for(u=0,d=h.length;u<d;u++){t=h[u];if(t.child("content").get()){r.push(new j.Comment(t))}if(t.child("comments").exists()){e=t.child("comments").children();for(l=0,_=e.length;l<_;l++){o=e[l];a[t]=t.child("type").get()}g=e.sort(i);for(c=0,p=g.length;c<p;c++){o=g[c];r.push(new j.Comment(o))}}}return r};t.prototype.comment=function(e,t){if(t){return new j.Comment(this.json.child("comments").child(t.id()).child("comments").child(e))}else{return new j.Comment(this.json.child("comments").child(e))}};t.prototype.repair_ids=function(e){var t,n,r,i,o,a;if(e.child("type").get()!=null&&!e.child("id").get()){n=e.raw();n.id=y.uid();l().changes.set_id_cache(e,n);e.set(n);console.log("added id "+n.id+" to type "+n.type+", path: "+e._path())}else if(e.child("id").get()!=null&&!e.child("type").get()){console.log("WARNING, missing type for id "+e.child("id").get()+", "+e._path())}o=e.child("elements").children();a=[];for(r=0,i=o.length;r<i;r++){t=o[r];a.push(this.repair_ids(t))}return a};t.prototype.get_editor_link=function(e){var t,n;if(e){t="https://local.bubble.is"}else{t=l().location.get_base_for_meta()}n=t+"/page?id="+y.appname()+"&version="+y.app_version();if(l().location.get_pieces().path[0]){n+="&name="+l().location.get_pieces().path[0]}return n};return t}(j.AppNode));j.add("API",t=function(e){G(t,e);function t(e){var n=this;t.__super__.constructor.call(this,e);e.register_indexer("issues_list",function(){var e;e=["issues_list",n.id()];return[e,R.json_stringify([])]});e.register_indexer("issues_sub",function(){var e,t,r;r=["issues_sub",n.id()];t=function(){var t,n,r,i;r=this.events();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e.id())}return i}.call(n);return[r,R.json_stringify(t)]});e.register_indexer("api_wf_name_to_id",function(){var e,t,r,i,o,a;t=["api_wf_name_to_id"];r={};a=n.events();for(i=0,o=a.length;i<o;i++){e=a[i];if(e.wf_name()!=null){r[e.wf_name()]=e.id()}}return[t,r]})}t.prototype.id=function(){return"api"};t.prototype.type=function(){return"API"};t.prototype.get_name=function(){return"API"};t.prototype.is_api=function(){return true};t.prototype.is_page=function(){return false};t.prototype.is_custom_definition=function(){return false};t.prototype.root=function(){return this};t.prototype.get_new_event_json=function(){return this.json.child(R.LUID())};t.prototype.parent=function(){return null};t.prototype.events=function(e){var t;return j.filter_array(e,function(){var e,n,r,i;r=this.json.children();i=[];for(e=0,n=r.length;e<n;e++){t=r[e];i.push(j.new_workflow_item(t))}return i}.call(this))};t.prototype.new_event=function(e,t){var n,r;r=j.RAW.copy(t,e).new_data;n=(new l).changes.Change("CreateEvent",{root_id:this.id(),id:e,data:r});return n.execute()};t.prototype.find_actions=function(e){var t,n,r,i,o;n=[];o=this.events();for(r=0,i=o.length;r<i;r++){t=o[r];n.push.apply(n,t.all_next(e))}return n};t.prototype.find_expressions=function(e){var t,n,r,i,o;n=[];o=this.events();for(r=0,i=o.length;r<i;r++){t=o[r];n.push.apply(n,t.find_expressions(e))}return n};t.prototype.check_for_errors=function(){};t.prototype.run_indexers=function(){return this.json.turn_indexer_switch()};t.prototype.find_in_editor=function(e,t){l().visual_edit.responsive_mode_box("builder");return l().visual_edit.ensure_root(this,t)};t.prototype.property=function(e){if(e==="wf_folder_list"){return y.get_public_setting_node("api_wf_folder_list")}};t.prototype.set_property=function(e,t){if(e.indexOf("wf_folder_list")===0){y.set_setting(true,"api_"+e,t);return this.commit()}};t.prototype.get_static_property=function(e){if(e==="wf_folder_list"){return y.get_public_setting("api_wf_folder_list")}};return t}(j.AppNode));j.add("CustomType",u=function(e){G(t,e);function t(){L=t.__super__.constructor.apply(this,arguments);return L}t.prototype.name=function(){return this.json.name()};t.prototype.id=function(){return this.name()};t.prototype.to_value=function(){var e;e=this.name();if(e==="user"){return"user"}else{return"custom."+e}};t.prototype.deleted=function(){return this.json.child("deleted").get()};t.prototype.display=function(){return this.json.child("display").get()};t.prototype.exposed_api=function(){return this.json.child("exposed_api").get()};t.prototype.fields=function(){var e,t,n,r,i;r=this.json.child("fields").children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(new j.CustomField(e))}return i};t.prototype.field=function(e){return new j.CustomField(this.json.child("fields").child(e))};t.prototype.privacy_roles=function(){var e,t,n,r,i;r=this.json.child("privacy_role").children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(new j.PrivacyRole(e))}return i};t.prototype.privacy_role=function(e){return new j.PrivacyRole(this.json.child("privacy_role").child(e))};t.prototype.check_for_errors=function(e){return{children:this.privacy_roles()}};t.prototype.create_new_privacy_role=function(e){var t,n,r,i,o,a,s;if(e===null){i="everyone";e="everyone"}else{t=e.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase();o="";r=function(){return t+"_"+o};while(this.privacy_role(r()).exists()){o=(o||0)+1}i=r()}a=this.json.path()+".privacy_role."+i;s={display:e,permissions:this.starting_permissions()};n=(new l).changes.Change("ChangeAppSetting",{path:a,value:s});n.execute();return y.commit()};t.prototype.starting_permissions=function(){return{view_all:true,view_attachments:true,search_for:true,auto_binding:false,modify_api:false,delete_api:false,create_api:false}};t.prototype.delete_privacy_role=function(e){var t,n,r,i;r=this.json.path()+".privacy_role."+e;i=null;n=this.privacy_role(e).json.raw();t=(new l).changes.Change("ChangeAppSetting",{path:r,value:i,old_value:n});t.execute();return y.commit()};t.prototype.reserved_fields=function(){return["_id","_rev","type"]};t.prototype.readable_fields=function(){var e;e=this.writeable_fields().concat([new(l().sets.Option)("Created Date","Created Date","Documentation.Data.Messages.CustomType.Created Date"),new(l().sets.Option)("Modified Date","Modified Date","Documentation.Data.Messages.CustomType.Modified Date")]);if(this.name()!=="user"){e.push(new(l().sets.Option)("Created By","Created By","Documentation.Data.Messages.CustomType.Created By"))}return e};t.prototype.writeable_fields=function(){var e,t,n,r,i;t=[];i=this.fields();for(n=0,r=i.length;n<r;n++){e=i[n];if(!e.deleted()){(function(e){return t.push(new(l().sets.Option)(e.display(),e.name(),void 0,void 0,void 0,function(){if(window.confirm("Delete field "+e.display()+"?")){return e.set_deleted(true)}}))})(e)}}return t};t.prototype.get_field_option=function(e){var t,n,r,i;i=this.readable_fields();for(n=0,r=i.length;n<r;n++){t=i[n];if(t.value===e){return t}}return null};t.prototype.get_permissions_editors=function(){return{view_all:{caption:"View all fields",composer:"Checkbox"},view_attachments:{caption:"View attached files",composer:"Checkbox"},search_for:{caption:"Find this in searches",composer:"Checkbox"},auto_binding:{caption:"Allow auto-binding",composer:"Checkbox"},modify_api:{caption:"Modify via API",composer:"Checkbox"},delete_api:{caption:"Delete via API",composer:"Checkbox"},create_api:{caption:"Create via API",composer:"Checkbox"}}};t.prototype.create_field=function(e,t,n){var r;r=(new l).changes.Change("WriteCustomField",{custom_name:this.name(),name:e,data:{display:t,value:n}});return r.execute()};t.prototype.set_deleted=function(e){var t;t=(new l).changes.Change("WriteCustom",{name:this.name(),path:"deleted",data:e});return t.execute()};t.prototype.set_display=function(e){var t;t=(new l).changes.Change("WriteCustom",{name:this.name(),path:"display",data:e});return t.execute()};t.prototype.set_api=function(e){var t;t=(new l).changes.Change("WriteCustom",{name:this.name(),path:"exposed_api",data:e});return t.execute()};t.prototype.find_in_editor=function(e,t){$(".tab.tabs-3").click();l().data_canvas.selection_boxes["Data Types"](this);l().data_canvas.open_tab("Data Types");return typeof t==="function"?t():void 0};return t}(j.AppNode));j.add("SecurableType",g=function(e){G(t,e);function t(e,n,r){this.plugin=e;this._name=n;t.__super__.constructor.call(this,r)}t.prototype.name=function(){return this._name};t.prototype.to_value=function(){return"custom."+this.json.name()};t.prototype.my_data=function(){var e;return(e=I.get_service(this.plugin).securable)!=null?e[this.name()]:void 0};t.prototype.display=function(){var e,t;return(e=(t=this.my_data())!=null?t.display:void 0)!=null?e:"[missing: "+this.plugin+" "+this.name()+"]"};t.prototype.get_permissions_editors=function(){var e,t;return(e=(t=this.my_data())!=null?t.permissions_editors:void 0)!=null?e:{}};t.prototype.starting_permissions=function(){var e,t;return(e=(t=this.my_data())!=null?t.starting_permissions:void 0)!=null?e:{}};t.prototype.fields=function(){var e,t,n,r,i,o;i=(n=(r=this.my_data())!=null?r.fields:void 0)!=null?n:{};o=[];for(t in i){e=i[t];o.push(k(t,e))}return o};t.prototype.field=function(e){var t,n,r;t=(n=(r=this.my_data())!=null?r.fields[e]:void 0)!=null?n:{display:"Missing: "+e,value:"null"};return k(e,t)};t.prototype.no_special_messages=true;t.prototype.not_writeable=true;return t}(u));j.add("CustomField",s=function(e){G(t,e);function t(){q=t.__super__.constructor.apply(this,arguments);return q}t.prototype.display=function(){return this.json.child("display").get()};t.prototype.value=function(){return this.json.child("value").get()};t.prototype.default_val=function(){return this.json.child("default_val").get()};t.prototype.can_have_default=function(){var e;return this.name()!=null&&((e=this.value())==="text"||e==="number"||e==="date"||e==="boolean"||e==="file"||e==="image"||e==="geographic_address")&&!this.is_list()};t.prototype.is_list=function(){return this.value().indexOf("list.")===0};t.prototype.exists=function(){return this.json.child("value").get()!=null};t.prototype.deleted=function(){return this.json.child("deleted").get()};t.prototype.name=function(){return this.json.name()};t.prototype.id=function(){return this.name()};t.prototype.parent=function(){return new j.CustomType(this.json.parent().parent())};t.prototype.set_deleted=function(e){var t;t=(new l).changes.Change("WriteCustomField",{custom_name:this.parent().name(),name:this.name(),path:"deleted",data:e});return t.execute()};t.prototype.set_display=function(e){var t;t=(new l).changes.Change("WriteCustomField",{custom_name:this.parent().name(),name:this.name(),path:"display",data:e});return t.execute()};t.prototype.set_default_val=function(e){var t;t=(new l).changes.Change("WriteCustomField",{custom_name:this.parent().name(),name:this.name(),path:"default_val",data:e});return t.execute()};t.prototype.find_in_editor=function(e,t){$(".tab.tabs-3").click();l().data_canvas.selection_boxes["Data Types"](this.parent());l().data_canvas.open_tab("Data Types");return typeof t==="function"?t():void 0};return t}(j.AppNode));j.add("PrivacyRole",c=function(e){G(t,e);function t(){U=t.__super__.constructor.apply(this,arguments);return U}t.prototype.display=function(){if(this.name()==="everyone"){return"everyone"}else{return this.json.child("display").get()}};t.prototype.name=function(){return this.json.name()};t.prototype.id=function(){return this.name()};t.prototype.parent=function(){var e;e=this.json.parent().parent();return this.app().custom_type(e.name())};t.prototype.condition=function(){return j.new_expression(this.json.child("condition"),this)};t.prototype.check_for_errors=function(e){var t,n;t=this.condition();if(!t.is_empty()){n=t.get_eval_value();if(!n.matches("sys.bool")){return e(this.display()+' privacy role - condition must evaluate to "yes" or "no", but this is a '+n.display(),t)}}};t.prototype.get_composer_context=function(){return{privacy_condition:true,node:{json:this.json,owner:this}}};t.prototype.set_display=function(e){var t,n,r;r=this.json.path()+".display";n=this.display();if(e!==n){t=(new l).changes.Change("ChangeAppSetting",{path:r,value:e,old_value:n});t.execute();return y.commit()}};t.prototype.set_condition=function(e){var t,n,r;r=this.json.path()+".condition";n=this.condition().raw();if(JSON.stringify(n)!==JSON.stringify(e)){t=(new l).changes.Change("ChangeAppSetting",{path:r,value:e,old_value:n});t.execute();return y.commit()}};t.prototype.get_injected_display=function(){return"This "+this.parent().display()};t.prototype.get_injected_value=function(){return this.parent().to_value()};t.prototype.can_search_for=function(){var e,t,n,r,i,o,a;t=this.condition();e=t.find_expressions("InjectedValue");if(t.is("InjectedValue")){e.push(t)}for(o=0,a=e.length;o<a;o++){n=e[o];if(typeof(r=n.next()).next==="function"?typeof(i=r.next()).message==="function"?i.message().is_lookup():void 0:void 0){return false}}return true};t.prototype.get_permissions=function(){var e;e=this.json.child("permissions").raw();if(e){if(e.auto_binding==null){e.auto_binding=false}}return e};t.prototype.set_permission=function(e,t){var n,r,i,o;i=this.json.path()+".permissions."+e;r=(o=this.get_permissions())!=null?o[e]:void 0;if(JSON.stringify(r)!==JSON.stringify(t)){n=(new l).changes.Change("ChangeAppSetting",{path:i,value:t,old_value:r});n.execute();return y.commit()}};t.prototype.find_in_editor=function(e,t){$(".tab.tabs-3").click();l().data_canvas.selection_boxes["Privacy"](this.parent());l().data_canvas.open_tab("Privacy");return R.wait_for_updates(t)};return t}(j.AppNode));v.show_privacy_warning=function(e,t,n){var r,i,o,a,s,u;if(!y.get_public_setting(e)){y.set_setting(true,e,true);o=[];u=y.custom_types();for(a=0,s=u.length;a<s;a++){i=u[a];o.push.apply(o,function(){var e,t,n,o;n=i.privacy_roles();o=[];for(e=0,t=n.length;e<t;e++){r=n[e];if(r.name()!=="everyone"){o.push(r)}}return o}())}if(!o.length){t();return}}return typeof n==="function"?n():void 0};j.add("Comment",a=function(e){G(t,e);function t(){F=t.__super__.constructor.apply(this,arguments);return F}t.prototype.name=function(){return this.json.name()};t.prototype.set=function(e,t,n){if(t===null||t===""){this.json.child("type").set(null);this.get_content_node().set(null);return this.json.child("parent").set(null)}else{this.json.child("type").set(e);this.get_content_node().set(t);return this.json.child("parent").set(n)}};t.prototype.get_content_node=function(){return this.json.child("content")};t.prototype.get=function(){return this.get_content_node().get()};t.prototype.get_type=function(){return this.json.child("type").get()};t.prototype.get_parent=function(){return this.json.child("parent").get()};t.prototype.id=function(){return this.name()};return t}(j.AppNode));C=function(e){if(e==="CustomDefinition"){return false}return l().load_plugin("Element:"+e,true)==null};j.RAW={Empty:function(){return{type:"Empty"}},TextExpression:function(e){if(e==null){e=null}return{type:"TextExpression",entries:e}},DataSource:function(e,t,n){if(t==null){t=null}if(n==null){n=null}return{type:e,properties:t,next:n}},Message:function(e,t,n,r){if(t==null){t=null}if(n==null){n=null}if(r==null){r=null}return{type:"Message",properties:t,name:e,next:r,args:n}},CustomType:function(e){var t;t={display:e.display,fields:e.fields,privacy_role:e.privacy_role,exposed_api:e.exposed_api};return t},CustomField:function(e){var t;t={display:e.display,value:e.value,deleted:e.deleted,"default":e["default"]};return t},Application:function(e,t,n){var r;if(e==null){e=null}if(t==null){t=null}if(n==null){n={}}r={pages:e,user_types:t};R.extend(r,n);return r},Page:function(e){if(!e.name){throw R.error("all pages must have names")}return j.RAW.Element("Page",e)},CustomDefinition:function(e){return j.RAW.Element("CustomDefinition",e)},Element:function(e,t){var n,r,i,o,a,s,u,l,c,f;if(t==null){t={}}n={properties:(a=t.properties)!=null?a:{},id:(s=t.id)!=null?s:R.LUID(),name:(u=t.name)!=null?u:null,elements:(l=t.elements)!=null?l:null,states:(c=t.states)!=null?c:null,workflows:(f=t.workflows)!=null?f:null,style:(o=t.style)!=null?o:null};for(r in t){i=t[r];if(i!=null&&!n[r]){throw R.error("sent an unrecognized parameter to lang.RAW.Element: "+r)}}if(C(e)){n.type="CustomElement";n.properties.custom_id=e}else{n.type=e}return n},State:function(e,t){if(e==null){e=null}if(t==null){t=null}return{type:"State",condition:e,properties:t}},Event:function(e,t){var n,r,i,o,a,s;if(t==null){t={}}n={type:e,properties:(o=t.properties)!=null?o:null,id:(a=t.id)!=null?a:R.LUID(),actions:(s=t.actions)!=null?s:null};for(r in t){i=t[r];if(i!=null&&!n[r]){throw R.error("sent an unrecognized parameter to lang.RAW.Event: "+r)}}return n},Action:function(e,t){var n,r,i,o,a;if(t==null){t={}}n={type:e,properties:(o=t.properties)!=null?o:null,id:(a=t.id)!=null?a:R.LUID()};for(r in t){i=t[r];if(i!=null&&!n[r]){throw R.error("sent an unrecognized parameter to lang.RAW.Action: "+r)}}return n},copy:function(e,t){var n,r,i;if(!t){throw R.error("must pass in a new id to copy")}i=j.deep_copy_with_new_ids(e),r=i[0],n=i[1];if(e.id&&e.id!==t){n[e.id]=n[r.id]=t}j.deep_replace(r,n);r.id=t;return{new_data:r,mapping:n}}};k=function(e,t){var n,r,i;if(typeof t==="object"){i=t.value;n=t.deleted;r=t.display}else{i=t;n=false;r=e}return{name:function(){return e},raw:function(){return true},value:function(){return i},exists:function(){return true},display:function(){return r},deleted:function(){return n}}};S=function(e,t,n){return{exists:function(){return true},name:function(){return e},field:function(e){return k(e,t[e])},fields:function(){var e,n,r;r=[];for(e in t){n=t[e];if(typeof n==="object"&&n.display!=null||typeof n!=="object"){r.push(k(e,n))}}return r},no_rename:true,display:function(){return e},privacy_roles:function(){var t,r,i;r=n!=null?n:{};i=[];for(e in r){t=r[e];i.push(M(e,t))}return i},privacy_role:function(e){if(n!=null?n[e]:void 0){return M(e,n[e])}}}};M=function(e,t){return{get_permissions:function(){return t.permissions},condition:function(){return{json:function(){return{raw:t.condition}}}}}};v.SPECIAL_TYPES=p=function(){var e,t,n,r,i,o,a,s,u;e={run_id:{value:"sys.uid"},charge_user_id:{value:"sys.uid"},status:{value:"sys.uid"}};u={plan_id:{value:"sys.uid",display:"Plan id"},done:{value:"boolean",display:"Subscription was successful"},coupon_id:{value:"sys.uid",display:"Coupon id"},quantity:{value:"number",display:"Quantity"},trial_end:{value:"date",display:"Trial End"},tax_percent:{value:"number",display:"Tax percent"},user_id:{value:"sys.uid"},subscribe_id:{value:"sys.uid"},stringified_properties:{value:"sys.uid"}};o={amount:{value:"number",display:"Amount Charged"},app_fee:{value:"number",display:"Application Fee"},currency:{value:"sys.uid",display:"Currency"},StripeChargeID:{value:"sys.uid",display:"Charge Id"},captured:{value:"boolean",display:"Captured"},description:{value:"text",display:"Order description"},charged_user_email:{value:"sys.uid",display:"Email of charged user"},charge_user_action_id:{value:"sys.uid"},charged_user_id:{value:"sys.uid"},charged_user:{value:"sys.uid"},payee_user:{value:"sys.uid"},authorize_only:{value:"boolean"}};n=S("Order",R.extend({},e,o));i=S("SubscriptionOrder",R.extend({},e,u));a={used:"boolean",user_id:"custom",token_text:"text"};s={everyone:{permissions:{}},no_one:{condition:false,permissions:{}}};r=S("password_reset",a,s);t=S("confirmation email entry",a);return[n,i,r,t]}();j.SPECIAL_ALL=f={"Modified Date":"date","Created Date":"date","Created By":"custom",recurring_scheduling:"json"};h={StripeCustomerID:"custom",stripeauthtoken:"not_indexed",email:"custom",user_signed_up:"boolean"};d={max_number_of_app:"long"};_={__salesforce_id:"custom",__last_event_description:"custom",__event_feed:"boolean"};v.get_special_fields=function(e,t){var n,r,i,o,a,s,u;i=[f];if(t){i.push(t)}if(e.name()==="user"){i.push(h);if(l().appname()==="meta"){i.push(d)}}if(I.is_installed("salesforce")){i.push(_)}o=[];for(s=0,u=i.length;s<u;s++){r=i[s];for(n in r){a=r[n];o.push(k(n,a))}}return o};o=["index","reset_pw","404"];N=function(e,t){if(e.toLowerCase()<t.toLowerCase()){return-1}else{return 1}};v.get_sorted_list_of_pages=function(){var e,t,n,r,i,a;e=(a=y.app().json.read_index("page_name_to_id"))!=null?a:{};t=function(){var t,n,i;i=[];for(t=0,n=o.length;t<n;t++){r=o[t];if(e[r]!=null){i.push(r)}}return i}();i=function(){var t;t=[];for(r in e){n=e[r];if(V.call(o,r)<0){t.push(r)}}return t}();i.sort(N);return t.concat(i)};v.get_sorted_list_of_custom_definitions=function(){var e,t,n,r,i;e=(i=y.app().json.read_index("custom_name_to_id"))!=null?i:{};r=function(){var r;r=[];for(n in e){t=e[n];if(t){r.push(t.name)}}return r}();r.sort(N);return r};v.page_name_to_id=function(e){return y.app().json.read_index("page_name_to_id",e)};v.page_id_to_name=function(e){var t,n,r;r=y.app().json.read_index("page_name_to_id");for(t in r){n=r[t];if(e===n){return t}}return null};v.custom_name_to_id=function(e){return y.app().json.read_index("custom_name_to_id",R.digest(e),"custom_id")};v.custom_id_to_name=function(e){var t,n,r,i,o;i=y.app().json.read_index("custom_name_to_id");for(r in i){o=i[r],t=o.custom_id,n=o.name;if(e===t){return n}}return null};A=e("./../db/db");E=e("./elements");e("./workflow");m=e("./../app_lib");l=e("./../lib");B=e("./../webfonts");D=e("./../locations");y=e("./appquery");P=e("./shrink");I=e("./../services");O=e("./plugins");x=e("./../core/core_elements");b=e("./apptests");w=e("./../client_config");if(R.on_server()){T=e;w=T("./../configuration")}}).call(this)},{"./../app_lib":4,"./../client_config":16,"./../core/core_elements":19,"./../db/db":28,"./../lib":65,"./../locations":66,"./../services":70,"./../u":72,"./../util":74,"./../webfonts":76,"./appquery":51,"./apptests":52,"./elements":55,"./lang":57,"./plugins":60,"./shrink":61,"./workflow":63}],51:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f=[].slice;s=e("./../u");i=n;s.safe_register("./lang/appquery",i);a=e("./lang");r=e("./application");i.make_run_app=function(e){return new a.ApplicationVersion(new a.RuntimeJSON(e))};i.app=function(e,n){return t().app(e,n)};c=a.ApplicationVersion.prototype;l=function(e,n){return i[e]=function(){var n,r;n=1<=arguments.length?f.call(arguments,0):[];r=t().app();return r[e].apply(r,n)}};for(o in c){u=c[o];l(o,u)}if(typeof window!=="undefined"&&window!==null){window.appquery=i}t=e("./../lib")}).call(this)},{"./../lib":65,"./../u":72,"./application":50,"./lang":57}],52:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l;s=e("./../u");r=e("./appquery");t=e("./application");a=e("./lang");i=n;i.check_issues=function(e,t){var n,i,o,a,u,c;i=[];a=Date.now();o=function(e){var n,r,a,s,u,l,c;if((e!=null?typeof e.exists==="function"?e.exists():void 0:void 0)&&e.check_for_errors){r=e.check_for_errors(function(t,n,r){if(r){return i.push({cross_page:r})}else{return i.push({message:t,node:(n!=null?n:e).serialize()})}},t);l=(u=r!=null?r.children:void 0)!=null?u:[];c=[];for(a=0,s=l.length;a<s;a++){n=l[a];c.push(o(n))}return c}};o(e);if(!l&&!s.running_test()){n=Date.now();if(n>a+5e3){s.warn("slow issue checker",{appname:r.appname(),path:e.path(),id:e.id(),root_id:typeof e.root==="function"?(u=e.root())!=null?u.id():void 0:void 0,root_name:typeof e.root==="function"?(c=e.root())!=null?typeof c.name==="function"?c.name():void 0:void 0:void 0,duration:n-a})}}return i};i.pretest_cross_pages=function(){var e,t,n,a,u,l;u=o();l=[];for(t=n=0,a=u.length;n<a;t=++n){e=u[t];if(e.cross_page){l.push(function(e,t){return s.run_once(10*60*1e3,function(){return i.check_issues(r.by_id(e.cross_page),true)},function(e){},true)}(e,t))}}return l};o=function(){var e,n,i,o,a,u,l,c,f,d,_,p;n=[];a=r.app().read_index("issues_list");u=r.app().read_index("issues_sub");o=function(e){var t,r,i,l,c,f,d,_,p;if(a!=null?a[e]:void 0){d=s.json_parse(a!=null?a[e]:void 0);for(i=0,c=d.length;i<c;i++){r=d[i];n.push(r)}}if(u!=null?u[e]:void 0){_=s.json_parse(u!=null?u[e]:void 0);p=[];for(l=0,f=_.length;l<f;l++){t=_[l];p.push(o(t))}return p}};_=t.get_sorted_list_of_pages();for(l=0,f=_.length;l<f;l++){i=_[l];o(t.page_name_to_id(i))}p=t.get_sorted_list_of_custom_definitions();for(c=0,d=p.length;c<d;c++){e=p[c];o(t.custom_name_to_id(e))}o("api");return n};l=false;u=false;i.get_all_issues=function(){var e,n,i,s,c,f,d,_,p,h,g,m,v,y;i=o();d=r.app().read_index("issues_list");if(!u){u=true;l=true;_=[];v=t.get_sorted_list_of_pages();for(p=0,g=v.length;p<g;p++){s=v[p];c=t.page_name_to_id(s);if((d!=null?d[c]:void 0)==null){_.push({type:"page",id:c})}}y=t.get_sorted_list_of_custom_definitions();for(h=0,m=y.length;h<m;h++){e=y[h];n=t.custom_name_to_id(e);if((d!=null?d[n]:void 0)==null){_.push({type:"custom_definition",id:n})}}f=function(e){var t;if(!e.length){if((d!=null?d.api:void 0)==null){r.api().run_indexers()}a.wait_for_stable(function(){return l=false});return}if((t=r.app().read_index("issues_list"))!=null?t[e[0].id]:void 0){return f(e.slice(1))}else{r[e[0].type](e[0].id).run_indexers(1e6);return setTimeout(function(){return a.wait_for_stable(function(){return f(e.slice(1))})},20*1e3)}};f(_)}return i};i.test_app=function(){var e,n,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D;m=[];u=o();g=r.app().read_index("issues_list");p=function(e){var t,n,o;if(e.cross_page){o=i.check_issues(r.by_id(e.cross_page),true),n=o[0],t=o[1];return m.push.apply(m,t)}else{return m.push(e)}};h=function(e){var t,n,r,o,a,s,u;s=e.elements().concat(e.events());u=[];for(o=0,a=s.length;o<a;o++){n=s[o];r=i.check_issues(n);u.push(function(){var e,n,i,o;i=r!=null?r:[];o=[];for(e=0,n=i.length;e<n;e++){t=i[e];o.push(p(t))}return o}())}return u};for(v=0,x=u.length;v<x;v++){l=u[v];p(l)}T=t.get_sorted_list_of_pages();for(y=0,k=T.length;y<k;y++){_=T[y];f=t.page_name_to_id(_);if((g!=null?g[f]:void 0)==null){c=r.element(f);c.json.pre_cache();d=i.check_issues(c);C=d!=null?d:[];for(b=0,S=C.length;b<S;b++){l=C[b];p(l)}h(c)}}j=t.get_sorted_list_of_custom_definitions();for(w=0,A=j.length;w<A;w++){s=j[w];n=t.custom_name_to_id(s);if((g!=null?g[n]:void 0)==null){e=r.custom_definition(n);e.json.pre_cache();a=i.check_issues(e);D=a!=null?a:[];for(M=0,E=D.length;M<E;M++){l=D[M];p(l)}h(e)}}return m}}).call(this)},{"./../u":72,"./application":50,"./appquery":51,"./lang":57}],53:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x=[].indexOf||function(e){
for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};p=n;w=e("./../u");g=false;p.custom_circle=d=w.autorun_cache(function(e){g=true;try{return _(e,{})}finally{g=false}});_=function(e,t){var n,r,i,o,a,s,u,l,c,f;if(!e){return false}t=w.extend({},t);t[e.property("custom_id").get_static()]=true;n=e.root();if(!(n!=null?n.is_custom_definition():void 0)){return false}r=n.id();if(t[r]){return true}t[r]=true;c=e.app().custom_definitions();for(a=0,u=c.length;a<u;a++){o=c[a];f=o.find_elements("CustomElement.custom_id="+r);for(s=0,l=f.length;s<l;s++){i=f[s];if(_(i,t)){return true}}}return false};u={missing:true,get_static_property:function(){},get_default:function(){},events:function(){return[]},property:function(e){return m.new_expression(m.EmptyJSON(c.app().json,null,"property on missing def"),this)},id:function(){return"missing"},container_names:function(){return[]},toUniqueString:function(){return"MissingDef"},get_style_if_exists:function(){},element_custom_states:function(){return[]},element_custom_state:function(){return null},add_specific_messages:function(){}};a=function(e){return{get_html:function(){return"<div>Deleted reusable element</div>"},initialize:function(){},get_messages:function(){return[]},get_states:function(){return[]},get_private_messages:function(){return[]},container_names:function(){return[]},is_visible_on_page_load:function(){return true},add_specific_messages:function(){}}};i={custom_circle:true,get_static_property:function(e){return this.property(e).get_static()},id:function(){return"customcircle"},property:function(e){switch(e){case"width":return m.new_expression(m.VirtualJSON(c.app().json,200),this);case"height":return m.new_expression(m.VirtualJSON(c.app().json,100),this);case"select_parent":return m.new_expression(m.VirtualJSON(c.app().json,null),this);default:return m.new_expression(m.EmptyJSON(c.app().json,null,"property on missing def"),this)}},events:function(){return[]},get_default:function(){},container_names:function(){return[]},toUniqueString:function(){return"CustomCircleDef"},get_style_if_exists:function(){},element_custom_states:function(){return[]},element_custom_state:function(){return null},add_specific_messages:function(){}};r={get_html:function(){return"<div>This is a circular Reusable Element... Reusable Elements cannot contain themselves (or other Reusable Elements that contain them).</div>"},initialize:function(){},get_messages:function(){return[]},get_states:function(){return[]},get_private_messages:function(){return[]},container_names:function(){return[]},is_visible_on_page_load:function(){return true},add_specific_messages:function(){},id:function(){return"custom circle"}};o=function(e){var t,n;if(!g&&d(e)){return i}t=e.property("custom_id").get_static();n=e.app().custom_definition(t);if(!(n!=null?n.exists():void 0)){return u}return n};t=function(e,t){var n,i;if(t==null){t=o(e)}if(t.missing){return a(e.property("custom_id").get_static())}if(t.custom_circle){return r}n=(i=t.property("element_type").get_static())!=null?i:"Group";return s().load_plugin("Element:"+n)};p.ON_ELEMENT=l=["is_visible","top","left","zindex","data_source","custom_id","greyout_color","greyout_blur","responsive_alignment","prevent_user_from_closing_through_esc","collapse_margin","fixed_width","min_width","use_max_width","max_width","responsive_show","responsive_show_width","width","height","floating_reference","floating_reference_horizontal"];v=function(e){var n,r,i,a,s,u,c,d;i=o(e);r=t(e,i);a=i.property("element_type").get_static();c=a!=="Popup";u=a==="FloatingGroup";s={data_source:{},edit_custom_definition:{only_edit_mode:true},min_width:{"default":30,no_states:true},fixed_width:{no_states:true,"default":false},responsive_alignment:{"default":"center",no_states:true},use_max_width:{no_states:true,"default":false},max_width:{"default":100,optional:true,no_states:true},collapse_margin:{"default":0,optional:true,no_states:true}};if(c){w.extend(s,(new b.PositionOnly).field_names,{use_max_width:{no_states:true,"default":false},max_width:{optional:true,no_states:true,"default":100},collapse_margin:{"default":375,optional:true,no_states:true}})}else{w.extend(s,f.greyout_field_names)}w.extend(s,f.visibility_field_names);if(u){w.extend(s,f.floating_field_names)}n={base_name:r.plugin_retrieved_name,property_transformer:function(e,t){return function(n){if(x.call(l,n)>=0){if(n==="height"||n==="width"){if(e.not_resizable()){return i.property(n)}else{return t(n)}}else{return t(n)}}if(h.style_properties[n]&&i.get_style_if_exists()){return i.get_style().property(n)}else{return i.property(n)}}},get_static_property_transformer:function(e,t){return function(n,r){var o;if(x.call(l,n)>=0){if(n==="height"||n==="width"){if(e.not_resizable()){return i.get_static_property(n,r)}else{return(o=t(n,r))!=null?o:i.get_static_property(n,r)}}else{return t(n,r)}}if(h.style_properties[n]&&i.get_style_if_exists()){return i.get_style().get_static_property(n,r)}else{return i.get_static_property(n,r)}}},eval_property_transformer:function(e,t){return function(e,n,r,o){if(x.call(l,e)>=0){return t(e,n,r,o)}if(h.style_properties[e]&&i.get_style_if_exists()){return i.get_style().eval_property(e,n,r,o)}else{return i.eval_property(e,n,r,o)}}},default_transformer:function(e,t){return function(e){if(x.call(l,e)>=0){return t(e)}if(h.style_properties[e]&&i.get_style_if_exists()){return i.get_style().get_default(e)}else{return i.get_default(e)}}},states_transformer:function(e){return function(){var e;return(e=typeof i.states==="function"?i.states():void 0)!=null?e:[]}},primary_field:function(e){},field_names:s,fields:function(e){var t,n,r,o;r=[];o=i.get_static_property("group_type");r.push({name:"data_source",caption:"Data source",editor:"Basic",value:o,optional:true,pretty:{short_caption:false,section:"GroupType"},condition:function(){return o!=null}});r.push(f.visibility_property);t=function(t){return r.push({name:"information",label_text:"Orginal element dimensions "+(i.get_width()+"x"+i.get_height())+" (click to apply)",editor:"Label",click_cb:function(){e.set_property("height",i.get_height());e.set_property("width",i.get_width());return e.commit()},pretty:{section:t}})};if(c){if(e.not_resizable()){r.push.apply(r,(new b.PositionOnly).get_properties())}else{r.push.apply(r,(new b.Dimensions).get_properties());t("Position")}}else{if(!e.not_resizable()){r.push.apply(r,(new b.ShortDimensions).get_properties());t("ShortPosition")}r.push.apply(r,f.get_greyout_properties())}if(u){r.push.apply(r,f.floating_group_fields())}r.push.apply(r,(new b.MinWidth).get_properties());r.push({name:"edit_custom_definition",button_caption:"Edit element",editor:"Button",optional:true,click_cb:function(){return w.run_once(30,function(){return i.name()},function(e,t){if(e){w.warn(e);return}if(t){window.change_to_custom(t);return true}})},pretty:{section:"ElementMetaActions",no_caption:true,width:"small"}});n=f.delete_element_property(e);n.pretty.width="small";r.push(n);r.push(f.select_parent_property(e));r.push(f.reveal_in_tree_property(e));r.push(f.lock_in_editor_property(e));return r},property_applications:i!=null?(d=i.E)!=null?d.property_applications:void 0:void 0,custom_states:function(){var e;return(e=typeof i.states==="function"?i.states():void 0)!=null?e:m.enhance_array([])},element_custom_states:function(){return i.element_custom_states()},element_custom_state:function(e){return i.element_custom_state(e)},get_default:function(){},transition:function(e){var t,n;t=i.transition(e);if(t){return t}n=i.get_style_if_exists();if(n){return n.transition(e)}},get_messages:function(e){return r.get_messages(e)},get_states:function(e){return r.get_states(e)},add_specific_messages:function(e,t){return r.add_specific_messages(e,t)},get_state_value:function(e,t){return r.get_state_value(e,t)},get_private_messages:function(e){return r.get_private_messages(e)},mandatory_sections:function(e){return["GroupType","Background"]},get_html:function(e){return r.get_html(e)},is_visible_on_page_load:function(e){return r.is_visible_on_page_load(e)},is_popup:function(e){return!c},not_max_adjustable:r.not_max_adjustable,property_supports_states:false,property_supports_transitions:false,can_copy_style:false,initialize:function(t){var n=this;t.split_namespace();t.add_to_namespace(t,i.id());if(t.run_mode()){w.WaitFor(t.can_register_workflows(),function(){return t.register_workflows(i.events())})}r.initialize(t);if(t.edit_mode()){return t.autorun(function(){var n,r,o,a,s,u,l,c,f,d,_,p,g,m,v;t.canvas.find(".sub-elements").remove();c=w.div("sub-elements");c.css("height","100%");t.canvas.append(c);m=i.container_names();for(d=0,p=m.length;d<p;d++){s=m[d];u=w.div("sub-element-container");c.append(u);n=t.container.create_child(t,u);v=i.get_container_elements(s);f=function(e){var r;r=h.ElementInstance(e,n,h.THUMBNAIL);r.draw();return t.on_destroy(function(){return r.destroy()})};for(_=0,g=v.length;_<g;_++){e=v[_];f(e)}}r=w.div("compound-cover",c);l=w.div("compound-outertable",c);o=w.div("compound-innertable",l);a=w.div("compound-cover-label",o);return a.text(t.element.get_name())})}},container_names:function(e){return r.container_names(e)},get_container_canvas:function(e,t){return r.get_container_canvas(e,t)},get_container_elements:function(e,t,n){if(n){return[]}if(g){return[]}else{return i.get_container_elements(t)}},goes_on_document:function(e){var t;return(t=typeof r.goes_on_document==="function"?r.goes_on_document(e):void 0)!=null?t:false},goes_on_document_for_drawing:function(e){var t;return(t=typeof r.goes_on_document_for_drawing==="function"?r.goes_on_document_for_drawing(e):void 0)!=null?t:this.goes_on_document(e)},no_edit_draw_children:function(){return true},is_visible_on_page_load:function(e){return r.is_visible_on_page_load(e)},not_resizable:function(e){var t;return!(((t=e.root())!=null?t.use_responsive_algorithm():void 0)&&(typeof i.use_responsive_algorithm==="function"?i.use_responsive_algorithm():void 0))},not_draggable:function(e){var t;return(t=typeof r.not_draggable==="function"?r.not_draggable(e):void 0)!=null?t:false},modal:function(e){return typeof r.modal==="function"?r.modal(e):void 0},get_definition_workflows:function(e){return i.events()},get_visible_workflows:function(e){return m.enhance_array(e.parents().events().concat(this.get_definition_workflows(e)))},get_related_workflows:function(e){return function(t){var n,r,o,a,s,u,l,c;r=[];l=e.parents().events();for(o=0,s=l.length;o<s;o++){n=l[o];if(n.element_id()===e.id()&&n.type()===t){r.push(n)}}c=i.events();for(a=0,u=c.length;a<u;a++){n=c[a];if(n.element_id()===i.id()&&n.type()===t){r.push(n)}}return m.enhance_array(r)}},custom_definition:function(){return i}};if(r.position_canvas){n.position_canvas=r.position_canvas}if(r.do_show){n.do_show=r.do_show}if(r.do_hide){n.do_hide=r.do_hide}if(r.notify_width){n.notify_width=r.notify_width}if(r.get_min_width&&i.use_responsive_algorithm()){n.get_min_width=r.get_min_width}return n};p.load_custom=function(e){if(g){return v(e)}else{return y(e)}};y=w.autorun_cache(v);p.load_custom_definition=w.autorun_cache(function(e){return f.transform_element("Custom Element",{field_names:w.extend({element_type:{"default":"Group",no_states:true},group_type:{no_states:true},delete_custom_definition:{no_states:true},new_responsive:{no_states:true},min_width:{no_states:true,"default":0,optional:true},use_max_width:{no_states:true},max_width:{no_states:true,"default":100,optional:true}},f.floating_field_names),_fields:function(e){var t,n,r;t=(r=s().visual_edit)!=null?r.get_root():void 0;n=[{name:"element_type",caption:"Type of element",editor:"Dropdown",set:s().sets.Object({Group:"Group",Popup:"Popup",FloatingGroup:"Floating Group"}),pretty:{section:"GroupType"}},{name:"group_type",caption:"Type of Content",editor:"Dropdown",optional:true,set:s().sets.DisplayableInListValues(true),pretty:{section:"GroupType"}}];if(e.get_static_property("element_type")==="FloatingGroup"){n.push.apply(n,f.floating_group_fields())}n.push.apply(n,[{name:"delete_custom_definition",button_caption:"Delete this reusable element",editor:"Button",optional:true,click_cb:function(){if(window.confirm("Delete reusable element "+t.get_name()+"?")){t["delete"]();return t.commit()}},pretty:{section:"ElementMetaActions",no_caption:true}},{name:"new_responsive",caption:"Enable new page rendering engine",editor:"Checkbox",condition:function(){return!c.get_public_setting("no_legacy_responsive")},pretty:{section:"ShortPosition"}},{name:"min_width",caption:"Minimum width (% of current width)",editor:"StaticNumber",integer:true,condition:function(e){return e!=null?e.use_responsive_algorithm():void 0},pretty:{section:"Position"}},{name:"use_max_width",caption:"Apply a max width when the page is stretched",editor:"Checkbox",condition:function(e){var t;return((t=e.root())!=null?t.use_responsive_algorithm():void 0)&&!e.get_static_property("fixed_width")&&e.max_width_adjustable()},pretty:{section:"Position"}},{name:"max_width",caption:"Maximum width (% of current width)",editor:"StaticNumber",integer:true,condition:function(e){var t;return((t=e.root())!=null?t.use_responsive_algorithm():void 0)&&!e.get_static_property("fixed_width")&&e.max_width_adjustable()&&e.get_static_property("use_max_width")},pretty:{section:"Position"}}]);return n},initialize:function(e){},property_applications:[new b.ShortDimensions,new b.Background,new b.Border,new b.BoxShadow],defaults:{bgcolor:"#FFFFFF",background_style:"bgcolor"},get_html:function(){return"<div></div>"},get_min_width:function(e){return 0},position_canvas:function(e,t){if(t.responsive_mode()){t.container.add(t);return}$(".canvas").append(e);return e.css({"margin-right":"auto","margin-left":"auto",position:"relative"})},always_visible:true,container_names:function(){return["elements"]},get_container_canvas:function(e,t){return e.get_canvas()},get_state_value:function(e,t){return f.state_value_helper_for_group(e,t)},is_input:false,is_container:true,change_cursor_style_if_clickable:false,add_an_invisible_div_on_the_top:false,not_draggable:function(){return true}})});b=e("./../core/property_applications");f=e("./../core/core_elements");m=e("./lang");s=e("./../lib");h=e("./elements");c=e("./appquery")}).call(this)},{"./../core/core_elements":19,"./../core/property_applications":24,"./../lib":65,"./../u":72,"./appquery":51,"./elements":55,"./lang":57}],54:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};y=e("./../u");f=n;f.get_basic_datasources=function(e,t){var n;if(t==null){t={}}n={current_user:function(){return i().current_user()},page_data:function(e,t){return f.get_page_data(e.name,t)},page_data_value:function(e){var t;return(t=f.get_page_data_type(e.name))!=null?t:" null"}};if(!(e!=null?typeof e.is_api==="function"?e.is_api():void 0:void 0)){y.extend(n,{current_page_item:function(){return i().pageparam.get()},current_page_item_value:function(){var t;return(t=e.get_static_property("page_item_type"))!=null?t:"null"}})}return y.extend(n,t)};f.page_width=y.Box(1200);f.page_current_scroll_position=y.Box(0);a=["Website Admin Email","Current Date/Time","CurrentLanguage","AppIsTest"];f.get_page_data_names=function(e){var t,n,r;if(e.is_api){return a}t=["Website Home","This Url","CurrentLanguage"];if(((n=e.element_node)!=null?(r=n.root())!=null?r.type():void 0:void 0)==="CustomDefinition"){t.push("Current Page Name")}t.push.apply(t,["Website Admin Email","Current Date/Time","Current Position","Current Page Width","Current Page Scrolling Position","Is Reset Password Token Valid","Page Loaded Above Fold","Page Loaded (Entire)","AppIsTest"]);return t};f.get_page_data=function(e,t){var n;if(t.is_api&&w.call(a,e)<0){throw y.error("calling a PageData datasource in API invalid: "+e)}switch(e){case"Website Home":return i().location.get_server_base();case"This Url":return i().location.my_location();case"Current Page Name":return i().location.get_page();case"CurrentLanguage":return i().app_language();case"AppIsTest":return i().app_version()==="test";case"Website Admin Email":return s.admin_email();case"Current Date/Time":if(t._current_date_time==null){t._current_date_time=new Date(y.timestamp())}return t._current_date_time;case"Current Position":if(t.frozen_state&&y.on_server()){return t.frozen_state.other_data["Current Position"]}return p.get_current_geographic_position();case"Current Page Width":return f.page_width();case"Current Page Scrolling Position":return f.page_current_scroll_position();case"Is Reset Password Token Valid":n=i().location.get_query().reset;if(n){return!i().db_instance().get(n).child("used").get()}break;case"Page Loaded Above Fold":if(y.on_server()){return true}return i().element.page_done_loading();case"Page Loaded (Entire)":if(y.on_server()){return true}return i().element.page_done_loading(true);default:throw y.error("unrecognized: "+e)}};f.get_page_data_ready_key=function(){return y.FakeKey()};f.get_page_data_type=function(e){switch(e){case"Current Date/Time":return"date";case"Current Position":return"geographic_address";case"Current Page Width":return"number";case"Current Page Scrolling Position":return"number";case"Page Loaded Above Fold":case"Page Loaded (Entire)":case"Is Reset Password Token Valid":case"AppIsTest":return"boolean";default:return"text"}};f.HYDRATE_STRING="1348695171700984260__LOOKUP__";f.MESSAGE_PREFIX="Message_";f.ELEMENT_INSTANCE_DEHYDRATE="ElementInstance";t="ElementParent";f.STATES={CurrentUser:function(){return"CurrentUser"},Message:function(e,t,n,r,i){var o,a,s;if(e==null){e=null}if(t==null){t=null}if(r==null){r={}}if(n==="count"){o=((a=i["%n"])!=null?a["%a"]:void 0)+"_"+((s=i["%n"])!=null?s["%nm"]:void 0)}if(n==="filtered"){return null}return f.MESSAGE_PREFIX+y.json_stringify(d.dehydrate_tree(e))+"_"+n+"_"+y.json_stringify(d.dehydrate_tree(t))+"_"+y.json_stringify(d.dehydrate_tree(r))+(o!=null?o:"")},CurrentPageItem:function(){return"CurrentPageItem"},CurrentWorkflowItem:function(){return null},PageData:function(e){return"PageData_"+e},APIEventParameter:function(e){return"APIEventParameter_"+e},ElementParent:function(){return t},CurrentCellsIndex:function(){return"CurrentCellsIndex"},ThisElement:function(){return"ThisElement"},PreviousStep:function(e){return"PreviousStep_"+e},Search:function(e,t,n){return"Search_"+d.turn_search_properties_into_a_json(e,t,n)},GetDataFromAPI:function(e){return"GetDataFromAPI_"+JSON.stringify(d.dehydrate_tree(e))}};g=function(e){return e.indexOf("PreviousStep_")===0};f.build_frozen_state_from_client_state=function(e,t){var n;n=new f.FrozenState(t);y.extend(n,e);return n};h=function(e){return e.is_element_expression()};f.ESTATE_PREFIX="ElementState:";f.NV_MARKER=o="not_valid_1431708660335x963720156345516400";f.NOT_VALID={};f.NOT_VALID[o]=true;f.INSTANCE_NOT_FOUND="NOT_FOUND";f.dehydrate_context=null;f.run_in_dehydrate_context=function(e,t){var n;try{n=f.dehydrate_context;f.dehydrate_context=e;return t()}finally{f.dehydrate_context=n}};f.FrozenState=r=function(){function e(e){this.context=e;if(this.context.frozen_state){throw y.error("this frozen state already has a context")}this.context.frozen_state=this;this.cache={};this.exists={};this.element_instances={};this.element_state={};this.other_data={}}e.prototype._save_element_instance=function(e,t,n){var r,i;if(n){return this.element_instances[t]=f.INSTANCE_NOT_FOUND}else{return(r=this.element_instances)[t]!=null?(r=this.element_instances)[t]:r[t]={dehydrated:d.dehydrate_tree(e),parent_element_id:d.dehydrate_tree((i=e.parent())!=null?i.element_id():void 0)}}};e.prototype.instance_id_not_found=function(e){return this.element_instances[e]===f.INSTANCE_NOT_FOUND};e.prototype.element_id_to_instance_id=function(e){var t;if(this.instance_id_not_found(e)){throw y.error("instance id not found -- should not hit this",{element_id:e})}t=this.element_instances[e];if(!t){throw y.error("could not find element id in frozen state",{element_id:e})}return t.dehydrated};e.prototype.element_id_to_parent_element_id=function(e){var t;if(this.instance_id_not_found(e)){throw y.error("instance id not found -- should not hit this",{element_id:e})}t=this.element_instances[e];if(!t){throw y.error("could not find element id in frozen state",{element_id:e})}return t.parent_element_id};e.prototype.shorten=function(e){e=String(e);if(e.length>50){return y.digest(e)}else{return e}};e.prototype.freeze_workflows=function(e,t){var n=this;return y.run_once(30,function(){y.ensure_ready(y.scheduled_key,false);return n._freeze_workflows(e)},t,true)};e.prototype._freeze_workflows=function(e,t){var n,r=this;if(t==null){t={}}n={};return f.run_in_dehydrate_context({instance:function(e){if(!n[e.toUniqueString()]){n[e.toUniqueString()]=true;return r._save_element_instance(e,e.element_id())}},save_to_state:function(e,t,n){var i,o,a;i=d.dehydrate_tree(e);if((o=r.element_state)[i]==null){o[i]={}}return(a=r.element_state[i])[t]!=null?(a=r.element_state[i])[t]:a[t]=d.dehydrate_tree(n!=null?n:null)}},function(){var n,o,a,u,l,f,_,p,h,g,m,v,b,w;for(v=0,b=e.length;v<b;v++){o=e[v];u=o;while(u){r._freeze(u);if((w=u.type())==="TriggerCustomEvent"||w==="TriggerCustomEventFromReusable"){n=s.event(u.get_static_property("custom_event"));if(n.exists()){if(t[n.id()]!=null){if(t[n.id()]!=="REPORTED"){t[n.id()]="REPORTED";(function(e){return i().show_error_to_user({event:e,error:{message:"This custom event is triggering a custom event that triggers itself (directly or indirectly)"},type:"workflow"})})(n)}}else{l=r.context.datasources["current_workflow_item_value"];r.context.datasources["current_workflow_item_value"]=function(){return n.get_static_property("custom_event_data_type")};if(u.type()==="TriggerCustomEventFromReusable"){f=r.context.element;r.context.element=r.context.element.find_instance_by_id(u.get_static_property("element_id"))}p={};p[n.id()]="SEEN";r._freeze_workflows([n],y.extend({},t,p));r.context.datasources["current_workflow_item_value"]=l;if(u.type()==="TriggerCustomEventFromReusable"){r.context.element=f}}}}u=u.next()}}_=c.get_runtime_parent(r.context);if(_){a=d.dehydrate_tree(_);r._save_element_instance(_,_.element_id());if((h=r.element_state)[a]==null){h[a]={}}if((g=r.element_state[a])["group_data"]==null){g["group_data"]=d.dehydrate_tree(_.state("group_data"))}if((m=r.element_state[a])["cell_index"]==null){m["cell_index"]=_.state("cell_index")}}return r._save_element_instance(r.context.element,r.context.element.element_id())})};e.prototype.has_invalid_state=function(){var e,t,n,r,i;i=this.element_state;for(e in i){n=i[e];for(t in n){r=n[t];if(r!=null?r[o]:void 0){return true}}}return false};e.prototype.retrieve_element_state=function(e,t){var n,r,a;n=d.dehydrate_tree(e);r=(a=this.element_state[n])!=null?a[t]:void 0;if(r!=null?r[o]:void 0){throw y.error("not valid input data made it to server")}if(r!==void 0){return d.rehydrate_tree(i().db_instance(),r)}else{throw y.error("trying to retrieve missing element state",{instance_id:n,state:t})}};e.prototype._freeze=function(e){var t,n,r,o,a,s,l,c,_,p,h,g,m=this;if(!e.is_action()){if(i().workflow.uses_server(e)){if((c=this.context)._temp_db_instance==null){c._temp_db_instance=u.new_instance()}t=i().current_user();if(t){t=this.context._temp_db_instance.get(t._id())}i.extend({db_instance:this.context._temp_db_instance,current_user:t},function(){return e.check_condition(m.context)})}else{e.check_condition(this.context)}}s=e.element_id();if(s!=null){l=this.context.element.find_instance_by_id(s);if(l){this._save_element_instance(l,s)}else{this._save_element_instance(null,s,true)}}a=function(e,t){var n,r,i,o,a,s,u;r=m.context.element.find_instance_by_id(e);if(!r){return m._save_element_instance(null,e,true)}else{i=d.dehydrate_tree(r);m._save_element_instance(r,e);s=t.next();a=s!=null?typeof s.name==="function"?s.name():void 0:void 0;if(a){if((u=m.element_state)[i]==null){u[i]={}}o=b.get("element."+e).get_message(a);n={state:function(e){var t;t=r.state(e);m.element_state[i][e]=d.dehydrate_tree(t!=null?t:null);return t},is_visible:function(){var e;e=r.is_visible();m.element_state[i]["is_visible"]=d.dehydrate_tree(e!=null?e:null);return e},evaluate_property:function(e){return r.evaluate_property(e)},toUniqueString:function(){return r.toUniqueString()},element:r.element,element_id:function(){return r.element_id()},find_instance_by_id:function(e){return r.find_instance_by_id(e)},is_fake_instance:true};return o.fn(n,null,null,null,{inputs_must_be_valid:true})}}};n=e.find_my_expressions("GetElement");for(_=0,h=n.length;_<h;_++){o=n[_];r=o.element_id();a(r,o)}n=e.find_my_expressions("ThisElement");for(p=0,g=n.length;p<g;p++){o=n[p];r=o.context_element().id();a(r,o)}if(!this.other_data["Current Position"]&&e.find_my_expressions("PageData.\name=Current Position").length>0){return this.other_data["Current Position"]=f.get_page_data("Current Position",this.context)}};e.prototype.clone=function(t){var n,r,i,a,s,u,l,c,f,d;n=new e(t);f=["cache","exists","element_instances","element_state","other_data"];for(l=0,c=f.length;l<c;l++){i=f[l];n[i]=y.json_deep_copy(this[i])}d=n.element_state;for(r in d){s=d[r];for(a in s){u=s[a];if(u!=null?u[o]:void 0){delete s[a]}}}return n};e.prototype.get_client_state=function(){return{element_instances:this.element_instances,element_state:this.element_state,other_data:this.other_data,cache:this.cache,exists:this.exists}};e.prototype.update_from_action=function(e,t,n,r){var i,o,a,s,u,l,c,_=this;i={};if(t){l=[{k:f.STATES.PreviousStep(e.id()),v:t},{k:f.STATES.PreviousStep(e.id())+"_value",v:e.return_value().id()}];for(s=0,u=l.length;s<u;s++){c=l[s],o=c.k,a=c.v;this.set(o,a);i[o]={v:a}}}return n.then(function(t){var n,o,a,s,u,l,c,p;y.optional_pause();u=e.get_data_to_refresh(t,r);y.optional_pause();c=u!=null?u:{};for(o in c){l=c[o];y.optional_pause();if(l!=null){_.set(o,l);i[o]={v:l}}else{_.clear(o);i[o]={x:true}}if(y.on_server()&&o.indexOf(f.ESTATE_PREFIX)===0){n=o.replace(f.ESTATE_PREFIX,"");for(s in l){a=l[s];y.optional_pause();if(a!=null){if((p=_.element_state[n])!=null){p[s]=d.dehydrate_tree(a)}}}}}return i})};e.prototype.get=function(e){var t;e=this.shorten(e);t=this.exists[e]?this.cache[e]:void 0;return d.rehydrate_tree(i().db_instance(),t)};e.prototype.set=function(e,t){var n;if(t==null){t=null}if(((n=y.CurrentNotReadyCatcher)!=null?n.length:void 0)>0){return}e=this.shorten(e);this.cache[e]=d.dehydrate_tree(t);return this.exists[e]=true};e.prototype.clear=function(e){e=this.shorten(e);delete this.cache[e];return delete this.exists[e]};e.prototype.has_key=function(e){e=this.shorten(e);return this.exists[e]};e.prototype.serialize=function(){return{cache:this.cache,exists:this.exists,element_instances:this.element_instances,element_state:this.element_state,other_data:this.other_data}};return e}();f.deserialize_frozen_state=function(e,t){var n;n=new r(e);y.extend(n,t);return n};s=e("./appquery");i=e("./../lib");d=e("./../db/db");u=e("./../db/client_db");_=e("events");m=e("./../locations");l=e("./../client_config");b=e("./values");c=e("./../core/core_expressions");p=e("./../geolocation");f.uid_cookie_name=function(e,t,n){var r,i,o,a;r=(i=(o=(a=l.cookie_name_prefix)!=null?a:l.environment_name)!=null?o:l.env)!=null?i:"";return e+"_u1"+(t!==m.DEFAULT_VERSION?"_"+t:"")+r+(n?"_"+n:"")};f.sid_cookie_name=function(e,t,n){var r,i,o,a;r=(i=(o=(a=l.cookie_name_prefix)!=null?a:l.environment_name)!=null?o:l.env)!=null?i:"";return e+"_"+t+"_u2"+r+(n?"_"+n:"")};f.firebase_cookie_name=function(e,t){return e+"-"+t}}).call(this)},{"./../client_config":16,"./../core/core_expressions":21,"./../db/client_db":27,"./../db/db":28,"./../geolocation":41,"./../lib":65,"./../locations":66,"./../tests/testing":71,"./../u":72,"./appquery":51,"./values":62,events:276}],55:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,K,J,X,Z,Q,ee,te,ne=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1},re=[].slice,ie={}.hasOwnProperty,oe=function(e,t){for(var n in t){if(ie.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};E=n;G=e("./../u");I=e("./lang");S=e("./../db/db");E.style_properties={};E.ElementInstance=function(e,t,n){return new o(e,t,n)};E.STATE_NOT_READY={};u={};E.RUN="run";E.EDIT="edit";E.THUMBNAIL="thumbnail";E.RESPONSIVE="responsive";g=[E.RUN,E.EDIT,E.THUMBNAIL,E.RESPONSIVE];te=E._use_issue_checker=function(){var e,t;return(e=(t=s().visual_edit)!=null?t.issue_checker_on:void 0)!=null?e:true};j=function(){var e;e={};return function(t){var n;if(e[t]==null){e[t]=0;return t}n=t+"_"+String(e[t]);e[t]++;return n}}();o=function(){function e(e,t,n){var r;this.element=e;this.container=t;this.mode=n;if(r=this.mode,ne.call(g,r)<0){throw G.error("unrecognized: "+this.mode)}this._thumbnail_mode=this.mode===E.THUMBNAIL;this._edit_mode=this.mode===E.EDIT;this._run_mode=this.mode===E.RUN;this._responsive_mode=this.mode===E.RESPONSIVE;this.__to_string="ElementInstance:"+this.element.type();this._destroy_fns=[];this._watchers={};this._msg_handlers={};this._states={};this._has_been_hidden=false;this._is_visible_me=e.is_visible_on_page_load();this._is_visible=null;this._is_visible_cbs=[];this._is_visible_dependency=G.Dependency()}e.prototype._update_visible=function(){var e,t,n,r,i,o,a,s;t=true;if(!this.container){t=false}else if(!this._is_visible_me){t=false}else{n=this.parent();if(n&&(!n._is_visible||n._setting_visible)){if(this.element.added_to_container()||this.element.type()==="GroupItem"){t=false}}}if(t!==this._is_visible){this._is_visible=t;this._setting_visible=true;r=this._is_visible_cbs;this._is_visible_cbs=[];G.autorun_top(function(){var e,t,n,i;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e())}return i});this._setting_visible=false;s=(a=this.children)!=null?a:[];for(i=0,o=s.length;i<o;i++){e=s[i];e._update_visible()}return this._is_visible_dependency.invalidate()}};e.prototype.is_visible=function(e){this._update_visible();if(!e){this._is_visible_dependency.register()}return this._is_visible};e.prototype.wait_for_visible_lite=function(e,t){if(this.is_destroyed()){return}if(this.thumbnail_mode()&&!t){e();return}if(this.is_visible(true)){return e()}else{return this._is_visible_cbs.push(e)}};e.prototype.notify_width=function(e){var t;this._dimension_box("width",e);return typeof(t=this.element.E).notify_width==="function"?t.notify_width(this,e):void 0};e.prototype.wait_for_visible=function(e){var t,n=this;if(this.is_destroyed()){return}if(this.is_visible(true)){t=function(){if(n.is_destroyed()){return}if(n.canvas.is(":visible")){return e()}else{return setTimeout(t,150)}};return t()}else{return this.wait_for_visible_lite(this.wait_for_visible.bind(this,e),true)}};e.prototype.destroy=function(){var e,t,n,r,i,o,a,s,u,l;if(this._destroy_started){return}this._destroy_started=true;if((a=this.canvas)!=null?a[0].bubble_data:void 0){delete this.canvas[0].bubble_data}u=(s=this.children)!=null?s:[];for(n=0,i=u.length;n<i;n++){e=u[n];e.destroy()}l=this._destroy_fns;for(r=0,o=l.length;r<o;r++){t=l[r];t()}this._destroy_fns=void 0;this.canvas.trigger("destroy.dot");this.canvas="destroyed";this._msg_handlers=void 0;this._watchers=void 0;this.children=void 0;return this._is_visible_cbs=[]};e.prototype.is_destroyed=function(){return this.canvas==="destroyed"};e.prototype.destroy_started=function(){return this._destroy_started};e.prototype.on_destroy=function(e){if(this.is_destroyed()){return e()}else{return this._destroy_fns.push(e)}};e.prototype.get_canvas=function(){return this.canvas};e.prototype.get_container_canvas=function(e){return this.element.E.get_container_canvas(this,e)};e.prototype.toString=function(){return this.__to_string};e.prototype.element_id=function(){return this.element.id()};e.prototype.parent=function(){var e;return(e=this.container)!=null?e.get_owner():void 0};e.prototype.split_namespace=function(){this._id_namespace={};return this._id_namespace[this.element_id()]=this;
};e.prototype.get_children_drawn_key=function(){if(this._our_children_drawn==null){this._our_children_drawn=G.MakeKey(null,"_our_children_drawn")}return this._our_children_drawn};e.prototype.get_namespace=function(){var e,t;return(e=this._id_namespace)!=null?e:(t=this.parent())!=null?t.get_namespace():void 0};e.prototype.add_to_namespace=function(e,t){var n;if(t==null){t=e.element_id()}n=this.get_namespace();return n[t]=e};e.prototype.child_namespace_prefix=function(){var e;e=this.parent();if(!e){return""}if(this._id_namespace){return this.toUniqueString()+":"}return e.child_namespace_prefix()};e.prototype.toUniqueString=function(){var e,t;return((e=(t=this.parent())!=null?t.child_namespace_prefix():void 0)!=null?e:"")+this.element_id()};e.prototype.dehydrate=function(){var e;if((e=k.dehydrate_context)!=null){if(typeof e.instance==="function"){e.instance(this)}}return S.dehydrate_prefix(k.ELEMENT_INSTANCE_DEHYDRATE)+this.toUniqueString()};e.prototype.find_instance_by_id=function(e){var t,n,r,i;if(e==null){return null}t=this.get_namespace();if(t==null){return null}if(t[e]){return t[e]}i=this.parent();r=i!=null?i.find_instance_by_id(e):void 0;if(r){return r}if(i){G.ensure_ready(i.get_children_drawn_key())}if(G.string_contains(e,"_group_item_")){i=m.element(e.split("_group_item_")[0])}else{i=m.element(e).parent()}if(i){n=this.find_instance_by_id(i.id());if(n){G.ensure_ready(n.get_children_drawn_key())}}return null};e.prototype.get_visible_instances=function(){var e,t,n,r,i,o,a,s,u,l;n={};r=this.get_namespace();for(e in r){t=r[e];n[e]=t}i=this.parent();l=(u=i!=null?i.get_visible_instances():void 0)!=null?u:[];for(o=0,a=l.length;o<a;o++){t=l[o];if(n[s=t.element_id()]==null){n[s]=t}}return function(){var r;r=[];for(e in n){t=n[e];r.push(t)}return r}()};e.prototype.get_static_property=function(e,t){var n,r,i;if(E.style_properties[e]){n=this.element.get_style_if_exists();if(n){if((i=this.element.field_names()[e])!=null?i.if_no_style_use_element:void 0){r=n.property(e).raw();if(r==null){return this.element.get_static_property(e,t)}else{return r}}else{return n.get_static_property(e,t)}}}return this.element.get_static_property(e,t)};e.prototype.get_property_watcher=function(e){var t;if((t=this._watchers)[e]==null){t[e]=this._create_property_watcher(e)}return this._watchers[e]};e.prototype._dimension_box=function(e,t){var n;n="__dimension_box_"+e;if(this[n]==null){this[n]=G.Box(t!=null?t:this.element["get_"+e]())}return this[n](t)};e.prototype.evaluate_property=function(e){var t,n,r,i,o,a,s,l,c;if(this.is_destroyed()){return null}if(e==="height"||e==="width"){if(!this.edit_mode()&&((a=this.element.root())!=null?a.use_responsive_algorithm():void 0)){return this._dimension_box(e)}}if(this.run_mode()){n=this.element.get_precomputed();if(n[e]===void 0){n[e]=(s=this.get_static_property(e,true))!=null?s:null}if(n[e]!==u){return n[e]}}if((o=this._watchers)[e]==null){o[e]=this._create_property_watcher(e)}l=this._watchers[e].get_current(true),r=l[0],i=l[1],t=l[2];if(t){return void 0}if(!G.CurrentAutoRun&&!G.CurrentNotReadyCatcher&&!((c=G.Fiber)!=null?c.current:void 0)){G.warn("Calling evaluate_property("+e+") outside of an autorun or watcher")}if(!r){if(G.CurrentNotReadyCatcher){if(i.is_turned()){return this._watchers[e].get()}else{G.throw_not_ready(i)}}return void 0}return i};e.prototype.on_property_change=function(e,t){var n,r,i,o,a,s,l,c,f,d,_,p,h,g,m,v,y,b=this;o=function(e){var n,r;if(b.element.exists()&&!b.is_destroyed()){try{return t(e)}catch(i){n=i;r=G.not_ready_key(n);if(!r){throw n}else{return G.WaitFor(r,function(){return o(e)})}}}};if(typeof e==="string"){if(this.run_mode()){a=this.element.get_precomputed();if(a[e]===void 0){a[e]=(v=this.get_static_property(e,true))!=null?v:null}if(a[e]!==u){o(a[e]);return}}l=(f=this._watchers)[e]!=null?(f=this._watchers)[e]:f[e]=this._create_property_watcher(e);l.on_value(o);return}s={};c={};if(this.run_mode()){a=this.element.get_precomputed();r=false;for(p=0,g=e.length;p<g;p++){i=e[p];if(a[i]===void 0){a[i]=(y=this.get_static_property(i,true))!=null?y:null}if(a[i]!==u){s[i]=a[i]}else{r=true;c[i]=(d=this._watchers)[i]!=null?(d=this._watchers)[i]:d[i]=this._create_property_watcher(i)}}if(!r){o(s);return}}else{for(h=0,m=e.length;h<m;h++){i=e[h];c[i]=(_=this._watchers)[i]!=null?(_=this._watchers)[i]:_[i]=this._create_property_watcher(i)}}n=G.Watcher(function(){var e,t,n;e={};for(t in c){l=c[t];e[t]=l.get()}for(t in s){n=s[t];e[t]=n}return e});n.on_value(o);return this.on_destroy(function(){return n.destroy()})};e.prototype.prop_eval_context=function(){if(!this._p_context){this._p_context={element:this,datasources:k.get_basic_datasources(this.element.root())};setTimeout(function(){return this._p_context=null},10*1e3)}return this._p_context};e.prototype.is_state_on=function(e){var t,n,r,i,o,a=this;n="state:"+e.toUniqueString();if((i=this._watchers)[n]==null){i[n]=G.Watcher(function(){return e.eval_condition(a.prop_eval_context(),null)})}o=this._watchers[n].get_current(),t=o[0],r=o[1];if(!t){return false}return r};e.prototype._create_property_watcher=function(e){var t,n;t=this.element.property_watcher_fn(e);if(typeof t!=="function"){return G.FakeWatcher(t)}n=G.Watcher(t.bind(void 0,this));if(!s().is_edit_mode()){n.on_error(this.on_run_eval_error.bind(this,e))}this.on_destroy(n.destroy.bind(n));return n};e.prototype.on_run_eval_error=function(e,t){return s().show_error_to_user({instance:this,prop_name:e,error:t,type:"element"})};e.prototype.autorun=function(e){var t,n=this;t=G.autorun(this._run_if_not_destroying.bind(this,e));return this.on_destroy(function(){return t.destroy()})};e.prototype._run_if_not_destroying=function(e){if(!this._destroy_started){return e()}};e.prototype.message=function(){var e,t,n=this;t=arguments[0],e=2<=arguments.length?re.call(arguments,1):[];if(!this.supports_message(t)){G.warn("Element "+this.element.type()+" does not support message "+t)}return G.autorun_top(function(){var r,i,o,a,s,u;i=(s=n._msg_handlers[t])!=null?s:[];u=[];for(o=0,a=i.length;o<a;o++){r=i[o];u.push(r.apply(null,e))}return u})};e.prototype.supports_message=function(e){var t,n;return ne.call(this.element.get_messages(),e)>=0||ne.call((n=typeof(t=this.element.E).get_private_messages==="function"?t.get_private_messages(this.element):void 0)!=null?n:[],e)>=0};e.prototype.get_messages=function(){return this.element.get_messages()};e.prototype.on_message=function(e,t){var n;if((n=this._msg_handlers)[e]==null){n[e]=[]}return this._msg_handlers[e].push(t)};e.prototype.state=function(e,t,n){var r,i;if((i=this._states)[e]==null){i[e]=G.Box()}if(t===E.STATE_NOT_READY){r=this._states[e](null,true)}else{r=this._states[e](t)}if(typeof r==="function"&&!n){r=r()}return r};e.prototype.responsive_mode=function(){return this._responsive_mode};e.prototype.thumbnail_mode=function(){return this._thumbnail_mode};e.prototype.edit_mode=function(){return this._edit_mode};e.prototype.run_mode=function(){return this._run_mode};e.prototype.draw=function(){var e,t,n,r=this;e=this.element.E;this.canvas=this.container.render(this.get_html());this.canvas.addClass(this.element.type());if(y.run_mode_ids&&this.run_mode()){this.canvas.attr("id",j(this.element_id()))}if((n=this.parent())!=null){n.add_to_namespace(this)}if(typeof e.position_canvas==="function"&&!this.thumbnail_mode()){this.position_canvas()}else{this.container.add(this)}this.initialize();if(this.element.E.draw_children){this.element.E.draw_children(this)}else{this.draw_children()}this.canvas[0].bubble_data={bubble_instance:this};t=s().workflow["debugger"];if(t!=null){if(!G.is_on_mobile_or_tablet()){this.canvas.on("mouseenter.debugger",function(){return t.element_hovered(r)});this.on_destroy(function(){return r.canvas.off("mouseenter.debugger")})}this.canvas.on("click.debugger",function(e){if(t.element_clicked(r,r.get_partial())){return e.stopPropagation()}});return this.on_destroy(function(){return r.canvas.off("click.debugger")})}};e.prototype.get_partial=function(){return M.make_partial_expression_evaluator(this.prop_eval_context())};e.prototype.set_height=function(e){if(this.destroy_started()){return}this._dimension_box("height",e);return this.container.set_height(this,e)};e.prototype.position_canvas=function(e){return this.element.E.position_canvas(e!=null?e:this.canvas,this)};e.prototype.on_resize=function(e){var t,n,r=this;if((n=this.element.root())!=null?n.use_responsive_algorithm():void 0){if(this.run_mode()){t="resize."+this.element.type()+"-"+this.toUniqueString();$(window).on(t,function(){if($(window).width()!==r._old_width){r._old_width=$(window).width();return e(r._old_width)}});return this.on_destroy(function(){return $(window).off(t)})}else if(this.responsive_mode()){this.container.on("resize_width",e);return this.on_destroy(function(){return r.container.removeListener("resize_width",e)})}}};e.prototype.initialize=function(){var e=this;if(this._initialized){throw G.error("can only call initialize once")}this._initialized=true;return G.autorun_top(function(){return e.element.E.initialize(e)})};e.prototype.is_initialized=function(){return this._initialized};e.prototype.get_html=function(){return this.element.E.get_html(this)};e.prototype.draw_children=function(){var e,t,n,r,i,o,a,s,u,l,c,f;e=this.element.E;this.children=[];c=this.element.container_names();for(a=0,u=c.length;a<u;a++){o=c[a];n=this.get_container_canvas(o);t=this.container.create_child(this,n);if(typeof e.initialize_container_width==="function"){e.initialize_container_width(this,t)}f=this.element.get_container_elements(o);for(s=0,l=f.length;s<l;s++){r=f[s];if(!this.thumbnail_mode()||r.is_visible_on_page_load()){G.count("draw children element created: "+this.element.type());i=E.ElementInstance(r,t,this.mode);this.children.push(i);i.draw()}}t.initialize();this.child_container=t}return this.get_children_drawn_key().turn()};e.prototype.workflow_show=function(){if(this.element.E.workflow_show){return this.element.E.workflow_show(this)}else{return this.do_show()}};e.prototype.workflow_hide=function(){if(this.element.E.workflow_hide){return this.element.E.workflow_hide(this)}else{return this.do_hide()}};e.prototype.do_show=function(){var e;e=this.element.E.do_show;if(e){e(this)}else{if(this._has_been_hidden){this._has_been_hidden=false;this.get_canvas()[0].style.display="block"}}this._is_visible_me=true;return this._update_visible()};e.prototype.do_hide=function(){var e;e=this.element.E.do_hide;if(e){e(this)}else{if(!this._has_been_hidden){this._has_been_hidden=true;this.get_canvas()[0].style.display="none"}}this._is_visible_me=false;return this._update_visible()};e.prototype.register_workflows=function(e){var t,n,r,i,o;o=[];for(r=0,i=e.length;r<i;r++){n=e[r];t=n.register(this);o.push(this.on_destroy(t))}return o};e.prototype.can_register_workflows=function(){var e,t;return(t=typeof(e=this.element.E).can_register_workflows==="function"?e.can_register_workflows(this):void 0)!=null?t:this.parent().can_register_workflows()};e.prototype.get_transition_css=function(e){var t,n,r,i,o,a,s,u,l,c,f,d;t="";l=this.element.field_names();for(r in l){s=l[r];if(!((c=this.element.E.transition_properties)!=null?c[r]:void 0)){continue}o=this.element.transition(r);if(o!=null?o.exists():void 0){n=(f=this.element.E.transition_properties)!=null?f[o.prop_name()]:void 0;t+=n+" "+o.duration()+"ms "+o.fn()+", "}}if(t){i=this.get_canvas();a=i.prop("outerHTML");if(e[a]==null){e[a]={}}if((u=e[a]).target==null){u.target=i}return e[a].css_prop=((d=e[a].css_prop)!=null?d:"")+t}};e.prototype.show_borders=function(){var e;return typeof(e=this.element.E).show_borders==="function"?e.show_borders(this):void 0};e.prototype.hide_borders=function(){var e;return typeof(e=this.element.E).hide_borders==="function"?e.hide_borders(this):void 0};return e}();S.ElementInstance=o;o.rehydrate=function(e,t){var n,r,i,o,a;i=t.split(":");n=s().element.get_page();for(o=0,a=i.length;o<a;o++){r=i[o];n=n!=null?n.find_instance_by_id(r):void 0}return n};if(typeof window!=="undefined"&&window!==null){window.ElementInstance_rehydrate=o.rehydrate}I.new_element=function(e){return e.smart_cache("element",R)};R=function(e,t){var n;n=e.child("type").get();if(n==="Page"){return new I.Page(e)}else if(n==="CustomDefinition"){return new I.CustomDefinition(e)}else{return new I.Element(e,t)}};C={};P={get_html:function(){return"<div>missing element</div>"},fields:function(){return[]},field_names:function(){return{}},is_visible_on_page_load:function(){return true},initialize:function(){}};T=function(e,t){var n,r,i,o,a;i=[];if(e==null){return i}t=I.make_filter(t);r=I.raw_children(e,f.elements);for(o=0,a=r.length;o<a;o++){n=r[o];if(t(n)){i.push(n)}i.push.apply(i,T(n,t))}return i};A=function(e,t){var n,r,i,o,a,s,u,l,c,d,_,p,h,g,m,v,y;o=[];if(e==null){return o}t=I.make_filter(t);g=I.raw_properties(e,I.new_element);for(s=0,d=g.length;s<d;s++){i=g[s];if(t(i)){o.push(i)}o.push.apply(o,I.expression_find_expressions(i,t))}m=I.raw_children(e,f.states);for(u=0,_=m.length;u<_;u++){a=m[u];o.push.apply(o,W(a,t))}v=I.raw_children(e,f.workflows);for(l=0,p=v.length;l<p;l++){r=v[l];o.push.apply(o,I.event_find_expressions(r,t))}y=T(e);for(c=0,h=y.length;c<h;c++){n=y[c];o.push.apply(o,A(n,t))}return o};W=function(e,t){var n,r,i,o,a,s,u;o=[];if(e==null){return o}t=I.make_filter(t);r=function(e){if(t(e)){o.push(e)}return o.push.apply(o,I.expression_find_expressions(e,t))};n=I.raw_child(e,f.condition,e);if(n){I.set_owner(n,e,z);r(n)}u=I.raw_properties(e,z);for(a=0,s=u.length;a<s;a++){i=u[a];r(i)}return o};N=[{name:"ChangeMultiElements",show_title:false},{name:"Text",show_title:false},{name:"PageTitle",show_title:false},{name:"Image",show_title:false},{name:"InputContent",show_title:false},{name:"PluginElement",show_title:false},{name:"CheckboxContent",show_title:false},{name:"FileInputContent",show_title:false},{name:"SliderContent",show_title:false},{name:"DropdownContent",show_title:false},{name:"DateInputContent",show_title:false},{name:"CalendarContent",show_title:false},{name:"CalendarFormat",show_title:false},{name:"MapContent",show_title:false},{name:"MapFormat",show_title:false},{name:"CarouselContent",show_title:false},{name:"CarouselFormat",show_title:false},{name:"ChartContent",show_title:false},{name:"ChartFormat",show_title:false},{name:"LinkBehavior",show_title:false},{name:"VideoBehavior",show_title:false},{name:"HTML",show_title:false},{name:"IconStyle",show_title:false},{name:"FloatingReference",show_title:false},{name:"GroupType",show_title:false},{name:"RepeatingGroupLayout",show_title:false},{name:"StartWorkflow",show_title:false},{name:"ElementStyle",show_title:false},{name:"Font",show_title:false},{name:"ToolTip",show_title:false},{name:"PlaceholderColor",show_title:false},{name:"CenterVertically",show_title:false},{name:"BackdropBackground",show_title:false},{name:"Stripes",show_title:false},{name:"Background",show_title:false},{name:"ButtonBackground",show_title:false},{name:"Border",show_title:false},{name:"Padding",show_title:true},{name:"InputPadding",show_title:false},{name:"FontShadow",show_title:false},{name:"Boxshadow",show_title:false},{name:"ShortPosition",show_title:false},{name:"Position",show_title:false},{name:"Position2",show_title:false},{name:"Rotation",show_title:false},{name:"ElementMetaActions",show_title:false},{name:"SearchEngineData",show_title:false},{name:"UniqueID",show_title:false}];L=new RegExp(" ","g");E.get_short_display=function(e){var t,n,r;t=b.get_element_object(e);return(n=t!=null?(r=t.display)!=null?r.replace(L,""):void 0:void 0)!=null?n:U.get_service_and_type(e)[1]};K={};I.add("GenericElement",a=function(e){oe(t,e);t.prototype.make_new=I.new_element;function t(e,n){var r,i,o,a,u,l,c,f=this;this.fake=n;e=e.to_id();t.__super__.constructor.call(this,e);if(this._type==null){this._type=e.child("type").get()}if(this._type==="CustomElement"){this.E=x.load_custom(this);a=this.property;r=this.get_default;i=this.eval_property;o=this.get_static_property;this.property=this.E.property_transformer(this,function(e){return a.call(f,e)});this.get_static_property=this.E.get_static_property_transformer(this,function(e,t){return o.call(f,e,t)});this.eval_property=this.E.eval_property_transformer(this,function(e,t,n,r){return i.call(f,e,t,n,r)});this.get_default=this.E.default_transformer(this,function(e){return r.call(f,e)});this.states=this.E.states_transformer(this);this.get_responsive_data=function(){var e;e=f.property("custom_id").get_static();return m.app().read_index("responsive",e,e)};this.get_visible_workflows=function(){return this.E.get_visible_workflows(this)};this.get_related_workflows=this.E.get_related_workflows(this);if(!s().is_edit_mode()){c=(l=typeof(u=this.E).custom_states==="function"?u.custom_states():void 0)!=null?l:I.enhance_array([]);c=c.concat(function(){var t,n,r,i;r=this.json.child("states").children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(new d(e))}return i}.call(this));this.states=function(){return c}}}else if(this._type==="CustomDefinition"){this.E=x.load_custom_definition(this)}else if(!this._type){this.E=P}else{this.E=s().load_plugin("Element:"+this._type,true);if(this.E==null){this.E=P}}if(!this.fake){e.register_indexer("fonts_used",function(){var e,t,n,r;t=I.new_element(f.json);n=t.property("font_face").get_static();if(!n){r=t.get_style_if_exists();if(r!=null){n=r.property("font_face").get_static()}}if(!n){n=t.get_default("font_face")}if(typeof n==="string"){e=["fonts_used",n,t.id()];return[e,true]}});if(this._type==="CustomElement"){e.register_indexer("redirect_on_server",function(){var e,t,n,r,i,o,a;t=f.E.get_definition_workflows(f);for(r=0,i=t.length;r<i;r++){e=t[r];if(e.can_server_side_redirect()&&((a=f.root())!=null?a.is_page():void 0)){o=e.json._path();n=["redirect_on_server",f.root().name(),S.id_safe(o)];return[n,o]}}})}if(this.container_names().length>0){e.register_indexer("responsive",function(){var e,t,n,r,i,o,a,s;r=I.new_element(f.json);e=r.id();o=(a=r.root())!=null?a.id():void 0;if(o==null){return}if((s=f.root())!=null?s.use_responsive_algorithm():void 0){n=q.calculate_lines(r);if(n!=null){t=["responsive",o,e];return[t,n]}}else{i=r.read_index("responsive",o,e);n=q.build_push_tree(r,i);if(n!=null){t=["responsive",o,e];return[t,n]}}})}}}t.prototype.display=function(e){return this.get_name(e)};t.prototype.get_name=function(e){var t,n;t=this.json.child("name").get();if(t){return t}else{if(!e&&s().workflow["debugger"]!=null){e=true}return(n=this.gen_name(e))!=null?n:this.default_name()}};t.prototype.get_responsive_data=function(){return m.app().read_index("responsive",this.root().id(),this.id())};t.prototype.default_name=function(){return this.json.child("default_name").get()};t.prototype.gen_name=function(e){var t,n,r,i,o,a,u=this;if(!s().is_edit_mode()&&!e){return null}r=["text","placeholder","label","icon","group_type"];t=function(e){var t,n,i,o,a,u,l,c,f,d,_;l={};for(c=0,d=r.length;c<d;c++){u=r[c];i=e.property(u);o=I.make_filter("GetElement");a=I.make_filter("ThisElement");t=i.find_expressions(o).concat(i.find_expressions(a));if(s().is_edit_mode()){l[e.json._id]=true}else{l[e.json.id()]=true}for(f=0,_=t.length;f<_;f++){n=t[f];if(l[n.raw().properties.element_id]){return true}l[n.raw().properties.element_id]=true}}return false};if(t(this)){return this.default_name()}n=this.toUniqueString();if(C[n]==null){C[n]=G.Watcher(function(){var e,t,n,i,o,a,s;t=function(e){var t,n,r;t=E.get_short_display(u.type());if(t==="CustomElement"){n=(r=m.custom_definition(u.get_static_property("custom_id")))!=null?r.name():void 0;if(n){return n}}return t+" "+e};for(a=0,s=r.length;a<s;a++){i=r[a];if(i==="group_type"){n=u.get_static_property(i);if(n){n=V.get(n);n=n!=null?n.display():void 0;if(n){return t(n)}}}else{e=u.property(i);if(!e.is_empty()){o=e.get_tree_display().slice(0,20);return t(o)}}}})}a=C[n].get_current(),i=a[0],o=a[1];if(i){return o}};t.prototype.is_equal_to=function(e){var n,r;if(!t.__super__.is_equal_to.call(this,e)){return false}if(this._type!==e._type){return false}if(this._type==="CustomElement"){return((n=this.E)!=null?n.base_name:void 0)===((r=e.E)!=null?r.base_name:void 0)}return true};t.prototype.toUniqueString=function(){return t.__super__.toUniqueString.call(this)+this._type};t.prototype.type=function(){return this._type};t.prototype.is_input=function(){var e;return(e=this.E)!=null?e.is_input:void 0};t.prototype.is_root=function(){return(typeof this.is_page==="function"?this.is_page():void 0)||(typeof this.is_custom_definition==="function"?this.is_custom_definition():void 0)};t.prototype.id=function(){return this.json.id()};t.prototype.get_precomputed=function(){var e,t,n,r,i,o,a,s,l,c,d,_,p,h,g,m,v,y,b;if(!this._precomputed){h={};o=this.get_style_if_exists();if(o){b=O()}g=this.json._child(f.properties)._raw();for(p in g){s=g[p];if(o&&b[p]){continue}if(I.is_static(s)){h[p]=I.get_static(s)}else{h[p]=u}}r={};for(p in h){s=h[p];r[F.expand(p)]=s}if(this._type==="CustomElement"){e={};for(t in r){a=r[t];if(ne.call(x.ON_ELEMENT,t)>=0&&(t!=="width"&&t!=="height")){e[t]=a}}r=e}if(o){m=o.get_precomputed();for(n in m){s=m[n];if(E.style_properties[n]){r[n]=s}}}v=this.states();for(l=0,d=v.length;l<d;l++){i=v[l];y=i.property_names();for(c=0,_=y.length;c<_;c++){n=y[c];r[n]=u}}this._precomputed=r}return this._precomputed};t.prototype.property_watcher_fn=I.run_cache_1_param("property_watcher_fn",function(e){var t,n,r,i,o,a;if(s().is_edit_mode()){return this.edit_eval.bind(this,e)}else{i=E.style_properties[e]?this.get_style_if_exists():null;if(i){t=function(){var t,n,o,a,s;a=(o=i.states())!=null?o:[];s=[];for(t=0,n=a.length;t<n;t++){r=a[t];if(ne.call(r.property_names(),e)>=0){s.push(r)}}return s}()}else{t=[]}t.push.apply(t,function(){var t,n,i,o;i=this.states();o=[];for(t=0,n=i.length;t<n;t++){r=i[t];if(ne.call(r.property_names(),e)>=0){o.push(r)}}return o}.call(this));if(i){if(t.length===0){return i.get_static_property(e)}}else{o=this.property(e).json._raw();if((o!=null?o[f.type]:void 0)==="Empty"){o=null}if(!o||typeof o!=="object"){n=(a=o!=null?o:this.get_default(e))!=null?a:null}else{n=u}if(n!==u&&t.length===0){return n}}return this.run_eval.bind(this,e,i,t,n)}});t.prototype.edit_eval=function(e,t){var n,r,i,o,a,u,l,c,f,d,_;i=null;if(t.responsive_mode()){n=s().visual_edit.get_state_eval_context()}if(n){n=G.extend(n,{element:t})}u=[];if(E.style_properties[e]){l=this.get_style_if_exists();if(l){u.push.apply(u,l.states())}}u.push.apply(u,this.states());u.reverse();for(c=0,f=u.length;c<f;c++){o=u[c];if(!(ne.call(o.property_names(),e)>=0)){continue}a=n!=null?o.eval_condition(n):this.is_on_edit_mode(o);if(a){i=o.property(e);break}}if(i===null){if(E.style_properties[e]){l=this.get_style_if_exists();if(l){i=this.get_style().property(e)}}}if(i===null){if(E.style_properties[e]){l=this.get_style_if_exists();if(l){i=this.get_style().property(e)}}if(i===null){i=this.property(e)}}if(i.is_empty()){return(d=this.get_default(e))!=null?d:null}if(i.is_static()){return i.get_static()}else{r=this.field(e);if((r!=null?r.editor:void 0)==="Color"&&(r!=null?r.dynamic:void 0)){return(_=this.get_default(e))!=null?_:null}if(i.get_eval_value().matches("text")){return i.get_tree_display()}else{return null}}};t.prototype.run_eval=function(e,t,n,r,i){var o,a,s;o=function(){var e,t,r;r=[];for(e=0,t=n.length;e<t;e++){s=n[e];if(i.is_state_on(s)){r.push(s)}}return r}();if(o.length>0){s=o[o.length-1];if(s.property(e).is_empty()){s=null}}else{s=null}if(s!=null){a=s.eval_property(e,i.prop_eval_context(),null)}else{if(t){a=t.get_static_property(e)}else{if(r===u){a=this.eval_property(e,i.prop_eval_context(),null,this.get_default(e))}else{a=r}}}if(e==="text"||e==="html"){G.ensure_ready(Y.active_key)}return a!=null?a:null};t.prototype.default_states=function(){var e;return(e=this.E.default_states)!=null?e:[]};t.prototype.default_transitions=function(){return this.E.default_transitions};t.prototype.added_to_container=function(){if(typeof this.E.added_to_container==="function"){return this.E.added_to_container(this)}return this.E.position_canvas==null};t.prototype.compute_initial_properties=function(e,t){var n;if(this.E.get_min_width!=null&&t&&t.exists()){if(e.properties.width<=60&&t.get_width()>200){e.properties.fixed_width=true}if(e.properties.left<50&&t.get_width()>300&&e.properties.width<150){e.properties.responsive_alignment="left"}else if(t.get_width()>300&&t.get_width()-(e.properties.left+e.properties.width)<50&&e.properties.left>150){e.properties.responsive_alignment="right"}}return typeof(n=this.E).compute_initial_properties==="function"?n.compute_initial_properties(e,t):void 0};t.prototype.get_new_event_json=function(){return this.json.child("workflows").child(G.LUID())};t.prototype.events=function(e){return this.json.smart_cache("events_"+String(e),function(t){var n;return I.filter_array(e,function(){var e,r,i,o;i=t.child("workflows").children();o=[];for(e=0,r=i.length;e<r;e++){n=i[e];o.push(I.new_workflow_item(n))}return o}())})};t.prototype.find_events=function(e){return this.events(e)};t.prototype.find_actions=function(e){var t,n,r,i,o;n=[];o=this.events();for(r=0,i=o.length;r<i;r++){t=o[r];n.push.apply(n,t.all_next(e))}return n};t.prototype.elements=function(e){var t,n,r,i,o,a,s,u,l;r=[];u=this.container_names();for(i=0,a=u.length;i<a;i++){t=u[i];l=this.get_container_elements(t,true);for(o=0,s=l.length;o<s;o++){n=l[o];r.push(n)}}return I.filter_array(e,r)};t.prototype.find_elements=function(e){return I.from_raw_array(this.json,I.new_element,T(I.to_raw(this),e))};t.prototype.find_elements_custom=function(e){var t,n,r,i,o,a;r=[];e=I.make_filter(e);a=this.elements();for(i=0,o=a.length;i<o;i++){n=a[i];if(e(n)){r.push(n)}r.push.apply(r,I.to_array(n.find_elements_custom(e)))}if(this._type==="CustomElement"){if(!x.custom_circle(this)){t=this.app().custom_definition(this.get_static_property("custom_id"));r.push.apply(r,I.to_array(t.find_elements_custom(e)))}}return I.enhance_array(r)};t.prototype.find_expressions=function(e){return I.from_raw_array(this.json,I.new_expression,A(I.to_raw(this),e))};t.prototype.parent=function(){var e,t;if(this.fake){return null}e=(t=this.json.parent())!=null?t.parent():void 0;if(e){return I.new_element(e)}};t.prototype.parents=function(e){var t,n;t=[];n=this;while(n=n.parent()){t.push(n)}return I.filter_array(e,t)};t.prototype.context_element=function(){return this};t.prototype.root=function(){var e;return(e=this.parent())!=null?e.root():void 0};t.prototype.get_width=function(){return this.get_static_property("width")};t.prototype.get_height=function(){return this.get_static_property("height")};t.prototype.get_left=function(){return this.get_static_property("left")};t.prototype.get_top=function(){return this.get_static_property("top")};t.prototype.get_zindex=function(){return this.get_static_property("zindex")};t.prototype.min_width_adjustable=function(){return!this.get_static_property("fixed_width")&&this.E.get_min_width!=null&&this.E.get_min_width(this)<this.get_static_property("width")};t.prototype.max_width_adjustable=function(){return this.min_width_adjustable()&&!this.E.not_max_adjustable};t.prototype.get_min_width=function(){var e,t,n;if(this.E.get_min_width==null||this.get_static_property("fixed_width")){return this.get_static_property("width")}t=((n=this.get_static_property("min_width"))!=null?n:0)/100*this.get_static_property("width");e=this.E.get_min_width(this);return Math.max(t,e)};t.prototype.get_max_width=function(){var e;if(this.E.get_min_width==null||this.get_static_property("fixed_width")){return this.get_static_property("width")}if(!this.get_static_property("use_max_width")){return null}return((e=this.get_static_property("max_width"))!=null?e:100)/100*this.get_static_property("width")};t.prototype.responsive_show=function(){return this.get_static_property("responsive_show")};t.prototype.responsive_show_width=function(){return this.get_static_property("responsive_show_width")};t.prototype.states=I.run_cache("states",function(){var e;return I.enhance_array(function(){var t,n,r,i;r=this.json.child("states").children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(new d(e))}return i}.call(this))});t.prototype.state_by_name=function(e){return new d(this.json.child("states").child(e))};t.prototype.get_messages=function(){var e,t;return(t=typeof(e=this.E).get_messages==="function"?e.get_messages(this):void 0)!=null?t:[]};t.prototype.add_specific_messages=function(e){var t;return typeof(t=this.E).add_specific_messages==="function"?t.add_specific_messages(e,this):void 0};t.prototype.get_states=function(){var e,t;return(t=typeof(e=this.E).get_states==="function"?e.get_states(this):void 0)!=null?t:[]};t.prototype.get_state_value=function(e){var t;return V.get((t=this.E.get_state_value(this,e))!=null?t:"null")};t.prototype._fields=function(e){return this.E.fields(this,e)};t.prototype.field=function(e){var t,n,r,i;i=this.fields();for(n=0,r=i.length;n<r;n++){t=i[n];if(t.name===e){return t}}};t.prototype.field_names=function(){return this.E.field_names};t.prototype.get_property_applications=function(){var e;if(typeof this.E.property_applications==="function"){e=this.E.property_applications(this)}else{e=this.E.property_applications}return e.concat([new B.UniqueID])};t.prototype.get_value_id=function(){return"element."+this.id()};t.prototype.get_visible_workflows=function(){return this.parents().events()};t.prototype.get_related_workflows=function(e){var t,n,r,i,o,a;r=[];n=this.id();a=this.get_visible_workflows();for(i=0,o=a.length;i<o;i++){t=a[i];if(t.element_id()===n&&t.type()===e){r.push(t)}}return I.enhance_array(r)};t.prototype.container_names=function(){var e,t;return(t=typeof(e=this.E).container_names==="function"?e.container_names(this):void 0)!=null?t:[]};t.prototype.get_container_elements=function(e,t){if(this.E.get_container_elements){return this.E.get_container_elements(this,e,t)}else{return this._get_container_elements(e)}};t.prototype._get_container_elements=function(e){var t;return I.enhance_array(function(){var n,r,i,o;i=this.json.child(e).children();o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push(new I.Element(t))}return o}.call(this))};t.prototype.get_container_width=function(){var e,t,n,r,i,o;if(this.E.get_container_width){return this.E.get_container_width(this)}else{n=0;if(this.get_static_property("four_border_style")){o=["_left","_right"];for(r=0,i=o.length;r<i;r++){e=o[r];t=this.get_static_property("border_style"+e,true);if(t!==void 0&&t!=="none"){n+=this.get_static_property("border_width"+e,true)}}}else{t=this.get_static_property("border_style",true);if(t!==void 0&&t!=="none"){n=2*this.get_static_property("border_width",true)}}return this.get_width()-n}};t.prototype.tell_editcanvas=function(){return true};t.prototype.is_visible_on_page_load=function(){return this.E.is_visible_on_page_load(this)};t.prototype.modal=function(){var e,t;return(t=typeof(e=this.E).modal==="function"?e.modal(this):void 0)!=null?t:false};t.prototype.not_draggable=function(){var e,t;return(t=typeof(e=this.E).not_draggable==="function"?e.not_draggable(this):void 0)!=null?t:false};t.prototype.not_resizable=function(){var e,t;return(t=typeof(e=this.E).not_resizable==="function"?e.not_resizable(this):void 0)!=null?t:false};t.prototype.goes_on_document=function(){var e,t;return(t=typeof(e=this.E).goes_on_document==="function"?e.goes_on_document(this):void 0)!=null?t:false};t.prototype.goes_on_document_for_drawing=function(){var e,t;return(t=typeof(e=this.E).goes_on_document_for_drawing==="function"?e.goes_on_document_for_drawing(this):void 0)!=null?t:this.goes_on_document()};t.prototype.no_edit_draw_children=function(){var e,t;return(t=typeof(e=this.E).no_edit_draw_children==="function"?e.no_edit_draw_children(this):void 0)!=null?t:false};t.prototype.find_in_editor_raw=function(e,t){var n=this;return G.run_once(30,function(){return n.root()},function(r,i){return i!=null?i.find_in_editor(false,function(){$(w.VISUAL_TAB).click();s().visual_edit.responsive_mode_box("builder");s().edit_canvas.select_one(n.id());s().edit_canvas.update_selection();s().visual_edit.edit_current_element();return e()},t):void 0;
})};t.prototype.find_in_editor=function(e,t,n){var r=this;return this.find_in_editor_raw(function(){s().property_editor.current_tab("appearance");return G.wait_for_updates(function(){if(e){return t($("#"+r.id()))}else{return t()}})},n)};t.prototype.is_on_edit_mode=function(e){var t;t="state:"+e.toUniqueString();if(K[t]==null){K[t]=G.Box(false)}return K[t]()};t.prototype.toggle_state_edit_mode=function(e){var t;t="state:"+e.toUniqueString();return K[t](!K[t]())};t.prototype.get_style_node=function(){return I.new_expression(this.json.child("style"),this)};t.prototype.get_style_id=function(){return this.json.child("style").get()};t.prototype.get_style=function(){return this.app().style(this.get_style_id())};t.prototype.get_style_if_exists=I.run_cache("get_style_if_exists",function(){var e,t;e=this.json._child(f.style).get();if(!e){return null}t=this.app().style(e);if(!t.exists()){return null}return t});t.prototype.set_style=function(e){var t,n,r;if(e!==this.get_style_id()){n=((r=this.get_style())!=null?r.exists():void 0)?this.get_style().json:this.json;t=s().changes.Change("AssignStyle",{target_id:this.id(),old_value:this.get_style_id(),value:e,old_properties:n.child("properties").raw(),old_states:n.child("states").raw(),old_transitions:n.child("transitions").raw()});return t.execute()}};t.prototype.property_supports_states=function(){var e;return(e=this.E.property_supports_states)!=null?e:true};t.prototype.property_supports_transitions=function(){var e;return(e=this.E.property_supports_transitions)!=null?e:true};t.prototype.primary_field=function(){var e;return typeof(e=this.E).primary_field==="function"?e.primary_field(this):void 0};t.prototype.mandatory_sections=function(){var e,t;return(t=typeof(e=this.E).mandatory_sections==="function"?e.mandatory_sections(this):void 0)!=null?t:null};t.prototype.can_copy_style=function(){var e;return(e=this.E.can_copy_style)!=null?e:true};t.prototype.property_sections=function(){return N};t.prototype.set_name=function(e){var t,n,r,i,o;if(this instanceof c){if(this.is_page()){i=s().appchange.validate_page_name(e),n=i[0],e=i[1];if(n){throw G.error(n)}}else if(this.is_custom_definition()){o=s().appchange.validate_custom_name(e),n=o[0],e=o[1];if(n){throw G.error(n)}}}r=this.json.child("name").get();if(e!==r){t=s().changes.Change("SetData",{target_id:this.id(),path:"name",old_value:r,value:e});return t.execute()}};t.prototype.move_to=function(e,t){var n;n=(new s).changes.Change("MoveElement",{old_parent:this.parent().id(),old_container:this.json.parent().name(),id:this.id(),new_parent:e.id(),new_container:t});return n.execute()};t.prototype.new_child_element=function(e,t,n){var r,i,o,a=this;if(!n){throw G.error("must provide raw data")}o=I.RAW.copy(n,t),i=o.new_data,r=o.mapping;G.run_once(30,function(){return G.walk(i,function(e){var t;if(e!=null?e.id:void 0){return e.default_name=s().appchange.gen_name(a.root(),e.type,(t=e.properties)!=null?t.custom_id:void 0)}})},function(n){var r;if(n){G.warn(n,{context:"temporary error creating your new element.",time_since_load:Date.now()-window.editor_loading_started});alert("Sorry, we had a temporary error creating your new element.  Please try again in a minute");return}r=(new s).changes.Change("CreateElement",{parent_id:a.id(),container:e,id:t,data:i});return r.execute()});return r};t.prototype.new_state=function(e){var t;if(e==null){e=null}t=s().changes.Change("NewState",{element_id:this.id(),name:m.uid(),data:e!=null?e:I.RAW.State()});return t.execute()};t.prototype["delete"]=function(){var e=this;return G.run_once(30,function(){var t,n,r;r=e.elements();n=e.get_visible_workflows().filter(".element_id="+e.id());t=e.get_visible_workflows().actions(".element_id="+e.id());return[r,n,t]},function(t,n){var r,i,o,a,u,l,c,f,d,_,p,h,g,m;c=n[0],l=n[1],u=n[2];if(t){G.warn(t);window.alert("Oops, we hit a temporary error processing the element deletion... please try again in a bit");return}for(f=0,p=c.length;f<p;f++){o=c[f];o["delete"]()}for(d=0,h=l.length;d<h;d++){a=l[d];a["delete"]()}for(_=0,g=u.length;_<g;_++){r=u[_];r["delete"]()}if(e.json.exists()){i=(new s).changes.Change("RemoveElement",{parent_id:(m=e.parent())!=null?m.id():void 0,container:e.json.parent().name(),id:e.id(),data:e.json.raw()});return i.execute()}})};t.prototype.switch_to_new_type=function(e){var t,n;n=this.json.child("properties").raw();t=(new s).changes.Change("ReplaceElement",{old_type:this._type,new_type:e,id:this.id(),old_properties:n,old_style:this.get_style_id()});t.execute();if(b.get_element_object(e).goes_on_document()){this.move_to(this.root(),"elements")}return this.commit()};t.prototype.element_custom_states=function(){var e;if(this.E.element_custom_states){return this.E.element_custom_states()}return function(){var t,n,r,i;r=this.json.child("custom_states").children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(new I.CustomState(e))}return i}.call(this)};t.prototype.element_custom_state=function(e){if(!e){return null}if(this.E.element_custom_state){return this.E.element_custom_state(e)}e=e.split("custom.")[1];return new I.CustomState(this.json.child("custom_states").child(e))};t.prototype.create_custom_state=function(e,t){var n,r,i,o,a,u;n=e.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase();u="";o=function(){return n+"_"+u};while(this.element_custom_state(o()).exists()){u=(u||0)+1}a=o();i={display:e,value:t,make_static:true};r=(new s).changes.Change("CreateCustomState",{element_id:this.id(),name:a,data:i});r.execute();this.commit();return"custom."+a};t.prototype.transitions=function(){var e;return I.enhance_array(function(){var t,n,r,i;r=this.json.child("transitions").children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(new h(e))}return i}.call(this))};t.prototype.transition=function(e){var t,n;if(this.E.transition){return this.E.transition(e)}t=this.json.child("transitions").child(e);if(t.exists()){return new h(t)}n=this.get_style_if_exists();if(n){return n.transition(e)}};t.prototype.add_transition=function(e){var t;t=(new s).changes.Change("AddTransition",{element_id:this.id(),prop_name:e,data:H});t.execute();return this.commit()};t.prototype.find_events_using_this_element=function(){var e,t,n,r,i,o,a,u;e=this.id();n=(a=(u=s().visual_edit.root_node())!=null?u.events():void 0)!=null?a:[];r=[];for(i=0,o=n.length;i<o;i++){t=n[i];if(t.element_id()===e){r.push(t)}else if(t.find_my_expressions("GetElement.element_id="+e).length){r.push(t)}}return r};t.prototype.find_actions_using_this_element=function(){var e,t,n,r,i,o,a,u,l,c;t=this.id();i=s().visual_edit.root_node().events();r=[];for(a=0,l=i.length;a<l;a++){n=i[a];r.push.apply(r,n.actions())}o=[];for(u=0,c=r.length;u<c;u++){e=r[u];if(e.element_id()===t){o.push(e)}else if(e.find_my_expressions("GetElement.element_id="+t).length){o.push(e)}}return o};t.prototype.find_elements_using_this_element=function(){var e,t,n,r,i,o,a,u;t=this.id();n=(u=typeof(i=s().visual_edit.root_node()).find_elements==="function"?i.find_elements():void 0)!=null?u:[];r=[];for(o=0,a=n.length;o<a;o++){e=n[o];if(e.find_expressions("GetElement.element_id="+t).length&&e.id()!==t){r.push(e)}}return r};return t}(I.HasID));I.add("Element",i=function(e){oe(t,e);function t(e,n){var r=this;this.fake=n;t.__super__.constructor.call(this,e,this.fake);if(!this.fake&&te()&&this.is_top_level()){e.register_indexer("issues_list",function(){var e,t,n,i;i=I.new_element(r.json);e=i.id();if(e==null){return}n=v.check_issues(i);t=["issues_list",e];return[t,G.json_stringify(n)]})}}t.prototype.is_top_level=function(){var e,t;e=this.json.path();return(e!=null?(t=e.match(/\./g))!=null?t.length:void 0:void 0)===3};t.prototype.check_for_errors=function(e,n){var r,i,o,a,s,u;a=typeof(s=this.E).check_for_errors==="function"?s.check_for_errors(this,e,n):void 0;if(a===true){return}o=t.__super__.check_for_errors.call(this,e);r=function(){var e,t,n,r;n=U.get_app_services();r=[];for(e=0,t=n.length;e<t;e++){i=n[e];r.push(i.name)}return r}();if(this.E.is_plugin&&(u=this.E.service,ne.call(r,u)<0)){e(this.display()+" - You're using this element but haven't installed the plugin "+U.get_service(this.E.service).display())}return{children:this.events().concat(this.states(),this.elements(),o.children)}};return t}(a));if(G.is_edit_mode()){i.prototype.get_static_property=function(e,t){var n,r;if(!t){r=this.field_names();if(!r){throw G.error("missing field names for "+this._type)}n=r[e];if(n&&!n.no_states){G.warn("called get_static_property on "+e+" but no_states is not set, is it really static? Element type is "+this._type)}}return i.__super__.get_static_property.call(this,e)}}z=function(e){return new d(e)};I.add("State",d=function(e){oe(t,e);function t(){J=t.__super__.constructor.apply(this,arguments);return J}t.prototype.property_names=I.run_cache("property_names",function(){var e,t,n,r,i;r=this.json._child(f.properties).children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e.name())}return i});t.prototype.condition=I.run_cache("condition",function(){return I.new_expression(this.json._child(f.condition),this)});t.prototype.eval_condition=function(e,t){var n=this;return I.with_eval_node(this,function(){return I.evaluate_json(n.json._child(f.condition),e,t,null)[0]})};t.prototype.property=function(e){return I.new_expression(this.json._gchild(f.properties,F.shrink(e)),this)};t.prototype.eval_property=function(e,t,n){var r=this;return I.with_eval_node(this.property(e),function(){return I.evaluate_json(r.json._gchild(f.properties,F.shrink(e)),t,n,null)[0]})};t.prototype.properties=function(){var e,t,n,r,i;r=this.json._child(f.properties).child_names();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(this.property(e))}return i};t.prototype.find_expressions=function(e){return I.from_raw_array(this.json,I.new_expression,W(I.to_raw(this),e))};t.prototype.rel_path=function(){return"states."+this.json.name()};t.prototype.get_static_property=function(e){return this.property(e).get_static()};t.prototype.context_element=function(){return I.new_element(this.json.parent().parent())};t.prototype.root=function(){return this.context_element().root()};t.prototype.check_for_errors=function(e){var t,n,r,i,o,a,u,l,c;i=this.context_element();t=this.condition().get_eval_value();if(t.matches("null")){if(this.property_names().length>0){e(i.display()+" - remember to fill out when we should show this conditional state",this.condition())}}else if(!t.matches("sys.bool")){e(i.display()+' - states must evaluate to "yes" or "no", but this is a '+t.display(),this.condition())}o=[];c=this.property_names();for(u=0,l=c.length;u<l;u++){a=c[u];r=G.extend({},i._field_data(a));n=s().GenericEditor.get_editor(this,r);if(n.type_check(i.display()+" (state)",e)){o.push(this.property(a))}}return{children:[this.condition()].concat(o)}};t.prototype.find_in_editor=function(e,t,n){var r=this;return G.run_once(30,function(){return r.context_element()},function(e,r){return r.find_in_editor_raw(function(){s().property_editor.current_tab("conditional");return G.wait_for_updates(t)},n)})};t.prototype.set_condition=function(e){var t,n,r,i;n=this.condition().raw();if(JSON.stringify(n)===JSON.stringify(e)){return}i=this.context_element().id();r=this.rel_path()+".condition";t=s().changes.Change("SetData",{target_id:i,path:r,old_value:n,value:e});return t.execute()};t.prototype.set_property=function(e,t){var n,r,i,o;r=this.property(e).raw();if(JSON.stringify(r)===JSON.stringify(t)){return}o=this.context_element().id();i=this.rel_path()+".properties."+e;n=s().changes.Change("SetData",{target_id:o,path:i,old_value:r,value:t});return n.execute()};t.prototype["delete"]=function(){var e,t;t=this.context_element().id();e=s().changes.Change("RemoveState",{element_id:t,name:this.json.name(),data:this.json.raw()});return e.execute()};t.prototype.rank=function(){var e;return function(){var t,n,r,i;r=this.context_element().states();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e.json.name())}return i}.call(this).indexOf(this.json.name())};t.prototype.move_up=function(){var e,t,n,r;t=this.context_element().id();r=this.rank();n=this.rank()-1;e=s().changes.Change("ReorderState",{element_id:t,old_index:r,new_index:n});return e.execute()};t.prototype.move_down=function(){var e,t,n,r;t=this.context_element().id();r=this.rank();n=this.rank()+1;e=s().changes.Change("ReorderState",{element_id:t,old_index:r,new_index:n});return e.execute()};return t}(I.AppNode));H={duration:200,fn:"ease"};E.transition_fns=["ease","ease-in","ease-out","ease-in-out","linear","step-start","step-end"];I.add("Transition",h=function(e){oe(t,e);function t(){X=t.__super__.constructor.apply(this,arguments);return X}t.prototype.context_element=function(){return I.new_element(this.json.parent().parent())};t.prototype.prop_name=function(){return this.json.name()};t.prototype.prop_name_display=function(){var e,t,n,r,i,o;t=this.context_element().fields(true);for(r=0,i=t.length;r<i;r++){e=t[r];if(!(e.name===this.prop_name())){continue}n=(o=e.long_caption)!=null?o:e.caption;break}if(n===null){console.log("could not find property "+this.prop_name()+" on node "+this.context_element())}return n};t.prototype.duration_node=function(){return this.json.child("duration")};t.prototype.duration=function(){return this.duration_node().get()};t.prototype.fn_node=function(){return this.json.child("fn")};t.prototype.fn=function(){return this.fn_node().get()};t.prototype.set_property=function(e,t){var n,r;r=this.property(e).raw();if(r===t){return}n=(new s).changes.Change("ModifyTransition",{element_id:this.context_element().id(),prop_name:this.prop_name(),sub_prop_name:e,value:t,old_value:r});n.execute();return this.commit()};t.prototype["delete"]=function(){var e;e=(new s).changes.Change("RemoveTransition",{element_id:this.context_element().id(),prop_name:this.prop_name(),data:{duration:this.duration(),fn:this.fn()}});e.execute();return this.commit()};return t}(I.HasProperties));I.add("Style",_=function(e){oe(t,e);function t(e){var n=this;t.__super__.constructor.call(this,e);e.register_indexer("fonts_used",function(){var e,t;t=n.property("font_face").get_static();if(t){e=["fonts_used",t,n.id()];return[e,true]}})}t.prototype.is_style=function(){return true};t.prototype.root=function(){return null};t.prototype.from_theme=function(){return this.json.child("from_theme").get()};t.prototype.display=function(){var e;return(e=this.json.child("display").get())!=null?e:""};t.prototype.set_display=function(e){var t,n;n=this.display();if(n!==e){t=s().changes.Change("SetStyleData",{style_name:this.name(),name:"display",value:e,old_value:n});t.execute();return this.commit()}};t.prototype.name=function(){return this.json.name()};t.prototype.id=function(){return this.name()};t.prototype.type=function(){return this.json.child("type").get()};t.prototype.set_property=function(e,t){var n,r;if(typeof(t!=null?t.raw:void 0)==="function"){t=t.raw()}r=this.property(e).raw();if(JSON.stringify(r)===JSON.stringify(t)){return}n=s().changes.Change("SetStyleData",{style_name:this.name(),name:e,value:t,old_value:r});return n.execute()};t.prototype.check_for_errors=function(e){return{children:this.states()}};t.prototype.property_supports_states=function(){return true};t.prototype.property_supports_transitions=function(){return true};t.prototype.mandatory_sections=function(){return[]};t.prototype.get_element_from_style=function(){if(this.json.child("id").get()==null||this.json.to_id().child("type").get()==null){this.json.child("id").set(this.name());s().changes.set_id_cache(this.json,this.json.raw())}return R(this.json,true)};t.prototype.E_object=function(){var e;if(!this.type()){return P}return(e=b.get_element_object(this.type()))!=null?e:P};t.prototype.get_width=function(){return this.get_default("width")};t.prototype.get_height=function(){return this.get_default("height")};t.prototype.get_default=function(e){var t,n;return(t=this.field_names())!=null?(n=t[e])!=null?n["default"]:void 0:void 0};t.prototype.context_element=function(){return this};t.prototype.get_value_id=function(){return"style."+this.type()};t.prototype.get_style_id=function(){return null};t.prototype.get_style_if_exists=function(){return null};t.prototype.field_names=I.run_cache("field_names",function(){if(!this.E_object()){return null}return this.E_object().field_names});t.prototype._fields=function(e){return this.E_object().fields(this,e)};t.prototype.use_responsive_algorithm=function(){return false};t.prototype.get_property_applications=function(){var e;e=this.E_object();if(typeof e.property_applications==="function"){return e.property_applications(this)}else{return e.property_applications}};t.prototype.property_sections=function(){return N};t.prototype.new_state=function(e){var t;t=s().changes.Change("NewStyleState",{style_name:this.name(),name:m.uid(),data:e!=null?e:I.RAW.State()});return t.execute()};t.prototype.states=I.run_cache("states",function(){var e;return I.enhance_array(function(){var t,n,r,i;r=this.json.child("states").children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(new p(e))}return i}.call(this))});t.prototype.state_by_name=function(e){return new p(this.json.child("states").child(e))};t.prototype.is_on_edit_mode=function(e){var t;t="state:"+e.toUniqueString();if(K[t]==null){K[t]=G.Box(false)}return K[t]()};t.prototype.toggle_state_edit_mode=function(e){var t;t="state:"+e.toUniqueString();return K[t](!K[t]())};t.prototype.transitions=function(){var e;return I.enhance_array(function(){var t,n,r,i;r=this.json.child("transitions").children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(new h(e))}return i}.call(this))};t.prototype.transition=function(e){return new h(this.json.child("transitions").child(e))};t.prototype.add_transition=function(e){var t;t=(new s).changes.Change("AddTransition",{element_id:this.name(),prop_name:e,data:H});t.execute();return this.commit()};t.prototype.find_in_editor_raw=function(e){return this.find_in_editor(void 0,e)};t.prototype.find_in_editor=function(e,t){var n=this;$(w.STYLES_TAB).click();return G.wait_for_updates(function(){if(n.type()!==s().styles_canvas.element_type_node.get()){s().styles_canvas.element_type_node.set(null)}s().styles_canvas.currently_displayed_style(n.id());return typeof t==="function"?t():void 0})};t.prototype.get_precomputed=function(){var e,t,n,r,i,o,a,s,l,c,d,_,p;if(!this._precomputed){c={};d=this.json._child(f.properties)._raw();for(l in d){r=d[l];c[l]=I.get_static(r)}t={};for(l in c){r=c[l];t[F.expand(l)]=r}_=this.states();for(i=0,a=_.length;i<a;i++){n=_[i];p=n.property_names();for(o=0,s=p.length;o<s;o++){e=p[o];t[e]=u}}this._precomputed=t}return this._precomputed};return t}(I.HasProperties));E._is_state_basic=function(e){var t,n,r;if(!e||!e.type){return true}if((t=e.type)!=="ThisElement"&&t!=="PageData"){return false}if(e.type==="ThisElement"&&e.next&&((n=e.next.name)!=="is_focused"&&n!=="isnt_focused"&&n!=="isnt_pressed"&&n!=="is_pressed"&&n!=="isnt_hovered"&&n!=="is_hovered"&&n!=="isnt_valid"&&n!=="isnt_clickable")){return false}if(e.type==="PageData"&&((r=e.properties.name)!=="Current Page Width"&&r!=="Current Page Scrolling Position")){return false}if(e.next&&e.next.next){return false}return true};I.add("StyleState",p=function(e){oe(t,e);function t(){Z=t.__super__.constructor.apply(this,arguments);return Z}t.prototype.context_element=function(){return new _(this.json.parent().parent())};t.prototype.toUniqueString=function(){return new d(this.json).toUniqueString()};t.prototype["delete"]=function(){var e;e=s().changes.Change("RemoveStyleState",{style_name:this.context_element().name(),name:this.json.name(),data:this.json.raw()});return e.execute()};t.prototype.set_condition=function(e){var t,n;n=this.condition().raw();if(JSON.stringify(n)===JSON.stringify(e)){return}if(!E._is_state_basic(e)){alert("This state should be basic: hovered, pressed. focused or valid");return}t=s().changes.Change("SetStyleStateCondition",{style_name:this.context_element().name(),state_name:this.json.name(),value:e,old_value:n});return t.execute()};t.prototype.set_property=function(e,t){var n,r;r=this.property(e).raw();if(JSON.stringify(r)===JSON.stringify(t)){return}n=s().changes.Change("SetStyleStateData",{style_name:this.context_element().name(),state_name:this.json.name(),name:e,value:t,old_value:r});return n.execute()};t.prototype.check_for_errors=function(e){var t,n,r;r=this.context_element();if(!r.type()){return}t=this.condition().get_eval_value();n="Style "+r.display();if(t.matches("null")){if(this.property_names().length>0){return e(n+" - remember to fill out when we should show this conditional state",this.condition())}}else if(!t.matches("sys.bool")){return e(n+' - states must evaluate to "yes" or "no"',this.condition())}};return t}(d));D=function(e){var t,n,r,i,o,a,s,u,l,c,f;a={};t={};f=(c=e!=null?e.find_elements():void 0)!=null?c:[];for(u=0,l=f.length;u<l;u++){r=f[u];i=r.type();if(i==="CustomElement"){t[r.get_static_property("custom_id")]=true}else{a[i]=true}}return{types:function(){var e;e=[];for(o in a){s=a[o];e.push(o)}return e}(),custom:function(){var e;e=[];for(n in t){s=t[n];e.push(n)}return e}()}};I.add("CustomState",r=function(e){oe(t,e);function t(){Q=t.__super__.constructor.apply(this,arguments);return Q}t.prototype.display=function(){return this.json.child("display").get()};t.prototype.value=function(){return this.json.child("value").get()};t.prototype.exists=function(){return this.json.child("value").get()!=null};t.prototype.make_static=function(){return this.json.child("make_static").get()};t.prototype.name=function(){return"custom."+this.json.name()};t.prototype.id=function(){return this.name()};t.prototype.change_value=function(e,t){var n,r;t={value:t!=null?t:this.value(),display:e!=null?e:this.display()};r={value:this.value(),display:this.display()};if(G.json_stringify(t)!==G.json_stringify(r)){n=(new s).changes.Change("ModifyCustomState",{element_id:this.parent().id(),name:this.name().split("custom.")[1],old_value:r,value:t});n.execute();return this.commit()}};t.prototype.parent=function(){return new I.Element(this.json.parent().parent())};t.prototype["delete"]=function(){var e;e=(new s).changes.Change("DeleteCustomState",{element_id:this.parent().id(),name:this.name().split("custom.")[1],data:{value:this.value(),display:this.display()}});e.execute();return this.commit()};return t}(I.AppNode));I.add("Root",c=function(e){oe(t,e);function t(e){var n=this;t.__super__.constructor.call(this,e);e.register_indexer("root_id_to_element_types",function(){var e,t,r;r=I.new_element(n.json);e=D(r);t=["root_id_to_element_types",r.id()];return[t,e]});if(te()){e.register_indexer("issues_list",function(){var e,t,r;r=I.new_element(n.json);if(!r.id()){return}t=v.check_issues(r);e=["issues_list",r.id()];return[e,G.json_stringify(t)]})}e.register_indexer("issues_sub",function(){var e,t,r,i,o;r=I.new_element(n.json);if(!r.id()){return}t=["issues_sub",r.id()];i=function(){var t,n,i,o;i=r.elements();o=[];for(t=0,n=i.length;t<n;t++){e=i[t];o.push(e.id())}return o}();o=function(){var t,n,i,o;i=r.events();o=[];for(t=0,n=i.length;t<n;t++){e=i[t];o.push(e.id())}return o}();return[t,G.json_stringify(i.concat(o))]})}t.prototype.check_for_errors=function(e,n){var r,i,o;i=typeof(o=this.E).check_for_errors==="function"?o.check_for_errors(this,e,n):void 0;r=t.__super__.check_for_errors.call(this,e);return{children:this.states().concat(r.children)}};t.prototype.use_responsive_algorithm=function(){return m.get_public_setting("no_legacy_responsive")||this.get_static_property("new_responsive")};t.prototype.run_indexers=function(e){return this.json.turn_indexer_switch(e)};t.prototype.get_element_types=function(){var e,t,n,r,i,o=this;r={};e={};n=function(t){var i,a,s,u,l,c,f,d,_,p;if(r[t]){return}r[t]=true;f=(c=o.json.read_index("root_id_to_element_types",t))!=null?c:D(m.element(t)),l=f.types,i=f.custom;d=l!=null?l:{};for(s in d){u=d[s];e[u]=true}_=i!=null?i:{};p=[];for(s in _){a=_[s];p.push(n(a))}return p};n(this.id());return function(){var n;n=[];for(t in e){i=e[t];n.push(t)}return n}()};t.prototype.get_custom_definitions_used=function(){var e,t,n,r,i,o=this;r={};e={};n=function(t){var i,a,s,u,l,c,f,d;if(r[t]){return}r[t]=true;c=(l=o.json.read_index("root_id_to_element_types",t))!=null?l:D(m.element(t)),u=c.types,i=c.custom;f=i!=null?i:{};d=[];for(s in f){a=f[s];e[a]=true;d.push(n(a))}return d};n(this.id());return function(){var n;n=[];for(t in e){i=e[t];n.push(t)}return n}()};t.prototype.parent=function(){return null};t.prototype.root=function(){return this};t.prototype.is_api=function(){return false};t.prototype.name=function(){return this.json.child("name").get()};t.prototype.find_in_editor=function(e,t,n){var r=this;s().visual_edit.responsive_mode_box("builder");return s().visual_edit.ensure_root(this,function(){if(n){$(w.VISUAL_TAB).click();s().visual_edit.select_to_edit(r.id())}return G.wait_for_updates(t)})};t.prototype.new_event=function(e,t){var n,r;r=I.RAW.copy(t,e).new_data;n=(new s).changes.Change("CreateEvent",{root_id:this.id(),id:e,data:r});return n.execute()};t.prototype["delete"]=function(){var e;e=(new s).changes.Change("RemoveElement",{container:this.json.parent().name(),id:this.id(),data:this.json.raw()});return e.execute()};return t}(a));I.add("Page",l=function(e){oe(t,e);function t(e){var n=this;this._type="Page";t.__super__.constructor.call(this,e);if(!e.path()||e.path().indexOf("styles.")===-1){e.register_indexer("page_name_to_path",function(){var e,t,r,i;i=n.json.path();if(!i){return}else if(i.indexOf("pages.")!==0){G.warn("Trying to register page_name_to_path on a non-page",{path:n.json.path()});return}t=I.new_element(n.json);r=t.json.child("name").get();if(r){e=["page_name_to_path",r];return[e,n.json._path()]}else if(n.json.exists()){console.log("PAGE WITHOUT A NAME: "+n.json.path())}});e.register_indexer("page_name_to_id",function(){var e,t,r,i;i=n.json.path();if(!i){return}else if(i.indexOf("pages.")!==0){G.warn("Trying to register page_name_to_id on a non-page",{path:n.json.path()});return}t=I.new_element(n.json);r=t.json.child("name").get();if(r){e=["page_name_to_id",r];return[e,n.json.id()]}});e.register_indexer("page_title",function(){var e,t,r,i;t=I.new_element(n.json);i=t.property("title");r=t.json.child("name").get();if(i.is_static()&&r!=null){i=i.get_static();if(i){e=["page_title",r];return[e,i]}}});e.register_indexer("page_plugin_headers",function(){var e,t,r,i,o,a,s,u,l;i=I.new_element(n.json);if(!i.id()){return}r=["page_plugin_headers",i.id()];t=[];u=n.get_element_types();for(a=0,s=u.length;a<s;a++){e=u[a];o=(l=b.get_element_object(e))!=null?typeof l.element_html_header==="function"?l.element_html_header():void 0:void 0;if(o!==null&&o!==void 0&&o!==""&&ne.call(t,o)<0){t.push(o+"\n")}}return[r,G.json_stringify(t)]})}}t.prototype.get_plugin_headers=function(){var e,t;e=(t=this.json.read_index("page_plugin_headers",this.id()))!=null?t:"[]";return G.json_parse(e)};t.prototype.get_images_for_preload=function(){var e,t,n,r,i,o;e=[];n=function(t){var n,r,i,o,a,s,u,l;i=t.get_width();r=t.get_height();u=(s=[t]).concat.apply(s,I.to_array(t.states()));l=[];for(o=0,a=u.length;o<a;o++){n=u[o];l.push(function(t){var n,o,a,s,u,l,c;l=["background_image","src"];c=[];for(s=0,u=l.length;s<u;s++){o=l[s];n=t.get_static_property(o,true);if(n&&n!=="[object Object]"){a={src:n};if(o==="src"){a.width=i;a.height=r}c.push(e.push(a))}else{c.push(void 0)}}return c}(n))}return l};r=this.find_elements_custom();for(i=0,o=r.length;i<o;i++){t=r[i];if(t._type!=="FileInput"){n(t)}}return e};t.prototype.is_custom_definition=function(){return false};t.prototype.is_page=function(){return true};t.prototype.is_api=function(){return false};t.prototype.is_editor=function(){return this.json.child("is_editor").get()};t.prototype.is_plugin_editor=function(){return this.json.child("is_plugin_editor").get()};t.prototype.is_plugin_editor=function(){return this.json.child("is_plugin_editor").get()};t.prototype.required_js_files=function(){return this.E.required_js_files(this)};t.prototype.required_css_files=function(){return this.E.required_css_files(this)};return t}(c));I.add("CustomDefinition",t=function(e){oe(t,e);function t(e){var n=this;this._type="CustomDefinition";t.__super__.constructor.call(this,e);e.register_indexer("custom_name_to_id",function(){var e,t,r,i;i=n.json.path();if(!i){return}else if(i.indexOf("element_definitions.")!==0){G.warn("Trying to register custom_name_to_id on a non-custom-definition",{path:n.json.path()});return}t=I.new_element(n.json);r=t.json.child("name").get();if(r){e=["custom_name_to_id",G.digest(r)];return[e,{name:r,custom_id:n.json.id()}]}})}t.prototype.is_custom_definition=function(){return true};t.prototype.is_page=function(){return false};t.prototype.is_api=function(){return false};t.prototype.element_type=function(){return this.get_static_property("element_type")};return t}(c));ee=null;O=function(){var e,t,n;if(!ee){ee={};n=E.style_properties;for(e in n){t=n[e];ee[F.shrink(e)]=t}}return ee};s=e("./../lib");V=e("./values");x=e("./custom_elements");e("./workflow");e("./expressions");y=e("./../client_config");w=e("./../editor/css");Y=e("./../webfonts");k=e("./dataops");F=e("./shrink");f=F.S;m=e("./appquery");U=e("./../services");b=e("./../core/core_elements");q=e("./../editor/responsive");M=e("./expressions");v=e("./apptests");B=e("./../core/property_applications")}).call(this)},{"./../client_config":16,"./../core/core_elements":19,"./../core/property_applications":24,"./../db/db":28,"./../editor/css":36,"./../editor/responsive":38,"./../lib":65,"./../services":70,"./../u":72,"./../webfonts":76,"./appquery":51,"./apptests":52,"./custom_elements":53,"./dataops":54,"./expressions":56,"./lang":57,"./shrink":61,"./values":62,"./workflow":63}],56:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,K,J,X,Z=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1},Q={}.hasOwnProperty,ee=function(e,t){for(var n in t){if(Q.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};A=n;U=e("./../u");C=e("./lang");if(U.is_edit_mode()){C.new_expression=function(e,t){return e.smart_cache("expression_"+(typeof t.id==="function"?t.id():void 0),I,t)}}else{C.new_expression=function(e,t){return e.smart_cache("expression",I,t)}}I=function(e,n){var i;if(e.empty()){return new r(e,n)}i=e.child("type").get();if(i){switch(i){case"Empty":return new r(e,n);case"Message":return new c(e,n);case"TextExpression":return new p(e,n);case"GeoAddress":return new o(e,n);default:return new t(e,n,i)}}if(e.raw_type()==="object"){return new f(e,n)}return new s(e,n)};C.current_eval_node=null;if(U.on_server()){C.with_eval_node=function(e,t){return t()}}else{C.with_eval_node=function(e,t){var n;n=C.current_eval_node;C.current_eval_node=e;try{return t()}finally{C.current_eval_node=n}}}C.expression_find_expressions=function(e,t){var n,r,i,o,a,s,u,l,c,f,_,p,h,g,m,v,y,b;n=[];f=e._raw;if(!f||typeof f!=="object"){return n}i=f[d.type];if(i==="Empty"||i==="GeoAddress"){return n}if(!i){_=C.raw_array_node(e);for(o=0,u=_.length;o<u;o++){r=_[o];if(r&&typeof r==="object"&&((p=r[d.type])!=="Empty"&&p!=="GeoAddress")){if(t(r)){n.push(r)}n.push.apply(n,C.expression_find_expressions(r,t))}}}else if(i==="TextExpression"){h=C.raw_children(e,d.entries);for(a=0,l=h.length;a<l;a++){r=h[a];if(r&&typeof r==="object"&&((g=r[d.type])!=="Empty"&&g!=="GeoAddress")){if(t(r)){n.push(r)}n.push.apply(n,C.expression_find_expressions(r,t))}}}else{if(f[d.properties]){m=C.raw_children(e,d.properties);for(s=0,c=m.length;s<c;s++){r=m[s];if(r&&typeof r==="object"&&((v=r[d.type])!=="Empty"&&v!=="GeoAddress")){if(t(r)){n.push(r)}n.push.apply(n,C.expression_find_expressions(r,t))}}}if(i==="Message"&&f[d.args]){r=C.raw_child(e,d.args);if(r&&typeof r==="object"&&((y=r[d.type])!=="Empty"&&y!=="GeoAddress")){if(t(r)){n.push(r)}n.push.apply(n,C.expression_find_expressions(r,t))}}if(f[d.next]){r=C.raw_child(e,d.next);if(r&&typeof r==="object"&&((b=r[d.type])!=="Empty"&&b!=="GeoAddress")){
if(t(r)){n.push(r)}n.push.apply(n,C.expression_find_expressions(r,t))}}}return n};l={};C.evaluate_properties=function(e,t,n,r){var i,o,a,s,u,c,f,d,_,p,h,g;if(e==null){e={}}if(r==null){r=[]}s={};if(t!=null?(p=t.frozen_state)!=null?p.skip:void 0:void 0){t.frozen_state.skip=false;f=true}if(n===C.DETECT_FIELD_NAMES){for(o in e){d=e[o];h=C.evaluate(d,t,null,null),u=h[0],_=h[1];if(_==="reduced"){return l}s[L.expand(o)]=u}}else{for(a in n){i=n[a];if(Z.call(r,a)<0){if(f&&t.frozen_state.should_skip(a)){return}c=L.shrink(a);g=C.evaluate(e[c],t,null,i["default"]),u=g[0],_=g[1];if(_==="reduced"){return l}s[a]=u}}}return s};C.evaluate_json=function(e,t,n,r){return C.evaluate(e._raw(),t,n,r)};C.evaluate=function(e,t,n,r,i){var o;if(e==null){return[r,"null"]}o=e[d.type];if(o){switch(o){case"Empty":return[r,"null"];case"Message":return x(e,t,n,i);case"TextExpression":return S(e,t,n);case"GeoAddress":return b(e,t,n);default:if(o==="InjectedValue"&&t.reduce_mode){return z(e,t,n)}return y(o,e,t,n)}}if(typeof e==="object"){return k(e,t,n)}return[e,j(typeof e)]};C.is_static=function(e){var t,n,r,i,o;if(!e){return true}r=e[d.type];if(r){if(r==="GeoAddress"||r==="Empty"){return true}if(r==="TextExpression"){t=(o=e[d.entries])!=null?o:{};for(n in t){i=t[n];if(!C.is_static(i)){return false}}return true}else{return false}}if(typeof e==="object"){for(n in e){i=e[n];if(!C.is_static(i)){return false}return true}}return true};C.reduce=function(e,t,n){var r,i,o;t=U.extend({},t,{reduce_mode:true});o=C.evaluate(e,t,null,null,"reduce"),r=o[0],i=o[1];if(n){return F(r)}else{return g(r,i)}};C.get_static=function(e){var t;if(e==null){return null}t=e[d.type];if(t){switch(t){case"Empty":return null;case"Message":return null;case"TextExpression":return T(e);case"GeoAddress":return e[d.val];default:return null}}if(typeof e==="object"){return M(e)}return e};b=function(e,t,n){return[e[d.val],"geographic_address"]};S=function(e,t,n){var r,i,o,a,s,u,l,c,f,_,p,h;r=e[d.entries];c=C.raw_to_child_names(r);a=[];s=[];h=false;f=function(e){var n,i,o;o=C.evaluate(r[e],t,null,null),n=o[0],i=o[1];if(i==="reduced"){h=true}else{a.push(W.get(i).cast_to_string(n))}return s.push([n,i])};for(_=0,p=c.length;_<p;_++){l=c[_];f(l)}if(h){o={};o[d.type]="TextExpression";o[d.entries]=function(){var e,t,n,r;r=[];for(e=0,t=s.length;e<t;e++){n=s[e],i=n[0],u=n[1];r.push(g(i,u))}return r}();return[o,"reduced"]}else{return[a.join("","text")]}};T=function(e){var t,n,r,i,o,a;t=e[d.entries];i=C.raw_to_child_names(t);n=[];for(o=0,a=i.length;o<a;o++){r=i[o];n.push(C.get_static(t[r]))}return n.join("")};k=function(e,t,n){var r,i,o,a,s,u,l,c,f;a={};l=false;o={};for(i in e){s=e[i];c=C.evaluate(s,t,null,null),r=c[0],u=c[1];if(u==="reduced"){l=true}a[L.expand(i)]=r;o[i]=[r,u]}if(l){a={};for(i in o){f=o[i],r=f[0],u=f[1];a[i]=g(r,u)}return[a,"reduced"]}else{return[a]}};M=function(e){var t,n,r,i;r={};for(n in e){i=e[n];t=C.get_static(i);r[L.expand(n)]=t}return r};w=function(e,t,n,r,i){var o,a,s;o=function(){var e,r;r=t();e=W.get(n);return e.cast(r)};if(i.frozen_state){if(e&&i.frozen_state.has_key(e)){s=i.frozen_state.get(e)}else{s=o();if(s!=null?s[m.NV_MARKER]:void 0){s=null}if(e){i.frozen_state.set(e,s)}}}else{s=o()}a=r[d.next];if(a!=null){return C.evaluate(a,i,s,null,n)}else{return[s,n]}};P=function(e,t,n,r,i){var o,a;if(e==="and_"&&t===false){a=false;o="sys.bool"}else if(e==="or_"&&t===true){a=true;o="sys.bool"}else{a=n;o="reduced"}if(r!=null){return C.evaluate(r,i,a,null,o)}else{return[a,o]}};x=function(e,t,n,r){var i,o,a,s,u,c,f,_,p,h,v,y,b,x;u=e[d.name];if(e[d.args]!=null){y=C.evaluate(e[d.args],t,null,null),i=y[0],o=y[1]}if(o==="reduced"||r==="reduced"){if((u==="and_"||u==="or_")&&(o!=="reduced"||r!=="reduced")){if(o!=="reduced"){a=F(i);_=n}else{a=F(n);_=i}return P(u,a,_,e[d.next],t)}n=g(n,r);return B(e,t,n)}c=W.get(r);s=c!=null?c.get_message(u):void 0;if(!s||s.is_not_found()){return[null,"null"]}if(typeof s.field_names!=="function"){throw U.error("Message "+u+" on value "+r+" does not have field_names(): "+s.field_names)}f=C.evaluate_properties(e[d.properties],t,s.field_names(),[]);if(f===l){n=g(n,r);return B(e,t,n)}h=m.STATES.Message(n,i,u,f,e);p=(b=(x=s.ret_value())!=null?x._id:void 0)!=null?b:"null";v=function(){return s.fn(n,i,f,e,t)};return w(h,v,p,e,t)};F=function(e){if((e!=null?e[d.type]:void 0)!=="Dehydrated"){return e}else if((e!=null?e[d.next]:void 0)!=null){return e}else{return v.rehydrate_tree(a().db_instance(),e[d.properties][d.val])}};A.create_reduced=g=function(e,t){var n;if(t==="reduced"){return e}else{n={};n[d.type]="Dehydrated";n[d.properties]={};n[d.properties][d.val]=v.dehydrate_tree(e);n[d.properties][d.value_id]=t;return n}};h=function(e,t){var n;e=U.json_deep_copy(e);n=e;while(n[d.next]){n=n[d.next]}n[d.next]=t;return e};B=function(e,t,n){var r,i,o,a,s,u,l,c,f,_,p;i=e[d.name];if(e[d.args]!=null){f=C.evaluate(e[d.args],t,null,null),u=f[0],c=f[1];o=g(u,c)}if(e[d.properties]){a={};_=e[d.properties];for(r in _){l=_[r];p=C.evaluate(l,t,null,null),u=p[0],c=p[1];a[r]=g(u,c)}}s={};s[d.name]=i;s[d.properties]=a;s[d.args]=o;s[d.type]="Message";s=h(n,s);return N(s,e[d.next],t)};R=function(e,t,n){var r,i,o,a,s,u,l,c;if(t[d.properties]){i={};l=t[d.properties];for(r in l){s=l[r];c=C.evaluate(s,n,null,null),a=c[0],u=c[1];i[r]=g(a,u)}}o={};o[d.properties]=i;o[d.type]=e;return N(o,t[d.next],n)};N=function(e,t,n){if(t==null){return[e,"reduced"]}return C.evaluate(t,n,e,null,"reduced")};z=function(e,t,n){var r;r={};r[d.type]="InjectedValue";return N(r,e[d.next],t)};y=function(e,t,n,r){var i,o,s,u,c;i=a().load_plugin("Expression:"+e,true);if(i==null){i=O(e)}o=C.evaluate_properties(t[d.properties],n,i.field_names,[]);if(o===l){return R(e,t,n)}u=i.get_unique_string(o,n.element);s=i.get_runmode_value(t,n,o);c=function(){return i.evaluate(o,n)};return w(u,c,s,t,n)};A.make_partial_expression_evaluator=function(e){var t;t=function(n){var r,i,o,a,s;if(n instanceof c){s=t(n.prior()),r=s[0],i=s[1]}a=U.json_deep_copy(n.json._raw());if(a!=null){delete a[d.next]}try{e.is_in_partial=true;o=C.evaluate(a,e,r,null,i)}finally{e.is_in_partial=false}return o};return t};C.add("Expression",i=function(e){ee(t,e);t.prototype.make_new=C.new_expression;function t(e,n){this.owner=n;t.__super__.constructor.call(this,e);if(!this.owner){throw U.error("expression created without owner")}this._property_owner=this.owner}t.prototype.has_next=function(){return false};t.prototype.has_args=function(){return false};t.prototype.is_empty=function(){return false};t.prototype.get_spot=function(){return"EditableSpot"};t.prototype.get_literal=function(){return null};t.prototype.get_eval_value=function(){return W.get("null")};t.prototype.raw=function(){return this.json.raw()};t.prototype.node_name=function(){return this.json.name()};t.prototype.get_tree_display=function(){return this.display()};t.prototype.element_id=function(){return this.get_static_property("element_id")};t.prototype.pretty_print=function(e){var t;try{return e+this.get_tree_display()}catch(n){t=n;return e+"Error trying to pretty_print "+this.constructor.name+":\n"+t.stack}};t.prototype.context_element=function(){return this.owner.context_element()};t.prototype.parent_expression=function(){var e,t;t=this.json.parent();e=this.owner.path();if(!e){return null}if(t.path()===e){return null}return C.new_expression(t,this.owner)};t.prototype.parent_expressions=function(e){var t,n;n=[];t=this;while(t=t.parent_expression()){n.push(t)}return C.filter_array(e,n)};t.prototype.serialize_args=function(){return[this.json,this.owner]};t.prototype.find_in_editor=function(e,t,n){var r,i=this;r=$.fx.off;$.fx.off=true;return U.run_once(30,function(){return i.parent_expression()},function(o,s){var u,l;if(o){U.warn(o);return}u=function(){$.fx.off=r;if(e){return a().composer.get_owner(i.path(),function(e){return t(e!=null?e.canvas:void 0)},true)}else{return t()}};if(!s){i.owner.find_in_editor(false,u,n);return}l=s.get_spot();if(l==="EditableSpot"){return s.find_in_editor(false,u,n)}else if(l==="SlidableSpot"){return s.find_in_editor(false,function(){var e,t,n;e=U.MakeKey(null,"SlidableSpot owns_key");t=s.path();if(((n=a().SlidablePalette().node_box())!=null?n.path():void 0)!==t){a().composer.clear_owner(t);a().composer.select(t);a().composer.call_on_owner(t,"show");U.wait_for_updates(function(){return e.turn()})}else{e.turn()}return U.WaitFor(e,function(){if(!a().SlidablePalette().is_currently_visible()){return a().SlidablePalette().reveal(u)}else{return U.wait_for_updates(u)}})},n)}else{U.warn("Unrecognized spot type: "+l);return u()}})};t.prototype.find_expressions=function(e){return C.from_raw_array(this.json,C.new_expression,C.expression_find_expressions(C.to_raw(this),C.make_filter(e)))};return t}(C.HasProperties));_=function(e){ee(t,e);function t(){G=t.__super__.constructor.apply(this,arguments);return G}t.prototype.is_static=function(){return true};t.prototype.find_expressions=function(){return C.enhance_array([])};t.prototype.field_names=function(){return{}};return t}(i);C.add("Empty",r=function(e){ee(t,e);function t(){V=t.__super__.constructor.apply(this,arguments);return V}t.prototype.get_static=function(){return null};t.prototype.is_empty=function(){return true};t.prototype.get_eval_value=function(){return W.get("null")};t.prototype.display=function(){return""};t.prototype.type=function(){return"Empty"};return t}(_));j=function(e){switch(e){case"string":return"text";case"boolean":return"sys.bool";case"number":return"number"}};C.add("Literal",s=function(e){ee(t,e);function t(){Y=t.__super__.constructor.apply(this,arguments);return Y}t.prototype.get_static=function(){return this.json.get()};t.prototype.get_literal=function(){return this.json.get()};t.prototype.type=function(){return typeof this.json.get()};t.prototype.get_eval_value=function(){return W.get(j(this.type()))};t.prototype.get_tree_display=function(){var e;e=this.json.get();switch(this.type()){case"string":case"number":return e;case"boolean":if(e){return"yes"}else{return"no"}}};t.prototype.display=function(){var e;e=this.json.get();switch(this.type()){case"string":return"“"+e+"”";case"boolean":if(e){return'"yes"'}else{return'"no"'}break;case"number":return e}};return t}(_));C.add("ObjectLiteral",f=function(e){ee(t,e);function t(){H=t.__super__.constructor.apply(this,arguments);return H}t.prototype.entries=C.run_cache("entries",function(){var e;return C.enhance_array(function(){var t,n,r,i;r=this.json.children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(C.new_expression(e,this.owner))}return i}.call(this))});t.prototype.entry=function(e){return C.new_expression(this.json.child(e),this.owner)};t.prototype.type=function(){return"ObjectLiteral"};t.prototype.pretty_print=function(e){var t,n,r,i,o;if(e==null){e=""}n=[e+"ObjectLiteral:"];o=this.entries();for(r=0,i=o.length;r<i;r++){t=o[r];n.push("\n"+e+"  "+t.json.name());n.push("\n"+t.pretty_print(e+"    ",false))}return n.join("")};t.prototype._process=function(e){var t,n,r,i,o,a;r={};a=this.entries();for(i=0,o=a.length;i<o;i++){t=a[i];n=e(t);r[t.json.name()]=n}return r};t.prototype.properties=function(){return this.entries()};t.prototype.property=function(e){return this.entry(e)};t.prototype.get_static_property=function(e){return this.property(e).get_static()};t.prototype.is_static=function(){var e;return function(){var t,n,r,i;r=this.entries();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];if(!e.is_static()){i.push(e)}}return i}.call(this).length===0};t.prototype.get_static=function(){return M(this.json._raw())};t.prototype.check_for_errors=function(){return{children:this.properties()}};return t}(i));C.add("TextExpression",p=function(e){ee(t,e);function t(){K=t.__super__.constructor.apply(this,arguments);return K}t.prototype.entries=C.run_cache("entries",function(){var e;return C.enhance_array(function(){var t,n,r,i;r=this.json._child(d.entries).children();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(C.new_expression(e,this.owner))}return i}.call(this))});t.prototype.entry=function(e){return C.new_expression(this.json._gchild(d.entries,L.shrink(e)),this.owner)};t.prototype.type=function(){return"TextExpression"};t.prototype.properties=function(){return this.entries()};t.prototype.is_static=function(){var e;return function(){var t,n,r,i;r=this.entries();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];if(!e.is_static()){i.push(e)}}return i}.call(this).length===0};t.prototype.get_static=function(){return T(this.json._raw())};t.prototype.get_tree_display=function(){var e;return function(){var t,n,r,i;r=this.entries();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e.get_tree_display())}return i}.call(this).join("")};t.prototype.display=function(){return this.get_tree_display()};t.prototype.get_eval_value=function(){return W.get("text")};t.prototype.field_names=function(){return{}};t.prototype.check_for_errors=function(e){var t,n,r,i,o,a;a=this.entries();for(i=0,o=a.length;i<o;i++){t=a[i];if(!t.is_empty()){n=t.get_eval_value(e);if(!n.matches(W.stringable)){r="Dynamic data in text boxes must be printable as text, but instead this is ";if(n.display()){r+="a "+n.display()}else{r+="a non-text expression"}e(r,t)}}}return{children:this.entries()}};return t}(i));C.add("LiveExpression",u=function(e){ee(t,e);function t(){J=t.__super__.constructor.apply(this,arguments);return J}t.prototype.has_next=function(){return true};t.prototype.message_set=function(e){return new(a().sets.Messages)(this,this.get_value(),e)};t.prototype.is_static=function(){return false};t.prototype.get_static=function(){return null};t.prototype.get_static_property_fetcher=function(){var e=this;return function(t){return e.get_static_property(t)}};t.prototype.get_tree_display=function(){var e;e=this.display();if(this.has_args()){e+=this.args().get_tree_display()}if(this.has_next()){e+=this.next().get_tree_display()}return e};t.prototype.next=function(){return C.new_expression(this.json._child(d.next),this.owner)};t.prototype.type=function(){return this.json.child("type").get()};t.prototype.get_eval_value=function(e){var t,n;if(this.has_args()){t=this.args();if(!this.get_arg_value().matches(t.get_eval_value())){if(e!=null){e("This argument should be a "+this.get_arg_value().display()+" but right now it is a "+t.get_eval_value().display(),t)}return W.get("null")}}n=this.next();if(!n.is_empty()){return n.get_eval_value(e)}else{return this.get_value()}};t.prototype.check_for_errors=function(e){var t,n,r,i,o,s;r=this.fields();s=[];for(i=0,o=r.length;i<o;i++){n=r[i];if(n.editor){t=a().GenericEditor.get_editor(this,n);s.push(t.type_check(this.display(),e))}else{s.push(void 0)}}return s};return t}(i));O=function(e){return{_fields:function(){return[]},field_names:{},get_unique_string:function(){},evaluate:function(){},get_value:function(){return"null"},display:function(){return"[missing: "+e+"]"},check_for_errors:function(t){return t("Could not find "+e)}}};C.add("DataSource",t=function(e){ee(t,e);function t(e,n,r){t.__super__.constructor.call(this,e,n);this.D=a().load_plugin("Expression:"+r,true);if(this.D==null){this.D=O(r)}this._type=r}t.prototype.field_names=function(){if(!this.D.field_names){throw U.error("missing field_names for datasource "+this._type)}return this.D.field_names};t.prototype._fields=function(){return this.D.fields(this.get_static_property_fetcher(),this)};t.prototype.has_args=function(){return false};t.prototype.get_state_key=function(e,t){return this.D.get_unique_string(this.evaluate_properties(e),e.element)};t.prototype.get_value=function(){return W.get(this.D.get_value(this.get_static_property_fetcher(),this))};t.prototype.display=function(){return this.D.display(this.get_static_property_fetcher(),this)};t.prototype.get_spot=function(){var e,t;return(t=typeof(e=this.D).get_spot==="function"?e.get_spot():void 0)!=null?t:"EditableSpot"};t.prototype.check_for_errors=function(e){var n,r,i,o,s,u,l,c,f,d;t.__super__.check_for_errors.call(this,e);if(this.D.check_for_errors){i=this.D.check_for_errors(this.get_static_property_fetcher(),this);if(typeof i==="string"){i=[i]}f=i!=null?i:[];for(s=0,l=f.length;s<l;s++){r=f[s];e(this.display()+" - "+r,this)}}if(this.get_spot()==="SlidableSpot"){o=[];d=this.fields();for(u=0,c=d.length;u<c;u++){n=d[u];if(a().GenericEditor.get_editor(this,n).condition()){o.push(this.property(n.name))}}}else{o=this.properties()}return{children:o.concat(this.next())}};t.prototype.serialize_args=function(){return[this.json,this.owner,this._type]};t.prototype.is_equal_to=function(e){if(!t.__super__.is_equal_to.call(this,e)){return false}if(this._type!==e._type){return false}return true};return t}(u));D=function(e){return{fn:function(){},ret_value:function(){return W.get("null")},arg_value:function(){return null},spot_data:function(){},field_names:{},_fields:function(){},M:function(){return{}},description:function(){return"[Not found: "+e+"]"},NOT_FOUND:true}};C.add("MessageNode",c=function(e){ee(t,e);function t(e,n){var r,i;t.__super__.constructor.call(this,e,n);this._name=this.json.child("name").get();this._parent_value=this.prior().get_value();this._message=(r=(i=this._parent_value)!=null?i.get_message(this.name()):void 0)!=null?r:D(this._name)}t.prototype.name=function(){return this._name};t.prototype.is_equal_to=function(e){if(!t.__super__.is_equal_to.call(this,e)){return false}if(this._name!==e.name()){return false}if(this._parent_value.id()!==e._parent_value.id()){return false}if(this.get_value().id()!==e.get_value().id()){return false}return true};t.prototype.message=function(){return this._message};t.prototype.get_state_key=function(e,t){var n,r;n=this.args()["eval"](e);r=this.evaluate_properties(e);return m.STATES.Message(t,n,this.name(),r,this.json._raw())};t.prototype.get_value=function(){return this._message.ret_value()};t.prototype.has_args=function(){return this._message.arg_value()!=null};t.prototype.args=function(){return C.new_expression(this.json.child("args"),this.owner)};t.prototype.get_arg_value=function(){return this._message.arg_value()};t.prototype.prior=function(){return C.new_expression(this.json.parent(),this.owner)};t.prototype.get_spot=function(){var e;return(e=this._message.spot_data())!=null?e:"EditableSpot"};t.prototype.field_names=function(){var e;if(!this._message.field_names){throw U.error("message "+this._name+" on  "+((e=this._parent_value)!=null?typeof e.display==="function"?e.display():void 0:void 0)+" is missing field_names")}return this._message.field_names()};t.prototype._fields=function(){return this._message.fields(this.get_static_property_fetcher(),this)};t.prototype.get_display_for_sliding_palette=function(){var e;return(e=this._message.M.description_for_sliding_palette)!=null?e:this.display()};t.prototype.argument_set=function(){var e,t,n,r,i;r=this._message.arg_value();t=(i=this._message.editor)!=null?i:{};e=t["default"];if(t["static"]){return a().sets.EditorOnly(typeof r.get_editor_name==="function"?r.get_editor_name():void 0,e)}if(!r){return a().sets.NullSet()}if(r.matches("sys.bool")){n=null}else{n=r}return a().sets.DataSources(this,r,n,e)};t.prototype.display=function(){return this._message.description(this)};t.prototype.check_for_errors=function(e){if(this._message.NOT_FOUND){e(this.prior().display()+": missing property... please double-check")}else{t.__super__.check_for_errors.call(this,e)}return{children:this.properties().concat(this.next(),this.args())}};t.prototype.set_property=function(e,t){var n,r,i,o;if(typeof(t!=null?t.raw:void 0)==="function"){t=t.raw()}r=this.property(e).raw();if(JSON.stringify(r)===JSON.stringify(t)){return}o=this.owner.id();if(!o){throw U.error("trying to set property on a MessageNode without an owner...")}i=this.path().split(this.owner.path()+".")[1];n=a().changes.Change("SetData",{target_id:o,path:i+".properties."+e,old_value:r,value:t});return n.execute()};return t}(u));C.add("GeoAddressNode",o=function(e){ee(t,e);function t(){X=t.__super__.constructor.apply(this,arguments);return X}t.prototype.is_static=function(){return true};t.prototype.get_address=function(){return E.get_address(this.json.child("val").get())};t.prototype.get_static=function(){return this.json.child("val").get()};t.prototype.get_literal=function(){return this.json.child("val").get()};t.prototype.type=function(){return"GeoAddress"};t.prototype.get_eval_value=function(){return W.get("geographic_address")};t.prototype.get_tree_display=function(){return this.get_address()};t.prototype.display=function(){return this.get_address()};return t}(_));m=e("./dataops");W=e("./values");a=e("./../lib");v=e("./../db/db");E=e("./../geolocation");L=e("./shrink");d=L.S}).call(this)},{"./../db/db":28,"./../geolocation":41,"./../lib":65,"./../tests/testing":71,"./../u":72,"./dataops":54,"./lang":57,"./shrink":61,"./values":62}],57:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C=[].slice,j={}.hasOwnProperty,D=function(e,t){for(var n in t){if(j.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};x=n;A=e("./../u");A.safe_register("./lang/lang",x);x.run_cache=function(e,t){return function(){var n;n=t.call(this);if(A.on_client()&&!u().is_edit_mode()){this[e]=function(){return n}}else{this[e]=t}return n}};x.run_cache_1_param=function(e,t){return function(n){var r,i;r=e+"_run_cache_1_param";if(!this[r]){if(A.on_client()&&!u().is_edit_mode()){i={};this[r]=function(e){if(i[e]==null){i[e]=t.call(this,e)}return i[e]}}else{this[r]=t}}return this[r](n)}};x.all_cache=function(e,t){return function(){var n;n=t.call(this);this[e]=function(){return n};return n}};x.add=function(e,t){var n;x[e]=t;t.prototype.lang_constructor=e;return(n=t.prototype).make_new!=null?(n=t.prototype).make_new:n.make_new=function(e){return new t(e)}};x.AppNode=t=function(){function e(e){this.json=e}e.prototype.is_node=true;e.prototype.toString=function(){return this.lang_constructor+"<"+this.json.path()+">"};e.prototype.toUniqueString=function(){return this.lang_constructor+"<"+this.json.toUniqueString()+">"};e.prototype.app=function(){var e;e=this.json.root();if(e._appnode_application_version_cache==null){e._appnode_application_version_cache=new x.ApplicationVersion(e)}return e._appnode_application_version_cache};e.prototype.id=function(){return this.json.id()};e.prototype.is_equal_to=function(e){return(e!=null?e.toUniqueString():void 0)===this.toUniqueString()};e.prototype.path=function(){return this.json.path()};e.prototype.raw=function(){return this.json.raw()};e.prototype.pre_cache=function(e,t){return this.json.pre_cache(e,t)};e.prototype.read_index=function(){var e,t;e=1<=arguments.length?C.call(arguments,0):[];return(t=this.json).read_index.apply(t,e)};e.prototype.is=function(e){return x.make_filter(e)(this)};e.prototype.exists=function(){return this.json.exists()};e.prototype.ensure_exists=function(){var e;e=this.json.ensure_exists();if(!e){return null}return this};e.prototype.serialize=function(){var e,t,n;if(!this.lang_constructor){throw A.error("missing lang_constructor: "+this.constructor.name)}n=function(e){if(e.is_json){return{type:"json",value:e._path()}}else if(e.is_node){return{type:"node",value:e.serialize()}}else{return{type:"raw",value:e}}};t=function(){var t,r,i,o;i=this.serialize_args();o=[];for(t=0,r=i.length;t<r;t++){e=i[t];o.push(n(e))}return o}.call(this);return{constructor_name:this.lang_constructor,args:t}};e.prototype.serialize_args=function(){return[this.json]};e.prototype.uid=function(){return this.json.uid()};e.prototype.commit=function(){return this.json.get_undostack().commit()};e.prototype.commit_merge=function(){return this.json.get_undostack().commit_merge()};e.prototype.get_comment_node=function(e){if(!this.id()){return}return this.app().comment(this.id(),e)};e.prototype.has_comment=function(e){var t;t=this.get_comment_node(e);return(t!=null?t.exists():void 0)&&t.get()};return e}();x.deserialize=function(e,t){var n,r,i,o,a,s;s=function(t){switch(t.type){case"json":return e.json.by_path(t.value);case"node":return x.deserialize(e,t.value);case"raw":return t.value;default:throw A.error(t.type)}};a=function(){var e,r,i,o;i=t.args;o=[];for(e=0,r=i.length;e<r;e++){n=i[e];o.push(s(n))}return o}();r=a[0];i=a[1];o=a[2];if(a.length>3){A.warn("error deserializing: we have something with more than 3 args: "+t.constructor_name)}return new x[t.constructor_name](r,i,o)};x.DETECT_FIELD_NAMES="DETECT";M={};x.HasProperties=a=function(e){D(t,e);function t(){T=t.__super__.constructor.apply(this,arguments);return T}t.prototype.evaluate_properties=function(e){var t,n=this;t=this.json._child(f.properties);return x.with_eval_node(this,function(){return x.evaluate_properties(t._raw(),e,n.field_names(),typeof n.exclude_properties==="function"?n.exclude_properties():void 0,t._path())})};t.prototype.get_default=function(e){var t,n;if(!this.field_names){throw A.error("does not have field names defined: "+this)}t=this.field_names();if(t===x.DETECT_FIELD_NAMES){return null}return(n=t[e])!=null?n["default"]:void 0};t.prototype.fields=function(e){var t,n,r;n=this.field_names();r=this._fields(e);return function(){var e,i,o;o=[];for(e=0,i=r.length;e<i;e++){t=r[e];o.push(A.extend({},t,n[t.name]))}return o}()};t.prototype._field_data=function(e){var t,n,r,i;i=this.fields();for(n=0,r=i.length;n<r;n++){t=i[n];if(t.name===e){return t}}return{name:e,editor:"NoEditor"}};t.prototype.get_static_property=x.run_cache_1_param("get_static_property",function(e){var t,n,r,i;r=this.json._child(f.properties)._child(S.shrink(e))._raw();if(r!=null){if(typeof r==="object"){switch(r[f.type]){case"Empty":return null;case"TextExpression":return function(){var e,i,o;i=(e=r[f.entries])!=null?e:[];o=[];for(n in i){t=i[n];o.push(t)}return o}().join("");case"GeoAddressNode":return r[S.shrink("val")];default:return r}}else{return r}}else{return(i=this.get_default(e))!=null?i:null}});t.prototype.property=function(e){var t,n,r,i;n=this.json.path_cache()+e;if(A.Fiber){t=(r=A.Fiber)._property_json_cache!=null?(r=A.Fiber)._property_json_cache:r._property_json_cache={}}else{t=M}if(t[n]==null){t[n]=this.json._gchild(f.properties,S.shrink(e))}return x.new_expression(t[n],(i=this._property_owner)!=null?i:this)};t.prototype.eval_property=function(e,t,n,r){var i=this;return x.with_eval_node(this.property(e),function(){return x.evaluate_json(i.json._gchild(f.properties,S.shrink(e)),t,n,r)[0]})};t.prototype.properties=x.run_cache("properties",function(){var e;return x.enhance_array(function(){var t,n,r,i,o;r=this.json._child(f.properties).children();o=[];for(t=0,n=r.length;t<n;t++){e=r[t];o.push(x.new_expression(e,(i=this._property_owner)!=null?i:this))}return o}.call(this))});t.prototype.set_property=function(e,t){var n,r,i;if(typeof(t!=null?t.raw:void 0)==="function"){t=t.raw()}r=this.property(e).raw();if(JSON.stringify(r)===JSON.stringify(t)){return}i=this.id();if(!i){throw A.error("trying to set property on something without an id... should override set property!")}n=u().changes.Change("SetData",{target_id:i,path:"properties."+e,old_value:r,value:t});return n.execute()};return t}(t);x.HasID=o=function(e){D(t,e);function t(e){t.__super__.constructor.call(this,e);e.register_indexer("type_to_path",function(e){var t,n,r;r=e._child(f.type)._raw();if(r){n=e._path();t=["type_to_path",r,A.digest(n)];return[t,n]}})}t.prototype.exists=function(){return this.json.child("id").exists()};t.prototype.check_for_errors=function(e){var t,n,r,i,o,a;r=this.fields();i=[];for(o=0,a=r.length;o<a;o++){n=r[o];t=u().GenericEditor.get_editor(this,n);if(t.type_check(this.display(true),e)){i.push(this.property(n.name))}}return{children:x.enhance_array(i)}};return t}(a);x.filter_array=function(e,t){var n;if(!e){return x.enhance_array(t)}e=x.make_filter(e);return x.enhance_array(function(){var r,i,o;o=[];for(r=0,i=t.length;r<i;r++){n=t[r];if(e(n)){o.push(n)}}return o}())};b=function(){return"Compiled filter: "+this._original};y=function(e,t,n,r,i,o){var a,s,u,l,c,d,_;if(e){if(o._raw){l=x.from_raw(o)}else{l=o}if(!(l instanceof e)){return false}}if(o._raw!=null){d=o._raw;if(t&&t!==d[f.type]){return false}if(n){c=(_=d[f.properties])!=null?_[n]:void 0;if((c!=null?c[f.type]:void 0)==="TextExpression"){c=function(){var e,t;e=c[f.entries];t=[];for(s in e){a=e[s];t.push(a)}return t}().join("")}if(String(c)!==r){return false}}if(i&&d[f.name]!==i){return false}return true}else{u=o.json;if(!u){return false}if(t&&t!==u._child(f.type).get()){return false}if(n){c=u._child(f.properties)._child(n)._raw();if((c!=null?c[f.type]:void 0)==="TextExpression"){c=function(){var e,t;e=c[f.entries];t=[];for(s in e){a=e[s];t.push(a)}return t}().join("")}if(String(c)!==r){return false}}if(i&&u._child(f.name).get()!==i){return false}return true}};w=function(){return true};w.toString=function(){return"Identity filter"};v={};x.make_filter=function(e){var t,n,r,i,o,a,s,u,l;if(!e){return w}if(typeof e==="function"){return e}if(!v[e]){if(e.charAt(0)==='"'){a=e.indexOf('"',1);s=e.substring(1,a);r=e.substring(a+2)}else{n=e.split(".");s=n[0];r=n.slice(1).join(".")}if(r){l=r.split("="),i=l[0],o=l[1];if(i==="name"){u=o;i=null}if(i==="\name"){i="name"}}i=S.shrink(i);if(x[s]){A.warn("Deprecated: filter using class_type: "+e);t=x[s];s=null}v[e]=y.bind(null,t,s,i,o,u);v[e]._type=s;v[e]._original=e;v[e].toString=b}return v[e]};x.to_raw=function(e){var t,n,r,i;t=e.json;i=t._raw();if(i==null){return null}r=t._path();if(e.owner instanceof x.AppNode){n=x.to_raw(e.owner);n.converter=e.owner.make_new;if(!n.converter){throw A.error("Class "+e.owner.constructor.name+" is missing a make_new function")}}return{_raw:i,_path:r,owner:n}};x.from_raw=function(e,t,n){var r,i,o,a;a=n._raw,o=n._path,i=n.owner;r=e.root().by_path(o);if(i!=null){if(!i.converter){throw A.error("bad owner:\n"+JSON.stringify({_raw:a,_path:o,owner:i},null,4))}i=x.from_raw(e,i.converter,i)}return t(r,i)};x.from_raw_array=function(e,t,n){var r;return x.enhance_array(function(){var i,o,a;a=[];for(i=0,o=n.length;i<o;i++){r=n[i];a.push(x.from_raw(e,t,r))}return a}())};x.raw_child=function(e,t){var n,r,i;i=e._raw,r=e._path,n=e.owner;i=i[t];if(!i){return null}r=r+"."+t;return{_raw:i,_path:r,owner:n}};x.set_owner=function(e,t,n){e.owner=t;return t.converter=n};x.raw_children=function(e,t){var n,r,i,o,a,s;s=e._raw,a=e._path,r=e.owner;i=a+"."+t+".";return function(){var e,a,u;a=(e=s[t])!=null?e:{};u=[];for(n in a){if(!j.call(a,n))continue;o=a[n];if(o!=null&&(n!=="length"&&n!==l)){u.push({_raw:o,_path:i+n,owner:r})}}return u}()};x.raw_properties=function(e,t){var n,r,i,o,a;a=e._raw,o=e._path;e.converter=t;r=o+"."+f.properties+".";return function(){var t,o,s;o=(t=a[f.properties])!=null?t:{};s=[];for(n in o){if(!j.call(o,n))continue;i=o[n];if(i!=null&&(n!=="length"&&n!==l)){s.push({_raw:i,_path:r+n,owner:e})}}return s}()};x.raw_array_node=function(e){var t,n,r,i,o,a;a=e._raw,o=e._path,n=e.owner;r=o+".";return function(){var e,o;e=a!=null?a:{};o=[];for(t in e){if(!j.call(e,t))continue;i=e[t];if(i!=null&&(t!=="length"&&t!==l)){o.push({_raw:i,_path:r+t,owner:n})}}return o}()};i=null;h=function(){var e,n,r,o,a,s,u,l,c,f,d;s={};l=["asdf"];for(u in x){n=x[u];if(n&&n.prototype instanceof t){f=n.prototype;for(o in f){r=f[o];if(l[o]==null){s[o]=true}}}}i=e=function(){function e(){this.length=0}e.prototype.is_equal_to=function(e){var t,n,r,i;if((e!=null?e.length:void 0)==null){return false}for(t=r=0,i=this.length;r<i;t=++r){n=this[t];if(!A.compare(n,e[t])){return false}}return true};e.prototype.push=Array.prototype.push;e.prototype.filter=p;e.prototype.toString=function(){return"Enhanced Array: "+this.to_array()};e.prototype.concat=function(){var e,t,n,r,o,a,s,u,l,c;r=1<=arguments.length?C.call(arguments,0):[];n=new i;for(o=0,u=this.length;o<u;o++){t=this[o];n.push(t)}for(a=0,l=r.length;a<l;a++){t=r[a];if(Array.isArray(t)||t instanceof i){for(s=0,c=t.length;s<c;s++){e=t[s];n.push(e)}}else{n.push(t)}}return n};e.prototype.indexOf=Array.prototype.indexOf;e.prototype.to_array=function(){var e,t,n,r;r=[];for(t=0,n=this.length;t<n;t++){e=this[t];r.push(e)}return r};e.prototype.sort=function(e){var t,n,r,o,a;n=new i;a=this.to_array().sort(e);
for(r=0,o=a.length;r<o;r++){t=a[r];n.push(t)}return n};return e}();d=[];for(a in s){c=s[a];d.push(function(e,t){var n;return(n=i.prototype)[e]!=null?(n=i.prototype)[e]:n[e]=function(){var t,n,r,o;t=1<=arguments.length?C.call(arguments,0):[];r=function(){var r,i,o;o=[];for(r=0,i=this.length;r<i;r++){n=this[r];if(n!=null){if(!n[e]){throw A.error("EArray child missing "+e)}o.push(n[e].apply(n,t))}else{o.push(null)}}return o}.call(this);o=new i;return o.concat.apply(o,r)}}(a,c))}return d};p=function(e){return x.filter_array(e,this)};x.enhance_array=function(e){var t,n,r,o;if(!i){h()}n=new i;for(r=0,o=e.length;r<o;r++){t=e[r];n.push(t)}return n};x.to_array=function(e){if(e.to_array){return e.to_array()}else{return e}};x.deep_copy_with_new_ids=function(e,t){var n;n=A.json_deep_copy(e);if(t==null){t={}}g(n,t);x.deep_replace(n,t);return[n,t]};g=function(e,t){var n,r,i,o;if(!e||typeof e!=="object"){return}o=[];for(n in e){i=e[n];if(i&&typeof i==="object"){o.push(g(i,t))}else if(n==="id"||n==="_id"){if(t[i]){console.log("warning with change_all_ids: two objects had the same id: "+i);r=_.uid()}else{t[i]=r=_.uid()}o.push(e[n]=r)}else{o.push(void 0)}}return o};E=function(e){var t;e=S.expand(e);if(e==="page"||e==="id"||e==="custom_event"){return true}t=e.indexOf("_id");if(t!==-1&&(t=e.length-3)){return true}return false};x.deep_replace=function(e,t){var n,r,i;if(!e||typeof e!=="object"){return}i=[];for(n in e){r=e[n];if(r&&typeof r==="object"){i.push(x.deep_replace(r,t))}else if(t[r]!==void 0){if(E(n)){i.push(e[n]=t[r])}else{i.push(console.log("warning: found what looks like an id in a non-whitelisted property. "+S.expand(n)+": "+r))}}else{i.push(void 0)}}return i};x.OBJECT_MARKER=l="__obj_marker__";x.raw_to_child_names=function(e){var t,n,r,i,o,a;if(!e||typeof e!=="object"){o=[]}else{if(Array.isArray(e)){o=function(){var n,r,i;i=[];for(t=n=0,r=e.length;n<r;t=++n){a=e[t];i.push(String(t))}return i}()}else{i=-1;o=[];for(r in e){if(!j.call(e,r))continue;a=e[r];if(!(a!==void 0&&(r!=="length"&&r!==l))){continue}if(i!=null){n=parseInt(r);if(String(n)!==String(r)){i=null}else{i=Math.max(n,i)}}o.push(r)}if(i!=null&&i>-1){o=function(){var e,n;n=[];for(t=e=0;0<=i?e<=i:e>=i;t=0<=i?++e:--e){n.push(String(t))}return n}()}else{o.sort()}}}return o};x.JSONBase=s=function(){function e(){}e.prototype.child_by_path=function(e){var t,n,r,i,o;n=e.split(".");r=this;for(i=0,o=n.length;i<o;i++){t=n[i];if(t){r=r.child(t)}}return r};e.prototype.by_path=function(e){var t,n,r,i,o;n=e.split(".");r=this;for(i=0,o=n.length;i<o;i++){t=n[i];if(t){r=r._child(t)}}return r};e.prototype.child=function(e){return this._child(S.shrink(e))};e.prototype.name=function(){return S.expand(this._name())};e.prototype.path=function(){var e,t;t=this._path();if(!t){return t}return function(){var n,r,i,o;i=t.split(".");o=[];for(n=0,r=i.length;n<r;n++){e=i[n];o.push(S.expand(e))}return o}().join(".")};e.prototype.is_json=true;e.prototype.by_index=function(e,t){var n;n=this.raw_index(e,t);if(n==null){return null}return this.root().by_path(n)};e.prototype.by_id=function(e){var t,n;n=this.raw_index("id_to_path",e);t=this.root();t.pre_cache(n,true);if(n==null){return x.EmptyJSON(this,e)}return t.by_path(n)};e.prototype.read_index=function(){var e,t;e=1<=arguments.length?C.call(arguments,0):[];t=this.raw_index.apply(this,e);if(t!=null){delete t[l]}if(t!=null){delete t.length}return t};e.prototype.children=function(){var e,t,n,r,i;r=this._child_names();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(this._child(e))}return i};e.prototype.child_names=function(){var e,t,n,r,i;r=this._child_names();i=[];for(e=0,t=r.length;e<t;e++){n=r[e];i.push(S.expand(n))}return i};e.prototype.is_equal_to=function(e){return(e!=null?typeof e.toUniqueString==="function"?e.toUniqueString():void 0:void 0)===this.toUniqueString()};e.prototype._raw_to_child_names=x.raw_to_child_names;e.prototype.raw=function(){return S.expand_object(this._raw())};e.prototype.set=function(e){return this._set(S.shrink_object(e))};e.prototype.push=function(e){return this._push(S.shrink_object(e))};e.prototype.pre_cache=function(e,t){var n,r,i,o,a,s;i=this;if(e){s=function(){var t,r,i,o;i=e.split(".");o=[];for(t=0,r=i.length;t<r;t++){n=i[t];if(n){o.push(n)}}return o}();for(o=0,a=s.length;o<a;o++){r=s[o];if(t){i=i._child(r)}else{i=i.child(r)}}}return i.ensure_loading()};return e}();x.EmptyJSON=function(e,t,n){return new r(e,t,n)};r=function(e){D(t,e);function t(e,t,n){this.owner=e;this._id=t;this.search=n}t.prototype.empty=function(){return true};t.prototype.exists=function(){return false};t.prototype._raw=function(){return void 0};t.prototype.raw_type=function(){return typeof void 0};t.prototype.get=function(){return null};t.prototype.id=function(){return this._id};t.prototype.to_id=function(){return this};t.prototype.to_path=function(){return this};t.prototype.toString=function(){var e,t;return"EmptyJSON<"+((e=this._id)!=null?e:"")+((t=this.search)!=null?t:"")+">"};t.prototype.toUniqueString=function(){return this.toString()+"_"+this.owner.toString()};t.prototype.path_cache=function(){return this.toString()+"_"+this.owner.toString()};t.prototype.ensure_exists=function(){return null};t.prototype._path=function(){};t.prototype._name=function(){return""};t.prototype.parent=function(){return null};t.prototype._child=function(e){return x.EmptyJSON(this.owner,null,this.toString()+".child("+e+")")};t.prototype._gchild=function(e,t){return x.EmptyJSON(this.owner,null,this.toString()+".gchild("+e+","+t+")")};t.prototype.pre_cache=function(e,t){return this.owner.pre_cache(e,t)};t.prototype._child_names=function(){return[]};t.prototype.root=function(){return this.owner.root()};t.prototype.application=function(){return this.owner.application()};t.prototype.raw_index=function(){var e,t;e=1<=arguments.length?C.call(arguments,0):[];return(t=this.owner).raw_index.apply(t,e)};t.prototype.register_indexer=function(){};t.prototype.smart_cache=function(e,t,n){return t(this,n)};return t}(x.JSONBase);x.VirtualJSON=function(e,t){return new x.RuntimeJSON(S.shrink_object(t),e.parent(),e._name(),e.root(),A.LUID())};x.RuntimeJSON=c=function(e){D(t,e);function t(e,t,n,r,i){this.cache=e;this._parent=t;this.__name=n;this._app=r;this._unique_key=i!=null?i:"";this.__name=String(this.__name);if(!this._parent){this._app=this;this.__path="";this.__name="";this._id=A.LUID()}else{this.__path=this._parent.__path?this._parent.__path+"."+this.__name:this.__name}this._children={}}t.prototype.toString=function(){return"RuntimeJSON<"+this.__path+">"};t.prototype.toUniqueString=function(){return"RuntimeJSON<"+this.__path+">"+"_"+this._app._id+this._unique_key};t.prototype.path_cache=function(){return"RuntimeJSON<"+this.__path+">"+"_"+this._app._id+this._unique_key};t.prototype.id=function(){var e;return(e=this.cache)!=null?e.id:void 0};t.prototype._name=function(){return this.__name};t.prototype.to_id=function(){return this};t.prototype.to_path=function(){return this};t.prototype.parent=function(){return this._parent};t.prototype._path=function(){return this.__path};t.prototype.get=function(){if(typeof this.cache==="object"){return null}return this.cache};t.prototype.empty=function(){return this.cache==null};t.prototype.exists=function(){return this.cache!=null};t.prototype.ensure_exists=function(){if(this.exists()){return this}else{return null}};t.prototype._child=function(e){var n,r;e=String(e);if((n=this._children)[e]==null){n[e]=new t((r=this.cache)!=null?r[e]:void 0,this,e,this._app)}return this._children[e]};t.prototype._gchild=function(e,n){var r,i;e=String(e);if((r=this._children)[e]==null){r[e]=new t((i=this.cache)!=null?i[e]:void 0,this,e,this._app)}return this._children[e]._child(n)};t.prototype._child_names=function(){if(!this._child_names_cache){this._rebuild_child_names()}return this._child_names_cache};t.prototype._rebuild_child_names=function(){return this._child_names_cache=this._raw_to_child_names(this.cache)};t.prototype.pre_cache=function(e){};t.prototype.raw_index=function(){var e,t,n,r,i;t=1<=arguments.length?C.call(arguments,0):[];n=this._app.cache["_index"];for(r=0,i=t.length;r<i;r++){e=t[r];n=n!=null?n[String(e)]:void 0}return n};t.prototype.root=function(){return this._app};t.prototype.application=function(){return new x.FakeApplication(this._app)};t.prototype.app_version=function(){return this._app.child("app_version").get()};t.prototype._raw=function(){return this.cache};t.prototype.raw_type=function(){return typeof this.cache};t.prototype.register_indexer=function(e,t){var n;if(this._indexers==null){this._indexers={}}this._indexers[e]=t;if((n=this._app)._has_indexers==null){n._has_indexers={}}return this._app._has_indexers[this._path()]=this};t.prototype.smart_cache=function(e,t,n){var r;if(this._smart_cache==null){this._smart_cache={}}if((r=this._smart_cache)[e]==null){r[e]=t(this,n)}return this._smart_cache[e]};t.prototype.uid=function(){var e;if((e=this._app.cache)["counter"]==null){e["counter"]=0}this._app.cache["counter"]++;return A.short_uid(this._app.cache["counter"],-1)};t.prototype._set=function(e){var t,n;t=this.parent();if(t){if((n=t.cache)!=null){n[this._name()]=e}t._child_names_cache=void 0;this.cache=e;return this._child_names_cache=void 0}else{throw A.error("we do not support setting the root object")}};t.prototype.force_index=function(e){var t,n,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,k,S,A,E=this;if(e==null){e=false}n=new x.ApplicationVersion(this._app);_=function(){var e,t,n,r;n=this._app.child("pages").children();r=[];for(e=0,t=n.length;e<t;e++){c=n[e];r.push(x.new_element(c))}return r}.call(this);_.push.apply(_,function(){var e,t,n,r;n=this._app.child("element_definitions").children();r=[];for(e=0,t=n.length;e<t;e++){c=n[e];r.push(new x.CustomDefinition(c))}return r}.call(this));_=x.enhance_array(_);r=_.find_elements();o=_.events().concat(n.api().events());t=o.actions();d={};y=this._app._has_indexers;for(v in y){c=y[v];b=c._indexers;for(f in b){l=b[f];if(f==="issues_list"||f==="issues_sub"){d[f]=(w=this._app.cache._index)!=null?w[f]:void 0;continue}S=(k=l(c))!=null?k:[null,null],s=S[0],u=S[1];if(s!=null){p=d;A=s.slice(0,s.length-1);for(g=0,m=A.length;g<m;g++){i=A[g];p=p[i]!=null?p[i]:p[i]={}}p[s[s.length-1]]=u}}}this._app.cache._index=d;delete this._app._children._index;if(!e){this.force_index(true);if((h=this._app.cache._index).id_to_path==null){h.id_to_path={}}a=function(e){var t,n,r,i,o;if(e._name()==="id"){E._app.cache._index.id_to_path[e.get()]=e.parent()._path()}i=e.children();o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push(a(t))}return o};return a(this._app)}};return t}(s);x.wide_type=function(e,t){if(e==="qwybble_2"&&(t==="custom.airfare_offers"||t==="airfare_offers")){return true}return false};d=e("./application");u=e("./../lib");S=e("./shrink");f=S.S;_=e("./appquery");k=e("./plugins");m=e("./../client_config")}).call(this)},{"./../client_config":16,"./../lib":65,"./../u":72,"./application":50,"./appquery":51,"./plugins":60,"./shrink":61}],58:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d;l=n;d=e("./../u");r=e("./../lang/shrink").S;l.reduce=function(e,t,n,r){var i;if(t!=null){throw new Error("dont support prev")}i={};i.datasources=a.get_basic_datasources();if(n!=null){i.datasources.injected_value=function(){return n};i.datasources.injected_value_value=function(){return r!=null?r:n!=null?n._type():void 0};return u.evaluate(e,i)[0]}else{return u.reduce(e,i,true)}};l.add_next=i=function(e,t){var n;n=e[r.next];if(n){i(n,t)}else{e[r.next]=t}return e};l.create_message=o=function(e,t){var n;n={};n[r.type]="Message";n[r.name]=e;n[r.args]=t;return n};t=e("./../lib");u=e("./lang");a=e("./dataops")}).call(this)},{"./../db/db":28,"./../lang/shrink":61,"./../lib":65,"./../tests/testing":71,"./../u":72,"./dataops":54,"./lang":57}],59:[function(e,t,n){(function(){var t,r,i,o,a,s,u=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};s=e("./../u");a=n;t=null;if(a.load_plugin==null){a.load_plugin=function(n,l){var c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j;if(l==null){l=false}if(!t){i()}if(n.slice(0,7)==="Module:"){return o(n.slice(7))}y=t[n];if(!y){w=e("./../services");if(n.indexOf("Element:")===0){h=n.split("Element:")[1];x=w.get_service_and_type(h),b=x[0],_=x[1];if(!_){k=a.plugins_old_elements_names_mapping;for(b in k){p=k[b];if(!(u.call(p,h)>=0)){continue}_=h;break}}if(_){y=(S=w.get_service(b))!=null?S.get_element(h):void 0}}else if(n.indexOf("Action:")===0){d=n.split("Action:")[1];if(d.indexOf(r.CUSTOM_ACTION_PREFIX)===0){return r.build_custom_action(d.slice(r.CUSTOM_ACTION_PREFIX.length))}A=w.get_service_and_type(d),b=A[0],c=A[1];if(!c){E=a.plugins_old_actions_names_mapping;for(b in E){f=E[b];if(!(u.call(f,d)>=0)){continue}c=d;break}}if(c){y=(M=w.get_service(b))!=null?M.get_action(d):void 0}}else if(n.indexOf("Event:")===0){m=n.split("Event:")[1];T=w.get_service_and_type(m),b=T[0],g=T[1];if(!g){C=a.plugins_old_events_names_mapping;for(b in C){v=C[b];if(!(u.call(v,m)>=0)){continue}g=m;break}}if(m){y=(j=w.get_service(b))!=null?j.get_event(m):void 0}}}if(!y){if(l){return null}throw s.error(a.MISSING_PLUGIN+" "+n)}y.plugin_retrieved_name=n;return y}}a.MISSING_PLUGIN="could not find plugin";a.plugins_old_elements_names_mapping={facebook:["FacebookLikeButton","FacebookPagePlugin"],jtinder:["TinderPile"],multifileupload:["MultiFileInput"],circle_jplayer:["CircleJPlayer"],fullcalendar:["Calendar"],chartjs:["LineBarChart"],slickcarousel:["Carousel"],sceditor:["RichTextInput"],jpanelmenu:["SlidebarMenu"],ionic:["IonicToggle","IonicCheckbox","IonicRange","IonicIcon"],disqus:["DisqusComments"],addtoany:["AddToAnyShareButtons"],star_rating:["StarRating"]};a.plugins_old_actions_names_mapping={facebook:["SendFacebookMessage"],jtinder:["TinderSwipeLeft","TinderSwipeRight"],localizejs:["ChangeLocalizeLanguage"],mailchimp:["AddUserToMailchimpList"],mixpanel:["SendEventToMixpanel","SendUserToMixpanel","SendChargeToMixpanel"],Omnivore:["CreateOmnivoreTicket","AddItemToOmnivoreTicket","MakeThirdPartyPayment"],salesforce:["DSGenerateLOI","DeleteInSalesforce","UpdateFromSalesforce","WriteToSalesforce","SalesforceCreateLoanQuote","SalesforceDoCreditEstimation","SalesforceCreateBankAccount","DS_CSV_Import","DSSaveInvestor","DSGenerateProposal","DSGenerateProposal2"],segment:["SendTrackToSegment","SendPageViewToSegment","IdentifyUserWithSegment"],stripe:["ChargeUser","GetUserCCInfo","ChargeUserWithSavedCC","DefineAsSeller","SubscribeStripePlan","CancelStripePlan"],zapier:["TrigggerZap"],genability:["upsert_account","upsert_usage_profile","upsert_pvwatts_profile","upsert_production_profile","run_savings_analysis"]};a.plugins_old_events_names_mapping={jtinder:["TinderSwipedRight","TinderSwipedLeft"],fullcalendar:["CalendarEventClicked","CalendarDayClicked"],jpanelmenu:["SlidebarMenuOptionClicked"]};r=null;i=function(){var n,i,o,a,u,l,c;n=e("./../core/core_elements");i=e("./../core/core_events");r=e("./../core/core_actions");a=e("./../core/core_values");o=e("./../core/core_expressions");t={};if(!n.all_loaded){throw s.error("got here too soon")}for(u in n){l=n[u];t["Element:"+u]=l}for(u in a){l=a[u];t["Value:"+u]=l}for(u in i){l=i[u];t["Event:"+u]=l}for(u in r){l=r[u];t["Action:"+u]=l}c=[];for(u in o){l=o[u];c.push(t["Expression:"+u]=l)}return c};o=function(e){return s.safe_require("./optional/"+e)}}).call(this)},{"./../core/core_actions":18,"./../core/core_elements":19,"./../core/core_events":20,"./../core/core_expressions":21,"./../core/core_values":23,"./../services":70,"./../u":72}],60:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};u=n;_=e("./../u");t=e("./../lib");_.safe_register("./lang/plugins",u);u.get_all_tags=function(e){if(e==="built_by"){return["Bubble","Third-party developers"]}if(e==="premium"){return["free","premium"]}return d.services.bubble_plugin.get_call("get_plugins_tags").execute(void 0,{tag_type:e})};l=null;a=function(){if(!l){l=d.services.bubble_plugin.get_call("get_edit_mode_plugins_list").execute(void 0,{appname:o.appname(),current_plugins:o.list_plugins_version()})}return l};s=function(e,n){var r;if(!e){return}if(t().is_edit_mode()){return(r=a())!=null?r[e]:void 0}else{return d.services.bubble_plugin.get_call("get_plugin_meta_data").execute(void 0,{plugin_id:e,version:n})}};u.get_plugin=function(e,t){return new i(e,s(e,t))};u.get_all_plugins=function(){var e,t,n;return function(){var r,o,s,u;s=function(){var n,r;n=a();r=[];for(t in n){e=n[t];r.push(new i(t,e))}return r}();u=[];for(r=0,o=s.length;r<o;r++){n=s[r];if(n.can_install()){u.push(n)}}return u}()};u.get_app_plugins=function(){var e,t,n,r;t=[];r=o.list_plugins_version();for(e in r){n=r[e];t.push(u.get_plugin(e,n))}return t};u.get_all_plugins_by_tags=function(e,t){var n,r,i,o,a;o=u.get_all_plugins();a=[];for(r=0,i=o.length;r<i;r++){n=o[r];if(n.matches(e,t)){a.push(n)}}return a};u.get_app_plugins_by_tags=function(e,t){var n,r,i,o,a;o=u.get_app_plugins();a=[];for(r=0,i=o.length;r<i;r++){n=o[r];if(n.matches(e,t)){a.push(n)}}return a};u.is_hardcoded=function(e){return!_.is_UUID(e)};f={};i=function(){function e(e,t){this.id=e;this.data=t}e.prototype._raw=function(){if(!this.data){return null}return this.data};e.prototype.exists=function(){return this.data!=null};e.prototype.display=function(){var e,t;return(e=(t=this._raw())!=null?t.display:void 0)!=null?e:"<missing plugin "+this.id+">"};e.prototype.description=function(){var e,t;return(e=(t=this._raw())!=null?t.description:void 0)!=null?e:""};e.prototype.help=function(){var e,t;return(e=(t=this._raw())!=null?t.help:void 0)!=null?e:""};e.prototype.icon=function(){var e;if(!((e=this._raw())!=null?e.icon:void 0)){return}return c.optimize_image(this._raw().icon+"?ignore_imgix")};e.prototype.has_version=function(){return!u.is_hardcoded(this.id)};e.prototype.versions=function(){var e,t,n,r,i,o,a,s,u;if(!this.has_version()){return{}}t=_.json_parse((a=this.data.history)!=null?a:"[]");n={};s=t.reverse();for(i=0,o=s.length;i<o;i++){u=s[i],r=u.version,e=u.description;n[r]=r+" - "+e}return n};e.prototype.latest_version=function(){var e;if(!this.has_version()){return}return(e=this._raw())!=null?e.last_version:void 0};e.prototype.current_version=function(){return o.get_public_setting("plugins."+this.id)};e.prototype.is_testing=function(){var e;return(e=this._raw())!=null?e.testing:void 0};e.prototype._get_review_hash=function(){return this.id+"_"+this.current_version()};e.prototype.get_current_user_review=function(e){var t=this;if(f[this._get_review_hash()]){return e(f[this._get_review_hash()])}return d.services.bubble_plugin.get_call("get_current_user_review").execute_async(void 0,{plugin_id:this.id,version:this.current_version()}).callback(function(n,r){var i;if(n){_.warn(n);return}i=r!=null?r:{};f[t._get_review_hash()]=i;return e(i)})};e.prototype.submit_review=function(e,t){var n=this;e.plugin_id=this.id;e.version=this.current_version();return d.services.bubble_plugin.get_call("create_plugin_review").execute_async(void 0,e).callback(function(e,r){if(e){_.warn(e);return}f[n._get_review_hash()]=r;return t()})};e.prototype.update_review=function(e,t){var n=this;e.plugin_id=this.id;e.version=this.current_version();return d.services.bubble_plugin.get_call("modify_plugin_review").execute_async(void 0,e).callback(function(e,r){if(e){_.warn(e);return}f[n._get_review_hash()]=r;return t()})};e.prototype.delete_review=function(e,t){var n,r=this;n={review_id:e};return d.services.bubble_plugin.get_call("delete_plugin_review").execute_async(void 0,n).callback(function(e){if(e){_.warn(e);return}delete f[r._get_review_hash()];return t()})};e.prototype.link=function(){var e,t;e=(t=this._raw())!=null?t.link:void 0;if(e!=null&&e.indexOf("http://")!==0&&e.indexOf("https://")!==0){e="http://"+e}return e};e.prototype.tags=function(e){var t,n,r;if(e==="built_by"){if(this._raw().meta_id&&this._raw().meta_id!=="1339510945575x284965680912137020"){return["Third-party developers"]}else{return["Bubble"]}}else if(e==="premium"){if(this.price()>0){return["premium"]}else{return["free"]}}return(t=(n=this._raw())!=null?(r=n.tags)!=null?r[e]:void 0:void 0)!=null?t:[]};e.prototype.count=function(){var e,t;return parseInt((e=(t=this._raw())!=null?t.count:void 0)!=null?e:0)};e.prototype.creator_name=function(){var e,t;return(e=(t=this._raw())!=null?t.creator_name:void 0)!=null?e:"Bubble"};e.prototype.creator_icon=function(){var e,t;return(e=(t=this._raw())!=null?t.creator_icon:void 0)!=null?e:"https://dd7tel2830j4w.cloudfront.net/f1466784355287x118481623474508530/apple_touch_icon_precomposed.png?ignore_imgix"};e.prototype.creator_url=function(){var e;if((e=this._raw())!=null?e.creator_id:void 0){return"https://bubble.is/contributor/"+this._raw().creator_id}};e.prototype.plugin_page_url=function(){var e;if((e=this._raw())!=null?e.meta_id:void 0){return"https://bubble.is/plugin/"+this._raw().meta_id}};e.prototype.published_date=function(){var e;return(e=this._raw())!=null?e.published_date:void 0};e.prototype.all_versions_rating=function(){var e;return(e=this._raw())!=null?e.all_versions_rating:void 0};e.prototype.last_version_rating=function(){var e;return(e=this._raw())!=null?e.last_version_rating:void 0};e.prototype.price=function(){var e;if(this.is_testing()){return 0}return(e=this._raw())!=null?e.price:void 0};e.prototype.documented=function(){var e;return(e=this._raw())!=null?e.documented:void 0};e.prototype.can_install=function(){var e;e=this._raw();if(e==null||e.needs_permission){return o.get_private_setting("plugin_can_install_"+this.id)}else{return true}};e.prototype.matches=function(e,t){if(!this.tags("types").length){return true}if(e&&p.call(this.tags("types"),e)<0){return false}if(t&&t!=="plugins"&&p.call(this.tags("categories"),t)<0){return false}return true};e.prototype.get_service=function(){var e;return(e=d.get_service(this.id,this.current_version()))!=null?e:r};return e}();r={is_missing:function(){return true}};d=e("./../services");o=e("./appquery");c=e("./../core/property_applications")}).call(this)},{"./../core/property_applications":24,"./../lib":65,"./../services":70,"./../u":72,"./appquery":51}],61:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l;s=n;u=e("./../u");i={display_sender_name:"d7",list_id:"li",deleted:"del",email_address:"ea",action_id:"ai",description:"d3",label:"lab",user_name:"un",floating:"f7",formatting_type:"ft",poststripeauth:"p8",image_pressed:"ip",center_background:"cb",image_normal:"i9",image_hover:"ih",descending:"d2",password2:"p2",require_confirm:"rc",choices:"ch","default":"d1",terms:"tz",thing_type:"tt",initial_values:"i2",element_type:"et",email:"em",from:"fr",sort_field:"sf",seperator_width:"sw",useiframe:"u2",columns:"c5",seperator_color:"sc",html:"ht",name_has_been_changed:"n0",fields:"f3",rows:"rs",seperator_style:"ss",body:"b3",subject:"su",constraint_type:"c2",constraints:"co",element_name:"e4",bind:"bi",meta_description:"md",type_to_find:"t5",group_type:"gt",action:"ak",to_change:"tc",stripes:"st",after:"af",changes:"cs",title:"t1",data_source:"ds",additional_values:"av",limit_number_of_characters:"0l",backdrop:"bd",workflows:"wf",margintop:"mt",password:"pw",event_name:"en",app_path:"ap",mandatory:"1m",linktype:"1l",open_in_new_tab:"o9",stripe_height:"sh",contents:"ct",floating_reference:"3f",stretch_or_rescale:"2f",tabs:"ts",custom_id:"ci",icon:"9i",page:"pa",content_format:"cf",display:"d",icon_color:"ic",args:"a",placeholder:"ps",background_gradient_direction:"b4",content:"c1",background_image:"bgi",bggcolor:"bg2",style:"s1",textshadow:"tes",key:"k",elements:"el",event:"e1",value:"v",repeat_background_vertical:"rbv",repeat_background_horizontal:"rbh",underline:"u",italic:"i",vertical_centering:"vc",textshadow_blur:"tsb",textshadow_color:"tsc",textshadow_horizontal:"tsh",textshadow_vertical:"tsv",page_item_type:"pet",readable_field:"rf",bold:"b",__initialized:"in",element_id:"ei",text:"3",line_height:"lh",condition:"c",letter_spacing:"ls",word_spacing:"ws",padding_vertical:"pv",background_gradient_from:"bgf",background_gradient_to:"bgt",padding_horizontal:"ph",current_parent:"cp",font_face:"f",font_alignment:"fa",font_size:"fs",border_width:"bw",states:"s",boxshadow_blur:"bsb",boxshadow_color:"bsc",boxshadow_vertical:"bv",boxshadow_horizontal:"bh",font_color:"fc",bgcolor:"bgc",default_name:"dn",entries:"e",border_color:"bc",is_visible:"iv",background_style:"bas",border_roundness:"br",border_style:"bos",zindex:"z",top:"t",left:"l",width:"w",height:"h",boxshadow_style:"bs",next:"n",name:"nm",properties:"p",type:"x",pages:"p3",element_definitions:"ed"};o={provider:true,actions:true,val:true,id:true,_id:true,value_id:true};s.S={};for(r in i){l=i[r];s.S[r]="%"+l}for(r in o){l=o[r];s.S[r]=r}a={};t="%";for(r in i){l=i[r];if(l.indexOf(t)!==-1||r.indexOf(t)!==-1){throw u.error("cannot use # sign in shrinks: "+r+", "+l)}if(l.toLowerCase()!==l){throw u.error("cannot use upper case in shrinks: "+l)}if(a[l]){throw u.error("Mapping "+l+" to "+r+" but "+l+" is already mapped to "+a[l])}a[l]=r}s.shrink=function(e){if(typeof e!=="string"){return e}if(i[e]){return t+i[e]}if(e.indexOf(t)===0){return t+e}return e};s.shrink_again=function(e){if(typeof e!=="string"){return e}if(i[e]){return t+i[e]}return e};s.expand=function(e){var n;if(typeof e!=="string"){return e}if(e.indexOf(t)!==0){return e}n=e.slice(1);if(a[n]){return a[n]}return n};s.expand_object=function(e){var t;if(!e||typeof e!=="object"){return e}t=Array.isArray(e)?[]:{};for(r in e){l=e[r];t[s.expand(r)]=s.expand_object(l)}return t};s.shrink_object=function(e){var t;if(!e||typeof e!=="object"){return e}t=Array.isArray(e)?[]:{};for(r in e){l=e[r];t[s.shrink(r)]=s.shrink_object(l)}return t}}).call(this)},{"./../u":72}],62:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};y=n;v=e("./../u");v.safe_register("./lang/values",y);t=e("./../lib");o=e("./appquery");c=e("./lang");y.get=function(e){if(e!=null?e.get_message:void 0){return e}return y.get_raw(e)};y.get_raw=c.run_cache_1_param("get_raw",function(e){var t;if(!e){e="null"}t=o.toUniqueString();return l(e,t)});y.list=v.autorun_cache(function(e){var n,r,o,a,u,l;o=function(e){var t;if(typeof e==="function"){t=e();return t.get_message_names&&!t.dont_list}else{return e.get_message_names&&!e.dont_list}};if(!e){return function(){var e;e=[];for(a in s){n=s[a];if(o(n)){e.push(new i(a))}}return e}()}l=e.split(".");u=t().load_plugin("Value:"+l[0]);if(l.length>1){u=u.get(l.slice(1).join("."))}return function(){var t,n,i,o,a;o=(i=u.list())!=null?i:[];a=[];for(t=0,n=o.length;t<n;t++){r=o[t];a.push(y.get(e+"."+r))}return a}()});y.search=function(e){var t,n,r,i;r=[].concat(y.list());for(n in s){t=s[n];if(typeof t.list==="function"){r=r.concat(y.list(n))}}return function(){var t,n,o;o=[];for(t=0,n=r.length;t<n;t++){i=r[t];if(i.matches(e)){o.push(i)}}return o}()};l=v.autorun_cache(function(e,t){return new i(e)});y.missing_id="Missing value:";d=function(e){return{get_message_names:function(){return[]},get_message:function(e){},get_messages:function(){return[]},display:function(){return this.id()},cast:function(){},id:function(){return y.missing_id+" "+e},storable:function(){return false},synonyms:function(){return[]},can_cast_to_string:function(){return false},can_sort:function(){return false},matches:function(){return false}}};i=function(){function e(e){var n,r;this._id=e;r=this._id.split(".");this.V=t().load_plugin("Value:"+r[0]);if(r.length>1){this.V=this.V.get(r.slice(1).join("."));if(!this.V){n=r.length;return d(r.slice(0,+n+1||9e9).join("."))}}else{if(typeof this.V==="function"){this.V=this.V()}}}e.prototype.id=function(){return this._id};e.prototype.get_message=function(e){var t;t=this.V.get_message(e);if(!t){t={description:" [not found: "+e+"]",not_found:true,fn:function(){}}}return new r(e,t)};e.prototype.get_messages=function(){var e,t,n,r,i;r=this.V.get_message_names();i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(this.get_message(e))}return i};e.prototype.call=function(e,t,n,r){return this.get_message(e).fn(t,n,r)};e.prototype.display=function(){return this.V.display()};e.prototype.equals=function(e,t){return this.V.equals(e,t)};e.prototype.get_sample=function(){return this.V.get_sample()};e.prototype.cast=function(e){return this.V.cast(e)};e.prototype.cast_to_string=function(e){if(!this.V.cast_to_string){console.log("trying to cast a "+this.id()+" to string, but no V.cast_to_string function");return""}return this.V.cast_to_string(e)};e.prototype.can_cast_to_string=function(){if(this.V.can_cast_to_string){return this.V.can_cast_to_string()}else{return this.V.cast_to_string!=null}};e.prototype.can_sort=function(){return this.V.can_sort};e.prototype.custom_type=function(){var e;return typeof(e=this.V).custom_type==="function"?e.custom_type():void 0};e.prototype.can_get_JS_object=function(){return this.V.get_JS_object!=null};e.prototype.get_JS_object=function(e){return this.V.get_JS_object(e)};e.prototype.can_JS_to_bubble=function(){return this.V.JS_to_bubble!=null};e.prototype.JS_to_bubble=function(e){return this.V.JS_to_bubble(e)};e.prototype.matches=function(e){return f(e)(this)};e.prototype.synonyms=function(){var e,t;if(this.inner()!=null){return[this.id()].concat(function(){var t,n,r,i,o,a;o=(r=(i=this.inner().V)!=null?i.synonyms:void 0)!=null?r:[];a=[];for(t=0,n=o.length;t<n;t++){e=o[t];a.push("list."+e)}return a}.call(this))}else{return[this.id()].concat((t=this.V.synonyms)!=null?t:[])}};e.prototype.storable=function(){return this.V.storable};e.prototype.bindable=function(){return this.V.bindable};e.prototype.get_editor_name=function(){return this.V.editor_name};e.prototype.inner=function(){var e;return typeof(e=this.V).inner==="function"?e.inner():void 0};return e}();p=function(e){var t;t=function(t){return t.id()!==e};t.display=function(){return"anything but a "+y.get(e).display()};return t};h=function(e){var t;t=function(t){var n,r;return(n=e.id(),b.call(t.synonyms(),n)>=0)||(r=t.id(),b.call(e.synonyms(),r)>=0)};t.display=function(){return"a "+e.display()};return t};_=function(e){var t;t=function(t){var n;n=t.id();return n.indexOf(e)===0&&n[e.length]==="."};t.display=function(){return"any "+y.get(e).display()};return t};f=function(e){if(typeof e.id==="function"){return h(e)}if(!e){throw v.error("blank matcher")}if(typeof e==="string"){if(e[0]==="!"){return p(e.slice(1))}else if(e[e.length-1]==="*"){return _(e.slice(0,e.length-1))}else{return h(y.get(e))}}else{if(!e.display){v.warn("every matcher function must have a display function: "+e);e.display=function(){return"a thing"}}return e}};r=function(){function e(e,t){this._name=e;this.M=t;this.fn=this.M.fn}e.prototype.is_not_found=function(){return this.M.not_found};e.prototype.has_args=function(){return this.M.arg_value!=null};e.prototype.no_arg_no_properties=function(){return!this.has_args()&&this.spot_data()!=="SlidableSpot"};e.prototype.arg_value=function(){if(this.M.arg_value){return y.get(this.M.arg_value)}else{return null}};e.prototype.name=function(){return this._name};e.prototype.ret_value_id=function(){var e;return(e=this.M.ret_value)!=null?e:"null"};e.prototype.ret_value=function(){return y.get(this.M.ret_value)};e.prototype.spot_data=function(){return this.M.spot_data};e.prototype.not_public_plugin=function(){return this.M.not_public_plugin};e.prototype.fields=function(e){var t,n;return(n=typeof(t=this.M).fields==="function"?t.fields(e):void 0)!=null?n:[]};e.prototype.field_names=function(){var e;if(this.M.fields&&!this.M.field_names){throw v.error("missing field_names for message "+this._name)}return(e=this.M.field_names)!=null?e:{}};e.prototype.description=function(e,t){var n;if(typeof this.M.description==="function"){n=this.M.description(e)}else{n=this.M.description}if(t&&n.indexOf("'s ")===0){return n.split("'s ").slice(1).join("'s ")}return n};e.prototype.filter_context=function(e){var t;if(e.privacy_condition){if(this.M.privacy_condition_okay===false){
return false}if(this.M.build_pg_constraint&&(this.M.build_pg_relationship&&this.M.build_pg_r_constraint||this.M.arg_value==null)){return true}if((t=this._name)==="and_"||t==="or_"){return true}return this.is_lookup()}if(!this.M.filter_context){return true}return this.M.filter_context(e)};e.prototype.is_lookup=function(){return this.M.is_lookup};e.prototype.get_lookup_name=function(){if(typeof this.M.is_lookup==="string"){return this.M.is_lookup}else{return this._name}};e.prototype.build_pg_relationship=function(e,t){if(this.M.arg_value==null){return[this._name+" does not take args so no relationship"]}if(!this.M.build_pg_relationship){return["no pg relationship for "+this._name]}else{return[null,this.M.build_pg_relationship(e,t)]}};e.prototype.build_pg_constraint=function(e,t){if(!this.M.build_pg_constraint){return["no pg constraint for "+this._name]}else{return[null,this.M.build_pg_constraint(e,t)]}};e.prototype.build_pg_r_constraint=function(e,t){if(this.M.arg_value==null){return[this._name+" does not take args so no reversed"]}if(!this.M.build_pg_r_constraint){return["no pg reversed constraint for "+this._name]}else{return[null,this.M.build_pg_r_constraint(e,t)]}};return e}();y.lookup_fn=function(e){return function(t,n){var r,i;r=t!=null?typeof t.child==="function"?typeof(i=t.child(e)).get==="function"?i.get():void 0:void 0:void 0;return r}};y.any=function(e){return true};y.any.display=function(){return"any"};y.saveable=function(e){var t,n;return typeof(e!=null?(t=e.custom_type())!=null?t.writeable_fields:void 0:void 0)==="function"&&!(e!=null?(n=e.custom_type())!=null?n.not_writeable:void 0:void 0)};y.saveable.display=function(){return"anything saveable"};y.saveable.get_name=function(){return"saveable"};y.compound=function(e){return e&&e.bindable()};y.compound.display=function(){return"any thing"};y.stringable=function(e){return(e!=null?e.can_cast_to_string():void 0)&&e.id()!=="null"};y.stringable.display=function(){return"anything that can be printed as text"};y.display_matcher=function(e){return f(e).display()};m=e("./../db/sample");u=e("./dataops");a=e("./../client_config");s=e("./../core/core_values");g=e("./plugins")}).call(this)},{"./../client_config":16,"./../core/core_values":23,"./../db/sample":30,"./../lib":65,"./../u":72,"./appquery":51,"./dataops":54,"./lang":57,"./plugins":60}],63:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P={}.hasOwnProperty,R=function(e,t){for(var n in t){if(P.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e},z=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};M=n;w=e("./lang");E=e("./values");A=e("./../u");w.new_workflow_item=function(e){var t,n;if(!e){return null}if(((t=e.parent())!=null?t.name():void 0)==="workflows"){return new w.Event(e)}else if(((n=e.parent())!=null?n.name():void 0)==="api"){return new w.APIEventObject(e)}else{return new w.Action(e)}};w.event_find_expressions=function(e,t){var n,r,i,o,a;i=[];if(!e){return i}t=w.make_filter(t);n=[e];n.push.apply(n,w.raw_children(e,s.actions));for(o=0,a=n.length;o<a;o++){r=n[o];i.push.apply(i,y(r,t))}return i};y=function(e,t){var n,r,i,o,a;r=[];if(!e){return}t=w.make_filter(t);a=w.raw_properties(e,w.new_workflow_item);for(i=0,o=a.length;i<o;i++){n=a[i];if(t(n)){r.push(n)}r.push.apply(r,w.expression_find_expressions(n,t))}return r};b=function(e){return[{name:"breakpoint",caption:"Add a breakpoint in debug mode",editor:"Checkbox",only_edit_mode:true,condition:function(){return!e.is_api()}}]};w.add("WorkflowObject",u=function(e){R(t,e);function t(){j=t.__super__.constructor.apply(this,arguments);return j}t.prototype.make_new=w.new_workflow_item;t.prototype.type=function(){return this.json.child("type").get()};t.prototype.id=function(){return this.json.id()};t.prototype.is_api=function(){var e;return(e=this.root())!=null?e.is_api():void 0};t.prototype.pretty_print=function(e,t){var n,r,i,o,a,s,u,l;if(e==null){e=""}if(t==null){t=true}o=[];if(t){o.push("\n")}o.push(e);try{n=this.display()}catch(c){a=c;true}if(n==null){n=this.type()}o.push((this.is_action()?"Action ":"Event ")+this.id()+": "+n);l=this.properties();for(s=0,u=l.length;s<u;s++){i=l[s];o.push("\n"+e+"  "+i.json.name()+":");o.push("\n"+i.pretty_print(e+"    ",false))}r=this.next();if(r){o.push(e+"\n\n          ↓\n\n");o.push(r.pretty_print(e,false))}if(t){o.push("\n")}return o.join("")};t.prototype.find_my_expressions=function(e){return w.from_raw_array(this.json,w.new_expression,y(w.to_raw(this),e))};t.prototype.root=function(){var e,t;return(e=this.event())!=null?(t=e.owner())!=null?t.root():void 0:void 0};t.prototype.my_element=function(){var e,t;t=this.element_id();if(t){e=f.element(t);return e}else{return null}};t.prototype.element_id=function(){return this.json.smart_cache("element_id",function(e){return e._child(s.properties)._child(s.element_id).get()})};t.prototype.new_action=function(e,t){var n;t=w.RAW.copy(t,e).new_data;n=(new a).changes.Change("CreateAction",{parent_id:this.id(),id:e,data:t});return n.execute()};t.prototype.set_name=function(e){return this.set_property("name",e)};t.prototype.mandatory_sections=function(){return null};t.prototype.property_sections=function(){return[{name:void 0}]};t.prototype.find_in_editor=function(e,t){var n=this;return A.run_once(30,function(){return n.root()},function(r,i){return i!=null?i.find_in_editor(false,function(){$(h.WORKFLOW_TAB).click();return A.wait_for_updates(function(){a().action_canvas.current_folder("__all");a().action_canvas.select(n.id());return A.wait_for_updates(function(){a().action_editor.edit_current_element();return A.wait_for_updates(function(){if(e){return t(a().action_canvas.key_to_token[n.id()])}else{return t()}})})})}):void 0})};return t}(w.HasID));k=function(e){return{_fields:function(){return[]},field_names:{},display:function(){return"[missing: "+e+"]"},register:function(){}}};M.event_colors=["grey","blue","red","green","orange","purple","cyan","brown"];_={grey:"Gray"};v={};D=M.event_colors;for(T=0,C=D.length;T<C;T++){l=D[T];v[l]=(O=_[l])!=null?O:A.toTitleCase(l)}w.add("GenericEvent",o=function(e){R(t,e);function t(e){var n,r,i=this;e=e.to_id();t.__super__.constructor.call(this,e);n=this.type();if(n){this.E=a().load_plugin("Event:"+n,true)}if(!this.E){this.E=k(n)}if(this.E.fields&&!this.E.field_names){throw A.error("missing field_names for "+n)}this._field_names=(r=this.E.field_names)!=null?r:{};this._field_names.condition={};if(m._use_issue_checker()){e.register_indexer("issues_list",function(){var e,t,n,r;r=w.new_workflow_item(i.json);e=r.id();if(e==null){return}n=d.check_issues(r);t=["issues_list",e];return[t,A.json_stringify(n)]})}}t.prototype.find_expressions=function(e){return w.from_raw_array(this.json,w.new_expression,w.event_find_expressions(w.to_raw(this),e))};t.prototype.is_action=function(){return false};t.prototype.exclude_properties=function(){return["condition"]};t.prototype.display=function(e){var t,n,r;if(this.E.never_show_condition){e=true}r=this.get_static_property("name");if(r&&typeof r==="string"){n=r}else{n=this.E.display(this)}if(e){return n}t=this.property("condition").get_tree_display();return n+(t?" and "+t:"")};t.prototype.next=function(){var e;e=this.json.child("actions").child(0);if(e.exists()){return w.new_workflow_item(e)}else{return null}};t.prototype.all_next=function(e){var t;return w.filter_array(e,function(){var e,n,r,i;r=this.json.child("actions").children();i=[];for(e=0,n=r.length;e<n;e++){t=r[e];i.push(w.new_workflow_item(t))}return i}.call(this))};t.prototype.get_next_json=function(){var e;e=this.json.child("actions");return e.child(this.json.children().length)};t.prototype.actions=function(e){return this.all_next(e)};t.prototype.event=function(){return this};t.prototype.context_element=function(){var e;return(e=this.my_element())!=null?e:this.owner()};t.prototype.owner=function(){var e,t;e=(t=this.json.parent())!=null?t.parent():void 0;if(e){return w.new_element(e)}};t.prototype.evaluate_properties_promise=function(e){var t=this;return A.run_once(30,function(){return{condition:t.check_condition(e)}})};t.prototype.check_condition=function(e){return this.eval_property("condition",e,null,true)};t.prototype.register=function(e){var t;t={element:e};return this.E.register(this,e,this.evaluate_properties(t))};t.prototype.field_names=function(){return A.extend(this._field_names,{event_color:{"default":"grey",only_edit_mode:true},wf_folder:{only_edit_mode:true}})};t.prototype._fields=function(){var e;e=[];if(this.E.fields){e.push.apply(e,this.E.fields(this))}e.push.apply(e,[{name:"event_color",caption:"Event color",editor:"Dropdown",set:a().sets.Object(v),optional:true},{name:"wf_folder",caption:"Workflow folder",editor:"Dropdown",set:a().sets.WFFolders(this.root()),optional:true,on_change:function(e){if(a().action_canvas.current_folder()!=="__all"){return a().action_canvas.current_folder(e)}}},{name:"condition",caption:"Only when",editor:"Basic",value:"sys.bool",optional:this.E.condition_not_optional?false:true,editor_value:"null"}]);e.push.apply(e,b(this));return e};t.prototype["delete"]=function(){var e;e=(new a).changes.Change("RemoveEvent",{root_id:this.root().id(),id:this.id(),data:this.json.raw()});return e.execute()};t.prototype.check_for_errors=function(e){var n,r;if(typeof(r=this.E).check_for_errors==="function"){r.check_for_errors(this,e)}n=t.__super__.check_for_errors.call(this,e).children;return{children:n.concat(this.all_next())}};t.prototype.condition=w.run_cache("condition",function(){return w.new_expression(this.json._child(s.properties)._child(s.condition),this)});return t}(u));w.add("Event",i=function(e){R(t,e);function t(e){var n=this;t.__super__.constructor.call(this,e);e.register_indexer("redirect_on_server",function(){var e,t,r,i;t=w.new_workflow_item(n.json);if(t.can_server_side_redirect()&&((i=t.root())!=null?i.is_page():void 0)){r=n.json._path();e=["redirect_on_server",t.root().name(),g.id_safe(r)];return[e,r]}})}t.prototype.can_server_side_redirect=function(){var e;if(!this.E.can_redirect){return false}e=this.all_next();if(e.length!==1){return false}return e[0].can_server_side_redirect()};t.prototype.server_side_redirect=function(e){var t;if(!this.E.server_side_redirect()){return false}if(!this.check_condition(e)){return false}t=this.all_next()[0];if(t.property("condition").json.raw()==null){return true}if(t.eval_property("condition",e,null,true)){return true}return false};t.prototype.check_for_errors=function(e){var n,r,i;n=function(){var e,t,n,i;n=S.get_app_services();i=[];for(e=0,t=n.length;e<t;e++){r=n[e];i.push(r.name)}return i}();if(this.E.is_plugin&&(i=this.E.service,z.call(n,i)<0)){e(this.display()+": You're using this event but haven't installed the plugin "+S.get_service(this.E.service).display())}return t.__super__.check_for_errors.call(this,e)};return t}(o));w.add("APIEventObject",t=function(e){R(t,e);function t(){I=t.__super__.constructor.apply(this,arguments);return I}t.prototype.owner=function(){return new w.API(this.json.parent())};t.prototype.get_parameters=function(){var e,t,n,r,i,o,a,s;if(this.get_static_property("parameter_def")==="auto"){e=A.json_parse((o=this.get_static_property("data_type"))!=null?o:"{}").is_list;return[{key:"_wf_request_data",value:"api_wf_data."+this.id(),is_list:e}]}else{t=this.property("parameters");n=[];s=(a=typeof t.entries==="function"?t.entries():void 0)!=null?a:[];for(r=0,i=s.length;r<i;r++){l=s[r];n.push({key:l.get_static_property("key"),optional:l.get_static_property("optional"),value:l.get_static_property("value"),is_list:l.get_static_property("is_list")})}return n}};t.prototype.is_exposed=function(){return this.get_static_property("expose")};t.prototype.creates_session=function(){return this.actions("SignUp").concat(this.actions("LogIn")).length>0};t.prototype.return_data_actions=function(){return this.actions("APIReturnData")};t.prototype.wf_name=function(){var e;return(e=this.get_static_property("wf_name"))!=null?e.toLowerCase():void 0};t.prototype.get_value=A.autorun_cache(function(){var e,t,n,r,i,o;t={};e={calls:{}};n=A.json_parse((o=this.get_static_property("data_type"))!=null?o:"{}").types;e.calls[this.id()]={types:n};c.get_values_from_call("api_event",e,t);for(i in t){r=t[i];r.name=i;r.full_name="api_wf_data."+i}return t});t.prototype.can_be_used_in_bulk=function(e){var t,n,r,i,o,a,s,u,l;u=["SendEmail","SendConfirmationEmail","SendPasswordResetEmail","SendICSFileEmail"];for(a=0,s=u.length;a<s;a++){t=u[a];if(this.actions(t).length){return{response:false,message:"Sends an email"}}}if(this.return_data_actions().length){return{response:false,message:"Returns some data"}}if(this.creates_session()){return{response:false,message:"Creates a session"}}i=this.get_parameters();if(i.length===0){return{response:false,message:"No parameter"}}if(i.length>1){return{response:false,message:"More than one parameter"}}l=i[0],r=l.key,o=l.value,n=l.is_list;if(o!==e||n){return{response:false,message:"Parameter isn't of the right type"}}return{response:true}};t.prototype.check_for_errors=function(e){var n,r,i,o,a;n=this.wf_name();if(n!=null){a=f.api().events();for(i=0,o=a.length;i<o;i++){r=a[i];if(r.id()!==this.id()){if(n===r.wf_name()){e(this.display(true)+": You're using the same name for more than one endpoint")}}}}return t.__super__.check_for_errors.call(this,e)};return t}(o));x=function(e){return{field_names:{},fields:function(){return[]},display:function(){return"[missing: "+e+"]"}}};w.add("Action",r=function(t){R(n,t);function n(e){var t,r;e=e.to_id();n.__super__.constructor.call(this,e);t=this.type();if(t){this.A=a().load_plugin("Action:"+t,true)}if(!this.A){this.A=x(t)}if(!this.A.field_names){throw A.error("Missing field names for "+t)}this._field_names=(r=this.A.field_names)!=null?r:{};this._field_names.condition={}}n.prototype.is_action=function(){return true};n.prototype.can_server_side_redirect=function(){var e;return typeof(e=this.A).can_redirect==="function"?e.can_redirect(this):void 0};n.prototype.server_side_redirect=function(e){return this.A.server_side_redirect(this,e)};n.prototype.find_expressions=function(e){return w.from_raw_array(this.json,w.new_expression,y(w.to_raw(this),e))};n.prototype.safe_to_send=function(){return!this.A.do_not_send_result_to_client};n.prototype.return_value=function(){var e,t,n;e=(n=typeof(t=this.A).return_value==="function"?t.return_value(this):void 0)!=null?n:"null";return E.get(e)};n.prototype.requires_server=function(e){var t,n,r,i,o,a;if(e==null){e={}}if(this.A.server_method!=null){return true}if((o=this.type())==="TriggerCustomEvent"||o==="TriggerCustomEventFromReusable"){n=f.event(this.get_static_property("custom_event"));if(!e[n.id()]){e[n.id()]=true;a=n.actions();for(r=0,i=a.length;r<i;r++){t=a[r];if(t.requires_server(e)){return true}}}}return false};n.prototype.server_method=function(){return this.A.server_method};n.prototype.exclude_properties=function(){var e;return(e=this.A.exclude_properties)!=null?e:[]};n.prototype.terminate_server_workflow=function(){var e;return(e=this.A.terminate_server_workflow)!=null?e:this.A.server_method_resume!=null};n.prototype.server_method_resume=function(){return this.A.server_method_resume};n.prototype.display=function(e){var t;t=this.get_static_property("name");if(t&&typeof t==="string"){return t}else{return this.A.display(this,e)}};n.prototype.use_injected_datasource=function(e){if(this.A.use_injected_datasource){return this.A.use_injected_datasource(this,e)}else{return[false,true]}};n.prototype.get_injected_value=function(e){var t;return typeof(t=this.A).get_injected_value==="function"?t.get_injected_value(this,e):void 0};n.prototype.get_injected_display=function(e){var t;return typeof(t=this.A).get_injected_display==="function"?t.get_injected_display(this,e):void 0};n.prototype.next=function(){var e,t,n;e=parseInt(this.json.name());t=(n=this.json.parent())!=null?n.child(e+1):void 0;if(t!=null?t.exists():void 0){return w.new_workflow_item(t)}else{return null}};n.prototype.all_next=function(e){var t,n,r,i,o,a;n=parseInt(this.json.name());a=this.json.parent();if(!a){return[]}o=this.json.parent().children().length;i=function(){var e,r,i;i=[];for(t=e=r=n+1;r<=o?e<o:e>o;t=r<=o?++e:--e){i.push(a.child(t))}return i}();return w.filter_array(e,function(){var e,t,n;n=[];for(e=0,t=i.length;e<t;e++){r=i[e];n.push(w.new_workflow_item(r))}return n}())};n.prototype.get_next_json=function(){var e,t;e=parseInt(this.json.name());return(t=this.json.parent())!=null?t.child(e+1):void 0};n.prototype.previous=function(){var e,t,n;e=parseInt(this.json.name());if(e===0){return this.event()}t=(n=this.json.parent())!=null?n.child(e-1):void 0;if(!(t!=null?t.exists():void 0)){return null}return w.new_workflow_item(t)};n.prototype.event=function(){var e;return w.new_workflow_item((e=this.json.parent())!=null?e.parent():void 0)};n.prototype.context_element=function(){var e;return(e=this.event())!=null?e.context_element():void 0};n.prototype.check_for_errors=function(e,t){var r,i,o,a,s;if(this.A.ignore_issue_checker){return}o=typeof(a=this.A).check_for_errors==="function"?a.check_for_errors(this,e,t):void 0;if(o===true){return}r=function(){var e,t,n,r;n=S.get_app_services();r=[];for(e=0,t=n.length;e<t;e++){i=n[e];r.push(i.name)}return r}();if(this.A.is_plugin&&(s=this.A.service,z.call(r,s)<0)){e(this.display()+": You're using this action but haven't installed the plugin "+S.get_service(this.A.service).display())}return n.__super__.check_for_errors.call(this,e)};n.prototype.field_names=function(){return this._field_names};n.prototype._fields=function(){var t;t=[];if(!this.A.fields){console.log("type: "+this.type());console.log(e("util").inspect(this.A))}t.push.apply(t,this.A.fields(this));t.push({name:"condition",caption:"Only when",editor:"Basic",value:"sys.bool",optional:true,editor_value:"null",dont_show_default_value:true});t.push.apply(t,b(this));return t};n.prototype.get_data_to_refresh=function(e,t){if(this.A.data_to_refresh==null){return}if(e.condition){return this.A.data_to_refresh(this,e,t.element)}};n.prototype.evaluate_properties=function(e){var t,r,i;r=n.__super__.evaluate_properties.call(this,e);i=this.A.pre_evaluate_properties?this.A.pre_evaluate_properties(r,this,e):r;t=this.property("condition").json.raw();if(t==null){i.condition=true}return i};n.prototype.evaluate_properties_promise=function(e){var t,n,r,i,o,s=this;if(this.A.fall_back_to_server&&((i=(o=a().workflow["debugger"])!=null?o.workflow_mode:void 0)!=="slow"&&i!=="step_by_step")){r=A.Promise(null,"property evaluation");if(e.server_workflow_completed||this.find_expressions("Search").length>0||this.find_expressions("GetDataFromAPI").length){r.reject(A.error("no local evaluation"))}else{try{n=A.CurrentAutoRun;A.CurrentAutoRun={invalidate:function(){},add_sub:function(){}};r.resolve(this.evaluate_properties(e))}catch(u){t=u;r.reject(t)}finally{A.CurrentAutoRun=n}}return r}return A.run_once(30,function(){return s.evaluate_properties(e)})};n.prototype.can_fall_back_to_server=function(){return this.A.fall_back_to_server};n.prototype.evaluate_properties_client_side=function(e){if(!(this.A.run||this.A.data_to_refresh)){return A.Promise(null)}return this.evaluate_properties_promise(e)};n.prototype.run=function(e,t,n){var r=this;if(!this.A.run){n();return}return t.callback(function(t,i){if(t){if(r.A.fall_back_to_server){e.get_server_outcome(r,n)}else{n(t)}return}try{if(i.condition||r.A.handle_condition_internally){return r.A.run(r,i,e,n)}else{return n()}}catch(o){t=o;return n(t)}})};n.prototype.resume=function(e,t){var n;if(this.A.resume){try{return this.A.resume(this,e,t)}catch(r){n=r;return t(n)}}else{return t()}};n.prototype["delete"]=function(){var e,t;if(!this.exists()){return}t=this.json.raw();e=(new a).changes.Change("RemoveAction",{parent_id:this.previous().id(),id:this.id(),data:t});return e.execute()};return n}(u));m=e("./elements");a=e("./../lib");p=e("./../client_config");f=e("./appquery");h=e("./../editor/css");S=e("./../services");s=e("./shrink").S;g=e("./../db/db");d=e("./apptests");c=e("./../apiconnectorbase")}).call(this)},{"./../apiconnectorbase":3,"./../client_config":16,"./../db/db":28,"./../editor/css":36,"./../lib":65,"./../services":70,"./../u":72,"./appquery":51,"./apptests":52,"./elements":55,"./lang":57,"./shrink":61,"./values":62,util:302}],64:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};u=n;c=e("./u");c.safe_register("./languages",u);l=e("./tests/testing");i=e("./lang/appquery");a=e("./db/db");i=e("./lang/appquery");r=e("./lib");d={};s=function(e){var t;if(!d[e]||c.running_test()){t=[{key:"language_text",constraint_type:"equals",value:e.toLowerCase()}];d[e]=r().db_instance().find("custom.language",t).get_children(0,1)[0]}return d[e]};u.available_languages=function(){var e,t,n;if(c.on_client()){t=function(){var t,r;t=window.language_data;r=[];for(e in t){n=t[e];r.push(e)}return r}();return t}else{return u.run_in_language_context(function(){var t;t=r().db_instance().find("custom.language",[]).all();return function(){var n,r,i;i=[];for(n=0,r=t.length;n<r;n++){e=t[n];if(e.child("language_text").get()!=null){i.push(e.child("language_text").get())}}return i}()})}};u.get_languages_data=function(){if(c.on_client()){return window.language_data}return u.run_in_language_context(function(){var e,t,n,i,o;t={};n=r().db_instance().find("custom.language",[]).all();for(i=0,o=n.length;i<o;i++){e=n[i];t[e.child("language_text").get()]={caption:e.child("caption_text").get(),iso_code:e.child("iso_text").get(),is_rtl:e.child("rtl_boolean").get(),deprecated:e.child("deprecated_boolean").get()}}return t})};u.get_runmode_language_data=function(e){if(c.on_client()){return window.language_data}return u.run_in_language_context(function(){var t,n;n={};t=s(e);n[t.child("language_text").get()]={iso_code:t.child("iso_text").get(),is_rtl:t.child("rtl_boolean").get()};return n})};u.get_user_language_field=function(){var e,t,n;e=r().app();t=e.get_public_setting("language_field");if(t){n=e.custom_type("user").field(t);if(n.exists()){return t}}return null};o=null;u.app_language=function(e){var t,n,a,s,l,f;t=function(e){if(e==="portugese"){return"portuguese"}return e};if(r().is_edit_mode()){return t(i.get_public_setting("app_language"))}a=(s=r().location)!=null?typeof s.get_query==="function"?(l=s.get_query())!=null?(f=l.lang)!=null?f.toLowerCase():void 0:void 0:void 0:void 0;if(a&&_.call(u.available_languages(),a)>=0){return t(a)}n=function(){var t,n,o,a,s,l;t=r().app();a=u.get_user_language_field();if(a!=null){try{s=(l=r().current_user().child(a).get())!=null?l.toLowerCase():void 0}catch(f){o=f;if(!c.not_ready_key(o)){throw o}}if(s&&_.call(u.available_languages(),s)>=0){return s}}if(i.get_public_setting_node("app_language").get_static()||!e){n=t.get_public_setting("app_language")}if(n&&_.call(u.available_languages(),n)>=0||n==="portugese"){return n}if(!e){return"en_us"}};if(c.on_client()){if(!o){o=t(n())}return o}else{return t(n())}};t={YES:"yes_text",NO:"no_text"};u.get_text=function(e,n){var i,o,a,l;i=u.app_language();a=r().app().get_public_setting("text."+i+"."+e+"."+n);if(c.on_client()){o=a;if(o==null){o=(l=window.translation_data[i][e])!=null?l[n]:void 0}return o}return u.run_in_language_context(function(){var u,l,f,d,p,h,g,m,v,y;p=s(i);if(e==="BUILT_IN"&&n==="DATE_FORMAT"){f=p.child("day_names_text").get();h=p.child("month_names_text").get();l={dayNames:f.split(","),monthNames:h.split(",")};o=l}else if(e==="BUILT_IN"){o=p.child(t[n]).get()}else{o=a;if(o==null){g=r().db_instance().find("custom.application_message",[{key:"plugin_text",constraint_type:"equals",value:e},{key:"code_text",constraint_type:"equals",value:n}]).get_children(0,1);u=g[0];if(u!=null){g=r().db_instance().find("custom.translation",[{key:"application_message_custom_application_message",constraint_type:"equals",value:u},{key:"language_custom_language",constraint_type:"equals",value:p}]).get_children(0,1);if(g.length===1){o=g[0].child("value_text").get()}else{o="Sorry! Translation missing";if(!c.running_test()){c.warn("Could not find translation",{plugin:e,name:n,language:i},"warn")}}}}}if(o==null){m=["test_app","test_app2"];if(e==="USER_TEXTS"){o="";if(r().app().app_version==="test"){o="No translation"}}else{d=s("en_us");if(d!=null){u=r().db_instance().find("custom.application_message",[{key:"plugin_text",constraint_type:"equals",value:e},{key:"code_text",constraint_type:"equals",value:n}]).get_children(0,1);if(u!=null){v=r().db_instance().find("custom.translation",[{key:"application_message_custom_application_message",constraint_type:"equals",value:u},{key:"language_custom_language",constraint_type:"equals",value:d}]).get_children(0,1)[0];if(v!=null){o=v.child("value_text").get()}else{o="No translation"}}else{o="No translation"}}else{o="No translation";if(!c.running_test()){c.warn("No translation available for",{language:i})}}}if(e!=="USER_TEXTS"&&(y=r().app().appname(),_.call(m,y)<0)){c.warn("Text missing for plugin",{plugin:e,name:n,language:i},"warn")}}return o})};u.get_app_text=function(){return r.extend({ignore_privacy_rules:function(){return true}},function(){var e,t,n,i,o,a,s,u;a=r().db_instance().find("custom.application_message",[]).all();e={};for(s=0,u=a.length;s<u;s++){i=a[s];o=i.child("plugin_text").get();n=i.child("code_text").get();t=i.child("caption_text").get();if(e[o]==null){e[o]={}}e[o][n]=t}return e})};u.get_iso_code=function(e){if(e==null){return"en_US"}if(c.on_client()){return window.language_data[e].iso_code}return u.run_in_language_context(function(){var t,n;n=s(e);t=n!=null?n.child("iso_text").get():void 0;if(!t&&!c.running_test()&&!c.on_server()){c.warn("missing ISO CODE "+e)}return t!=null?t:"en_US"})};u.is_rtl=function(e){var t;if(c.on_client()){return(t=window.language_data[e].is_rtl)!=null?t:false}return u.run_in_language_context(function(){var t,n;t=s(e);return(n=t!=null?t.child("rtl_boolean").get():void 0)!=null?n:false})};u.delete_user_text=function(e){var t,n,r,o;i.set_setting(true,"user_text_ids."+e,null);o=u.available_languages();for(n=0,r=o.length;n<r;n++){t=o[n];i.set_setting(true,"text."+t+".USER_TEXTS."+e,null)}return i.commit()};u.get_language_data=function(e){if(c.on_client()){return window.translation_data[e]}else{throw new Error("Cannot call get_language_data on server side")}};f=null;u.get_all_languages_translations=function(){var e;if(f){return f.block()}f=c.Promise(null,"getting_translations");try{return u.run_in_language_context(function(){var e,t,n,i,o,a,s,l,c,d,_,p,h;e=r().db_instance().find("custom.application_message",[]).all();l=r().db_instance().find("custom.translation",[]).all();t=u.available_languages();a={};for(p=0,h=l.length;p<h;p++){i=l[p];s=i.child("application_message_custom_application_message").get().child("plugin_text").get();n=i.child("application_message_custom_application_message").get().child("code_text").get();c=i.child("value_text").get();o=i.child("language_custom_language").get().child("language_text").get();if(a[o]==null){a[o]=u.add_built_ins(i.child("language_custom_language").get())}if((d=a[o])[s]==null){d[s]={}}if((_=a[o][s])[n]==null){_[n]=c}}a=JSON.stringify(a);f.resolve(a);setTimeout(function(){return f=null},5*60*1e3);return a})}catch(t){e=t;f=null;throw e}};u.get_language_data_with_plugins=function(e,t){if(e==null){e="en_us"}return u.run_in_language_context(function(){var n,i,o,a,l,f,d,_,p,h,g,m;t.push("CORE");a=s(e);if(a==null){throw c.error("No result found from custom.language for "+e,{app_language:e})}n=r().db_instance().find("custom.application_message",[{key:"plugin_text",constraint_type:"in",value:t}]).all();d=r().db_instance().find("custom.translation",[{key:"language_custom_language",constraint_type:"equals",value:a},{key:"application_message_custom_application_message",constraint_type:"in",value:n}]).all();l={};l[e]=u.add_built_ins(a);for(g=0,m=d.length;g<m;g++){o=d[g];f=o.child("application_message_custom_application_message").get().child("plugin_text").get();i=o.child("application_message_custom_application_message").get().child("code_text").get();_=o.child("value_text").get();if((p=l[e])[f]==null){p[f]={}}if((h=l[e][f])[i]==null){h[i]=_}}return l})};u.add_built_ins=function(e){var t,n,r,i,o,a;if(e==null){throw c.error("Language node is null for add_built_ins")}t={};r=e.child("language_text").get();a=e.child("yes_text").get();o=e.child("no_text").get();n=e.child("day_names_text").get();i=e.child("month_names_text").get();t={BUILT_IN:{YES:a,NO:o,DATE_FORMAT:{dayNames:n.split(","),monthNames:i.split(",")}}};return t}}).call(this)},{"./db/db":28,"./lang/appquery":51,"./lib":65,"./tests/testing":71,"./u":72}],65:[function(e,t,n){(function(){var n,r,i,o,a,s,u,l,c;s=e("./u");s.safe_register("./lib",r);n={app:"wrap",load_plugin:"function",appname:"wrap",app_version:"wrap",db_instance:"wrap",current_user:"wrap",current_user_id:"wrap",scope:"wrap",log:"function",is_edit_mode:"wrap",test_prod:"wrap",http_request:"function",values:"object",app_domain:"function",app_plan:"function",location:"object",element:"object",workflow:"object",pageparam:"object",user:"object",phonegap:"object",app_language:"function",get_text:"function",show_error_to_user:"function",visual_edit:"object",edit_canvas:"object",action_editor:"object",action_canvas:"object",data_editor:"object",data_canvas:"object",styles_editor:"object",styles_canvas:"object",logs_editor:"object",plugin_editor:"object",plugin_canvas:"object",settings_editor:"object",settings_canvas:"object",property_editor:"object",type_editor:"object",composer:"object",SlidablePalette:"function",ImagePalette:"function",appchange:"object",GenericEditor:"function",changes:"object",sets:"object",get_session_id:"function",current_user_rights:"function",visual_edit_is_ready:"object",app_indicator:"function",request:"object",history:"object",bubble_hostname:"wrap",full_url:"wrap",canonical_uri:"wrap",protocol:"wrap",hostname:"wrap",temp_db:"wrap",ignore_privacy_rules:"wrap",is_api:"function",api_version:"function",request_cache:"object",KeyValueDB:"function",emailservice:"object",workflow_lib:"object",fileupload:"object"};o=function(e){return e.toString!=null?e.toString:e.toString=function(){var t,r,i,o,a;o=["Lib Object {"];o.push("");o.push("Settings:");t=function(t){return o.push("    "+t+": "+(typeof e[t]==="function"?e[t]():void 0))};t("is_edit_mode");t("appname");t("app_version");r=s.extend({},n);o.push("");o.push("Available:");for(i in e){a=e[i];delete r[i];o.push("    "+i)}o.push("");o.push("Missing:");for(i in r){a=r[i];o.push("    "+i)}o.push("");o.push("}");return o.join("\n")}};l=function(e){return function(){return e}};u=function(e){var t,r,i,o;for(r in e){i=e[r];if(r!=="toString"){switch(n[r]){case"function":if(typeof i!=="function"){throw s.error("expected function for "+r+" but got "+i)}break;case"wrap":if(typeof i!=="function"){e[r]=l(i)}break;case"object":if(typeof i!=="object"){throw s.error("expected object for "+r+" but got "+i)}break;default:if(n[r]==null){throw s.error("Trying to validate a lib and found an invalid key: "+r)}throw s.error("Unrecognized contents entry for "+r+": "+n[r])}}}if(e.appname!=null&&((o=s.Fiber)!=null?o.current:void 0)!=null){t=typeof e.appname==="function"?e.appname():void 0;if(t!=null){if(!s.Fiber.current.fiber_appname||s.Fiber.current.fiber_appname==="meta"){return s.assign_fiber_ownership(t,typeof e.app_version==="function"?e.app_version():void 0)}}else{return s.Fiber.current.fiber_appname=null}}};if(s.Fiber!=null){t.exports=function(){var e,t,n;return(e=(t=s.Fiber)!=null?(n=t.current)!=null?n._running_lib:void 0:void 0)!=null?e:c}}else{t.exports=function(){return c}}r=t.exports;s.safe_register("./lib",r);i=s.MakeKey(null,"lib_ready_key");c=null;r.set_global_lib=function(e){u(e);o(e);c=e;return i.turn()};r.extend_global=function(e){var t,n;t=r();n=s.extend({},t,e);return r.set_global_lib(n)};r.wait_for_lib=function(e){
return s.WaitFor(i,e)};a=function(e,t){var n,r,i,o,a;if((r=s.Fiber)!=null?r.current:void 0){n=(i=s.Fiber)!=null?(o=i.current)!=null?o._running_lib:void 0:void 0;s.Fiber.current._running_lib=e}else{n=c;c=e}try{return t()}finally{if((a=s.Fiber)!=null?a.current:void 0){s.Fiber.current._running_lib=n}else{c=n}}};r.with_lib=function(e,t){u(e);o(e);return a(e,t)};r.extend=function(e,t){var n,i;n=r();if(!n){return r.with_lib(e,t)}u(e);i=s.extend({},n,e);return a(i,t)}}).call(this)},{"./u":72}],66:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c;a=n;l=e("url");o=e("./client_config");c=e("./util");u=e("./u");s=e("querystring");u.safe_register("./locations",a);a.DEFAULT_VERSION=t="live";a.TEST_VERSION=i="test";a.Location=r=function(){function e(e){this.base_url=e}e.prototype.get_pieces=function(){var e,n,r,i,a;i={};n=this.parsed_url();r=function(){var t,r,i,o;i=n.pathname.split("/");o=[];for(t=0,r=i.length;t<r;t++){e=i[t];if(e!==""){o.push(e)}}return o}();if(o.apps_domain&&u.ends_with(n.hostname,"."+o.apps_domain)){i.appname=n.hostname.slice(0,n.hostname.lastIndexOf("."+o.apps_domain));i.use_apps_domain=true}else if(o.apps_domain&&n.hostname===o.apps_domain){throw u.error({statusCode:302,headers:{Location:"https://"+c.get_meta_hostname()}})}else if(c.is_meta_hostname(n.hostname)&&r[0]==="site"){i.use_site_path=true;i.appname=r[1];r=r.slice(2)}else{i.domain=n.hostname}if(((a=r[0])!=null?a.indexOf("version-"):void 0)===0){i.app_version=r[0].split("version-")[1];i.version_explicit=true;r=r.slice(1)}else{i.version_explicit=false;i.app_version=t}i.path=r;return i};e.prototype.is_production=function(e){if(this.parsed_url().hostname!==c.get_meta_hostname_for_app(e)){return false}return true};e.prototype.format_pieces=function(e,n){var r,i,a,s,l,f,d,_,p;r=(f=n!=null?n.protocol:void 0)!=null?f:this.parsed_url().protocol;r+="//";if(e.domain){r+=e.domain}else if(o.apps_domain&&!e.use_site_path){r+=e.appname+"."+o.apps_domain}else{r+=(d=e.meta_hostname)!=null?d:c.get_meta_hostname(this.parsed_url().hostname);r+="/site/";r+=e.appname}a=e.version_explicit;if(a!=="default"&&a!==void 0&&a!==null&&a!==true&&a!==false){throw u.error("unrecognized version explicit: "+a)}if(a===true||a==="default"&&e.app_version!==t){r+="/version-"+e.app_version}p=(_=e.path)!=null?_:[];for(s=0,l=p.length;s<l;s++){i=p[s];r+="/"+i}return r};e.prototype.protocol=function(){return this.parsed_url().protocol};e.prototype.get_base_for_meta=function(e){var t,n,r;n=this.parsed_url();t=(r=e!=null?e.protocol:void 0)!=null?r:n.protocol;t+="//";t+=c.get_meta_hostname(n.hostname);if(n.port){t+=":"+n.port}return t};e.prototype.get_server_base=function(e){var t;t=this.get_pieces();delete t.path;return this.format_pieces(t,e)+"/"};e.prototype.get_page_url=function(e,t,n){var r;r=this.get_server_base()+e;if(t&&!u.is_empty(t)){r+="?"+s.stringify(t)}if(n){r+="#"+n}return r};e.prototype.get_page=function(){var e;return(e=this.get_pieces().path[0])!=null?e:"index"};e.prototype.parsed_url=function(){return l.parse(this.base_url,true)};e.prototype.my_location=function(){return this.base_url};e.prototype.get_query=function(){return this.parsed_url().query};e.prototype.get_hash=function(){var e;return(e=this.parsed_url().hash)!=null?e.slice(1):void 0};e.prototype.get_page_thing_id=function(){var e,t,n,r;e=this.get_pieces().path;if(e[1]!=null){n=e[1];t=n.split("-");return t[t.length-1]}return(r=this.get_query())!=null?r.id:void 0};return e}()}).call(this)},{"./client_config":16,"./u":72,"./util":74,querystring:285,url:299}],67:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y;g=e("./u");u=n;y={};u.on=function(e,t){if(!y[e]){y[e]=[];s(e)}return y[e].push(t)};p=null;h=null;u.get_server_time_offset=function(e){var t;o();t=function(){var n;if(d()&&p==null){n=Date.now();p=function(t){var r,i;i=Date.now();r=Math.round((n+i)/2);e(t-r);p=null;return h=null};h=function(){p=null;setTimeout(t,100);return h=null};return c.send("ts")}else{return setTimeout(t,100)}};return t()};m=false;c=null;f=false;d=function(){return f&&c.readyState===1};l=0;a=function(){var e,t;if(!window.WebSocket){console.log("No window.WebSocket class defined: real time updates are disabled");return}if(typeof h==="function"){h()}f=false;if(r.notifier_port){e=r.notifier_host+":"+r.notifier_port}else{e=r.notifier_host}c=new window.WebSocket("wss://"+e);c.onclose=function(e){setTimeout(a,l*l*1e3);l++;if(l===10){return g.warn("notifier_client: socket closed after 10 retries",{last_error:g.nice_print_error(t),close_code:e!=null?e.code:void 0,close_reason:e!=null?e.reason:void 0})}};t=null;c.onerror=function(e){t=e;return console.log("notifier_client.coffee: got error from socket: "+e.stack)};c.onopen=function(){var e;return c.send((e="s "+r.notifier_domain)!=null?e:g.error("no notifier domain set"))};return c.onmessage=function(e){var t,n,r,i,o,a,s,u,d,h,m;i=e.data;if(i==="ok"){if(!f){c.send("a "+function(){var e,t,n;n=[];for(e=0,t=_.length;e<t;e++){a=_[e];n.push(a)}return n}().join(" "));f=true;return l=0}}else if(i.slice(0,2)==="c "){i=i.slice(2);o=i.indexOf(" ");if(o===-1){g.warn("could not parse notifier message: "+i);return}a=i.slice(0,o);r=i.slice(o+1);h=(d=y[a])!=null?d:[];m=[];for(s=0,u=h.length;s<u;s++){t=h[s];try{m.push(t(r))}catch(v){n=v;m.push(g.warn(n))}}return m}else if(i.slice(0,3)==="ts "){return typeof p==="function"?p(parseInt(i.slice(3))):void 0}else{return g.warn("unrecognized message from notifier: "+i)}}};_=[];o=function(){if(!m){m=true;return a()}};t=function(e){o();if(d()){c.send("a "+e)}return _.push(e)};s=function(e){if(r.notifier_host){return t(e)}else{return v.get_notification_root("notifier").callback(function(t,n){var r,o;if(t){g.warn(t);return}o=n.child(i.id_safe(e));r=true;return o.on("value",function(n){var i,o,a,s,u,l;if(r){r=false;return}o=n.val();u=y[e];l=[];for(a=0,s=u.length;a<s;a++){i=u[a];try{l.push(i(o))}catch(c){t=c;l.push(g.warn(t))}}return l})})}};v=e("./db/workflow_firebase");i=e("./db/db");r=e("./client_config")}).call(this)},{"./client_config":16,"./db/db":28,"./db/workflow_firebase":32,"./u":72}],68:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l;s=e("./u");l=function(e,t){var n;if(t.inset==null){t.inset=""}n=""+t.horizontal+"px "+t.vertical+"px "+t.blur+"px "+t.spread+"px "+t.color+" "+t.inset;return e.css({"-webkit-box-shadow":n,"-moz-box-shadow":n,"box-shadow":n})};r=function(e){var t;t=e.data("__outline_stack");if(!t){t=[];e.data("__outline_stack",t)}return t};o=function(e,t){return r(e).push(t)};a=function(e,t){var n,i,o,a,u,l;i=r(e);o=function(){var e,r,o;o=[];for(e=0,r=i.length;e<r;e++){n=i[e];if(n.key===t){o.push(n)}}return o}();l=[];for(a=0,u=o.length;a<u;a++){n=o[a];l.push(s.array_remove(i,n))}return l};i=function(e){var t,n,i,o,a,s;t=null;n=-2;s=r(e);for(o=0,a=s.length;o<a;o++){i=s[o];if(i.priority>n){n=i.priority;t=i}}return t};u=function(e){var n;n=i(e);return t(e,n)};t=function(e,t){var n;if((n=!(t!=null?t.box_shadow_properties:void 0))!=null?n:false){return e.css({"-webkit-box-shadow":"none","-moz-box-shadow":"none","box-shadow":"none"})}else{return l(e,t.box_shadow_properties)}};n.add_outline=function(e,t,n,r,i,s,l,c){var f;if(!e){console.log("called add_outline without a div");return}if(i===void 0){f=r}else{f={horizontal:r,vertical:i,blur:s,spread:l,color:c}}a(e,t);o(e,{key:t,priority:n,box_shadow_properties:f});return u(e)};n.remove_outline=function(e,t){if(!e){return}a(e,t);return u(e)};n.get_default_shadow=function(e){var t,n,i,o;if(!e){throw s.error("called get_default_shadow without a div")}o=r(e);for(n=0,i=o.length;n<i;n++){t=o[n];if(t.key==="default"){return t.box_shadow_properties}}}}).call(this)},{"./u":72}],69:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w={}.hasOwnProperty,x=function(e,t){for(var n in t){if(w.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e},k=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};_=n;h=e("./u");o=e("./apiconnectorbase");c=e("./external");t=e("./lib");a=e("./lang/appquery");p=e("./core/property_applications");u=e("./core/core_actions");l=e("./core/core_elements");g=e("./lang/values");m=e("./core/widgets");d=e("./geolocation");f=/function\(([\w,\s?]*)\)/;_.create_code=function(e,t,n){var r,i,o,a,s,u;try{u=(s=e!=null?e.match(f):void 0)!=null?s:[],o=u[0],a=u[1];r=e.split(o).slice(1).join(o);r=r.split("{").slice(1).join("{").split("}").slice(0,-1).join("}");if(n){r=n(r)}return new Function(a,r)}catch(l){i=l;t();return null}};_.get_keys=function(e,t,n){var r,i,a,s,u,l,c,f,d,_,p,g,m,v,y,b,w,x,k,S,A,E;u={};switch(e!=null?e.auth:void 0){case"private_key_url":case"private_key_header":h.extend(u,{appsecret:{caption:"API Key",type:"secure"}});break;case"oauth2_pw":case"basic_auth":h.extend(u,{appid:{caption:"Username",type:"client_safe"},appsecret:{caption:"Password",type:"secure"}});break;case"jwt":h.extend(u,{iss:{caption:"Iss (account email)",type:"client_safe"},private_key:{caption:"Private key (between -----BEGIN RSA PRIVATE KEY----- and -----END RSA PRIVATE KEY-----)",type:"secure",editor:"MultilineTextBox"}});break;case"oauth2_custom":b=(v=e.calls)!=null?(y=v.token_call)!=null?y.body_params:void 0:void 0;for(a in b){s=b[a].key;l={};l["token_call_body_params_"+a]={caption:s+" (token call)",type:"secure"};h.extend(u,l)}break;case"oauth2_user":h.extend(u,{appid:{caption:"App ID/API Key",type:"client_safe"},appsecret:{caption:"App Secret",type:"secure"}})}w=t!=null?t.params:void 0;for(a in w){s=w[a].key;l={};l["header_"+a]={caption:s+" (headers)",type:"client_safe"};h.extend(u,l)}h.extend(u,n);x=["shared_headers","shared_params"];for(_=0,g=x.length;_<g;_++){d=x[_];k=e!=null?e[d]:void 0;for(f in k){c=k[f];if((c!=null?c.visibility:void 0)==="secret"&&c.key){u[d+"_"+f]={caption:c.key+" "+o.user_friendly_parameter_names[d],type:"secure"}}}}S=e!=null?e.calls:void 0;for(i in S){r=S[i];if(r.initialized&&i!=="token_call"){A=["url_params","headers","params","body_params"];for(p=0,m=A.length;p<m;p++){d=A[p];E=r[d];for(f in E){c=E[f];if((c!=null?c.visibility:void 0)==="secret"&&c.key){u[i+"_"+d+"_"+f]={caption:r.name+" - "+c.key+" "+o.user_friendly_parameter_names[d],type:"secure"}}}}}}return u};b={};y={};v={};i=function(e,t,n,r,i){var o,a;o=e+"_"+t+"_"+n+"_"+(i!=null?typeof i.__original==="function"?(a=i.__original())!=null?typeof a._id==="function"?a._id():void 0:void 0:void 0:void 0);if(b[o]){if(typeof r==="function"){r(null,b[o])}return}if(y[e]==null){y[e]=[]}y[e].push({fileName:t,contents:n,callback:r,attach_to:i});return s(e)};s=function(e){var t,n,r,i,o,a,u,l;if(!v[e]&&y[e].length){u=y[e][0],o=u.fileName,r=u.contents,n=u.callback,t=u.attach_to;a=e+"_"+o+"_"+r+"_"+(t!=null?typeof t.__original==="function"?(l=t.__original())!=null?typeof l._id==="function"?l._id():void 0:void 0:void 0:void 0);i=function(){y[e]=y[e].slice(1);if(y[e].length<50){v[e]=false;return s(e)}else{return setTimeout(function(){v[e]=false;return s(e)},1e3*y[e].length*100)}};if(b[a]){if(typeof n==="function"){n(null,b[a])}return i()}else{v[e]=true;return m.upload_file({contents:r},void 0,function(e){var n,r,i;if(t){r=typeof t.__original==="function"?(i=t.__original())!=null?typeof i._id==="function"?i._id():void 0:void 0:void 0;if(!r){n=h.error("Trying to attach an upload to a non Bubble thing");e(n);throw n}else{return e(null,{attach_to:r})}}else{return e(null,{})}},function(t){b[e+"_"+o+"+"+r]=t;if(typeof n==="function"){n(null,t)}return i()},void 0,function(e){if(typeof n==="function"){n(e)}return i()},void 0,o)}}};_.PluginService=r=function(e){x(n,e);n.prototype.handle_request_failures=o.handle_request_failures;n.prototype.dynamic_calls=true;n.prototype.get_error_message=o.get_error_message;function n(e,t,n){var r;this.name=e;this.version=t;this.raw=n;this.human=(r=this.human)!=null?r:this.get_api().human}n.prototype.response_to_data=function(e,t,r,i){var o,a;if(r==null){r="json"}o=n.__super__.response_to_data.call(this,e,t,r,i);if(i!=null?i.get_headers:void 0){a=t.headers;return{body:o,headers:a}}return o};n.prototype.get_api=function(){var e,t,n,r,i,o,a,s,u,l;if(!this._processed_raw_api){this._processed_raw_api=h.deep_copy((s=this.raw.plugin_api)!=null?s:{});n=this.name.split("_current")[0];r=new RegExp(n,"g");u=this._processed_raw_api.calls;for(t in u){e=u[t];l=["types","data_container"];for(o=0,a=l.length;o<a;o++){i=l[o];if(e[i]&&typeof e[i]==="string"){if(this.version==="current"&&i==="types"){e[i]=e[i].replace(r,this.name)}e[i]=h.json_parse(e[i])}}}}return this._processed_raw_api};n.prototype.has_html_header=function(){var e,t;return(e=(t=this.get_html_header())!=null?t.snippet:void 0)!==null&&e!==void 0&&e!==""};n.prototype.get_html_header=function(){return this.raw.html_header};n.prototype.get_keys=function(){return _.get_keys(this.get_api(),this.get_html_header(),this.raw.shared_keys)};n.prototype.authenticator=function(){var e,t,n,r,i,a=this;e=this.get_api();if((r=e.auth)===null||r===void 0||r==="none"){t=new c.NoAuth}if((i=e.auth)==="private_key_url"||i==="private_key_header"){if(e.token_param_name){e.token_param_name=e.token_param_name}else{if(e.auth==="private_key_url"){e.token_param_name="private_key"}else{e.token_param_name="Authorization"}}t=new c.PrivateKey(o.get_private_key_auth_params(e))}if(e.auth==="basic_auth"){t=new c.BasicAuth}if(e.auth==="oauth2_pw"){t=new c.Oauth2PWFlow(o.get_oauth2_pw_auth_params(e))}if(e.auth==="oauth2_custom"){t=new c.Oauth2Custom}if(e.auth==="jwt"){t=new c.JWT(o.get_jwt_auth_params(e))}if(e.auth==="oauth2_user"){n=o.get_oauth2_user_auth_params(e);h.extend(n,{_id:this.name});t=new c.Oauth2(n)}t._service=this;t._display=e.human;t.add_shared_params_and_headers=function(t){return o.add_shared_params_and_headers(e,t,a.name,function(e,t){if(t.visibility==="secret"){return a.get_key("shared_headers_"+e)}else{return t.value}},function(e,t){var n;if(t.visibility==="secret"){return n=this.get_key("shared_params_"+e)}else{return n=t.value}})};return t};n.prototype.dynamic_calls=true;n.prototype.public_values=function(){var e,t,n,r,i,o,a,s;r=[];e=this.get_api();a=e.calls;for(n in a){t=a[n];if(t.publish_as==="data"&&t.initialized){s=t.types;for(i in s){o=s[i];r.push(i)}}}return r};n.prototype.values=function(){var e,t;t={};e=this.get_api();if(e.auth==="oauth2_user"){t["oauth_profile"]=new c.StructValue("Profile "+e.human,{id:{path:e.id_path!=null?e.id_path.split("."):void 0},email:{path:e.email_path!=null?e.email_path.split("."):void 0}})}o.get_values_from_call(this.name,e,t);return t};n.prototype.calls=h.autorun_cache(function(){var e,t,n,r,i,o,a,s;r={};e=this.get_api();i=this.name;if(e.auth==="oauth2_user"){r["oauth_user_data_call"]=o=function(t){x(n,t);function n(){a=n.__super__.constructor.apply(this,arguments);return a}n.prototype.human=e.human;n.prototype._must_proxy=true;n.prototype.value_id="api."+i+".oauth_profile";n.prototype.build=function(t,n){var r;r=e.oauth_user_data_call;return{path:r}};return n}(c.Call)}s=e.calls;for(n in s){t=s[n];r[n]=t;r[n].api_human=e.human;r[n].api_id=this.name}return r});n.prototype.get_call_class=h.autorun_cache(function(e){var t;t=this.calls()[e];if(e==="oauth_user_data_call"){return t}return o.get_call_from_raw(e,t)});n.prototype._get_sorted_list=function(e){var t,n,r,i,o,a,s;o=[];i=0;a=this.get_api().calls;for(r in a){n=a[r];if(!(n.publish_as===e&&n.initialized)){continue}o.push({call_id:r,rank:(s=n.rank)!=null?s:i});i++}o.sort(function(e,t){if(e.rank<t.rank){return-1}else{return 1}});return function(){var e,n,r;r=[];for(e=0,n=o.length;e<n;e++){t=o[e];r.push(t.call_id)}return r}()};n.prototype.public_calls=function(){return this._get_sorted_list("data")};n.prototype.action_calls=function(){return this._get_sorted_list("action")};n.prototype.user_calls=function(){var e,t;t=[];e=this.get_api();if(e.auth==="oauth2_user"){t.push("oauth_user_data_call")}return t};n.prototype.oauth_providers=function(){var e,t;t=[];e=this.get_api();if(e.auth==="oauth2_user"){t.push({id:this.name,display:e.human})}return t};n.prototype.base_url=function(){return""};n.prototype._get_processed_elements_raw=function(){if(!this._processed_raw_elements){this._processed_raw_elements=this._interpret_raw_plugin_def()}return this._processed_raw_elements};n.prototype.actions=function(){return this._get_processed_elements_raw().actions};n.prototype.elements=function(){return this._get_processed_elements_raw().elements};n.prototype.events=function(){return this._get_processed_elements_raw().events};n.prototype._interpret_raw_plugin_def=function(){var e,n,r,o,s,c,f,m,v,y,b,w,x,S,A,E,M,T,C,j,D,O,I,P,R,z,B=this;y={};b={};r={};E=function(e,t,n){var r,i;if(t.indexOf("custom_data_")===0){if(t.indexOf("custom_data_element_")===0){r=a.element(e.get_static_property("element_id"));if(r!=null?r.exists():void 0){i=r.get_static_property(t.split("custom_data_element_")[1])}}else{i=e.get_static_property(t.split("custom_data_")[1])}}else if(t==="_any_thing"){i=g.any}else{i=t}if(n){return"list."+i}else{return i}};x=function(e,t){var n,r,i,o,a,s,u,c,f,d,_;s=e.fields,d=e.support_autobinding,n=e.autobinding_value;f={};if(t){f.element_id={}}for(a in s){_=s[a],r=_.caption,o=_.editor,c=_.optional,i=_.default_val,u=_.in_style;if(r&&o){f[a]={};if(c){f[a].optional=c}if(i!=null){f[a]["default"]=i}if(o==="custom_type"||o==="Label"||o.indexOf("custom_field_")===0){f[a].no_states=true}if((o==="StaticText"||o==="StaticNumber"||o==="Checkbox"||o==="Color"||o==="Dropdown"||o==="Image")&&u){f[a].in_style=true}}}if(d&&n){h.extend(f,l.get_auto_binding_field_names)}return f};O=function(e,t,n,r){var i,o;if(e==="text"||e==="number"||e==="number_range"||e==="boolean"||e==="image"||e==="file"||e==="geographic_address"||e==="date"||e==="date_range"){if(t){o="Basic";e="list."+e}else{if(e==="text"){if(n){o="LongText"}else{o="ShortText"}}else if(e==="image"){o="DynamicImage"}else if(e==="file"){o="DynamicFile"}else{o="Basic";e=e}}}else if(e){o="Basic";e=E(r,e,t);i=function(t){return e!=null}}return{editor:o,value:e,condition:i}};S=function(e,n,r){var i,o,a,s,u,c,f,d,_,p,h,m,v,y,b,w,x,S,A,E,M,T,C;p=n.fields,x=n.support_autobinding,a=n.autobinding_value,i=n.autobinding_is_list;c=[];if(x&&a){if(i){o=["list."+a]}else{o=[a]}c.push.apply(c,l.get_binding_properties(e,o))}h=0;w=[];for(d in p){f=p[d];b=(T=f.rank)!=null?T:h;w.push({field_id:d,field_data:f,rank:b});h++}w.sort(function(e,t){if(e.rank<t.rank){return-1}else{return 1}});A=function(n,i,o,a,s,u,l,f){var d,_,p,h,m,v,y,b,w,x,S,A,E;if(i&&o){m={name:n,caption:i};if(!r){m.pretty={section:"PluginElement"}}if(o==="Label"){m.label_text=i;m.name="information";delete m.caption}else if(o==="StaticText"||o==="StaticNumber"||o==="Checkbox"||o==="Color"||o==="Dropdown"||o==="Image"){if(o==="StaticText"&&l){o="StaticMultiLineText"}if(o==="Dropdown"){y=t().sets.List((A=s!=null?s.split(","):void 0)!=null?A:[],void 0,true)}if(o==="Color"){h=true}}else if(o==="key_value_list"){o="ObjectList";_="Set another key / value";x=O(a);d="generic_object_list";b=function(){return[{name:"key",editor:"StaticText"},{name:"action",editor:"Label",label_text:" = "},{name:"value",editor:x.editor,value:x.value}]}}else if(o==="custom_type"){o="Dropdown";y=t().sets.DisplayableInListValues(true)}else if(o.indexOf("custom_field_")===0){w=o.split("custom_field_")[1];S=e.get_static_property(w);o="Dropdown";v=t().sets.MessagesWithoutArguments({value_name:S,values_to_filter_out:["sys.bool"]});if(f){if(f==="text_image_file"){f=["text","image","file"]}else{f=[f]}y=t().sets.Filtered(v,function(e){var t,n;t=g.get(S).get_message(e.value);return(n=t.ret_value().id(),k.call(f,n)>=0)&&!t.not_public_plugin()})}else{y=t().sets.Filtered(v,function(e){return!g.get(S).get_message(e.value).not_public_plugin()})}p=function(e){return e.get_static_property(w)!=null&&y.get_options().length}}else{E=O(a,u,l,e),o=E.editor,a=E.value,p=E.condition}if(!o){return}m.editor=o;if(a!=null){m.value=a}if(y!=null){m.set=y}if(p!=null){m.condition=p}if(_!=null){m.button_caption=_}if(b!=null){m.sub_properties=b}if(d!=null){m.additional_class=d}if(h!=null){m.dynamic=h}return c.push(m)}};for(E=0,M=w.length;E<M;E++){C=w[E],d=C.field_id,f=C.field_data;s=f.caption,u=f.editor,S=f.value,y=f.options,m=f.is_list,v=f.long_text,_=f.field_type_restriction,S=f.value;A(d,s,u,S,y,m,v,_)}return c};f=function(e,n){var r,i;i=e.fn,r=e.add_debugger;if(t().is_edit_mode()){throw h.error("running plugin code in edit mode!!!!")}if(h.on_server()){throw h.error("running plugin code on the server!!!! TO REMOVE WHEN WE HAVE SERVER ACTIONS")}return _.create_code(i,function(){return console.log("WARNING: Error parsing plugin code for "+n+". Please check \n"+i)},function(e){if(B.version==="current"&&r){e="  debugger; // Debugger entry point for Bubble Plugin // \n"+e}return e})};M=function(e,n,r){var i;if(t().workflow["debugger"]){return(i=t().workflow["debugger"])!=null?i.report_error({instance:n,error:{message:e},type:r}):void 0}};T=function(e,t,n,r){var i;try{return t()}catch(o){i=o;if(i.not_ready_key!=null){throw i}M(i.stack,e,n);return typeof r==="function"?r(i):void 0}};I=function(e,t){var n;if(e==null){return null}if(typeof t==="function"){if(typeof e._type==="function"?e._type():void 0){t=typeof e._type==="function"?e._type():void 0}else{if(e.getTime!=null){t="date"}if(d.is_hashed(e)){t="geographic_address"}else if(Array.isArray(e)){if(typeof e[0]==="number"){t="number_range"}else if(e[0].getTime!=null){t="date_range"}}else{switch(typeof e){case"string":t="text";break;case"number":t="number";break;case"boolean":t="boolean"}}}}n=g.get(t);if(n.can_get_JS_object()){return n.get_JS_object(e)}if(t.indexOf("list.")===0){return{length:function(){return e.length()},get:function(t,r){var i,o,a,s,u;if(t==null){throw h.error("Invalid from: "+t)}if(r==null){throw h.error("Invalid from: "+r)}i=[];u=e.get_children(t,r);for(a=0,s=u.length;a<s;a++){o=u[a];i.push(I(o,n.inner().id()))}return i}}}else{return{get:function(t){var r;if(!t){throw h.error("Invalid fieldName: "+t)}r=n.get_message(t);if(r.is_not_found()){throw h.error("This fieldName does not exist: "+t)}return I(r.fn(e),r.ret_value_id())},listProperties:function(){var e,t,r,i,o;t=[];o=n.get_messages();for(r=0,i=o.length;r<i;r++){e=o[r];if(e.no_arg_no_properties()&&!e.not_public_plugin()){t.push(e.name())}}return t},__original:function(){return e}}}};A=function(e,t,n,r,i){var o,a,s,u,l;if(!r){return e}if(n==="custom_type"){return g.get(e).display()}if(n!=null&&n.indexOf("custom_field_")===0){u=t.get_static_property(n.split("custom_field_")[1]);a=g.get(u).get_message(e);if(a.is_not_found()){return null}return a.name()}if(n==="key_value_list"){s=[];for(l in e){o=e[l];delete o.action;o.value=I(o.value,r);s.push(o)}return s}return I(e,E(t,r,i))};C=(P=this.raw.dependencies)!=null?P.use_jquery:void 0;s={};o={};c={};w=function(e,n){var r,a,u,l,f,d,_;u={currentUser:A(t().current_user(),void 0,void 0,"user")};if(C){u.jQuery=$}u.uploadContent=function(e,t,n,r){if(!t){return null}i(B.name,e,t,n,r);return null};u.keys={};d=B.get_keys();for(a in d){_=d[a],r=_.caption,l=_.type;f=B.get_key(a);if(f!=null){u.keys[r]=f}}u.async=function(t){var r,i,a;r=t.toString()+((i=e!=null?e.toUniqueString():void 0)!=null?i:n!=null?n.run_id:void 0);if(s[r]==null){s[r]=h.MakeKey(null,"Pluginservice.context.async "+r);t(function(e,t){if(e){o[r]=e}else{c[r]=t}return s[r].turn()})}h.ensure_ready(s[r]);return(a=o[r])!=null?a:c[r]};return u};R=this.raw.plugin_elements;j=function(e,n){var i,o,s,c,d,_,m,v,k,j,D,O,I,P,R,z,N,L,q,U,F,W,G,V,Y,H,K;_={display:n.display,category:n.category,icon:n.icon,get_html:function(){return"<div></div>"},add_an_invisible_div_on_the_top:true,is_input:false,is_container:false,change_cursor_style_if_clickable:false,property_applications:[],mandatory_sections:function(){return["PluginElement"]},defaults:n.default_dim};_.field_names=x(n);_._fields=function(e){return S(e,n)};U=n.property_applications;for(I in U){P=U[I];if(P&&I!=="resizable"){_.property_applications.push(new p[I])}}if((F=n.property_applications)!=null?F.resizable:void 0){_.property_applications.push(new p.Dimensions)}else{_.property_applications.push(new p.PositionOnly);_.not_resizable=function(){return true}}if((W=n.property_applications)!=null?W.MinWidth:void 0){_.get_min_width=function(){return 0}}_.dont_add_hover_pressed=!n.add_hover_pressed;_.starts_hidden=!n.add_is_visible;j=(G=n.headers)!=null?(V=G.snippet)!=null?V.trim():void 0:void 0;if(j!==null&&j!==void 0&&j!==""){_.element_html_header=function(){j=j.replace(/\r?\n|\r/g,"");return j}}_.get_states=function(){var e,t,r,i;r=n.states;i=[];for(e in r){t=r[e];i.push(e)}return i};_.add_specific_messages=function(e,t){var r,i,o,a,s;r={};s=n.states;a=function(e,n){return r["get_"+e]={description:"'s "+n.caption,ret_value:E(t,n.value,n.is_list),fn:function(t,n){return t!=null?t.state(e):void 0}}};for(o in s){i=s[o];a(o,i)}return h.extend(e,r)};_.get_state_value=function(e,t){var r,i,o;o=n.states;for(i in o){r=o[i];if(r.caption===t){return E(e,r.value,r.is_list)}}};k=function(e,t,n){var r,i,o;o=n[t];for(r in o){i=o[r].name;if(i===e){return r}}};s=function(e,t,n,r){var i,o,a,u,l,c,f;if(e==null){return null}i=E(t,n,r);if(i.indexOf("list.")===0){if(!Array.isArray(e)){M("Trying to send an invalid array to Bubble "+e,t,"element")}a=g.get(i).inner().id();u=[];for(c=0,f=e.length;c<f;c++){o=e[c];u.push(s(o,t,a))}return u}l=g.get(i);if(l.can_JS_to_bubble()){return l.JS_to_bubble(e)}if(e.__original!=null){return e.__original()}return M("Trying to convert an invalid object to Bubble "+e,t,"element")};c=function(e){var t;t={};if(C){t.canvas=e.get_canvas();t.jQuery=$}else{t.canvas=e.get_canvas()[0]}t.publishState=function(t,r){var i;i=k(t,"states",n);if(i){return T(e,function(){return e.state(i,s(r,e,n.states[i].value,n.states[i].is_list))},"element")}else{return M("State "+t+" is not defined in the plugin",e,"element")}};t.triggerEvent=function(t,r){var i,o;i=k(t,"events",n);if(i){o=l.run_element_workflow(e,B.name+"-"+i,void 0,void 0,void 0,true);if(r!=null){return o!=null?o.callback(r):void 0}}else{return M("Event "+t+" is not defined in the plugin",e,"element")}};t.setHeight=function(t){if(typeof t!=="number"||t<0){M("Trying to set a negative or non-number height "+t,e,"element")}return e.set_height(t)};if(!n.add_is_visible){t.show=function(){e.canvas[0].style.display="block";e._is_visible_me=true;return e._update_visible()};t.hide=function(){e.canvas[0].style.display="none";e._is_visible_me=false;return e._update_visible()}}if(e._plugin_data==null){e._plugin_data={}}t.data=e._plugin_data;if(n.support_autobinding&&n.autobinding_value){t.publishAutobinding=function(t){return l.run_auto_binding(e,s(t,e,n.autobinding_value,n.autobinding_is_list),true)}}return t};_.initialize=function(e){var t,r,i,o,a,s;t=e.get_canvas();if(!e.run_mode()){i=n.edit_mode_image;if(i){h.img("plugin-edit-placeholder",t,i)}return}o=f(n.code.initialize,"initialize ("+n.display+")");a=c(e);r=w(e);e.wait_for_visible(function(){var t;T(e,function(){return typeof o==="function"?o(a,r):void 0},"element");t=f(n.code.update,"update ("+n.display+")");return e.autorun(function(){var i,o,s,u,f,d,_,p,g,m,v,y,b,x;p={bubble:{}};y=n.fields;for(u in y){b=y[u],_=b.name,o=b.editor,m=b.value,d=b.is_list;g=e.evaluate_property(u);p[_]=A(g,e,o,m,d)}if(n.support_autobinding&&n.autobinding_value){i=l.get_input_parent_thing_field(e);p.autobinding=A(i,e,void 0,n.autobinding_value,n.autobinding_is_list)}x=e.element.field_names();for(f in x){s=x[f];if(((v=n.fields)!=null?v[f]:void 0)==null&&!s.only_edit_mode){p.bubble[f]=e.evaluate_property(f)}}a=c(e);r=w(e);return h.run_without_catching_not_ready(function(){return T(e,function(){return typeof t==="function"?t(a,p,r):void 0},"element")})})});if(n.has_reset_fn&&n.code.reset){s=f(n.code.reset,"reset ("+n.display+")");return e.on_message("reset_input",function(){return s(a,r)})}};Y=["events","actions"];for(L=0,q=Y.length;L<q;L++){D=Y[L];_[D]=function(){var e,t;e=n[D];t=[];for(O in e){R=e[O];t.push(this.name+"-"+O)}return t}.call(B)}H=n.events;z=function(e,t){return b[e]={_display:function(){return" "+t.caption},element_name:"A "+n.display}};for(v in H){m=H[v];z(v,m)}d=function(e,t){var r,i;i=a.element(e!=null?e.element_id():void 0);if(i){r=i.get_name()}else{r="a "+n.display}return t+" "+r};K=n.actions;N=function(e,i){var o;if(!t().is_edit_mode()&&!h.on_server()){o=f(i.code,"element_action ("+n.display+"-"+i.caption+")")}return r[e]={category:"Element Actions",display:function(e){return d(e,i.caption)},field_names:x(i,true),fields:function(e){return u.get_element_id_field(e).concat(S(e,i,true))},run:function(e,t,n,r){return h.run_once(30,function(){return n.element.find_instance_by_id(t.element_id)},function(a,s){var u,l,f,d,_,p,g,m,v,y;if(a){r(a);return}g={};v=i.fields;for(f in v){y=v[f],p=y.name,m=y.value,_=y.is_list,l=y.editor;g[p]=A(t[f],e,l,m,_)}d=c(s);u=w(s,n);return h.run_without_catching_not_ready(function(){return h.run_once(30,function(){return T(e,function(){return typeof o==="function"?o(d,g,u):void 0},"action",function(e){return r(e)})},r)})})}}};for(o in K){i=K[o];N(o,i)}return y[e]=_};for(m in R){v=R[m];j(m,v)}z=this.raw.plugin_actions;D=function(e,n){var i,o,a;i={display:function(){return n.display},category:(a=n.category)!=null?a:"plugins",data_to_refresh:null};i.field_names=x(n,true);i._fields=function(e){return S(e,n,true)};if(!t().is_edit_mode()&&!h.on_server()){o=f(n.code.client,"action ("+n.display+")")}i.run=function(e,t,r,i){var a,s,u,l,c,f,d,_,p;f={};_=n.fields;for(u in _){p=_[u],c=p.name,d=p.value,l=p.is_list,s=p.editor;f[c]=A(t[u],e,s,d,l)}a=w(void 0,r);return h.run_without_catching_not_ready(function(){return h.run_once(30,function(){return T(e,function(){return typeof o==="function"?o(f,a):void 0},"action",function(e){return i(e)})},i)})};return r[e]=i};for(e in z){n=z[e];D(e,n)}return{elements:y,events:b,actions:r}};return n}(c.Service)}).call(this)},{"./apiconnectorbase":3,"./core/core_actions":18,"./core/core_elements":19,"./core/property_applications":24,"./core/widgets":26,"./external":40,"./geolocation":41,"./lang/appquery":51,"./lang/values":62,"./lib":65,"./u":72}],70:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};x=n;f=e("./external");S=e("./u");t=e("./lib");a=e("./lang/appquery");A=e("./lang/values");u=e("./editor/css");h=e("./languages");_=e("fs");d=e;s=e("./core/core_elements");m=e("./pluginservice");S.safe_register("./services",x);if(S.on_server()){y=d("./server_actions");p=d("./lang/hardcoded_plugins")}x.services={};x.defaults_for_services_settings={};x.add_service=r=function(e,t){var n;if(!x.services[e]){n=new t;n.name=e;if(n.human==null){n.human=S.toTitleCase(e)}x.services[e]=n;if(!n.authenticator){throw S.error("Error building service "+e+": missing authenticator")}if(typeof n.authenticator!=="function"){return n.authenticator._service=n}}};x.PLUGIN_SEPERATOR="-";x.get_service_and_type=function(e){var t;if(!e){return[null,null]}if(e.indexOf(x.PLUGIN_SEPERATOR)===-1){return[null,e]}t=e.split(x.PLUGIN_SEPERATOR);return[t[0],t.slice(1).join(x.PLUGIN_SEPERATOR)]};x.enter_your_api_key_button_field_names={key_info:{no_states:true}};x.get_enter_your_api_key_button=function(e,n,r){if(r==null){r="Enter your API key"}return[{name:"key_info",editor:"Button",button_caption:r,condition:function(){return n},optional:true,click_cb:function(){t().plugin_canvas.change_current_plugin(e);return $(u.PLUGIN_TAB).click()}}]};x.add_fields_from_parameters=function(e,n){var r,i,o,a,s,u;for(o in e){r=e[o];i={name:o,caption:(a=(s=r.display)!=null?s:r.caption)!=null?a:o,optional:r.optional,"default":r["default"],label_text:r.label_text,no_rich_text_editing:r.no_rich_text_editing};if(r.choices){i.editor="Dropdown";i.set=new(t().sets.List)(r.choices)}else{i.editor=(u=r.editor)!=null?u:"ShortText";i.value=r.value}n.push(i)}return n};x.add_key_button=function(e,t){var n,r,i;i=x.get_service(e);if(i.has_keys()&&j.call(function(){var e,r,i;
i=[];for(e=0,r=t.length;e<r;e++){n=t[e];i.push(n.name)}return i}(),"key_info")<0){r=i.are_keys_missing();return t.push.apply(t,x.get_enter_your_api_key_button(e,r))}};g={};o={};i={};x.get_api_data_for_edit_mode=function(e,n,r,a,s,u){var l,c;if(s==null){s=""}l=e+"_"+s+"_"+(a!=null?a:"");if(!o[l]){o[l]=S.MakeKey(null,"api_data_loaded for "+l);if(r==="post"){c=t().location.post(n,{apikey:a})}else if(r==="get"){c=t().location.get(n)}c.then(function(e){var t;if(!e||e.error||((t=e.errors)!=null?t.length:void 0)){g[l]=null}else{g[l]={};if(u){u(g[l],e)}else{g[l]=e}}return o[l].turn()},function(e){i[l]=e;o[l].turn();return null})}S.ensure_ready(o[l]);return g[l]};x.wipe_edit_mode_cache=function(e,t,n){var r;if(n==null){n=""}r=e+"_"+n+"_"+(t!=null?t:"");delete g[r];return delete o[r]};w={};x.register_service=function(e,t){var n,i,o,a,s,u,l,c,f,p;w[e]=t;if(S.on_server()){s="services/"+e+"_server";if(_.existsSync("lib/"+s+".coffee")){S.extend(t.cls.prototype,d("./"+s))}}r(e,t.cls);i=x.services[e];c=i.keys;for(o in c){n=c[o];if(n["default"]){x.defaults_for_services_settings[e+"_"+o]=n["default"]}}if(S.on_server()){f=i.get_server_actions();p=[];for(u=0,l=f.length;u<l;u++){a=f[u];p.push(y[e+x.PLUGIN_SEPERATOR+a]=i.server_actions_definitions[a])}return p}};x.get_oauth_authenticator=function(e){var t,n,r,i,o;if(!e){return null}if(e.indexOf(x.PLUGIN_SEPERATOR)===-1){return(r=x.get_service(e))!=null?r.get_authenticator():void 0}else{i=x.get_service_and_type(e,"oauth"),t=i[0],n=i[1];return(o=x.get_service(t))!=null?o.get_authenticator(n,"oauth"):void 0}};x.get_api_calls=S.autorun_cache(function(){var e,t,n,r,i,o,s,u,l,c,f,d,_;o={};d=a.list_plugins();for(u=0,c=d.length;u<c;u++){r=d[u];s=x.get_service(r);i=s!=null?s.get_public_calls():void 0;_=i!=null?i:[];for(l=0,f=_.length;l<f;l++){t=_[l];n=r+"."+t;e=s.get_call(t);if(!e){S.warn("could not find call "+n)}else{o[n]=e}}}return o});x.get_user_calls=function(){var e,t,n,r,i,o,s,u,l,c;r={};S.optional_pause();l=a.get_user_calls();for(s=0,u=l.length;s<u;s++){n=l[s];S.optional_pause();c=x.get_service_and_type(n),o=c[0],t=c[1];i=x.get_service(o);if(i==null){return null}e=i!=null?i.get_call(t):void 0;if(!e){S.warn("could not find call "+t)}else{r[t]=e}}S.optional_pause();return r};x.get_value_ids=S.autorun_cache(function(){var e,t,n,r,i,o,s,u,l,c;t=[];l=a.list_plugins();for(i=0,s=l.length;i<s;i++){e=l[i];n=x.get_service(e);if(n){c=n.get_public_values();for(o=0,u=c.length;o<u;o++){r=c[o];t.push(n.get_values()[r].full_name)}}}return t});x.is_installed=function(e){return j.call(a.list_plugins(),e)>=0};M=S.autorun_cache(function(e,n,r){var i,o,a,s,u,l,c,f;if(!S.is_edit_mode()&&!S.on_server()){i=typeof window!=="undefined"&&window!==null?(a=window.plugins)!=null?a[n]:void 0:void 0;if(i==null){o="The plugin "+n+" could not be loaded. Please check it exists."}else{if(typeof i==="string"){i=S.json_parse(i)}switch(i.forbidden){case"NOT_PAID":o="The plugin "+((s=i.caption)!=null?s:n)+" is published under a commercial license and this app does not have a subscription. Please subscribe in the Editor.";break;case"BLOCKED":o="The plugin "+((u=i.caption)!=null?u:n)+" is blocked by Bubble.";break;case"NOT_AUTHORIZED":o="The plugin "+((l=i.caption)!=null?l:n)+" is published under a private license and this app is not authorized.";break;case"NOT_TEST_APP":o="The plugin "+((c=i.caption)!=null?c:n)+" is in test mode and the current app is not the registered test app."}}if(o!=null){t().show_error_to_user({error:{message:o},type:"general"});return}}else{i=(f=x.services.bubble_plugin.get_call("get_raw_plugin").execute(void 0,{plugin_id:e,version:r}))!=null?f.plugin_data:void 0}if(!i||S.is_empty(i)){return}return new m.PluginService(n,r,i)});x.get_service=function(e,t){var n,r;if(e==null){return}if(x.services[e]!=null){return x.services[e]}n=e;if(e.indexOf("_current")!==-1){e=e.split("_current")[0];t="current"}if(!S.is_UUID(e)){return}if(!t){t=(r=a.list_plugins_version())!=null?r[e]:void 0;if(!t){return}}return M(e,n,t)};x.get_app_services=function(){var e,t,n,r;t=[];r=a.list_plugins_version();for(e in r){n=r[e];t.push(x.get_service(e,n))}return t};x.get_app_hardcoded_services=function(){var e,t,n,r;t=[];r=a.list_plugins_version();for(e in r){n=r[e];if(n===true){t.push(x.get_service(e,n))}}return t};x.tests={};x.register_test=function(e,t){var n,r,i,o,a,s,u,l,c,f,p,h,g,m,y,b,w,k,A,E,M;s=x.services[e];if(t.ignore_full_test_suite){return}w=s.get_calls();c=function(n){var r;r=s.get_call(n);if(t[n]&&!t[n].ignore){return x.tests[e+"_call_"+n]=function(){return v(e,n,r,t)}}};for(p=0,m=w.length;p<m;p++){r=w[p];c(r)}k=s.get_actions();f=function(n){var r,i,o;o=x.get_service_and_type(n),i=o[0],r=o[1];if(j.call(s.get_calls(),r)<0){if(t[r]&&!t[r].ignore){return x.tests[e+"_action_"+r]=function(){return t[r]()}}}};for(h=0,y=k.length;h<y;h++){n=k[h];f(n)}A=t._additional_tests;for(u in A){l=A[u];x.tests[e+"_additional_tests_"+u]=function(){return t._additional_tests[u]()}}if(S.on_server()){a="services/"+e+"_server";if(_.existsSync("lib/"+a+".coffee")){o=d("./"+a);S.extend(t,o.test_data)}E=s.get_server_actions();M=[];for(g=0,b=E.length;g<b;g++){i=E[g];M.push(function(n){var r,i;i=x.get_service_and_type(n),l=i[0],r=i[1];if(t[r]&&!t[r].ignore){return x.tests[e+"_server_action_"+r]=function(){return t[r]()}}}(i))}return M}};if(S.on_server()){T=p.raw_data;for(b in T){E=T[b];x.register_service(b,S.safe_require("./optional/services/"+b.toLowerCase()));C=x.services[b].get_elements();for(c in C){E=C[c];s.elements_list[c]=true}}r("APIPluginBuilderService",d("./editor_plugin/apicanvas").APIPluginBuilderService);S.extend(w,{APIPluginBuilderService:{test_data:{ignore_full_test_suite:true}}})}x._last_date_generated=null}).call(this)},{"./core/core_elements":19,"./db/db":28,"./editor/css":36,"./external":40,"./lang/appquery":51,"./lang/values":62,"./languages":64,"./lib":65,"./pluginservice":69,"./tests/testing":71,"./u":72,fs:77}],71:[function(e,t,n){(function(){var n,r,i,o,a,s,u,l,c,f,d,_=[].slice;c=t.exports;f=e("./../u");f.safe_register("./tests/testing",c);r=f.safe_require("./lib");if(f.on_server()){s=e;f.extend(c,s("./test_lib"))}if(typeof window!=="undefined"&&window!==null){window.testing=c;u=f.MakeSwitch(null,"server_running_key");u.turn_on();$(document).ajaxStart(function(){return u.turn_off()});$(document).ajaxStop(function(){return u.turn_on()})}c.initialize=function(){var e;e=f.MakeKeyList([r().workflow.everything_done_key(),u,r().location.open_requests,f.scheduled_key,f.no_outstanding_run_once]);window.everything_ready=function(){return e};return window.wait_for_everything=function(t){return setTimeout(function(){if(e.is_turned()){return t()}else{return window.wait_for_everything(t)}},100)}};c.fail=function(e){throw new Error(e)};c.assert=function(e,t){console.log("Asserting true: "+e);if(!e){return c.fail(t!=null?t:"expected true, got: "+e)}};c.assert_equals=function(e,t,n){console.log("Asserting equals: "+e+", "+t);if(e!==t){return c.fail(n!=null?n:"expected:\n"+e+"\nbut got:\n"+t)}};c.assert_contains=function(e,t,n){console.log("Asserting contains: "+e+", "+t);if(t.indexOf(e)===-1){return c.fail(n!=null?n:"expected it to contain "+e+" but got "+t)}};c.assert_error=function(){var e,t,n,r,i;r=2<=arguments.length?_.call(arguments,0,i=arguments.length-1):(i=0,[]),t=arguments[i++];console.log("asserting there is an error...");n=false;try{t();n=true}catch(o){e=o;if(r[0]){c.assert_equals(r[0],e.statusCode)}}if(n){return c.fail("Expected an error but did not get one")}};c.wait_for=function(e,t){var n,r;n=setInterval(function(){if(e()){clearInterval(n);clearTimeout(r);return t()}},500);return r=setTimeout(function(){clearInterval(n);throw f.error("Timed out after 30 seconds of waiting for: "+e)},3e4)};c.set_domain=function(e){c.DOMAIN=e;if(f.ends_with(e,"compute.amazonaws.com")){c.DOMAIN_PREFIX="http://"+c.DOMAIN+"/";return c.DOMAIN_PREFIX_DIRECT="http://"+c.DOMAIN+":8080"}else{c.DOMAIN_PREFIX="https://"+c.DOMAIN+"/";return c.DOMAIN_PREFIX_DIRECT="https://"+c.DOMAIN}};d=[];c.log=function(e){return d.push(e)};c.get_log=function(){var e;e=d;d=[];return e};o=function(){var e,t;if(f.all_page_errors.length>0){e=f.all_page_errors[0];f.all_page_errors=[];return(t=e.stacktrace)!=null?t:JSON.stringify(e)}return null};a=null;l=function(e){clearInterval(a);return a=setInterval(function(){var t;t=o();if(t){e(t);return clearInterval(a)}},1e3)};c.SimpleTest=i=function(){function e(e,t,n){this._name=e;this.fn=t;this.setup=n}e.prototype.name=function(){return this._name};e.prototype.run=function(e){var t;l(e);try{return this.fn(function(t){return e(t!=null?t:o())})}catch(n){t=n;return e(t)}};return e}();c.AsyncTest=n=function(){function e(e,t,n){this._name=e;this.fns=t;this.setup=n}e.prototype.name=function(){return this._name};e.prototype.run=function(e){var t,n=this;l(e);t=function(r){var i;if(!n.fns[r]){e(o());return}try{n.fns[r]();return f.wait_for_updates(function(){var n;n=o();if(n){e(n);return}return t(r+1)})}catch(a){i=a;return e(i)}};return t(0)};return e}()}).call(this)},{"./../u":72}],72:[function(e,t,n){(function(t,r){(function(){var i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T,C,j,D,O,I,P,R,z,B,N,L,q,U,F,W,G,V,Y,H,K,J,X,Z,Q,ee,te,ne,re,ie,oe,ae,se,ue,le,ce,fe,de,_e,pe,he,ge,me,ve,ye,be,we,xe,ke,Se,Ae,Ee,Me,Te,Ce,je,De,Oe,Ie,Pe,Re,ze,Be,Ne,Le,qe,Ue,Fe,We,Ge,Ve,Ye,He,$e,Ke,Je,Xe,Ze,Qe,et,tt,nt,rt,it,ot,at,st,ut,lt,ct,ft,dt,_t,pt,ht,gt,mt,vt,yt,bt,wt,xt,kt,St,At,Et,Mt=[].slice,Tt=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1},Ct={}.hasOwnProperty,jt=function(e,t){for(var n in t){if(Ct.call(t,n))e[n]=t[n]}function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};Error.stackTraceLimit=Infinity;Ye=n;oe=e;Ye.require=oe;ie=e("events");He=e("underscore");Y=e("crypto");y=function(){var t,n;n=null;t=function(){if(n==null){n=e("./lib")}return n()};t.extend=function(){var t;t=1<=arguments.length?Mt.call(arguments,0):[];if(n==null){n=e("./lib")}return n.extend.apply(n,t)};return t}();ft=typeof window!=="undefined"&&window!==null;_t=(typeof window==="undefined"||window===null)&&(typeof postMessage!=="undefined"&&postMessage!==null);Ye.on_client=function(){return ft&&!_t};Ye.on_server=function(){return!ft&&!_t};dt=(typeof document!=="undefined"&&document!==null?document.URL:void 0)&&document.URL.indexOf("file://")!==-1;Ye.on_phonegap=function(){return dt};Ye.running_test=function(){return false};Ye.on_worker=function(){return _t};Ye.is_edit_mode=function(){var t;if(!Ye.on_client()){return false}t=e("./client_config");if(t.apps_domain&&document.location.href.indexOf(t.apps_domain)!==-1&&document.location.href.indexOf("//meta.bubbleapps.io/page")===-1){return false}return document.location.href.indexOf("/page?")!==-1||document.location.href.indexOf("/plugin_editor")!==-1};Ye.is_plugin_edit_mode=function(){if(!Ye.on_client()){return false}return document.location.href.indexOf("/plugin_editor")!==-1};Ye.is_debug_mode=function(){return Ye.on_client()&&window.start_debugger!=null};Ye.edit_mode_only=function(){if(Ye.on_client()&&!Ye.is_edit_mode()&&!$e.parse(document.location.href,true).query.debug_mode){throw Ye.error("Oops, looks like we are in run-mode, but have required edit-mode code.  Look at the stack trace to see who is requiring this...")}};(function(){var t,n,r,i;r=e("./u2");i=[];for(t in r){n=r[t];i.push(Ye[t]=n)}return i})();if(Ye.on_server()||Ye.running_test()){(function(){var e,t,n,r;n=oe("./u3");r=[];for(e in n){t=n[e];r.push(Ye[e]=t)}return r})()}if(Ye.on_server()){_=e("fibers");Ye.Fiber=_}Ye.array_remove=function(e,t){var n,r;if(e==null){return}r=[];while((n=e.indexOf(t))!==-1){r.push(e.splice(n,1))}return r};Ye.array_replace=function(e,t,n){var r,i,o,a;if(e==null){return}i=[];for(o=0,a=e.length;o<a;o++){r=e[o];if(r===t){i.push(n)}else{i.push(r)}}return i};if(Number.isNaN==null){Number.isNaN=function(e){return typeof e==="number"&&isNaN(e)}}Ye.unique=function(e){var t,n,r,i,o,a;n={};for(t=i=0,o=e.length;0<=o?i<o:i>o;t=0<=o?++i:--i){n[e[t]]=e[t]}a=[];for(t in n){r=n[t];a.push(r)}return a};Ye.shuffle_array=function(e){var t,n,r;t=e.length;while(--t>0){n=~~(Math.random()*(t+1));r=e[n];e[n]=e[t];e[t]=r}return e};Ye.replace_all=function(e,t,n){return e.split(t).join(n)};Ye.sort_array=function(e,t){var n,r,i,o,a,s;r=[];for(i=0,a=t.length;i<a;i++){n=t[i];if(Tt.call(e,n)>=0){r.push(n)}}for(o=0,s=e.length;o<s;o++){n=e[o];if(Tt.call(r,n)<0&&Tt.call(t,name)<0){r.push(n)}}return r};Ye.get_domain_components=function(e){var t,n,r,i,o,a,s,u;if(e.indexOf("www.")===0){e=e.slice(4)}if(Ye.on_server()){return{top_domain:Ge.getDomain(e),subdomains:Ge.getSubdomain(e)}}else{r=["ac.uk","co.uk","gov.uk","ltd.uk","me.uk","net.uk","nhs.uk","org.uk","plc.uk","police.uk"];i=e.split(".");t=0;for(s=0,u=r.length;s<u;s++){n=r[s];if(Ye.ends_with(e,n)){t+=1;break}}a=i.slice(-(2+t));o=i.slice(0,i.length-(2+t));return{top_domain:a.join("."),subdomains:o.join(".")}}};if(Ye.on_server()){Ye.timestamp=function(){return Date.now()}}else if(Ye.on_worker()){Ye.timestamp=function(){throw Ye.error("not supported in web workers right now")}}else if(Ye.on_client()){Ye.timestamp=function(){return Date.now()+window.server_time_offset}}else{throw Ye.error("unrecognized environment: on_server, on_worker, on_client all returned false")}B=1e18;Ye.UUID=function(){var e;e=Math.round(Math.random()*B);return Date.now()+"x"+Ce(e,18)};Ye.is_UUID=function(e){return e.indexOf("x")===13&&e.length===32};Ce=function(e,t){e=String(e);return e+new Array(t+1-e.length).join("0")};(function(){var e;e=1;return Ye.LUID=function(){e++;return Date.now()+"x"+e}})();Ye.UUID_SEED=function(e){var t,n,r;n=e.seed,r=e.timestamp,t=e.iterations;return new N(n,r,t)};Ye.get_random_seed=function(){return Math.round(Math.random()*B)%w};x=1664525;w=B;A=1013904223;N=function(){function e(e,t,n){var r,i,o;this.seed=e;this.timestamp=t;this.iterations=n!=null?n:0;for(r=i=0,o=this.iterations;0<=o?i<o:i>o;r=0<=o?++i:--i){this.randn()}}e.prototype.randn=function(){this.seed=(x*this.seed+A)%w;this.iterations++;return this.seed};e.prototype.UUID=function(){return this.timestamp+"x"+Ce(this.randn(),18)};return e}();Ye.Random=function(e){return new C(e)};C=function(){function e(e,t){var n,r,i;this.seed=e;this.iterations=t!=null?t:10;for(n=r=0,i=this.iterations;0<=i?r<i:r>i;n=0<=i?++r:--r){this.next()}}e.prototype.next=function(){this.seed=(x*this.seed+A)%B;this.iterations++;return this.seed};e.prototype.random=function(e,t){this.next();return this.seed%(t-e)+e};return e}();(function(){var e;e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";return Ye.short_uid=function(t,n){var r,i,o,a,s;if(t<70304){r=3}else if(t<175478784){r=5;t+=190102016}else if(t<1e14){r=10;t+=0x1edcf7bcf280000}else{return Ye.UUID()}o=new Array(r);for(i=a=s=r-1;s<=0?a<=0:a>=0;i=s<=0?++a:--a){o[i]=e.charAt(t%52);t=Math.floor(t/52)}return o.join("")+(String(n)==="-1"?"":String(n))}})();ot=null;Ye.start_count=function(){return ot={}};Ye.count=function(e){if(ot){if(ot[e]==null){ot[e]=0}return ot[e]++}};Ye.stop_count=function(){var e,t,n,r,i,o,a;e=function(){var e;e=[];for(t in ot){n=ot[t];e.push([t,n])}return e}();e.sort(function(e,t){return t[1]-e[1]});a=[];for(r=0,i=e.length;r<i;r++){o=e[r],t=o[0],n=o[1];a.push(console.log(t+": "+n))}return a};vt={};Ye.safe_require=function(t){var n,r;if(vt[t]){return vt[t]}if(Ye.on_client()&&t.split("/")[1]==="optional"){n=t.split("/")[t.split("/").length-1];r=window.optional_modules[n];if(!r){throw Ye.error("could not find optional module: "+t)}return r}else{return e(t)}};Ye.safe_register=function(e,t){return vt[e]=t};$e=e("url");Ye.safe_register("url",$e);Ye.safe_register("querystring",e("querystring"));ut=null;Ye.fiber_lock=function(e){if(_.current===ut){return e()}while(ut!=null){Ye.pause(100)}try{ut=_.current;return e()}finally{ut=null}};Ye.is_fiber_locked=function(){return _.current===ut};se=null;Ee=false;ue=null;Je=0;At=false;Xe=null;ne=function(){if(At){return}At=true;Xe=t.hrtime();return setInterval(function(){var e,n,r;if(ue!=null){ce();ue=t.hrtime()}e=t.hrtime(Xe);n=e[0]*1e9+e[1];r=Je/n;if(typeof Ye.configuration_measure==="function"){Ye.configuration_measure(null,"fiber_utilization",r)}Xe=t.hrtime();return Je=0},1e3)};ce=function(){var e;e=t.hrtime(ue);Je+=e[0]*1e9+e[1];return ue=null};Ue=function(e,t){if(e.fiber_is_finished){return}if(bt){e.run();return}if(e.is_queued){return}e.is_queued=true;V(e);ae.add(e,t);return qe()};Se=0;Pe=false;Ie=function(){if(!Pe){Pe=true;return setInterval(function(){if(typeof Ye.configuration_measure==="function"){Ye.configuration_measure(null,"fiber_max_granularity",Se)}return Se=0},1e4)}};qe=function(){if(!Ee){Ee=true;se=Date.now();if(ue==null){ue=t.hrtime();ne()}return setImmediate(Be)}};f=function(){function e(){this.fibers=[];this.meta_fibers=[];this.ALLOWED_TIME=.95*1e9}e.prototype.add=function(e,t){var n;if(this._emptying){throw Ye.error("assertion failure: trying to add to queue while emptying!")}n=e.fiber_appname;if(n==null||n==="meta"){return this.meta_fibers.push({my_fiber:e,message:t})}else{return this.fibers.push({my_fiber:e,message:t})}};e.prototype.get=function(){if(this.used_time>this.ALLOWED_TIME){this.update(null,0);return null}if(this.meta_fibers.length>0){return this.meta_fibers.shift()}else{return this.fibers.shift()}};e.prototype.drain=function(){var e=this;this._emptying=true;return setTimeout(function(){var t,n,r,i,o,a,s;o=e.fibers;s=[];for(r=0,i=o.length;r<i;r++){a=o[r],n=a.my_fiber,t=a.message;n.is_queued=false;s.push(Ue(n,t))}return s},10)};e.prototype.update=function(e,t){var n;n=Date.now();if(this.period_start==null||n>this.period_start+1e3){this.period_start=n;this.used_time=0}return this.used_time+=t};e.prototype.has_time_left=function(e){return true};e.prototype.spend_time=function(e,t){};e.prototype.begin_shutdown=function(){return true};return e}();Ye.tag_fiber=function(e,t){var n;if(e==null||t==null){return}if((n=Ye.Fiber.current)._sampling_tags==null){n._sampling_tags={}}if(Ye.Fiber.current._sampling_tags[e]){Ye.flush_sampling()}return Ye.Fiber.current._sampling_tags[e]=t};Ye.flush_sampling=function(){return le(Ye.Fiber.current)};ct={};ge=false;le=function(e){var t,n,r,i,o,a,s;if(e._sampling_timestamp){i=(a=e._sampling_tags)!=null?a:{};n=JSON.stringify(i);if(ct[n]==null){ct[n]={tags:i,measures:{count:0}}}r=ct[n].measures;s=e._sampling_measures;for(t in s){o=s[t];if(r[t]==null){r[t]=0}r[t]+=o}r.count++;e._sampling_measures=null;e._sampling_timestamp=null;clearTimeout(e._sampling_timeout);if(!ge){ge=true;return setInterval(he,3e4)}}};he=function(){var e,t,n,r,i,o,a;n=ct;ct={};i=Date.now();a=[];for(e in n){o=n[e],r=o.tags,t=o.measures;a.push(typeof Ye.fiber_sampling_handler==="function"?Ye.fiber_sampling_handler(i,r,t):void 0)}return a};Ye.increment_fiber_sampling=function(e,n,r){var i,o;if(r==null){r=Ye.Fiber.current}if(!r){throw Ye.error("calling increment fiber sampling off fiber")}if(typeof n!=="number"||typeof e!=="string"){Ye.warn("bad params to increment_fiber_sampling",{key:e,value:n});return}if(n===0){return}if(typeof Ye.configuration_increment==="function"){Ye.configuration_increment(null,e,n)}if(r._sampling_running_total==null){r._sampling_running_total={}}if((i=r._sampling_running_total)[e]==null){i[e]=0}r._sampling_running_total[e]+=n;if(e==="spent_time"&&ae.burst_per_fiber&&r._sampling_running_total[e]>ae.burst_per_fiber){if(!r._sampling_burst_start){r._sampling_burst_start=t.hrtime()}}if(!r._sampling_timestamp){r._sampling_timestamp=Date.now();r._sampling_measures={};Ye.fiber_finalize("fiber_sampling",Ye.flush_sampling,r);r._sampling_timeout=setTimeout(function(){return le(r)},3e4)}if((o=r._sampling_measures)[e]==null){o[e]=0}return r._sampling_measures[e]+=n};Ye.fiber_sampling_handler=null;ae=new f;Ye.assign_fiber_ownership=function(e,t){Ye.tag_fiber("appname",e);Ye.tag_fiber("app_version",t);return Ye.Fiber.current.fiber_appname=e};Ye.has_time_left=function(e){return ae.has_time_left(e)};Ye.spend_time=function(e,t){Ve(_.current,t*1e6);return ae.spend_time(e,t)};Ve=function(e,t){return Ye.increment_fiber_sampling("spent_time",t,e)};Ye.set_fiber_queue=function(e){return setImmediate(function(){var t;t=ae;ae=e;return t.drain()})};bt=false;Ye.fiber_queue_soft_clean=function(){var e,t,n;for(t=0,n=U.length;t<n;t++){e=U[t];Q(e,Ye.QUEUE_TIMEOUT)}return ae.begin_shutdown()};Ye.fiber_queue_shutdown=function(e){var t;bt=true;t=function(){var n,r,i,o,a,s,u,l;o=[].concat(U);if(typeof e==="function"){e("unwinding "+o.length+" fibers out of "+Ye.open_fibers)}for(a=0,u=o.length;a<u;a++){n=o[a];Ye.unwind_fiber(n)}i=Ye.open_fiber_shutdown_handles;Ye.open_fiber_shutdown_handles=[];if(typeof e==="function"){e("calling "+i.length+" shutdown handles")}for(s=0,l=i.length;s<l;s++){r=i[s];r()}if(typeof e==="function"){e("unwind complete, "+U.length+" fibers in our array, and u.open_fibers = "+Ye.open_fibers)}if(Ye.open_fibers>0){return setTimeout(t,10)}};setTimeout(t,1);setTimeout(t,100);setTimeout(t,1e3);return setTimeout(t,1e4)};Ye.CLOSING_FIBER_ERROR="Manually closing fiber to dispose process";Ye.unwind_fiber=function(e){var t,n;if(e.fiber_is_finished){Ye.warn("Unwinding a finished fiber")}t=0;e.is_unwinding=true;while(!e.fiber_is_finished){Ye.kill_fiber(e,Ye.CLOSING_FIBER_ERROR);t++;if(t>1e3){Ye.warn("Could not unwind fiber",{history_path:(n=e.history)!=null?n.path:void 0});return}}};Ye.optional_pause=function(e){var n,r,i,o,a,s,u,l,c,f,d;if((_!=null?_.current:void 0)==null){return}a=_.current;if(a.run_start_time){r=t.hrtime(a.run_start_time)}else{r=0}if(r[0]*1e9+r[1]>5e6){n=Ye.Block("optional_pause");n.suppress_timeout=true;setImmediate(n.success.bind(n));a.optional_pause_message=e;n.wait();if(a._sampling_burst_start){i=a._sampling_running_total.spent_time;i-=ae.burst_per_fiber;r=t.hrtime(a._sampling_burst_start);s=r[0]*1e9+r[1];o=(f=a.max_per_fiber)!=null?f:ae.max_per_fiber;l=o*ae.total_per_second((d=a.fiber_appname)!=null?d:"meta")/1e3;c=i/l;u=Math.round((c-s)/1e6);if(u>0){return Ye.pause(u)}}}};Be=function(){var e,t;try{t=ze()}catch(n){e=n;Ye.warn("ERROR IN RUN_LOOP",{error:Ye.nice_print_error(e)})}finally{Ee=false}if(!t){return qe()}else{ce();return setTimeout(qe,10)}};ze=function(){var e,n,r,i,o,a,s,u,l,c;if(typeof Ye.configuration_increment==="function"){Ye.configuration_increment(null,"fiber_io_overhead",(Date.now()-se)/1e3)}l=t.hrtime();r=true;s=0;while(r&&(n=ae.get())){if(bt){return}o=n.my_fiber,i=n.message;o.is_queued=false;if(o.fiber_is_finished){continue}u=t.hrtime();o.run_start_time=u;o.run();e=t.hrtime(u);a=e[0]*1e9+e[1];if(a>1e8){o.last_run_was_slow=a}else{delete o.optional_pause_message}o.last_run_timing=a;ae.update(o,a);s+=a;Ve(o,a);Se=Math.max(Se,a);e=t.hrtime(l);if(e[0]*1e9+e[1]>2e7){r=false}}e=t.hrtime(l);c=e[0]*1e9+e[1];if(typeof Ye.configuration_increment==="function"){Ye.configuration_increment(null,"fiber_total_time",s/1e9)}if(typeof Ye.configuration_increment==="function"){Ye.configuration_increment(null,"fiber_overhead",(c-s)/1e9)}Ie();return r};Ye.open_fibers=0;Ye.open_fiber_shutdown_handles=[];Ye.kill_fiber=function(e,t){var n;if(e.fiber_is_finished){return}e._u_fiber_did_timeout=true;e._u_fiber_timeout_msg=t;try{return e.run()}catch(r){n=r;return Ye.warn(n)}};D="SYSTEM_FIBER";U=[];Ye.SyncRun=z=function(e,t){var n,r,i;i=e===D;if(bt&&!i){throw Ye.error("Trying to start new fiber but shutting down queue")}if(typeof e==="string"){r=e;e=typeof Ye._make_history==="function"?Ye._make_history(e):void 0}else if(e!=null){r=e.syncrun}n=function(){var n,o;n=null;o=function(){var o,a,s,u,l;if(n==null){throw Ye.error("Running a fiber that has already ended")}if(!i){Ye.open_fibers++;U.push(n)}if(r){Ye.tag_fiber("syncrun",r)}try{t();return e!=null?e.fiber_done():void 0}catch(c){o=c;if(e!=null){e.fiber_done()}return Ye.warn(o)}finally{if(!n.is_unwinding){l=(u=n._u_fiber_finalize)!=null?u:{};for(a in l){s=l[a];try{s()}catch(c){o=c;if(String(o.message)!==Ye.QUEUE_TIMEOUT&&String(o.message)!==Ye.CLOSING_FIBER_ERROR){Ye.warn("Bug in u_fiber_finalize",{error:Ye.nice_print_error(o)})}}}}n.fiber_is_finished=true;if(!i){Ye.open_fibers--;Ye.array_remove(U,n)}n=null}};n=_(o);n.history=e;n._u_fiber_timeout=90*1e3;return Ue(n,"starting fiber")};return setImmediate(n)};Ye.fiber_finalize=function(e,t,n){var r;if(n==null){n=_.current}if(!n){Ye.warn("Calling fiber_finalize while not on a fiber");return}if(e==null){e=Ye.LUID()}if(n._u_fiber_finalize==null){n._u_fiber_finalize={}}if((r=n._u_fiber_finalize)[e]==null){r[e]=t}return null};Ye.Sync=P=function(e,t){var n;n=E(e,t);return function(){var e,t;e=1<=arguments.length?Mt.call(arguments,0):[];t=n.apply(null,e);return t()}};Ye.Sync2=R=function(e,t){var n;n=M(e,t);return function(){var e,t;e=1<=arguments.length?Mt.call(arguments,0):[];t=n.apply(null,e);return t()}};Ye.Parallel=E=function(e,t){return function(){var n,r;n=1<=arguments.length?Mt.call(arguments,0):[];r=Ye.Block(e);t.apply(null,Mt.call(n).concat([function(e,t){if(e!=null){return r.fail(e)}else{return r.success(t)}}]));return r.wait.bind(r)}};Ye.Parallel2=M=function(e,t){return function(){var n,r;n=1<=arguments.length?Mt.call(arguments,0):[];r=Ye.Block(e);t.apply(null,Mt.call(n).concat([function(e,t,n){if(e!=null){return r.fail(e)}else{return r.success({data:t,data2:n})}}]));return r.wait.bind(r)}};Ye.FiberTimeout=function(e){return _.current._u_fiber_timeout=e};Ye.GetFiberTimeout=function(){return _.current._u_fiber_timeout};Ye.suspend_fiber_timeout=function(e,t){var n;if(t==null){t=e;e=4*60*1e3}n=Ye.GetFiberTimeout();try{Ye.FiberTimeout(e);return t()}finally{Ye.FiberTimeout(n)}};Fe=function(){var e;e=_.current;if(e._u_fiber_timeout){return e._u_fiber_timeout_cb=setTimeout(function(){clearTimeout(e._u_fiber_timeout_cb);return e._u_fiber_timeout_cb=setTimeout(function(){return Q(e)},500)},e._u_fiber_timeout)}};Q=function(e,t){e._u_fiber_did_timeout=true;clearTimeout(e._u_fiber_timeout_cb);e._u_fiber_timeout_cb=null;e._u_fiber_timeout_msg=t;return Ue(e,t!=null?t:"fiber timed out")};V=function(e){if(e._u_fiber_timeout_cb){clearTimeout(e._u_fiber_timeout_cb);return e._u_fiber_timeout_cb=null}};Ye.QUEUE_TIMEOUT="Operation timed out -- app too busy";G=function(e){var t,n,r;n=_.current;V(n);if(n._u_fiber_did_timeout){n._u_fiber_did_timeout=null;if(n._u_fiber_timeout_msg===Ye.QUEUE_TIMEOUT){throw Ye.error({statusCode:400,message:Ye.QUEUE_TIMEOUT})}t=(r=n._u_fiber_timeout_msg)!=null?r:"Current fiber timed out after "+_.current._u_fiber_timeout+" ms";throw Ye.error(t,{name:e})}};De=Date.now();Ye.Block=function(e,t){return new s(e,t)};s=function(){function e(e,t){this.name=e;this.prefetching=t;if(this.name==null){throw Ye.error("blocks must be named")}}e.prototype.wait=function(){var e,t,n,r,i,o;if(!this.finished){if(!_.current){throw Ye.error("Not inside SyncRun!")}if(this.my_fiber){throw new Error("two blocks trying to wait on the same fiber")}this.my_fiber=_.current;if(!this.suppress_timeout){Fe()}this.yielded=true;_["yield"]();this.yielded=false;this.about_to_resume=false;n=_.current.last_run_timing/1e6;if(_.current.last_run_was_slow){i=_.current.last_run_was_slow/1e6;r=_.current.optional_pause_message;if(_.current.last_run_was_slow>1e9&&!Ye.running_test()&&Date.now()>3e5+De){Ye.warn("Fiber took > 1 second on event loop",{ms:i,message:r})}else{if(Math.random()>Math.pow(.999,Math.round(i-99))){Ye.warn("Fiber took long time on event loop 2",{ms:i,message:r},"warn")}}delete _.current.last_run_was_slow}if(!this.suppress_timeout||_.current._u_fiber_timeout_msg){G(this.name)}this.my_fiber=null}o=this.result,t=o[0],e=o[1];if(t!=null){t=Ye.error(t);if(t.stack==null){t.stack=""}t.stack+="\n\n"+new Error("Outer Error (see above for inner error)").stack;throw t}return e};e.prototype.success=function(e){return this._complete([null,e])};e.prototype.make_cb=function(){var e=this;return function(t,n){if(t){return e.fail(t)}else{return e.success(n)}}};e.prototype.fail=function(e){return this._complete([e])};e.prototype._complete=function(e){if(this.finished){return}this.finished=true;this.result=e;if(this.yielded){this.about_to_resume=true;if(this.about_to_resume){return Ue(this.my_fiber,"after "+this.name,this.prefetching)}}};return e}();Ye.AddErr=i=function(e){return function(){var t,n,r,i;t=2<=arguments.length?Mt.call(arguments,0,i=arguments.length-1):(i=0,[]),n=arguments[i++];try{return e.apply(null,Mt.call(t).concat([function(e){return n(null,e)}]))}catch(o){r=o;return n(r)}}};Ye.pause=function(e){var t;t=Ye.Block("u.pause");t.suppress_timeout=true;setTimeout(t.success.bind(t),e);return t.wait()};Ye.SyncWait=function(){var e,t,n;n=1<=arguments.length?Mt.call(arguments,0):[];t=Ye.MakeKeySet(n);if(t.is_turned()){return}e=Ye.Block(t.toString());L(t,e.success.bind(e));return e.wait()};Ye.MakeKey=k=function(e,t,n){if(!t){Ye.warn("anonymous key created: please name it: u.MakeKey(null, 'my name') or u.MakeKey(timeout, 'my name')")}return new g(e,t,n)};et=null;Ye.FakeKey=function(){if(!et){et=Ye.MakeKey(null,"fake_key");et.turn()}return et};Ye.WaitFor=L=function(){var e,t,n,r,i,o,a,s,u=this;n=2<=arguments.length?Mt.call(arguments,0,r=arguments.length-1):(r=0,[]),e=arguments[r++];n=(a=[]).concat.apply(a,n);n=function(){var e,r,i;i=[];for(e=0,r=n.length;e<r;e++){t=n[e];if(!t.is_turned()){i.push(t)}}return i}();if(n.length===0){return typeof e==="function"?e():void 0}else{s=[];for(i=0,o=n.length;i<o;i++){t=n[i];s.push(function(t){var r;r=function(){Ye.array_remove(n,t);t.off_turned(r);if(n.length===0){return typeof e==="function"?e():void 0}};return t.on_turned(r)}(t))}return s}};wt=0;O=function(){function e(){}e.prototype.id=function(){if(!this._id){this._id=wt;wt++}return this._id};e.prototype.on_turned=function(e){var t,n;if(this.listeners==null){this.listeners=[]}this.listeners.push(e);t=(n=this.warning_number)!=null?n:1e4;if(this.listeners.length>t&&!this._has_warned){this._has_warned=true;console.log("simple listener "+this+" has over "+t+" listeners.  do key.warning_number = N to raise the threshold for this warning")}return e};e.prototype.off_turned=function(e){return Ye.array_remove(this.listeners,e)};e.prototype.turned_dependency=function(){if(this._turned_dependency==null){this._turned_dependency=Ye.Dependency()}return this._turned_dependency};e.prototype.fire_turned=function(e){var t,n,r,i,o,a;if(e==null){e=false}n=[].concat((o=this.listeners)!=null?o:[]);if(e){this.listeners=[]}for(r=0,i=n.length;r<i;r++){t=n[r];t()}return(a=this._turned_dependency)!=null?a.invalidate():void 0};e.prototype.toString=function(){return"SimpleListener of type "+this.constructor.name};return e}();g=function(e){jt(t,e);function t(e,t,n){this.timeout_length=e;this.name=t;this.turned=false;if(this.timeout_length&&this.timeout_length!==Infinity){this.end_time=Date.now()+1e3*this.timeout_length;this.timeout=Ye.timeout_warning(this.name,this.timeout_length,n)}}t.prototype.max_expected_time=function(){if(this.turned||!this.end_time){return null}if(this.timeout_length===Infinity){return Infinity}return this.end_time-Date.now()};t.prototype.turn=function(){if(this.turned){return}this.turned=true;if(typeof this.timeout==="function"){this.timeout()}return this.fire_turned(true)};t.prototype.is_turned=function(){return this.turned};t.prototype.toString=function(){var e;if(this.name){e=typeof this.name==="function"?this.name():this.name;return"Key "+e}else{return"Anonymous Key"}};return t}(O);Ye.MakeSwitch=function(e,t,n){if(!t){Ye.warn("anonymous switch created: please name it")}return new I(e,t,n)};I=function(e){jt(t,e);function t(e,t,n){this.timeout=e;this.name=t;this.timeout_cb=n;this.turn_off();if(this.timeout){throw Ye.error("switch timeout not implemented")}}t.prototype.max_expected_time=function(){return null};t.prototype.turn_off=function(){if(this.turned===false){return}this.turned=false;if(this.timeout){return this.timeout_handle=Ye.timeout_warning(this.name,this.timeout,this.timeout_cb)}};t.prototype.turn_on=function(){if(this.turned===true){return}this.turned=true;if(typeof this.timeout_handle==="function"){this.timeout_handle()}return this.fire_turned();
};t.prototype.is_turned=function(){return this.turned};t.prototype.toString=function(){if(this.name){return"Switch "+this.name}else{return"Anonymous Switch"}};return t}(O);Ye.MakeKeyList=function(e){return new m(e)};m=function(e){jt(t,e);function t(e){var t,n,r,i;this.keys=[];this.callbacks={};i=e!=null?e:[];for(n=0,r=i.length;n<r;n++){t=i[n];this.add_key(t)}}t.prototype.max_expected_time=function(){var e,t,n;e=function(){var e,n,r,i;r=this.keys;i=[];for(e=0,n=r.length;e<n;e++){t=r[e];i.push(t.max_expected_time())}return i}.call(this);e=function(){var t,r,i;i=[];for(t=0,r=e.length;t<r;t++){n=e[t];if(n!=null){i.push(n)}}return i}();if(!e.length){return null}return Math.min.apply(Math,e)};t.prototype.add_key=function(e){this.keys.push(e);return this.add_listener(e)};t.prototype.add_promise=function(e){return this.add_key(e.ready_key())};t.prototype.subtract=function(e){var t,n,r,i,o,a;t=false;r=[];a=this.keys;for(i=0,o=a.length;i<o;i++){n=a[i];if(n===e){t=true}else{r.push(n)}}if(!t){throw Ye.error("key was not in keylist (length "+this.keys.length+")")}return Ye.MakeKeySet(r)};t.prototype.add_listener=function(e){var t=this;return this.callbacks[e.id()]=e.on_turned(function(){if(t.is_turned()){return t.fire_turned()}})};t.prototype.make=function(e,t,n){var r;r=k(e,t,n);this.add_key(r);return r};t.prototype.get=function(){return this.keys};t.prototype.is_turned=function(){var e,t,n,r;r=this.keys;for(t=0,n=r.length;t<n;t++){e=r[t];if(!e.is_turned()){return false}}return true};t.prototype.garbage_collect=function(){var e,t,n,r,i;this.to_remove=function(){var t,n,r,i;r=this.keys;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];if(e.is_turned()){i.push(e)}}return i}.call(this);r=this.to_remove;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];e.off_turned(this.callbacks[e.id()]);this.callbacks[e.id()]=void 0;i.push(Ye.array_remove(this.keys,e))}return i};t.prototype.toString=function(){var e;return"[KeyList("+this.keys.length+") "+function(){var t,n,r,i;r=this.keys;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];if(!e.is_turned()){i.push(e.toString())}}return i}.call(this).join(", ")+" ]"};return t}(O);Ye.MakeKeySet=function(e){return new v(e)};v=function(e){jt(t,e);function t(e){var t,n,r,i;this.keys=[];this.callbacks={};i=e!=null?e:[];for(n=0,r=i.length;n<r;n++){t=i[n];if(!t.is_turned()){this.add_key(t)}}}t.prototype.toString=function(){var e;return"[KeySet("+this.keys.length+"): "+function(){var t,n,r,i;r=this.keys;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];i.push(e.toString())}return i}.call(this).join(", ")+" ]"};t.prototype.add_key=function(e){this.keys.push(e);return this.add_listener(e)};t.prototype.max_expected_time=function(){var e,t,n;e=function(){var e,n,r,i;r=this.keys;i=[];for(e=0,n=r.length;e<n;e++){t=r[e];i.push(t.max_expected_time())}return i}.call(this);e=function(){var t,r,i;i=[];for(t=0,r=e.length;t<r;t++){n=e[t];if(n!=null){i.push(n)}}return i}();if(!e.length){return null}return Math.min.apply(Math,e)};t.prototype.add_promise=function(e){return this.add_key(e.ready_key())};t.prototype.add_listener=function(e){var t=this;return this.callbacks[e.id()]=e.on_turned(function(){t.remove(e);if(t.is_turned()){return t.fire_turned(true)}})};t.prototype.make=function(e,t,n){var r;r=k(e,t,n);this.add_listener(r);this.keys.push(r);return r};t.prototype.get=function(){return this.keys};t.prototype.is_turned=function(){var e,t,n,r;r=this.keys;for(t=0,n=r.length;t<n;t++){e=r[t];if(!e.is_turned()){return false}}return true};t.prototype.remove=function(e){e.off_turned(this.callbacks[e.id()]);return Ye.array_remove(this.keys,e)};return t}(O);Ye.AsyncLock=o=function(){function e(e,t){this.timeout=e;this.timeout_cb=t;this._queue=[];this._locked=false}e.prototype.acquire=function(e){if(this._locked){return this._queue.push(e)}else{return this._grant(e)}};e.prototype._grant=function(e){var t,n,r=this;n=false;if(this.timeout){t=setTimeout(function(){if(n){return}n=true;r.timeout_cb();r._locked=false;return r._next()},this.timeout)}this._locked=true;return e(function(){if(n){return}n=true;clearTimeout(t);r._locked=false;return r._next()})};e.prototype._next=function(){var e;if(this._locked){throw Ye.error("should not happen")}e=this._queue.shift();if(e){return this._grant(e)}};return e}();ve=function(e){return e};Ye.Promise=function(e,t){if(typeof(e!=null?e.then:void 0)==="function"){return e}else{return new T(e,t)}};T=function(){function e(e,t){var n,r,i;this._fails=[];this._dones=[];this._done=false;if(t){this._waiting_on=t}else{if(typeof e==="function"){try{r=false;i=e()}catch(o){n=o;r=true;this.reject(n)}if(!r){this.resolve(i)}}else{this.resolve(e)}}}e.prototype.get_prefetching=function(){if(this.prefetching!=null){return this.prefetching}if(this._waiting_on instanceof e){return this._waiting_on.get_prefetching()}};e.prototype.toString=function(){var t;if(this._done){return"Promise("+((t=this._error)!=null?t:this._value)+")"}else{if(this._waiting_on instanceof e){return String(this._waiting_on)}else{return"Promise(waiting on "+this._waiting_on+")"}}};e.prototype.reject=function(e){var t,n,r,i,o,a=this;if(this._done){return}this._done=true;this._waiting_on=null;this._error=e;if(this._fails.length>0){i=this._fails;o=[];for(n=0,r=i.length;n<r;n++){t=i[n];o.push(t(e))}return o}else{return setTimeout(function(){if(!a._handled_error){throw e}},100)}};e.prototype.resolve=function(t){var n,r,i,o,a,s=this;if(this._done){return}if(t instanceof e){this._waiting_on=t;t._attach_success(function(e){return s.resolve(e)});return t._attach_failure(function(e){return s.reject(e)})}else{this._done=true;this._waiting_on=null;this._value=t;o=this._dones;a=[];for(r=0,i=o.length;r<i;r++){n=o[r];a.push(n(t))}return a}};e.prototype._attach_success=function(e){if(typeof e!=="function"){throw Ye.error("not a function")}if(this._done){if(!this._error){return e(this._value)}}else{return this._dones.push(e)}};e.prototype._attach_failure=function(e){if(typeof e!=="function"){throw Ye.error("not a function")}if(this._done){if(this._error){e(this._error);return this._handled_error=true}}else{return this._fails.push(e)}};e.prototype.then=function(e,t){var n;if(e==null){e=ve}if(t==null){t=ve}n=Ye.Promise(null,this);this._attach_success(function(t){var r,i,o;try{o=false;i=e(t)}catch(a){r=a;o=true;n.reject(r)}if(!o){return n.resolve(i)}});this._attach_failure(function(e){var r,i;try{i=t(e)}catch(o){r=o;i=r}if(i){return n.reject(i)}else{return n.resolve()}});return n};e.prototype.callback=function(e){this.then(function(t){return e(null,t)},function(t){e(t);return null});return null};e.prototype.done=function(e){if(e==null){e=ve}this._attach_success(e);this._attach_failure(function(e){if(e){return setTimeout(function(){throw e},1)}});return null};e.prototype.block=function(){var e;e=Ye.Block(this.toString(),this.get_prefetching());this.callback(function(t,n){if(t){return e.fail(t)}else{return e.success(n)}});return e.wait()};e.prototype.block_promise=function(e){var t=this;if(Ye.on_server()){Ye.suspend_fiber_timeout(e,function(){return t.block()})}return this};e.prototype.sync=function(){if(Ye.on_server()){return this.block()}Ye.ensure_ready(this.ready_key());if(this._error){throw this._error}return this._value};e.prototype.ready_key=function(){var e=this;if(!this._ready_key){this._ready_key=Ye.MakeKey(null,function(){return e.toString()});this._attach_success(function(){return e._ready_key.turn()});this._attach_failure(function(){return e._ready_key.turn()})}return this._ready_key};e.prototype.inspect=function(){if(!this._done){return{state:"pending"}}if(this._error){return{state:"rejected",reason:this._error}}else{return{state:"fulfilled",value:this._value}}};e.prototype.make_cb=function(){var e=this;return function(t,n){if(t){return e.reject(t)}else{return e.resolve(n)}}};return e}();Ye.promise_array=function(e,t){if(t==null){t=[]}if(e.length===0){return Ye.Promise(t)}else{return e[0].then(function(n){t.push(n);return Ye.promise_array(e.slice(1),t)})}};Ye.get_status_code=function(e){return e.statusCode};Ye.is_human_friendly=function(e){var t;return e.statusCode&&((t=e.statusCode)===400||t===401)&&e.message};Ye.human_friendly=function(e,t){if(t==null){if(!Ye.is_edit_mode()){t=y().get_text("CORE","TEMPORARY_BUG")}else{t="Sorry, we ran into a temporary bug and can't complete your request.  We'll fix it as soon as we can; please try again in a bit!"}}if(Ye.is_human_friendly(e)){return e.message}else{setTimeout(function(){throw e},1);return t}};tt=null;pt=0;Ye.all_page_errors=[];xe=function(e){Ye.all_page_errors.push(e);pt+=1;if(pt>2){console.log("we have already reported two bugs, not reporting any more");return}return y().location.post("server://bug",e)};Ye.make_object_errors_real=function(t){if(t.stack&&t.message){return t}if(!(t instanceof Error)){t=Ye.error("Uncaught non-Error thing",{inspected:e("util").inspect(t),type:typeof t})}else if(!t.stack){t.stack="Caught err was err but had no stack.  Constructor: "+t.constructor.name+", and inspect: "+e("util").inspect(t)}return t};if(Ye.on_client()){window.onerror=function(e,t,n,r,i){var o,a;try{if(!i){a=e+" (no stack)";i=Ye.error(a);i.stack="line "+n;if(r){i.stack+=" col "+r}i.stack+="\n in "+t}if(i.already_reported){return false}i=Ye.make_object_errors_real(i);we(i,{url:t,line:n,col:r})}catch(s){o=s;o.message="Error in window.onerror: "+o.message;we(o)}return false}}j=Date.now();we=function(e,t){var n;e=Ye.error(e);if(e.already_reported){return}e.already_reported=true;n={message:e.message,stack:e.stack,original_msg:e.original_msg,args:e.args,code:e.code,time_since_load:Date.now()-j};Ye.extend(n,t);Ye.extend(n,Ye.error_environment);return xe(n)};Me=function(e){var t,n;for(t in e){n=e[t];if(n===void 0){e[t]="<undefined>"}}return e};Ye.nice_print_error=function(e){var t,n,r,i;if(typeof(e!=null?e.stack:void 0)==="string"){if(e.message&&!Ye.safe_contains(e.stack,String(e.message))){r=String(e.message)+"\n"+e.stack}else{r=e.stack}if(e.args){try{t="error with args ("+Ye.json_stringify(e.args)+"): "}catch(o){i=o;n="[could not stringify args]"}}else{t="error stack:\n"}return t+r}try{return"error stringified: "+JSON.stringify(e)}catch(o){i=o;return"error failed to stringify: "+e}};Ye.error=function(t,n){var r,i,o,a,s,u,l;if(t instanceof Error){i=t}else if(t&&t.statusCode&&(t.message||t.html||t.headers||t.reason||t.body)){i=t;if(i.reason&&!i.message){l=i.reason.split("."),u=l[0],a=l[1];if(!a){a=u;u="CORE"}i.message=y().get_text(u,a)}try{r=JSON.stringify(i)}catch(c){i=c;r=e("util").inspect(t)}if(i.stack==null){i.stack=new Error("adding stack to object "+r).stack}}else{if(t&&typeof t==="object"){try{s=t;t=JSON.stringify(t)}catch(c){o=c;s="could not stringify so inspecting";t=e("util").inspect(t)}}i=new Error(t);if(s){i.original_msg=s}}if(n){if(i.args==null){i.args={}}Ye.extend(i.args,Me(n))}return i};Ye.warn=function(t,n,r){var i,o,a,s;if(typeof t!=="string"){if(n==null){n={}}n.warn_stack=new Error("called warn here").stack}if(r!=null){if(n==null){n={}}n.level=r}o=Ye.error(t,n);if(Ye.running_test()){if(r==="warn"||r==="info"){return}throw Ye.error(o)}if(Ye.on_server()){oe=e;i=oe("./bugservice");a=(s=y())!=null?s:{};return Ye.SyncRun(D,function(){return y.extend(a,function(){return(new i).handle(o)})})}else{we(o);return setImmediate(function(){throw o})}};Ye.timeout_warning=function(e,t,n){var r;if(t==null){t=40}r=setTimeout(function(){if(typeof e==="function"){e=e()}console.log(e+" failed to return after "+t+" seconds.");return typeof n==="function"?n():void 0},t*1e3);return function(){return clearTimeout(r)}};Ye.to_object=function(e){var t,n,r,i;t={};for(r=0,i=e.length;r<i;r++){n=e[r];t[n[0]]=n[1]}return t};Ye.extend=function(e,t,n,r,i,o){var a,s;if(o){throw Ye.error("u.extend using more than 4 args!!!!")}if(t){for(a in t){s=t[a];if(s!==void 0){e[a]=s}}}if(n){for(a in n){s=n[a];if(s!==void 0){e[a]=s}}}if(r){for(a in r){s=r[a];if(s!==void 0){e[a]=s}}}if(i){for(a in i){s=i[a];if(s!==void 0){e[a]=s}}}return e};Ye.deep_copy=function(){var e,t;e=arguments[0],t=2<=arguments.length?Mt.call(arguments,1):[];return K.apply(null,[false,e].concat(Mt.call(t)))};Ye.json_deep_copy=function(e){if(e&&typeof e==="object"){return JSON.parse(JSON.stringify(e))}else{return e}};Ye.incremental_json_deep_copy=function(e){var t;t="";Ye.incremental_json_stringify(e,function(e){return t+=e});return Ye.incremental_json_parse(t)};Ye.json_stringify=function(t,n,r){var i,o,a,s;if(r==null){r=false}try{return JSON.stringify(t,null,n)}catch(u){i=u;if(r){return e("util").inspect(t)}a=i.message+".  Data was "+t.constructor.name+", with fields: "+function(){var e;e=[];for(o in t){s=t[o];e.push(o)}return e}().join(", ");throw Ye.error(a)}};Ye.json_parse=function(e,t){var n,r;try{return JSON.parse(e)}catch(i){n=i;if(t){return e}r="json_parse failure: "+n.message;throw Ye.error(r,{string:e})}};Ye.incremental_json_parse=function(e){var t,n,r;if(!Ye.on_server()){return JSON.parse(e)}r=null;n=new h;n.onError=function(t){throw Ye.error("Could not parse JSON: "+e.slice(0,1e3))};n.onValue=function(e){return r=e};t=0;Ye.optional_pause("starting incremental_json_parse");while(t<e.length){n.write(e.slice(t,t+1e3));t+=1e3;Ye.optional_pause("incremental_json_parse")}return r};Ye.incremental_json_stringify=function(e,t){var n;Ye.optional_pause("incremental json stringify start");n=function(e){var r,i,o,a,s,u,l,c,f;if(e==null||typeof e!=="object"||e instanceof Date){return t(JSON.stringify(e))}else{Ye.optional_pause("incremental json digest obj");i=true;if(Array.isArray(e)){t("[");for(o=c=0,f=e.length;c<f;o=++c){a=e[o];if(i){i=false}else{t(",")}n(a);if(o%5===0){Ye.optional_pause("increment json stringify array")}}return t("]")}else{t("{");r=0;for(s in e){l=e[s];u='"'+s+'":';if(i){i=false}else{u=","+u}t(u);r++;if(r%5===0){Ye.optional_pause("incremental json stringify key")}n(l)}return t("}","utf8")}}};n(e);Ye.optional_pause("incremental json stringify finished");return null};Ye.incremental_json_digest=function(e){var t;t=Y.createHash("md5");Ye.incremental_json_stringify(e,function(e){return t.update(e,"utf8")});return t.digest("hex")};st=function(e,t,n,r){var i;if(t==null){throw Ye.error("Trying to _deep_copy onto mising value",{dest:t,key:n,value:r})}if(typeof r==="object"&&r!==null){if(!t[n]){if(Array.isArray(r)){t[n]=[]}else{t[n]={}}}return K(e,t[n],r)}else{if(r!==void 0){if(e&&(n==="id"||n==="_id")){i=t[n];t[n]=Ye.LUID();return e[i]=t[n]}else{return t[n]=r}}}};K=function(){var e,t,n,r,i,o,a,s,u,l,c,f,d;r=arguments[0],e=arguments[1],o=3<=arguments.length?Mt.call(arguments,2):[];if(e==null){throw Ye.error("Trying to dc onto mising value",{dest:e,key:n,value:a})}if(Array.isArray(e)){for(s=0,c=o.length;s<c;s++){i=o[s];if(!Array.isArray(i)){throw Ye.error("can only extend an array with another array")}for(t=u=0,d=i.length;0<=d?u<d:u>d;t=0<=d?++u:--u){st(r,e,t,i[t])}}}else{for(l=0,f=o.length;l<f;l++){i=o[l];for(n in i){a=i[n];st(r,e,n,a)}}}return e};Ye.walk=function(e,t,n){var r,i,o;if(n==null){n=""}t(e,n);if(e&&typeof e==="object"){o=[];for(r in e){i=e[r];o.push(Ye.walk(i,t,n+"."+r))}return o}};Ye.json_to_csv=function(e,t,n,r){var i,o,a,s,u,l,c,f,d,_;if(t==null){t=","}if(n==null){n=true}if(r==null){r=false}if(typeof e!=="object"){e=JSON.parse(e)}s="";if(n){a=[];if(r){d=e[0];for(o in d){l=d[o];u=o+"";a.push('"'+u.replace(/"/g,'""')+'"')}}else{_=e[0];for(o in _){l=_[o];a.push(o)}}s=function(){var e,t,n;n=[];for(e=0,t=a.length;e<t;e++){i=a[e];n.push(i)}return n}().join(t)+"\n"}for(c=0,f=e.length;c<f;c++){i=e[c];a=[];if(r){for(o in i){u=i[o];u=u+"";a.push('"'+u.replace(/"/g,'""')+'"')}}else{for(o in i){u=i[o];a.push(u)}}s=s+function(){var e,t,n;n=[];for(e=0,t=a.length;e<t;e++){i=a[e];n.push(i)}return n}().join(t)+"\n"}return s};gt=function(e){return e.replace(/"/g,"")};Ye.get_columns_header=function(e,t,n){var r,i,o,a,s,u;if(t==null){t=","}if(n==null){n=false}if(!e||e.trim()===""){return}e=e.trim();r=e.split("\n");o=[];u=r[0].split(t);for(a=0,s=u.length;a<s;a++){i=u[a];if(n){o.push(gt(i))}else{o.push(i)}}return o};Ye.csv_to_downloadable_file=function(e,t){var n,r;r=document.createElement("a");if(r){r.setAttribute("class","fake-link-to-trigger-a-download");if(navigator.msSaveOrOpenBlob){setTimeout(function(){var n;n=new Blob([t],{type:"text/csv"});return navigator.msSaveOrOpenBlob(n,e)},1e3);document.body.removeChild(r);return}n=new Blob([t],{type:"text/csv"});$e=window.URL.createObjectURL(n);r.setAttribute("href",$e);document.body.appendChild(r);r.setAttribute("download",e);r.click();document.body.removeChild(r);return window.URL.revokeObjectURL($e)}};Ye.smush=function(){var e;e=1<=arguments.length?Mt.call(arguments,0):[];return xt(e)};xt=function(e){var t;e=function(){var n,r,i,o;o=[];for(n=0,r=e.length;n<r;n++){t=e[n];if(!t||((i=typeof t)==="string"||i==="number")||t instanceof Date){o.push(t)}else if(Array.isArray(t)){o.push(xt(t))}else if(t.toUniqueString()){o.push(t.toUniqueString())}else{throw Ye.error("bad smush: "+t)}}return o}();return JSON.stringify(e)};Ye.RECURSION={};Ye.compute_once=function(e){var t;t={};return function(){var n,r;n=1<=arguments.length?Mt.call(arguments,0):[];r=JSON.stringify(n);if(!t[r]){t[r]=Ye.RECURSION;t[r]=e.apply(null,n)}return t[r]}};Ye.sub_object=function(e,t){var n,r;if(t===""){return e}n=function(){var e,n,i,o;i=t.split(".");o=[];for(e=0,n=i.length;e<n;e++){r=i[e];if(r!==""){o.push(r)}}return o}();if(e[n[0]]===void 0){e[n[0]]={}}return Ye.sub_object(e[n[0]],n.slice(1).join("."))};Ye.sub_object2=function(e,t){var n,r;if(t===""||t===null||t===void 0){return e}if(e===null||e===void 0){return e}n=function(){var e,n,i,o;i=t.split(".");o=[];for(e=0,n=i.length;e<n;e++){r=i[e];if(r!==""){o.push(r)}}return o}();if(e[n[0]]===void 0){return void 0}return Ye.sub_object(e[n[0]],n.slice(1).join("."))};Ye.sub_object_assign=function(e,t,n){var r,i;r=function(){var e,n,r,o;r=t.split(".");o=[];for(e=0,n=r.length;e<n;e++){i=r[e];if(i!==""){o.push(i)}}return o}();if(r.length===0){return n}if(r.length===1){e[r[0]]=n;return e}if(e[r[0]]===void 0){e[r[0]]={}}Ye.sub_object_assign(e[r[0]],r.slice(1).join("."),n);return e};Ye.is_empty=function(e){var t,n;if(!e||typeof e!=="object"){return false}for(t in e){if(!Ct.call(e,t))continue;n=e[t];return false}return true};Ye.not_empty=function(e){return e!=null&&typeof e==="object"&&!Ye.is_empty(e)};Ye.firebase_illegal=function(e){return/[\.\$#\[\]\/]/.test(e)};Ye.firebase_remove_illegal=function(e){return e.replace(/[\.\$#\[\]\/]/,"_")};re="&";ye={1:".",2:"$",3:"#",4:"[",5:"]",6:"/"};Re={};for(te in ye){W=ye[te];Re[W]=te}mt=function(e,t,n){var r,i;r="";i=e.split(t);if(i.length===1){return e}return i.join(n)};Ye.encode_key=function(e){var t;if(!Ye.firebase_illegal(e)){return e}t=mt(e,re,re+re);for(W in Re){te=Re[W];t=mt(t,W,re+te)}return t};Ye.decode_key=function(e){var t;t=mt(e,re+re,re);for(te in ye){W=ye[te];t=mt(t,re+te,W)}return t};Ye.singleton=function(e){var t;t=null;return function(){if(!t){Ye.autorun_top(function(){return t=new e})}return t}};Ye.make_new=function(e){return function(){var t;t=1<=arguments.length?Mt.call(arguments,0):[];return function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t);return Object(i)===i?i:r}(e,t,function(){})}};Ye.lazy=function(e){var t;t={};return function(){var n,r;n=1<=arguments.length?Mt.call(arguments,0):[];r=Ye.smush.apply(Ye,n);if(t[r]===void 0){t[r]=e.apply(null,n)}return t[r]}};Ye.process_response_body=function(e,t){var n;e.setEncoding("utf8");n=[];e.on("data",function(e){return n.push(e)});e.on("end",function(e){n.push(e);return t(null,n.join(""))});return e.on("error",function(e){return t(e)})};Ye.div=function(e,t,n){return ke("div",e,t,n)};Ye.span=function(e,t,n){return ke("span",e,t,n)};Ye.input=function(e,t,n,r){var i;i=ke("input",e,t);i.attr("type",n);return i.attr("placeholder",r)};Ye.img=function(e,t,n){var r;r=ke("img",e,t);if(n!=null){r[0].src=n}return r};ke=function(e,t,n,r){var i,o,a,s,u;if(!t){t=[]}if(!$.isArray(t)){t=[t]}t=function(){var e,n,r;r=[];for(e=0,n=t.length;e<n;e++){i=t[e];r.push(i.replace(".",""))}return r}();a=$("<"+e+"></"+e+">");for(s=0,u=t.length;s<u;s++){o=t[s];if(o){a.addClass(o.toLowerCase())}}if(n){if(typeof n.append_to_div==="function"){n=n.append_to_div()}n.append(a)}if(r!=null){a.text(r)}return a};Ye.apply_scale=function(e,t){var n,r;r="scale("+t+","+t+")";n="0 0";return e.css({transform:r,"-ms-transform":r,"-webkit-transform":r,"-o-transform":r,"-moz-transform":r,"tranform-origin":n,"-ms-transform-origin":n,"-webkit-transform-origin":n,"-o-transform-origin":n,"-moz-transform-origin":n})};Ye.not_ready_key=function(e){var t;return(t=e.not_ready_key)!=null?t:false};Ye.NeverCatchNotReady=false;Ye.throw_not_ready=function(e,t){var n;if(t==null){t=true}e.turned_dependency().register();if(t&&Ye.CurrentNotReadyCatcher!=null&&!Ye.NeverCatchNotReady){return Ye.CurrentNotReadyCatcher.push(e)}else{n=Ye.error("not ready");n.not_ready_key=e;throw Ye.error(n)}};Ye.run_without_catching_not_ready=function(e){var t;try{t=Ye.NeverCatchNotReady;Ye.NeverCatchNotReady=true;return e()}finally{Ye.NeverCatchNotReady=t}};Ye.ensure_ready=function(e,t){if(t==null){t=true}if(e.is_turned()){return true}if((_!=null?_.current:void 0)!=null){Ye.SyncWait(e);return true}else{Ye.throw_not_ready(e,t);return false}};Ye.retry=function(e,t,n){var r;if(typeof n!=="function"){throw Ye.error("u.retry bad function param")}try{return n()}catch(i){r=i;if(e>0){if(t){Ye.pause(t)}return Ye.retry(e-1,t,n)}else{throw r}}};Ye.CurrentNotReadyCatcher=null;Ye.no_outstanding_run_once=Ye.MakeKeyList();Ye.run_once=function(e,t,n,r){var i,o,a,s,u,l;if(typeof e!=="number"){throw Ye.error("calling run_once with non-numeric value for timeout_seconds")}if(Ye.on_server()){s=Ye.Promise(t)}else{s=Ye.Promise(null,"Running once: "+t);if(r){o=Ye.MakeKey(e+5,"run once: "+String(t))}else{o=Ye.no_outstanding_run_once.make(e+5,"run once: "+String(t))}l=Ye.Watcher(t);if(r){l.dont_track_scheduling()}l.once_value(function(e){if(o.is_turned()){return}o.turn();l.destroy();Ye.no_outstanding_run_once.garbage_collect();return s.resolve(e)});l.once_error(function(e){if(o.is_turned()){return}o.turn();l.destroy();return s.reject(e)});a=Date.now()+e*1e3;i=function(){var e;if(o.is_turned()){return}e=l.max_expected_time();if(e==null){e=a-Date.now()}if(e<0){u()}else{return setTimeout(i,Math.min(1e4,e))}};u=function(){var n,r,i,a,u,c,f;r="u.run_once timed out after "+e+" seconds";n=String(t);f=l.get_current_status(),a=f[0],c=f[1],u=f[2];if(a){i="WAS AN ERR, WHY DID WE NOT CALL ERROR HANDLER? "+Ye.nice_print_error(a)}else if(c){i="WATCHER IS READY, WHY DID WE NOT CALL ONCE_VALUE: "+u}else{if(!u){i="<NO READY KEYS>"}else if(u.is_turned()){i="WATCHER IS MARKED NOT READY BUT KEYS ARE TURNED: "+u+". IS SCHEDULED: "+l._is_scheduled}else{i="waiting on "+u}}if(Ye.error_environment.cannot_connect){s.reject({statusCode:400,message:"We are not connected to the server right now and could not complete this action.  Please try again once the internet connection is stronger..."})}else{s.reject(Ye.error(r,{waiting_on:i,fn_source:n}))}o.turn();return l.destroy()};i()}if(n){s.callback(n)}return s};Et=function(e,t,n){var r;try{return e()}catch(i){r=i;return t(r)}finally{n()}};Ne=function(e,t){var n;try{return[true,Ye.compare(e,t)]}catch(r){n=r;if(Ye.not_ready_key(n)){return[false]}else{throw n}}};Ye.Watcher=function(e,t){return new q(e,t)};q=function(){function e(e,t){var n=this;if(Ye.on_server()&&!Ye.running_test()){Ye.warn("IN A WATCHER ON THE SERVER!")}this.evaluate=function(){var r,i,o,a,s,u,l,c,f,d,_,p,h,g,m,v,y,b,w,x,k,S,A,E,M,T;d=Ye.CurrentNotReadyCatcher;c=[];f=Ye.CurrentAutoRun;n._ar_object=l={id:Ye.LUID(),invalidate:function(){if(n.ready_keys&&!n.ready_keys.is_turned()){return}l.invalidate=function(){};l.destroy();if(Ye.running_test()&&!t){return l.run_me()}else{Le(l);return n._is_scheduled=l}},destroy:function(){return l._is_destroyed=true},run_me:function(){l.run_me=function(){};if(l===n._is_scheduled){n._is_scheduled=null}return n.evaluate()},dont_track_scheduling:n._dont_track_scheduling,stop_tracking:function(){return this.dont_track_scheduling()}};u=null;_=null;p=null;Et(function(){Ye.CurrentNotReadyCatcher=c;Ye.CurrentAutoRun=l;return p=e()},function(e){_=Ye.not_ready_key(e);if(_){return c.push(_)}else{return u=e}},function(){Ye.CurrentNotReadyCatcher=d;return Ye.CurrentAutoRun=f});if(u){n.error=u;n.value=null;n.ready=true;if((w=n.dependency)!=null){w.invalidate()}o=(x=n.error_listeners)!=null?x:[];if(o.length>0){k=n.error_listeners;for(h=0,v=k.length;h<v;h++){s=k[h];s(n.error)}}else{Ye.warn(n.error)}return n._ready_rerun_count=0}else if(c.length===0){a=!n.ready;if(!a){S=Ne(p,n.value),i=S[0],r=S[1];a=!i||!r}if(a){n.ready=true;n.error=null;n.value=p;if((A=n.dependency)!=null){A.invalidate()}if(n.listeners){E=n.listeners;T=[];for(g=0,y=E.length;g<y;g++){s=E[g];T.push(s(n.value))}return T}}else{return n.value=p}}else{if(n.ready!==false&&n.not_ready_listeners!=null){M=n.not_ready_listeners;for(m=0,b=M.length;m<b;m++){s=M[m];s()}}n.ready=false;n.value=null;n.error=null;return n.ready_keys=Ye.MakeKeySet(c)}};this.evaluate();if(this._ar_object._has_dependency||!this.ready){this.dependency=Ye.Dependency();this.listeners=[];this.error_listeners=[]}else{this.evaluate=null;this._ar_object=null}}e.prototype.dont_track_scheduling=function(){var e;this._dont_track_scheduling=true;return(e=this._ar_object)!=null?e.dont_track_scheduling=true:void 0};e.prototype.invalidate=function(){var e;return(e=this._ar_object)!=null?e.invalidate():void 0};e.prototype.max_expected_time=function(){var e,t;return(e=(t=this.ready_keys)!=null?t.max_expected_time():void 0)!=null?e:null};e.prototype.get_current=function(e){var t,n;if((t=this._is_scheduled)!=null){t.run_me()}if((n=this.dependency)!=null){n.register()}if(this.error){if(e){return[null,null,this.error]}throw this.error}if(this.ready){return[this.ready,this.value]}else{return[this.ready,this.ready_keys]}};e.prototype.get_current_status=function(){if(this.error){return[this.error]}if(this.ready){return[null,this.ready,this.value]}else{return[null,this.ready,this.ready_keys]}};e.prototype.get=function(){var e,t;if((e=this._is_scheduled)!=null){e.run_me()}if((t=this.dependency)!=null){t.register()}if(this.error){throw this.error}if(!this.ready){Ye.ensure_ready(this.ready_keys,false);this.evaluate();return this.get()}return this.value};e.prototype.on_value=function(e){var t,n,r=this;t=function(t){var n;try{return e(t)}catch(r){n=r;return Ye.warn(n)}};if((n=this.listeners)!=null){n.push(t)}if(this.error){return Ye.warn(this.error)}else if(this.ready){return t(this.value)}};e.prototype.on_not_ready=function(e){var t,n=this;t=function(){var t;try{return e()}catch(n){t=n;return Ye.warn(t)}};if(this.not_ready_listeners==null){this.not_ready_listeners=[]}this.not_ready_listeners.push(t);if(this.ready===false){return t()}};e.prototype.on_error=function(e){var t,n,r=this;t=function(t){try{return e(t)}catch(n){t=n;return Ye.warn(t)}};if((n=this.error_listeners)!=null){n.push(t)}if(this.error){return t(this.error)}};e.prototype.once_error=function(e){var t,n=this;t=function(r){Ye.array_remove(n.error_listeners,t);return e(r)};return this.on_error(t)};e.prototype.once_value=function(e){var t,n=this;t=function(r){Ye.array_remove(n.listeners,t);return e(r)};return this.on_value(t)};e.prototype.once_change=function(e){var t,n,r=this;t=function(n){Ye.array_remove(r.listeners,t);return e(n)};return(n=this.listeners)!=null?n.push(e):void 0};e.prototype.destroy=function(){var e;this.listeners=[];this.not_ready_listeners=[];this.dependency=void 0;this.ready_keys=null;this.evaluate=function(){};this._is_scheduled=void 0;if((e=this._ar_object)!=null){e.destroy()}return this._ar_object=void 0};return e}();Ye.FakeWatcher=function(e){return new d(e)};d=function(){function e(e){this.data=e}e.prototype.invalidate=function(){};e.prototype.get_current=function(e){return[true,this.data]};e.prototype.get_current_status=function(){return[null,true,this.data]};e.prototype.get=function(){return this.data};e.prototype.on_value=function(e){return e(this.data)};e.prototype.on_error=function(e){};e.prototype.on_not_ready=function(e){};e.prototype.once_error=function(e){};e.prototype.once_value=function(e){return e(this.data)};e.prototype.once_change=function(e){};e.prototype.destroy=function(){};return e}();Ye.wait_for_updates=function(e){return setTimeout(function(){if(Ye.scheduled_key.is_turned()){return e()}else{return Ye.WaitFor(Ye.scheduled_key,function(){return Ye.wait_for_updates(e)})}},10)};Ye.wait_for_element=function(e,t,n){var r,i,o;i=null;r=setTimeout(function(){clearTimeout(i);return n("could not find "+e+" after "+t+" ms")},t);o=function(){if($(e).length>0){clearTimeout(r);return n()}else{return i=setTimeout(o,100)}};return o()};Ye.is_attached=function(e){return e.closest("html").length>0};Ye.is_fixed=function(e){var t;t=e;while(t.length&&!t.is("body")){if(t.css("position")==="fixed"){return true}t=t.parent()}return false};Ye.wait_for_attached=function(e,t){var n,r;r=false;e.on("remove",function(){return r=true});n=function(i){if(i==null){i=10}if(r){return}if(Ye.is_attached(e)){return t()}else{if(typeof i==="function"){return i()}else{return setTimeout(function(){return n(i*2)},i)}}};return n(function(){return Ye.WaitFor(Ye.scheduled_key,function(){return n(function(){Ye.warn("element "+e[0].outerHTML+" was not attached after u.scheduled_key");return n()})})})};Ye.wait_for_visible=function(e,t){var n;n=function(r){if(r==null){r=10}if(r>500){return}if(e.is(":visible")){return t()}else{if(typeof r==="function"){return r()}else{return setTimeout(function(){return n(r*2)},r)}}};return n(function(){return Ye.WaitFor(Ye.scheduled_key,function(){return n()})})};Ye.CurrentAutoRun=null;Ye.autorun=function(e,t){return new a(e,t)};a=function(){function e(e,t,n){this.fn=e;this.cleanup=t;this.run_once=n!=null?n:false;this.id=Ye.LUID();this._is_destroyed=false;this._subs=[];if(Ye.CurrentAutoRun){Ye.CurrentAutoRun.add_sub(this)}this.run_me()}e.prototype.set_run_immediately=function(e){this.run_immediately=e};e.prototype.alive=function(){return!this._is_destroyed};e.prototype.invalidate=function(){if(this._is_destroyed){return}if(this.run_once){return}if(rt===this){Ye.warn("Watched autorun just got invalidated")}if(this.run_immediately||Ye.on_server()){if(this._is_running){this._do_another_run=true;if(this._recursive_runs>20){throw Ye.error("recursive autorun run immediately loop")}}else{return this.run_me()}}else{return Le(this)}};e.prototype.run_me=function(){var e,t,n;if(this._is_destroyed){return}this.destroy_subs();try{n=Ye.CurrentAutoRun;Ye.CurrentAutoRun=this;t=Ye.CurrentNotReadyCatcher;Ye.CurrentNotReadyCatcher=null;this._is_running=true;this.fn()}catch(r){e=r;if(!Ye.not_ready_key(e)){Ye.warn(e)}}finally{this._is_running=false;Ye.CurrentAutoRun=n;Ye.CurrentNotReadyCatcher=t}if(this._do_another_run){this._do_another_run=false;if(this._recursive_runs==null){this._recursive_runs=0}this._recursive_runs++;return this.run_me()}else{return delete this._recursive_runs}};e.prototype.destroy_subs=function(){var e,t,n,r;r=this._subs;for(t=0,n=r.length;t<n;t++){e=r[t];e.destroy()}return this._subs=[]};e.prototype.destroy=function(){this._is_destroyed=true;this.destroy_subs();return typeof this.cleanup==="function"?this.cleanup():void 0};e.prototype.add_sub=function(e){return this._subs.push(e)};e.prototype.stop_tracking=function(){return this.dont_track_scheduling=true};return e}();Ye.autorun_once=function(e){return new a(e,null,true)};Ye.autorun_top=function(e){var t,n;try{n=Ye.CurrentAutoRun;Ye.CurrentAutoRun=null;t=Ye.CurrentNotReadyCatcher;Ye.CurrentNotReadyCatcher=null;return e()}finally{Ye.CurrentAutoRun=n;Ye.CurrentNotReadyCatcher=t}};Ye.autotop=function(e){return Ye.autorun_top(function(){return Ye.autorun(e)})};Ye.mock_auto_run=function(e){var t,n,r;try{r=Ye.CurrentAutoRun;t=new S;Ye.CurrentAutoRun=t;n=Ye.CurrentNotReadyCatcher;Ye.CurrentNotReadyCatcher=null;e();return t}finally{Ye.CurrentAutoRun=r;Ye.CurrentNotReadyCatcher=n}};S=function(){function e(){this.wr=false;this.id=Ye.LUID()}e.prototype.will_run=function(){return this.wr;
};e.prototype.invalidate=function(){return this.wr=true};return e}();Ye.scheduled_key=Ye.MakeSwitch(null,"u.scheduled_key");Ye.scheduled_key.turn_on();Le=function(){var e,t,n,r;n={};r=false;e=function(){if(r){return}r=true;return setTimeout(t,1)};t=function(){var e,t,i,o,a,s;r=false;i=function(){var t;t=[];for(e in n){o=n[e];t.push(o)}return t}();n={};for(a=0,s=i.length;a<s;a++){t=i[a];t.run_me()}if(!r){return Ye.scheduled_key.turn_on()}};return function(t){n[t.id]=t;if(!t.dont_track_scheduling){Ye.scheduled_key.turn_off()}return e()}}();c=function(){function e(){this.runs={};this.count=0;this.no_scheduled_collection=true}e.prototype.register=function(e){if(e==null){e=Ye.CurrentAutoRun}if(e){this.runs[e.id]=e;this.count++;e._has_dependency=true;if(this.no_scheduled_collection&&this.count>50){this.no_scheduled_collection=false;return this.schedule_collection()}}};e.prototype.needed=function(){if(this.count===0){return false}this.garbage_collect();return this.count>0};e.prototype.garbage_collect=function(){var e,t,n,r;t=this.runs;this.runs={};this.count=0;r=[];for(e in t){n=t[e];if(!n._is_destroyed){this.runs[e]=n;r.push(this.count++)}else{r.push(void 0)}}return r};e.prototype.schedule_collection=function(){var e=this;return setTimeout(function(){e.no_scheduled_collection=true;return e.garbage_collect()},3e4)};e.prototype.once_invalidate=function(e){return this.runs[Ye.LUID()]={invalidate:e}};e.prototype.invalidate=function(){var e,t,n,r,i,o,a;n=function(){var t,n;t=this.runs;n=[];for(e in t){r=t[e];n.push(r)}return n}.call(this);this.runs={};this.count=0;a=[];for(i=0,o=n.length;i<o;i++){t=n[i];a.push(t.invalidate())}return a};return e}();Ye.Dependency=function(){return new c};rt=null;Ye.autorun_watch=function(){return rt=Ye.CurrentAutoRun};Ye.compare=function(e,t){var n,r,i,o;if(e===t){return true}if(typeof(e!=null?e.is_equal_to:void 0)==="function"){return e.is_equal_to(t)}if((e!=null?e.toUniqueString:void 0)&&(t!=null?t.toUniqueString:void 0)){return e.toUniqueString()===t.toUniqueString()}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length){return false}for(r=i=0,o=e.length;i<o;r=++i){n=e[r];if(!Ye.compare(n,t[r])){return false}}return true}if(e instanceof Date&&t instanceof Date){return e.getTime()===t.getTime()}return false};Ye.Box=function(e,t){var n;n=new u(e);if(t){n.not_ready()}return n.val.bind(n)};u=function(){function e(e){this.state=e;this.dependency=Ye.Dependency();this.is_not_ready=false;this.not_ready_switch=null}e.prototype.not_ready=function(){this.is_not_ready=true;if(this.not_ready_switch==null){this.not_ready_switch=Ye.MakeSwitch(null,"u.Box not_ready_switch")}return this.not_ready_switch.turn_off()};e.prototype.val=function(e,t){if(t){return this.not_ready()}else if(e===void 0){return this.read()}else{return this.write(e)}};e.prototype.read=function(){if(this.is_not_ready){Ye.ensure_ready(this.not_ready_switch)}this.dependency.register();return this.state};e.prototype.write=function(e){if(!Ye.compare(this.state,e)){this.state=e;this.dependency.invalidate();if(this.is_not_ready){this.is_not_ready=false;return this.not_ready_switch.turn_on()}}};return e}();lt=this;Ye.autorun_cache=function(e){var t,n;n={};t=Ye.LUID();return function(r,i,o,a){var s,u,l,c,f,d,p,h,g,m,v,b,w,x=this;if(a){throw Ye.error("autorun_cache only supports 3 args right now")}l=[r,i,o];if(this.toUniqueString){l.push(this)}for(c=b=0,w=l.length;b<w;c=++b){s=l[c];if(s&&s.toUniqueString){s=s.toUniqueString()}if(typeof s==="string"){s='"'+s}if(s&&typeof s==="object"){throw Ye.error("passed in object to autorun_cache")}l[c]=s}f=l.join(" ");if(Ye.on_server()){p=_.current;if(!p){return e.call(this,r,i,o)}u=t+(typeof(g=y()).appname==="function"?g.appname():void 0)+"_"+(typeof(m=y()).app_version==="function"?m.app_version():void 0);if(p.__server_autorun_cache==null){p.__server_autorun_cache={}}if((v=p.__server_autorun_cache)[u]==null){v[u]={cache:{},exists:{}}}p=p.__server_autorun_cache[u];if(!p.exists[f]){d=e.call(this,r,i,o);p.cache[f]=d;p.exists[f]=true;if(p===Ye){setTimeout(function(){delete p.cache[f];return delete p.exists[f]},1e3)}}return p.cache[f]}else{if(n[f]==="evaluating"){return e.call(this,r,i,o)}else if(!n[f]){n[f]="evaluating";h=Ye.Watcher(function(){return e.call(x,r,i,o)});n[f]=h}return n[f].get()}}};Ye.autorun_return=function(e){var t,n,r,i=this;t=Ye.Dependency();r=null;n=null;Ye.autorun(function(){var i,o;try{o=e();if(!Ye.compare(o,r)){t.invalidate()}r=o;return n=null}catch(a){i=a;n=i;return t.invalidate()}});t.register();if(n){throw n}return r};Ye.did_event_pass_through=function(e,t){var n,r;n=$(e.target);if(typeof t==="string"){r=function(e){return e["is"](t)}}else{r=t}while(n[0]&&n[0]!==e.currentTarget){if(r(n)){return true}n=n.parent()}return false};We=false;Ye.simulate_double_tap_on_ipad=function(e,t){var n=this;if(Ye.is_on_mobile_or_tablet()){return e.on("vmouseup.fake-double-tap-1",function(n){n.preventDefault();if(!We){We=true;e.on("vmouseup.fake-double-tap-2",function(){n.preventDefault();return t(n)});return setTimeout(function(){We=false;return e.off("vmouseup.fake-double-tap-2")},200)}})}};Ye.one_blur=function(e,t){var n,r,i;i=new Ye.HasFocus(e);i.focus=true;r=false;n=function(){if(r){return}r=true;i.destroy();e.off("blur",n);e.off("change",n);return t()};i.on("blur",n);e.on("blur",n);return e.on("change",n)};Ye.trigger_blur=function(e){var t;t=$('<input class="fake-input"></input>');if(Ye.is_on_mobile_or_tablet()){t.attr("readonly",true)}t.css({top:e.offset().top,left:e.offset().left,position:"absolute"});$("body").append(t);t.focus();return t.remove()};nt=[];_e=function(){if(Ye.is_edit_mode()){return"vmousedown"}else{return"mousedown"}};Ye.HasFocus=p=function(e){jt(t,e);function t(e){var t=this;this.canvas=e;if(!this.canvas.data("_HasFocus_watchers")){this.canvas.data("_HasFocus_watchers",[])}this.canvas.data("_HasFocus_watchers").push(this);nt.push(this);this.focus=false;this.canvas_click=false;this.my_mousedown=function(){t.handle_click();return true};this.canvas.on(_e(),this.my_mousedown);this.doc_mousedown=function(){if(!t.canvas_click){t.force_blur()}t.canvas_click=false;return true};$(document).on(_e(),this.doc_mousedown)}t.prototype.force_blur=function(){if(this.focus){this.focus=false;return this.emit("blur")}};t.prototype.prevent_deselect=function(){return this.canvas_click=true};t.prototype.handle_click=function(){this.prevent_deselect();if(!this.focus){this.focus=true;return this.emit("focus")}};t.prototype.destroy=function(){Ye.array_remove(nt,this);this.canvas.off(_e(),this.my_mousedown);return $(document).off(_e(),this.doc_mousedown)};return t}(ie.EventEmitter);Ye.SetFocusOwner=function(e,t){e.data("HasFocusOwner",t);$(e).off(_e()+".setfocusowner");return $(e).on(_e()+".setfocusowner",function(){var e,n,r,i,o,a,s,u,l;if(t){e=fe(t);u=[];for(i=0,a=e.length;i<a;i++){n=e[i];u.push(function(){var e,t,i,o,a;o=(i=n.data("_HasFocus_watchers"))!=null?i:[];a=[];for(e=0,t=o.length;e<t;e++){r=o[e];a.push(r.handle_click())}return a}())}return u}else{l=[];for(o=0,s=nt.length;o<s;o++){r=nt[o];l.push(r.prevent_deselect())}return l}})};fe=function(e){var t,n;if(!e||e.length===0){return[]}n=fe(e.parent());t=fe(e.data("HasFocusOwner"));return[e].concat(n).concat(t)};Ye.force_focus_change=function(){var e;Ye.scroll_freeze();e=$("<input></input>");if(Ye.is_on_mobile_or_tablet()){e.attr("readonly",true)}$("body").append(e);e[0].focus();e[0];e.remove();return Ye.scroll_unfreeze()};Ye.delay=function(e,t){e.css("fake_css_nonsense",100);return Ye.velocity(e,{fake_css_nonsense:0},{duration:t})};Ze=false;Ye.velocity=function(e,t,n){if(!e||!e.length){if(typeof n.complete_cb==="function"){n.complete_cb()}return}if(n.complete){throw Ye.error("u.velocity called with complete, it should be complete_cb not to be overwritten")}if(typeof n!=="object"){throw Ye.error("u.velocity called with options not being an object, will break "+n)}if($.fx.off){n.duration=0}n.complete=function(){if(typeof n.complete_cb==="function"){n.complete_cb()}return Ze=false};Ze=true;return e.velocity(t,n)};Ye.are_animations_running=function(){return Ze};at=null;Ye.set_global_cursor=function(e){if(!at){at=$("<style></style>")}at.text("* { cursor: "+e+" !important; }");return $(document.head).append(at)};Ye.remove_global_cursor=function(){return at.remove()};Ye.meta=function(e){return e.metaKey||e.ctrlKey};kt=null;Ye.track_time=function(e){var t,n;t=Date.now();n=t-kt;kt=t;return console.log(n+": "+e)};Ye.escape=He.escape;Ye.unescape=He.unescape;F=e("./bbcodeparser");Ye.bbcode_to_html=function(e){var t,n,r;if(e==null){e=""}t=e;t=t.replace(/&#x2F;/g,"/");if((typeof window!=="undefined"&&window!==null?(r=window.BrowserDetect)!=null?r.browser:void 0:void 0)==="Explorer"){n=window.BrowserDetect.version}return F.fromBB_to_HTML(t,n)};Ye.extract_from_object=function(e,t){var n,r,i,o;r=e;for(i=0,o=t.length;i<o;i++){n=t[i];if((r!=null?r[n]:void 0)!=null){r=r[n]}else{return null}}return r};ht=null;Ye.scroll_freeze=function(){return ht=$(document).scrollTop()};Ye.scroll_unfreeze=function(){return $(document).scrollTop(ht)};Ye.isScrolledIntoView=function(e,t){var n,r,i,o,a,s;if(t==null){t=window}if(e.length===0){return true}if(t===window||!e.parents(t+":visible").length){a=$(window);r=$(a).scrollTop();n=r+a.height()-30}else{a=e.parents(t+":visible");r=Math.max(a.offset().top,$(window).scrollTop());n=Math.min(r+a.height(),$(window).scrollTop()+$(window).height()-40)}o=$(e).offset().top;i=o+$(e).height();s={};if(i<=n&&o>=r){s.status=true}else{s.status=false;if(i>n){s.side="bottom"}else{s.side="top"}}return s};Ye.revealInScreen=function(e,t,n){var r,i;if(t==null){t=window}if(!e||!e.length||e==="destroyed"){return}if(n==null){n=typeof e.offset==="function"?(i=e.offset())!=null?i.top:void 0:void 0}if(n==null){return}if(t!==window){n=n-$(t+":visible").offset().top}if(!Ye.isScrolledIntoView(e,t).status){try{if(t!==window){$(t+":visible").scrollTop(n-20);return n-20}else{return $(document).scrollTop(n-100)}}catch(o){r=o}}};Ye.make_zindex=function(e){var t,n,r;t=20;n=e;while(n.length>0&&n[0]!==document){r=parseFloat(n.css("z-index"));if(isNaN(r)){r=0}if(r>t){t=r}n=n.parent()}return t+1};Ye.local_data_store=function(e,t){var n;n=Ye.LUID();Ye.local_storage_put(n,e,t);return n};Ye.local_data_retrieve=function(e){var t;t=Ye.local_storage_get(e);if(!(typeof window!=="undefined"&&window!==null?window.localStorage:void 0)){r.local_storage_fallback(e,null,true)}else{window.localStorage.removeItem(e)}return t};r.local_storage_fallback=function(e,t,n){throw Ye.error("trying to store into localstorage, but it does not exist")};Ke=function(e){return Ye.is_edit_mode()&&e.indexOf("clipboard")!==-1};pe=function(e,t){var n;Ye.initialize_global_clipboard();n=Date.now();window.localStorage["_this_session_clipboard_"+e]=n;return it[0].contentWindow.postMessage({action:"global_clipboard_put",key:e,data:t,timestamp:n,id:Ye.UUID()},l)};it=null;l="https://bubble.is";Ye.approve_global_clipboard=function(e){var t;t=window.localStorage.global_clipboard_approved?JSON.parse(window.localStorage.global_clipboard_approved):[];t.push(e);console.log("Approved origin "+e+" on this computer.  Please refresh your editor window");return window.localStorage.global_clipboard_approved=JSON.stringify(t)};Ye.clipboard_script="\nvar _dead = false;\nfunction receiveMessage(event) {\n    if (_dead) { return; }\n\n    if (!isOkay(event.origin)) {\n        _dead = true;\n        console.log('Note: an unrecognized domain, ' + event.origin + ', is trying to access your global Bubble editor clipboard.  If you would like to grant access, go to https://bubble.is, and in the javascript console, type u.approve_global_clipboard(\\'' + event.origin + '\\'); and then refresh the editor window.');\n        return;\n    }\n\n    var parentOrigin = event.origin;\n\n    if (event.data.action === 'init_sync') {\n        function handleStoragePut(event) {\n            if (!event.key) { return; }\n            if (event.key.indexOf('global_clipboard_message_') != 0) { return; }\n            if (!event.newValue) { return; }\n            var message = JSON.parse(event.newValue);\n            parent.postMessage({\n                'action': 'new_clipboard_item',\n                'key': message.key,\n                'data': message.data,\n                'timestamp': message.timestamp\n            }, parentOrigin);\n        }\n\n        window.addEventListener(\"storage\", handleStoragePut, false);\n    }\n\n    if (event.data.action === 'global_clipboard_put') {\n        var message_key = 'global_clipboard_message_' + event.data.id;\n        window.localStorage[message_key] = JSON.stringify(event.data);\n        setTimeout(function() {\n            delete window.localStorage[message_key];\n        }, 10000);\n    }\n}\n\nfunction isOkay(origin) {\n    if (window.localStorage.global_clipboard_approved && JSON.parse(window.localStorage.global_clipboard_approved).indexOf(event.origin) > -1) {\n        return true;\n    }\n    if (origin === 'https://bubble.is') {\n        return true;\n    }\n    if (origin.indexOf('.bubble.is') > -1 && origin.indexOf('.bubble.is') + 10 == origin.length) {\n        return true;\n    }\n    return false;\n}\n\nwindow.addEventListener(\"message\", receiveMessage, false);\n\nparent.postMessage({'action': 'init_me'}, '*');";Ye.initialize_global_clipboard=function(){if(!it){window.addEventListener("message",Ye.handle_clipboard_message,false);it=window.$('<iframe src="'+l+'/appeditor/clipboard" style="position: absolute; left: -2px; width: 1px; height: 1px"></iframe>');return window.$("body").append(it)}};Ye.handle_clipboard_message=function(e){var t,n;if(e.origin!==l){return}if(((t=e.data)!=null?t.action:void 0)==="init_me"){it[0].contentWindow.postMessage({action:"init_sync",url:window.location.href},l);return}if(((n=e.data)!=null?n.action:void 0)!=="new_clipboard_item"){return}if(window.localStorage["_this_session_clipboard_"+e.data.key]>=e.data.timestamp){return}window.localStorage["_this_session_clipboard_"+e.data.key]=e.data.timestamp;return Ye.local_storage_put(e.data.key,e.data.data,false,true)};Ye.copy_on_click=function(e,t,n){if(!n){e.css({"-webkit-user-select":"all","-moz-user-select":"all","-ms-user-select":"all","user-select":"all",cursor:"pointer"})}return e.on("vclick",function(){return setTimeout(function(){var n,r;document.execCommand("copy");r=e.html();if(t){n="(copied)  "+r}else{n=r+"  (copied)"}e.html(n);return setTimeout(function(){return e.html(r)},1e3)},100)})};Ye.local_storage_put=function(e,t,n,i){var o,a,s;if(!i&&Ke(e)){pe(e,t)}te=JSON.stringify(t);if(!(typeof window!=="undefined"&&window!==null?window.localStorage:void 0)){return r.local_storage_fallback(e,te)}else{try{return window.localStorage[e]=te}catch(u){o=u;console.log(o.stack);console.log("clearing local storage");window.localStorage.clear();try{return window.localStorage[e]=te}catch(u){o=u;if(n){if((typeof window!=="undefined"&&window!==null?(s=window.BrowserDetect)!=null?s.browser:void 0:void 0)==="Safari"){a="Safari in private "}else{a="This browser does not support local storage, which prevents the workflow from running properly."}a+="mode does not support local storage, which prevents the workflow from running properly.";throw Ye.error({statusCode:400,message:a})}else{throw Ye.error("Second local storage failure.  Encoded size is "+te.length+", and message was: "+o.message+". key was "+e+" and data was: "+te.slice(0,2e3))}}}}};Ye.local_storage_get=function(e){if(!(typeof window!=="undefined"&&window!==null?window.localStorage:void 0)){te=r.local_storage_fallback(e)}else{te=window.localStorage[e]}if(!te){return null}return JSON.parse(te)};(function(){var e,t,n;e=null;n=null;t=false;Ye.rebuild_cookies=function(){var r,i,o,a,s,u,l,c,f,d;e={};if(Ye.on_phonegap()){l=window.localStorage;for(r in l){a=l[r];e[r]=a}}else{c=document.cookie.split(";");for(s=0,u=c.length;s<u;s++){o=c[s];f=o.trim().smart_split("=",1),r=f[0],a=f[1];e[r]=a}n=((d=document.cookie)!=null?d.length:void 0)>0;if(!n){i=document.cookie;document.cookie="testcookie";n=document.cookie.indexOf("testcookie")!==-1;document.cookie=i}}return t=true};Ye.createCookie=function(t,n,r){var i,o;if(Ye.on_phonegap()){window.localStorage.setItem(t,n)}else{if(r===-1){o="; expires=Thu, 01 Jan 1970 00:00:01 GMT"}else if(r){i=new Date;i.setTime(i.getTime()+r*24*60*60*1e3);o="; expires="+i.toGMTString()}else{o=""}document.cookie=t+"="+n+o+"; path=/"}return e=null};Ye.readCookie=function(t){var n;if(!e){Ye.rebuild_cookies()}if(!Ye.cookies_enabled()){throw Ye.error("trying to read a cookie, but cookies are turned off")}return(n=e[t])!=null?n:null};Ye.eraseCookie=function(e){return Ye.createCookie(e,"",-1)};Ye.cookies_enabled=function(){if(!t){Ye.rebuild_cookies()}return Ye.on_phonegap()||n};return Ye.get_all_cookies=function(){var t,n;if(!e){Ye.rebuild_cookies()}return function(){var r;r=[];for(t in e){n=e[t];r.push(t)}return r}()}})();function Dt(e){return parseInt(Pt(e).substring(0,2),16)}function Ot(e){return parseInt(Pt(e).substring(2,4),16)}function It(e){return parseInt(Pt(e).substring(4,6),16)}function Pt(e){return e.charAt(0)=="#"?e.substring(1,7):e}Ye.hexToRGB=function(e){return[Dt(e),Ot(e),It(e)]};Ye.RGBToHex=function(e){return"#"+(e[0]*256*256+e[1]*256+e[2]).toString(16)};Ye.HexToNumber=function(e){return parseInt(Pt(e),16)};Ye.NumberToHex=function(e){return"#"+e.toString(16)};Ye.RGBA_to_ARGB=function(e){var t,n,r,i,o,a;if(!e||e.split==null){return""}o=e.split("rgba(");if(o.length===1){return e}e=o[o.length-1];e=e.slice(0,e.length-1).replace(/\s/g,"");a=e.split(","),i=a[0],n=a[1],t=a[2],r=a[3];return"#"+parseInt(r*255).toString(16)+parseInt(i).toString(16)+parseInt(n).toString(16)+parseInt(t).toString(16)};Ye.rgb_to_hex=function(e){var t,n,r,i,o,a,s;a=e.split("rgba(");if(a.length===1){return{code:e,opacity:1}}e=a[a.length-1];e=e.slice(0,e.length-1).replace(/\s/g,"");s=e.split(","),i=s[0],n=s[1],t=s[2],r=s[3];o={};o.opacity=r;o.code="#"+((1<<24)+(parseInt(i)<<16)+(parseInt(n)<<8)+parseInt(t)).toString(16).substr(1);return o};Ye.hex_to_rgb=function(e,t){var n,r,i;e=e.replace("#","");i=Dt(e);r=Ot(e);n=It(e);return"rgba("+i+","+r+","+n+","+t/100+")"};Ye.RGBA_to_RGB=function(e){var t,n;if(!e||e.split==null){return""}n=e.split("rgba(");if(n.length===1){return e}t=n[1].split(",");t=t.slice(0,t.length-1).join(",")+")";return"rgb("+t};Ye.lighten_color=function(e,t){var n,r,i,o;try{o=Ye.hexToRGB(e);r=function(e){return Math.round(e*t+255*(1-t))};return Ye.RGBToHex(function(){var e,t,n;n=[];for(e=0,t=o.length;e<t;e++){i=o[e];n.push(r(i))}return n}())}catch(a){n=a;return"#FFFFFF"}};if(Ye.on_server()){Oe=e;je=Oe("pipette");Qe=Oe("zlib");Ye.do_gzip=function(e,t){var n,r;n=Qe.createGzip({level:Qe.Z_BEST_COMPRESSION});r=new je.Sink(n);r.on("data",function(e){return t(null,e)});n.write(e);return n.end()};Ge=Oe("tldjs");h=Oe("jsonparse")}(function(){var e;e=null;return Ye.logger=function(){if(!e){if(Ye.on_client()){if(typeof window.console.info==="function"){return window.console}else{return{log:window.console.log,info:window.console.log,warn:window.console.log,error:window.console.log}}}else{e=oe("./logger")}}return e}})();Ye.toTitleCase=function(e){if(typeof e!=="string"){return e}return e.replace(/(?:^|\s)\w/g,function(e){return e.toUpperCase()})};Ye.FirstLetterCapitalize=function(e){if(typeof e!=="string"||e.length===0){return e}return e[0].toUpperCase()+e.slice(1)};Ye.is_email=function(e){var t;if(typeof e!=="string"){return false}e=e.toLowerCase();t=e.match(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);if(!t||t[0]!==e){return false}else{return true}};Ye.is_url=function(e){if(typeof e!=="string"){return false}if(e.indexOf(".")===-1){return false}return true};Ye.digest=function(e,t){var n;if(t==null){t="utf8"}n=Y.createHash("md5");n.update(e,t);return n.digest("hex")};Ye.charCode=function(e){return e.charCodeAt(0)};Ye.LinkedList=b=function(){function e(e,t){this.timeout=e;this.timeout_cb=t;this.length=0;this._head=null;this._tail=null}e.prototype.push=function(e){var t;if(this.timeout){t=Date.now();if(!this._timeout_started){this.start_timeout(t)}}if(!this._head){this._head={item:e,start_time:t};this._tail=this._head}else{this._tail.next={item:e,start_time:t};this._tail=this._tail.next}this.length++;return this.length};e.prototype.shift=function(){var e;if(!this._head){return}e=this._head.item;this._head=this._head.next;if(!this._head){this._tail=null}this.length--;return e};e.prototype.start_timeout=function(e){var t=this;this._timeout_started=true;return setTimeout(function(){var e;t._timeout_started=false;while(t._head&&t._head.start_time+t.timeout<=Date.now()){e=t.shift();if(typeof t.timeout_cb==="function"){t.timeout_cb(e)}}if(t._head){return t.start_timeout(t._head.start_time)}},e+this.timeout-Date.now())};return e}();String.prototype.smart_split=function(e,t){var n,r;n=this.split(e);r=[];r.push.apply(r,n.slice(0,t));r.push(n.slice(t).join(e));return r};Ye.real_inner_width=function(e){var t,n,r;if(e==="destroyed"){return}n=Ye.div("measure",e);r=n.width();n.remove();if(r===0){t=e.width();if(t===100&&e.css("width")==="100%"){return}return e.width()}else{return r}};Ye.create_style_sheet=function(e){var t;t=document.createElement("style");t.type="text/css";t.innerHTML=e;return document.getElementsByTagName("head")[0].appendChild(t)};H=function(e,t){var n,r,i;r=function(){var e;e=[];for(n in t){i=t[n];e.push(n+": "+i)}return e}().join("; ");return"."+e+" { "+r+" } "};(function(){var e,t,n,r,i;t={};n=0;r=[];Ye.style_element=function(i,o){var a,s;a=JSON.stringify(o);if(!t[a]){n++;s="bbl-s"+n;r.push({name:s,data:o});e();t[a]=s}else{s=t[a]}return i.addClass(s)};i=false;return e=function(){if(i){return}i=true;return setImmediate(function(){var e,t,n,o;i=false;n=r;r=[];o=function(){var r,i,o,a;a=[];for(r=0,i=n.length;r<i;r++){o=n[r],t=o.name,e=o.data;a.push(H(t,e))}return a}().join("\n");return Ye.create_style_sheet(o)})}})();Ye.string_contains=function(e,t){var n,r;n=(r=e!=null?typeof e.indexOf==="function"?e.indexOf(t):void 0:void 0)!=null?r:-1;return n!==-1};Ye.safe_contains=Ye.string_contains;Ye.text_contains=function(e,t){var n,r;return(r=e!=null?typeof(n=e.toLowerCase()).indexOf==="function"?n.indexOf(t!=null?t.toLowerCase():void 0):void 0:void 0)!=null?r:-1};Ye.ends_with=function(e,t){var n;if(typeof e!=="string"){return false}n=e.lastIndexOf(t);if(n===-1){return false}return n+t.length===e.length};Ye.starts_with=function(e,t){if(typeof e!=="string"){return false}if(typeof t!=="string"){return false}return e.slice(0,t.length)===t};Ye.loadCSS=function(e,t){var n,r;r=document.createElement("link");r.type="text/css";r.rel="stylesheet";r.href=e;r.id="theme-style";document.getElementsByTagName("head")[0].appendChild(r);n=document.createElement("img");n.onerror=function(){return typeof t==="function"?t():void 0};return n.src=e};Ye.make_numeric=function(e,t){return e.keydown(function(e){var n,r,i;if((65<=(r=e.keyCode)&&r<=90||((i=e.keyCode)===186||i===191||i===219||i===220||i===221||i===222||i===187))&&!e.ctrlKey&&!e.altKey&&!e.metaKey){n=true}if(t&&e.keyCode===190){n=true}if(n){e.preventDefault()}else{}})};X=me=J=null;Z=false;de=function(){var e;e=y().app_language(true);if(e&&e.indexOf("_")!==-1){return e.replace("_","-")}};Ye.detect_decimal_thousand_separators=function(){var e,t,n,r,i,o,a;if(!Z){Z=true;t=111111111.1111111.toLocaleString(de());n=t[0];for(e=r=o=t.length-1;o<=0?r<=0:r>=0;e=o<=0?++r:--r){W=t.charAt(e);if(W!==n){X=W;J=t.length-e-1;break}}for(e=i=0,a=t.length;0<=a?i<a:i>a;e=0<=a?++i:--i){W=t.charAt(e);if(W!=="1"&&W!==X){me=W;break}me=""}}return{decimalSeparator:X,groupSeparator:me,decimalDigits:J}};Ye.add_thousand_sep=function(e,t){if(t==null){t=","}if(e==null){return""}return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,t)};Te=null;Ye.toLocaleStringRegional=function(e){if(Te==null){Te=new Intl.NumberFormat(de())}return Te.format(e)};Ye.parseFloatRegional=function(e){var t;if(typeof e!=="string"){return parseFloat(e)}t=Ye.detect_decimal_thousand_separators(),X=t.decimalSeparator,me=t.groupSeparator,J=t.decimalDigits;e=Ye.replace_all(e,me,"");if(me.charCodeAt(0)===160){e=Ye.replace_all(e," ","")}if(X!=="."){e=Ye.replace_all(e,".","");e=Ye.replace_all(e,X,".")}return parseFloat(e)};St=[];Ye.add_to_shutdown=function(e){return St.push(e)};Ye.add_to_shutdown_async=function(e){e._is_async=true;return St.push(e)};yt=false;Ye.do_shutdown=ee=function(){var e,n,r,i,o,a;if(yt){return}yt=true;setTimeout(function(){return t.exit(1)},3e4);r=function(e){var t;try{return console.log(e)}catch(n){t=n;return true}};r("running shutdown functions");n=Ye.MakeKeySet();i=function(e){var i,o;o=n.make(null,"shutdown function key");try{e(function(){return o.turn()});if(!e._is_async){return o.turn()}else{return setTimeout(function(){r("shutdown function failed to end after 10 seconds:\n"+e);return t.exit(1)},1e4)}}catch(a){i=a;r("error in shutdown function");return r(i.stack)}};for(o=0,a=St.length;o<a;o++){e=St[o];i(e)}r("all shutdown functions running");return Ye.WaitFor(n,function(){r("shutdown successful");return t.exit(1)})};if(typeof t.on==="function"){t.on("SIGINT",ee)}if(typeof t.on==="function"){t.on("SIGTERM",ee)}Ye.exit_on_parent_death=function(){return t.on("disconnect",function(){var e;try{console.log("u.coffee: lost contact with parent process; shutting down")}catch(t){e=t;true}return ee()})};function Rt(){window.BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var t=0;t<e.length;t++){var n=e[t].string;var r=e[t].prop;this.versionSearchString=e[t].versionSearch||e[t].identity;if(n){if(n.indexOf(e[t].subString)!=-1)return e[t].identity}else if(r)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(t==-1)return;return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};window.BrowserDetect.init()}if(typeof window!=="undefined"&&window!==null){Rt();Ye.error_environment={OS:window.BrowserDetect.OS,browser:window.BrowserDetect.browser,version:window.BrowserDetect.version,location_href:window.document.location.href,browser_raw:"navigator.platform: "+navigator.platform+" , navigator.userAgent: "+navigator.userAgent+" , navigator.appVersion: "+navigator.appVersion+" , navigator.vendor: "+navigator.vendor+" , window.opera: "+window.opera,total_open_requests:0,cannot_connect:false}}else{Ye.error_environment={}}var zt=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,r=function(e,t){e=String(e);t=t||2;while(e.length<t)e="0"+e;return e};return function(i,o,a,s){var u=zt;if(arguments.length==1&&Object.prototype.toString.call(i)=="[object String]"&&!/\d/.test(i)){o=i;i=undefined}i=i?new Date(i):new Date;if(isNaN(i))throw SyntaxError("invalid date");o=String(u.masks[o]||o||u.masks["default"]);if(o.slice(0,4)=="UTC:"){o=o.slice(4);a=true}if(typeof s!=="undefined"&&s!==null){zt.i18n=s}var l=a?"getUTC":"get",c=i[l+"Date"](),f=i[l+"Day"](),d=i[l+"Month"](),_=i[l+"FullYear"](),p=i[l+"Hours"](),h=i[l+"Minutes"](),g=i[l+"Seconds"](),m=i[l+"Milliseconds"](),v=a?0:i.getTimezoneOffset(),y={d:c,dd:r(c),ddd:u.i18n.dayNames[f],dddd:u.i18n.dayNames[f+7],m:d+1,mm:r(d+1),mmm:u.i18n.monthNames[d],mmmm:u.i18n.monthNames[d+12],yy:String(_).slice(2),yyyy:_,h:p%12||12,hh:r(p%12||12),H:p,HH:r(p),M:h,MM:r(h),s:g,ss:r(g),l:r(m,3),L:r(m>99?Math.round(m/10):m),t:p<12?"a":"p",tt:p<12?"am":"pm",T:p<12?"A":"P",TT:p<12?"AM":"PM",Z:a?"UTC":(String(i).match(t)||[""]).pop().replace(n,""),o:(v>0?"-":"+")+r(Math.floor(Math.abs(v)/60)*100+Math.abs(v)%60,4),S:["th","st","nd","rd"][c%10>3?0:(c%100-c%10!=10)*c%10]};return o.replace(e,function(e){return e in y?y[e]:e.slice(1,e.length-1)})}}();zt.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};zt.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Ae=e("./jquery_plugins/moment.timezone.min.js");Ye.format_date=function(e,t,n,r){if(e==null||isNaN(e)){return""}else{if(r){e=new Date(e.getTime()-60*1e3*r)}return zt(e,t,void 0,n)}};Ye.format_date_interval=function(e,t){switch(t){case"days":return Math.round(e/(1e3*60*60*24)*10)/10;case"hours":return Math.round(e/(1e3*60*60)*10)/10;case"minutes":return Math.round(e/(1e3*60));case"seconds":return Math.round(e/1e3)}};Ye.print_date_interval=function(e){var t,n,r,i,o;o=["days","hours","minutes","seconds"];for(r=0,i=o.length;r<i;r++){t=o[r];n=Ye.format_date_interval(e,t);if(n===1){return n+" "+t.slice(0,t.length-1)}else if(n>1||t==="seconds"){return n+" "+t}}};be=null;Ye.add_finish_cb_to_vimeo=function(e,t,n){var r,i,o=this;i=function(n,r){var i;i={method:n};if(r){i.value=r}return $(e.find("iframe"))[0].contentWindow.postMessage(JSON.stringify(i),"https://player.vimeo.com/video/"+t)};if(typeof window.removeEventListener==="function"){window.removeEventListener("message",be)}if(typeof window.detachEvent==="function"){window.detachEvent("onmessage",be)}be=r=function(e){var t;if(e!=null?e.data:void 0){try{t=JSON.parse(e.data);if(t.event==="finish"){n()}if(t.event==="ready"){return i("addEventListener","finish")}}catch(r){e=r}}};if(window.addEventListener){return window.addEventListener("message",r,false)}else{return window.attachEvent("onmessage",r,false)}};Ye.get_element=function(e){var t,n,r,i;if(Ye.is_edit_mode()){if(!e.hasClass("inner-element")){e=e.parents(".inner-element").first()}t=e.attr("id");if(!t){return"not found -- should be a div with the inner-element class"}return window.appquery.element(t)}else{if(!e.hasClass("bubble-element")){e=e.parents(".bubble-element").first()}return(n=(r=e[0])!=null?(i=r.bubble_data)!=null?i.bubble_instance:void 0:void 0)!=null?n:"not found -- should be a div with the bubble-element class"}};if(typeof window!=="undefined"&&window!==null){window.u=Ye;e("./jquery_plugins/jquery.dotdotdot-1.5.6.js");e("./jquery_plugins/jquery.velocity.min.js");e("./jquery_plugins/jquery.velocity.ui.min.js");Ye.page_loaded_key=Ye.MakeKey(null,"u.page_loaded_key");
Ye.page_is_loaded=function(){Ye.page_loaded_key.turn();$(document.body).append(Ye.div("page-is-loaded"));return console.log("page is loaded")}}Ye.console_with_styling=function(e){console.log("");console.log("%c"+e,["background: linear-gradient(rgb(79, 174, 232), rgb(29, 140, 204))","color: white","display: block","text-align: center","font-weight: bold","padding: 7px","border-radius: 3px"].join(";"));return console.log("")};Ye.fixedEncodeURIComponent=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}}).call(this)}).call(this,e("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./bbcodeparser":5,"./client_config":16,"./jquery_plugins/jquery.dotdotdot-1.5.6.js":43,"./jquery_plugins/jquery.velocity.min.js":44,"./jquery_plugins/jquery.velocity.ui.min.js":45,"./jquery_plugins/moment.timezone.min.js":47,"./lib":65,"./u2":73,_process:281,crypto:83,events:276,fibers:305,querystring:285,underscore:307,url:299,util:302}],73:[function(require,module,exports){(function(process,global){(function(){var android,initialize_navigator_checks,is_on_mobile_or_tablet,u,url,_base,_base1,_base2,_base3,_base4;u=exports;url=require("url");if(typeof window!=="undefined"&&window!==null){if(window.console==null){window.console={}}if((_base=window.console).log==null){_base.log=function(){}}if((_base1=window.console).error==null){_base1.error=function(){}}if((_base2=window.console).trace==null){_base2.trace=function(){}}if(!Array.isArray){Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}if(!Array.prototype.forEach){Array.prototype.forEach=function(e,t){var n,r,i,o,a;a=[];for(n=i=0,o=this.length;i<o;n=++i){r=this[n];a.push(e.call(t,r,n,this))}return a}}if("ab".substr(-1)!="b"){String.prototype.substr=function(e){return function(t,n){if(t<0)t=this.length+t;return e.call(this,t,n)}}(String.prototype.substr)}if(!Function.prototype.bind){Function.prototype.bind=function(e){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r?this:e,t.concat(Array.prototype.slice.call(arguments)))};r.prototype=this.prototype;i.prototype=new r;return i}}if(!Date.now){Date.now=function(){return(new Date).valueOf()}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e){"use strict";if(this==null){throw new TypeError}var t=Object(this);var n=t.length>>>0;if(n===0){return-1}var r=0;if(arguments.length>1){r=Number(arguments[1]);if(r!=r){r=0}else if(r!=0&&r!=Infinity&&r!=-Infinity){r=(r>0||-1)*Math.floor(Math.abs(r))}}if(r>=n){return-1}var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++){if(i in t&&t[i]===e){return i}}return-1}}if(!Array.prototype.reduce){Array.prototype.reduce=function e(t){if(this===null||this===undefined)throw new TypeError("Object is null or undefined");var n=0,r=this.length>>0,i;if(typeof t!=="function")throw new TypeError("First argument is not callable");if(arguments.length<2){if(r===0)throw new TypeError("Array length is 0 and no second argument");i=this[0];n=1}else i=arguments[1];while(n<r){if(n in this)i=t.call(undefined,i,this[n],n,this);++n}return i}}if((_base3=window.history).pushState==null){_base3.pushState=function(e,t,n){var r,i;r=url.parse(n);i=url.parse(document.location.href);if(r.protocol==null){r.protocol=i.protocol}if(r.host==null){r.host=i.host}if(r.pathname==null){r.pathname=i.pathname}n=url.format(r);return document.location.href=n}}if((_base4=window.history).replaceState==null){_base4.replaceState=function(e,t,n){}}if(!Array.prototype.every){Array.prototype.every=function(e){"use strict";if(this==null)throw new TypeError;var t=Object(this);var n=t.length>>>0;if(typeof e!="function")throw new TypeError;var r=arguments[1];for(var i=0;i<n;i++){if(i in t&&!e.call(r,t[i],i,t))return false}return true}}}android=is_on_mobile_or_tablet=null;initialize_navigator_checks=function(){var e,t,n,r;if(typeof window!=="undefined"&&window!==null&&(typeof navigator!=="undefined"&&navigator!==null)){var i=function(){var e=false;(function(t){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ipad|playbook|silk|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))e=true})(navigator.userAgent||navigator.vendor||window.opera);return e};is_on_mobile_or_tablet=i();r=navigator.userAgent;n=/mobile/i.test(r);e=/iemobile/i.test(r);t=/iphone/i.test(r)&&!e;return android=/android/i.test(r)&&!e}};initialize_navigator_checks();u.is_android=function(){return android!=null?android:false};u.is_on_mobile_or_tablet=function(){return is_on_mobile_or_tablet!=null?is_on_mobile_or_tablet:false};(function(global,undefined){"use strict";var tasks=function(){function Task(e,t){this.handler=e;this.args=t}Task.prototype.run=function(){if(typeof this.handler==="function"){this.handler.apply(undefined,this.args)}else{var scriptSource=""+this.handler;eval(scriptSource)}};var nextHandle=1;var tasksByHandle={};var currentlyRunningATask=false;return{addFromSetImmediateArguments:function(e){var t=e[0];var n=Array.prototype.slice.call(e,1);var r=new Task(t,n);var i=nextHandle++;tasksByHandle[i]=r;return i},runIfPresent:function(e){if(!currentlyRunningATask){var t=tasksByHandle[e];if(t){currentlyRunningATask=true;try{t.run()}finally{delete tasksByHandle[e];currentlyRunningATask=false}}}else{global.setTimeout(function(){tasks.runIfPresent(e)},0)}},remove:function(e){delete tasksByHandle[e]}}}();function canUseNextTick(){return typeof process==="object"&&Object.prototype.toString.call(process)==="[object process]"}function canUseMessageChannel(){return!!global.MessageChannel}function canUsePostMessage(){if(!global.postMessage||global.importScripts){return false}var e=true;var t=global.onmessage;global.onmessage=function(){e=false};global.postMessage("","*");global.onmessage=t;return e}function canUseReadyStateChange(){return"document"in global&&"onreadystatechange"in global.document.createElement("script")}function installNextTickImplementation(e){e.setImmediate=function(){var e=tasks.addFromSetImmediateArguments(arguments);process.nextTick(function(){tasks.runIfPresent(e)});return e}}function installMessageChannelImplementation(e){var t=new global.MessageChannel;t.port1.onmessage=function(e){var t=e.data;tasks.runIfPresent(t)};e.setImmediate=function(){var e=tasks.addFromSetImmediateArguments(arguments);t.port2.postMessage(e);return e}}function installPostMessageImplementation(e){var t="com.bn.NobleJS.setImmediate"+Math.random();function n(e,t){return typeof e==="string"&&e.substring(0,t.length)===t}function r(e){if(e.source===global&&n(e.data,t)){var r=e.data.substring(t.length);tasks.runIfPresent(r)}}if(global.addEventListener){global.addEventListener("message",r,false)}else{global.attachEvent("onmessage",r)}e.setImmediate=function(){var e=tasks.addFromSetImmediateArguments(arguments);global.postMessage(t+e,"*");return e}}function installReadyStateChangeImplementation(e){e.setImmediate=function(){var e=tasks.addFromSetImmediateArguments(arguments);var t=global.document.createElement("script");t.onreadystatechange=function(){tasks.runIfPresent(e);t.onreadystatechange=null;t.parentNode.removeChild(t);t=null};global.document.documentElement.appendChild(t);return e}}function installSetTimeoutImplementation(e){e.setImmediate=function(){var e=tasks.addFromSetImmediateArguments(arguments);global.setTimeout(function(){tasks.runIfPresent(e)},0);return e}}if(!global.setImmediate){var attachTo=typeof Object.getPrototypeOf==="function"&&"setTimeout"in Object.getPrototypeOf(global)?Object.getPrototypeOf(global):global;if(canUseNextTick()){installNextTickImplementation(attachTo)}else if(canUsePostMessage()){installPostMessageImplementation(attachTo)}else if(canUseMessageChannel()){installMessageChannelImplementation(attachTo)}else if(canUseReadyStateChange()){installReadyStateChangeImplementation(attachTo)}else{installSetTimeoutImplementation(attachTo)}attachTo.clearImmediate=tasks.remove}})(typeof global==="object"&&global?global:this);if(typeof window!=="undefined"&&window!==null){/* Copyright (C) 1999 Masanao Izumo <iz@onicos.co.jp>
     * Version: 1.0
     * LastModified: Dec 25 1999
     * This library is free.  You can redistribute it and/or modify it.
     */
(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var t=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function n(t){var n,r,i;var o,a,s;i=t.length;r=0;n="";while(r<i){o=t.charCodeAt(r++)&255;if(r==i){n+=e.charAt(o>>2);n+=e.charAt((o&3)<<4);n+="==";break}a=t.charCodeAt(r++);if(r==i){n+=e.charAt(o>>2);n+=e.charAt((o&3)<<4|(a&240)>>4);n+=e.charAt((a&15)<<2);n+="=";break}s=t.charCodeAt(r++);n+=e.charAt(o>>2);n+=e.charAt((o&3)<<4|(a&240)>>4);n+=e.charAt((a&15)<<2|(s&192)>>6);n+=e.charAt(s&63)}return n}function r(e){var n,r,i,o;var a,s,u;s=e.length;a=0;u="";while(a<s){do{n=t[e.charCodeAt(a++)&255]}while(a<s&&n==-1);if(n==-1)break;do{r=t[e.charCodeAt(a++)&255]}while(a<s&&r==-1);if(r==-1)break;u+=String.fromCharCode(n<<2|(r&48)>>4);do{i=e.charCodeAt(a++)&255;if(i==61)return u;i=t[i]}while(a<s&&i==-1);if(i==-1)break;u+=String.fromCharCode((r&15)<<4|(i&60)>>2);do{o=e.charCodeAt(a++)&255;if(o==61)return u;o=t[o]}while(a<s&&o==-1);if(o==-1)break;u+=String.fromCharCode((i&3)<<6|o)}return u}if(!window.btoa)window.btoa=n;if(!window.atob)window.atob=r})();u.base64=function(e){return window.btoa(e)}}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:281,url:299}],74:[function(e,t,n){(function(){var t,r,i,o,a,s,u;s=n;a=e("./u");a.safe_register("./util",s);r=e("./client_config");o=e("./imgix");s.get_cluster_from_app=function(e){return"main"};t=/^[0-9\.]+$/;s.is_meta_hostname=function(e){var n,i;n=".amazonaws.com";i=e.indexOf(n);return e===r.meta_hostname||i!==-1&&i+n.length===e.length||e.match(t)!=null};s.get_meta_hostname=function(e){return r.meta_hostname};s.get_meta_hostname_for_app=function(e){return r.meta_hostname};s.is_on_amazon=function(){return false};u={};s.get_image_real_dimensions=function(e,t){var n;if(!e){return t({})}if(u[e]){t(u[e]);return}n=function(){var n,r=this;n=a.img(void 0,$("body"),e);n.hide();return n.on("load",function(){var r;r={width:n.width(),height:n.height()};n.remove();u[e]=r;return t(r)})};if(e.indexOf(r.user_file_url)===-1||r.image_optimization_service&&e.indexOf(r.image_optimization_service)!==-1){return n()}else if(r.image_optimization_service){return o.get_image_json_data(e,function(r){if(!r){return n()}else{u[e]=r;return t(r)}})}else{return n()}};try{a.extend(s,a.safe_require("./../"+r.bubble_private_path+"/override_util"))}catch(l){i=l;if(String(i!=null?i.message:void 0).indexOf("Cannot find module")===-1){throw i}}}).call(this)},{"./client_config":16,"./imgix":42,"./u":72}],75:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d;f=e("./u");c=e("./lang/lang");t=e("./lib");r=e("./lang/appquery");a=e("./default_lib");d=n;d.reindex=function(e){var n;if(!e){throw f.error("app must exist")}n=r.make_run_app(e);t.extend(l(n),function(){return n.json.force_index()});return null};l=function(e){var t;t=a.get();f.extend(t,{app:e,is_edit_mode:false});return t}}).call(this)},{"./default_lib":33,"./lang/appquery":51,"./lang/lang":57,"./lib":65,"./u":72}],76:[function(e,t,n){(function(){var t,r,i,o,a,s,u,l,c,f,d,_,p,h,g,m=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};g=n;h=e("./u");h.safe_register("./webfonts",g);f=["Arial:::","Tinos:::","Raleway:::","Cousine:::","Open Sans:::","Droid Sans:::","Droid Serif:::","EB Garamond:::","PT Sans:::","Ubuntu:::","Lato:::","Oswald:::","ABeeZee:::","Source Sans Pro:::300","Source Sans Pro:::400"];c=["Arial:::","Times New Roman:::","Courier New:::","Georgia:::","Trebuchet MS:::","Verdana:::","Palatino:::","Garamond:::","Bookman:::","Avant Garde:::","Arial Black:::","Impact:::"];g.already_loaded=[];s=[];_=e;if(h.on_server()){a=_("./configuration")}i=[];g.get_font_list=function(){var e,n,r,o,a,s,u,l,c,d,_;if(!i.length){n=t().location.request_synchronous("server://appeditor/get_font_list","post");c=(l=n!=null?n.items:void 0)!=null?l:[];for(o=0,s=c.length;o<s;o++){e=c[o];if(d=e.family,m.call(f,d)<0){if(e.variants){_=e.variants;for(a=0,u=_.length;a<u;a++){r=_[a];i.push(g.standardized_name({font_family:e.family,variant:r}))}}else{i.push(g.standardized_name({font_family:e.family}))}}}}return[].concat(f.concat(i))};g.get_font_list_from_google=function(){var e,n,r;e=t().KeyValueDB().get("small","google_fonts_lists");if(e){return e}r=t().http_request({url:"https://www.googleapis.com/webfonts/v1/webfonts?key="+a.google_webfont_api_key}).block();if(r.statusCode!==200){throw h.error("Issues fetching webfonts",{response:r})}n=h.json_parse(r.body);t().KeyValueDB().put("small","google_fonts_lists",n,60*60*24);return n};g.standardized_name=function(e){if(e.variant){return e.font_family+":::"+e.variant}else{return e.font_family+":::"}};g.get_face_and_variant=function(e){var t,n;t={};if(!e){return{}}if(e.indexOf(":::")===-1){return{font_family:e,variant:null}}n=e.split(":::");t.font_family=n.slice(0,n.length-1).join(":::");t.variant=n[n.length-1];if(t.variant===""){t.variant=null}return t};g.get_canonical=function(e){if(e){return g.standardized_name(g.get_face_and_variant(e))}};g.pretty_font=function(e){var t,n,r,i;i=g.get_face_and_variant(e),t=i.font_family,r=i.variant;n=t;if(r!=null&&r!=="custom"){n+=" ("+r+")"}return n};if(typeof window!=="undefined"&&window!==null){g.active_key=h.MakeKey(null,"webfonts.active_key");if(window.google_web_fonts_active){g.active_key.turn()}else{window.google_web_fonts_active_cb=function(){return g.active_key.turn()}}}else{g.active_key=h.MakeKey(null,"webfonts.active_key");g.active_key.turn()}g.load_font=function(e,t,n){if(t==null){t=false}if(n==null){n=null}if(!e){return}e=g.get_canonical(e);if(!u(e)){if(g.get_face_and_variant(e).variant==="custom"){return g.load_external(g.get_face_and_variant(e).font_family)}else{return l([e],n,t)}}};g.load_external=function(e,t){var n;g.already_loaded.push(e+":::custom");n={custom:{families:[e],urls:[t]}};return window.WebFont.load(n)};p=function(e){var t,n,r;r=g.get_face_and_variant(e),t=r.font_family,n=r.variant;if(n){return t+":"+n}return t};g.load_fonts_list=function(e){var t;e=function(){var n,r,i;i=[];for(n=0,r=e.length;n<r;n++){t=e[n];if(!u(t)){i.push(t)}}return i}();if(e.length!==0){return l(e,function(){return g.active_key.turn()})}else{return g.active_key.turn()}};g.load_for_preview=function(e,t){var n;e=function(){var t,r,i;i=[];for(t=0,r=e.length;t<r;t++){n=e[t];if(!u(n)){i.push(n)}}return i}();if(e.length!==0){return l(e,t)}};u=function(e){return m.call(g.already_loaded,e)>=0||m.call(c,e)>=0};l=function(e,t,n){var r,i,o,a;if(t==null){t=null}if(n==null){n=false}for(o=0,a=e.length;o<a;o++){i=e[o];g.already_loaded.push(i)}r={google:{families:g.to_google_list(e)},active:function(){return typeof t==="function"?t():void 0}};if(n&&e.length===1){r.google.text=g.pretty_font(e[0])}return window.WebFont.load(r)};g.clean_list=function(e){var t,n,r,i;n=[];for(r=0,i=e.length;r<i;r++){t=e[r];t=g.get_canonical(t);if(t&&typeof t==="string"&&m.call(c,t)<0){n.push(t)}}return n};g.to_google_list=function(e){var t,n,r,i;i=[];for(n=0,r=e.length;n<r;n++){t=e[n];if(t){i.push(p(t))}}return i};g.to_custom_list=function(e){var t,n,r,i;i=[];for(n=0,r=e.length;n<r;n++){t=e[n];if(t){i.push(g.get_face_and_variant(t).font_family)}}return i};o=function(e){var t,n,r,i;r=e.read_index("app_fonts");i=[];for(t in r){n=r[t];if(n){i.push(t)}}return i};g.load_app_fonts=function(e){if(e==null){e=false}return h.run_once(60,function(){return o(r.app())},function(t,n){if(t){h.warn(t);n=[]}if(e){return g.load_fonts_list(n.concat(f))}else{return g.load_fonts_list(n)}})};g.load_default_fonts=function(){return g.load_fonts_list(f)};d=e("querystring");r=e("./lang/appquery");t=e("./lib")}).call(this)},{"./lang/appquery":51,"./lib":65,"./u":72,querystring:285}],77:[function(e,t,n){},{}],78:[function(e,t,n){t.exports=e(77)},{"/home/ec2-user/bubble/node_modules/browserify/lib/_empty.js":77}],79:[function(e,t,n){var r=e("base64-js");var i=e("ieee754");var o=e("is-array");n.Buffer=s;n.SlowBuffer=s;n.INSPECT_MAX_BYTES=50;s.poolSize=8192;var a=1073741823;s.TYPED_ARRAY_SUPPORT=function(){try{var e=new ArrayBuffer(0);var t=new Uint8Array(e);t.foo=function(){return 42};return 42===t.foo()&&typeof t.subarray==="function"&&new Uint8Array(1).subarray(1,1).byteLength===0}catch(n){return false}}();function s(e,t,n){if(!(this instanceof s))return new s(e,t,n);var r=typeof e;var i;if(r==="number")i=e>0?e>>>0:0;else if(r==="string"){if(t==="base64")e=C(e);i=s.byteLength(e,t)}else if(r==="object"&&e!==null){if(e.type==="Buffer"&&o(e.data))e=e.data;i=+e.length>0?Math.floor(+e.length):0}else throw new TypeError("must start with number, buffer, array or string");if(this.length>a)throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+a.toString(16)+" bytes");var u;if(s.TYPED_ARRAY_SUPPORT){u=s._augment(new Uint8Array(i))}else{u=this;u.length=i;u._isBuffer=true}var l;if(s.TYPED_ARRAY_SUPPORT&&typeof e.byteLength==="number"){u._set(e)}else if(D(e)){if(s.isBuffer(e)){for(l=0;l<i;l++)u[l]=e.readUInt8(l)}else{for(l=0;l<i;l++)u[l]=(e[l]%256+256)%256}}else if(r==="string"){u.write(e,0,t)}else if(r==="number"&&!s.TYPED_ARRAY_SUPPORT&&!n){for(l=0;l<i;l++){u[l]=0}}return u}s.isBuffer=function(e){return!!(e!=null&&e._isBuffer)};s.compare=function(e,t){if(!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError("Arguments must be Buffers");var n=e.length;var r=t.length;for(var i=0,o=Math.min(n,r);i<o&&e[i]===t[i];i++){}if(i!==o){n=e[i];r=t[i]}if(n<r)return-1;if(r<n)return 1;return 0};s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};s.concat=function(e,t){if(!o(e))throw new TypeError("Usage: Buffer.concat(list[, length])");if(e.length===0){return new s(0)}else if(e.length===1){return e[0]}var n;if(t===undefined){t=0;for(n=0;n<e.length;n++){t+=e[n].length}}var r=new s(t);var i=0;for(n=0;n<e.length;n++){var a=e[n];a.copy(r,i);i+=a.length}return r};s.byteLength=function(e,t){var n;e=e+"";switch(t||"utf8"){case"ascii":case"binary":case"raw":n=e.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=e.length*2;break;case"hex":n=e.length>>>1;break;case"utf8":case"utf-8":n=I(e).length;break;case"base64":n=z(e).length;break;default:n=e.length}return n};s.prototype.length=undefined;s.prototype.parent=undefined;s.prototype.toString=function(e,t,n){var r=false;t=t>>>0;n=n===undefined||n===Infinity?this.length:n>>>0;if(!e)e="utf8";if(t<0)t=0;if(n>this.length)n=this.length;if(n<=t)return"";while(true){switch(e){case"hex":return v(this,t,n);case"utf8":case"utf-8":return h(this,t,n);case"ascii":return g(this,t,n);case"binary":return m(this,t,n);case"base64":return p(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();r=true}}};s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return s.compare(this,e)===0};s.prototype.inspect=function(){var e="";var t=n.INSPECT_MAX_BYTES;if(this.length>0){e=this.toString("hex",0,t).match(/.{2}/g).join(" ");if(this.length>t)e+=" ... "}return"<Buffer "+e+">"};s.prototype.compare=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return s.compare(this,e)};s.prototype.get=function(e){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(e)};s.prototype.set=function(e,t){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(e,t)};function u(e,t,n,r){n=Number(n)||0;var i=e.length-n;if(!r){r=i}else{r=Number(r);if(r>i){r=i}}var o=t.length;if(o%2!==0)throw new Error("Invalid hex string");if(r>o/2){r=o/2}for(var a=0;a<r;a++){var s=parseInt(t.substr(a*2,2),16);if(isNaN(s))throw new Error("Invalid hex string");e[n+a]=s}return a}function l(e,t,n,r){var i=B(I(t),e,n,r);return i}function c(e,t,n,r){var i=B(P(t),e,n,r);return i}function f(e,t,n,r){return c(e,t,n,r)}function d(e,t,n,r){var i=B(z(t),e,n,r);return i}function _(e,t,n,r){var i=B(R(t),e,n,r,2);return i}s.prototype.write=function(e,t,n,r){if(isFinite(t)){if(!isFinite(n)){r=n;n=undefined}}else{var i=r;r=t;t=n;n=i}t=Number(t)||0;var o=this.length-t;if(!n){n=o}else{n=Number(n);if(n>o){n=o}}r=String(r||"utf8").toLowerCase();var a;switch(r){case"hex":a=u(this,e,t,n);break;case"utf8":case"utf-8":a=l(this,e,t,n);break;case"ascii":a=c(this,e,t,n);break;case"binary":a=f(this,e,t,n);break;case"base64":a=d(this,e,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=_(this,e,t,n);break;default:throw new TypeError("Unknown encoding: "+r)}return a};s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function p(e,t,n){if(t===0&&n===e.length){return r.fromByteArray(e)}else{return r.fromByteArray(e.slice(t,n))}}function h(e,t,n){var r="";var i="";n=Math.min(e.length,n);for(var o=t;o<n;o++){if(e[o]<=127){r+=N(i)+String.fromCharCode(e[o]);i=""}else{i+="%"+e[o].toString(16)}}return r+N(i)}function g(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;i++){r+=String.fromCharCode(e[i])}return r}function m(e,t,n){return g(e,t,n)}function v(e,t,n){var r=e.length;if(!t||t<0)t=0;if(!n||n<0||n>r)n=r;var i="";for(var o=t;o<n;o++){i+=O(e[o])}return i}function y(e,t,n){var r=e.slice(t,n);var i="";for(var o=0;o<r.length;o+=2){i+=String.fromCharCode(r[o]+r[o+1]*256)}return i}s.prototype.slice=function(e,t){var n=this.length;e=~~e;t=t===undefined?n:~~t;if(e<0){e+=n;if(e<0)e=0}else if(e>n){e=n}if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(t<e)t=e;if(s.TYPED_ARRAY_SUPPORT){return s._augment(this.subarray(e,t))}else{var r=t-e;var i=new s(r,undefined,true);for(var o=0;o<r;o++){i[o]=this[o+e]}return i}};function b(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUInt8=function(e,t){if(!t)b(e,1,this.length);return this[e]};s.prototype.readUInt16LE=function(e,t){if(!t)b(e,2,this.length);return this[e]|this[e+1]<<8};s.prototype.readUInt16BE=function(e,t){if(!t)b(e,2,this.length);return this[e]<<8|this[e+1]};s.prototype.readUInt32LE=function(e,t){if(!t)b(e,4,this.length);return(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};s.prototype.readUInt32BE=function(e,t){if(!t)b(e,4,this.length);return this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};s.prototype.readInt8=function(e,t){if(!t)b(e,1,this.length);if(!(this[e]&128))return this[e];return(255-this[e]+1)*-1};s.prototype.readInt16LE=function(e,t){if(!t)b(e,2,this.length);var n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};s.prototype.readInt16BE=function(e,t){if(!t)b(e,2,this.length);var n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};s.prototype.readInt32LE=function(e,t){if(!t)b(e,4,this.length);return this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};s.prototype.readInt32BE=function(e,t){if(!t)b(e,4,this.length);return this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};s.prototype.readFloatLE=function(e,t){if(!t)b(e,4,this.length);return i.read(this,e,true,23,4)};s.prototype.readFloatBE=function(e,t){if(!t)b(e,4,this.length);return i.read(this,e,false,23,4)};s.prototype.readDoubleLE=function(e,t){if(!t)b(e,8,this.length);return i.read(this,e,true,52,8)};s.prototype.readDoubleBE=function(e,t){if(!t)b(e,8,this.length);return i.read(this,e,false,52,8)};function w(e,t,n,r,i,o){if(!s.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(t>i||t<o)throw new TypeError("value is out of bounds");if(n+r>e.length)throw new TypeError("index out of range")}s.prototype.writeUInt8=function(e,t,n){e=+e;t=t>>>0;if(!n)w(this,e,t,1,255,0);if(!s.TYPED_ARRAY_SUPPORT)e=Math.floor(e);this[t]=e;return t+1};function x(e,t,n,r){if(t<0)t=65535+t+1;for(var i=0,o=Math.min(e.length-n,2);i<o;i++){e[n+i]=(t&255<<8*(r?i:1-i))>>>(r?i:1-i)*8}}s.prototype.writeUInt16LE=function(e,t,n){e=+e;t=t>>>0;if(!n)w(this,e,t,2,65535,0);if(s.TYPED_ARRAY_SUPPORT){this[t]=e;this[t+1]=e>>>8}else x(this,e,t,true);return t+2};s.prototype.writeUInt16BE=function(e,t,n){e=+e;t=t>>>0;if(!n)w(this,e,t,2,65535,0);if(s.TYPED_ARRAY_SUPPORT){this[t]=e>>>8;this[t+1]=e}else x(this,e,t,false);return t+2};function k(e,t,n,r){if(t<0)t=4294967295+t+1;for(var i=0,o=Math.min(e.length-n,4);i<o;i++){e[n+i]=t>>>(r?i:3-i)*8&255}}s.prototype.writeUInt32LE=function(e,t,n){e=+e;t=t>>>0;if(!n)w(this,e,t,4,4294967295,0);if(s.TYPED_ARRAY_SUPPORT){this[t+3]=e>>>24;this[t+2]=e>>>16;this[t+1]=e>>>8;this[t]=e}else k(this,e,t,true);return t+4};s.prototype.writeUInt32BE=function(e,t,n){e=+e;t=t>>>0;if(!n)w(this,e,t,4,4294967295,0);if(s.TYPED_ARRAY_SUPPORT){this[t]=e>>>24;this[t+1]=e>>>16;this[t+2]=e>>>8;this[t+3]=e}else k(this,e,t,false);return t+4};s.prototype.writeInt8=function(e,t,n){e=+e;t=t>>>0;if(!n)w(this,e,t,1,127,-128);if(!s.TYPED_ARRAY_SUPPORT)e=Math.floor(e);if(e<0)e=255+e+1;this[t]=e;return t+1};s.prototype.writeInt16LE=function(e,t,n){e=+e;t=t>>>0;if(!n)w(this,e,t,2,32767,-32768);if(s.TYPED_ARRAY_SUPPORT){this[t]=e;this[t+1]=e>>>8}else x(this,e,t,true);return t+2};s.prototype.writeInt16BE=function(e,t,n){e=+e;t=t>>>0;if(!n)w(this,e,t,2,32767,-32768);if(s.TYPED_ARRAY_SUPPORT){this[t]=e>>>8;this[t+1]=e}else x(this,e,t,false);return t+2};s.prototype.writeInt32LE=function(e,t,n){e=+e;t=t>>>0;if(!n)w(this,e,t,4,2147483647,-2147483648);if(s.TYPED_ARRAY_SUPPORT){this[t]=e;this[t+1]=e>>>8;this[t+2]=e>>>16;this[t+3]=e>>>24}else k(this,e,t,true);return t+4};s.prototype.writeInt32BE=function(e,t,n){e=+e;t=t>>>0;if(!n)w(this,e,t,4,2147483647,-2147483648);if(e<0)e=4294967295+e+1;if(s.TYPED_ARRAY_SUPPORT){this[t]=e>>>24;this[t+1]=e>>>16;this[t+2]=e>>>8;this[t+3]=e}else k(this,e,t,false);return t+4};function S(e,t,n,r,i,o){if(t>i||t<o)throw new TypeError("value is out of bounds");if(n+r>e.length)throw new TypeError("index out of range")}function A(e,t,n,r,o){if(!o)S(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38);i.write(e,t,n,r,23,4);return n+4}s.prototype.writeFloatLE=function(e,t,n){return A(this,e,t,true,n)};s.prototype.writeFloatBE=function(e,t,n){return A(this,e,t,false,n)};function E(e,t,n,r,o){if(!o)S(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308);i.write(e,t,n,r,52,8);return n+8}s.prototype.writeDoubleLE=function(e,t,n){return E(this,e,t,true,n)};s.prototype.writeDoubleBE=function(e,t,n){return E(this,e,t,false,n)};s.prototype.copy=function(e,t,n,r){var i=this;if(!n)n=0;if(!r&&r!==0)r=this.length;if(!t)t=0;if(r===n)return;if(e.length===0||i.length===0)return;if(r<n)throw new TypeError("sourceEnd < sourceStart");if(t<0||t>=e.length)throw new TypeError("targetStart out of bounds");if(n<0||n>=i.length)throw new TypeError("sourceStart out of bounds");if(r<0||r>i.length)throw new TypeError("sourceEnd out of bounds");if(r>this.length)r=this.length;if(e.length-t<r-n)r=e.length-t+n;var o=r-n;if(o<1e3||!s.TYPED_ARRAY_SUPPORT){for(var a=0;a<o;a++){e[a+t]=this[a+n]}}else{e._set(this.subarray(n,n+o),t)}};s.prototype.fill=function(e,t,n){if(!e)e=0;if(!t)t=0;if(!n)n=this.length;if(n<t)throw new TypeError("end < start");if(n===t)return;if(this.length===0)return;if(t<0||t>=this.length)throw new TypeError("start out of bounds");if(n<0||n>this.length)throw new TypeError("end out of bounds");var r;if(typeof e==="number"){for(r=t;r<n;r++){this[r]=e}}else{var i=I(e.toString());var o=i.length;for(r=t;r<n;r++){this[r]=i[r%o]}}return this};s.prototype.toArrayBuffer=function(){if(typeof Uint8Array!=="undefined"){if(s.TYPED_ARRAY_SUPPORT){return new s(this).buffer}else{var e=new Uint8Array(this.length);for(var t=0,n=e.length;t<n;t+=1){e[t]=this[t]}return e.buffer}}else{throw new TypeError("Buffer.toArrayBuffer not supported in this browser")}};var M=s.prototype;s._augment=function(e){e.constructor=s;e._isBuffer=true;e._get=e.get;e._set=e.set;e.get=M.get;e.set=M.set;e.write=M.write;e.toString=M.toString;e.toLocaleString=M.toString;e.toJSON=M.toJSON;e.equals=M.equals;e.compare=M.compare;e.copy=M.copy;e.slice=M.slice;e.readUInt8=M.readUInt8;e.readUInt16LE=M.readUInt16LE;e.readUInt16BE=M.readUInt16BE;e.readUInt32LE=M.readUInt32LE;e.readUInt32BE=M.readUInt32BE;e.readInt8=M.readInt8;e.readInt16LE=M.readInt16LE;e.readInt16BE=M.readInt16BE;e.readInt32LE=M.readInt32LE;e.readInt32BE=M.readInt32BE;e.readFloatLE=M.readFloatLE;e.readFloatBE=M.readFloatBE;e.readDoubleLE=M.readDoubleLE;e.readDoubleBE=M.readDoubleBE;e.writeUInt8=M.writeUInt8;e.writeUInt16LE=M.writeUInt16LE;e.writeUInt16BE=M.writeUInt16BE;e.writeUInt32LE=M.writeUInt32LE;e.writeUInt32BE=M.writeUInt32BE;e.writeInt8=M.writeInt8;e.writeInt16LE=M.writeInt16LE;e.writeInt16BE=M.writeInt16BE;e.writeInt32LE=M.writeInt32LE;e.writeInt32BE=M.writeInt32BE;e.writeFloatLE=M.writeFloatLE;e.writeFloatBE=M.writeFloatBE;e.writeDoubleLE=M.writeDoubleLE;e.writeDoubleBE=M.writeDoubleBE;e.fill=M.fill;e.inspect=M.inspect;e.toArrayBuffer=M.toArrayBuffer;return e};var T=/[^+\/0-9A-z]/g;function C(e){e=j(e).replace(T,"");while(e.length%4!==0){e=e+"="}return e}function j(e){if(e.trim)return e.trim();return e.replace(/^\s+|\s+$/g,"")}function D(e){return o(e)||s.isBuffer(e)||e&&typeof e==="object"&&typeof e.length==="number"}function O(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function I(e){var t=[];for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127){t.push(r)}else{var i=n;if(r>=55296&&r<=57343)n++;var o=encodeURIComponent(e.slice(i,n+1)).substr(1).split("%");for(var a=0;a<o.length;a++){t.push(parseInt(o[a],16))}}}return t}function P(e){var t=[];for(var n=0;n<e.length;n++){t.push(e.charCodeAt(n)&255)}return t}function R(e){var t,n,r;var i=[];for(var o=0;o<e.length;o++){t=e.charCodeAt(o);n=t>>8;r=t%256;i.push(r);i.push(n)}return i}function z(e){return r.toByteArray(e)}function B(e,t,n,r,i){if(i)r-=r%i;for(var o=0;o<r;o++){if(o+n>=t.length||o>=e.length)break;t[o+n]=e[o]}return o}function N(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}},{"base64-js":80,ieee754:81,"is-array":82}],80:[function(e,t,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(e){"use strict";var t=typeof Uint8Array!=="undefined"?Uint8Array:Array;var n="+".charCodeAt(0);var i="/".charCodeAt(0);var o="0".charCodeAt(0);var a="a".charCodeAt(0);var s="A".charCodeAt(0);function u(e){var t=e.charCodeAt(0);if(t===n)return 62;if(t===i)return 63;if(t<o)return-1;if(t<o+10)return t-o+26+26;if(t<s+26)return t-s;if(t<a+26)return t-a+26}function l(e){var n,r,i,o,a,s;if(e.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var l=e.length;a="="===e.charAt(l-2)?2:"="===e.charAt(l-1)?1:0;s=new t(e.length*3/4-a);i=a>0?e.length-4:e.length;var c=0;function f(e){s[c++]=e}for(n=0,r=0;n<i;n+=4,r+=3){o=u(e.charAt(n))<<18|u(e.charAt(n+1))<<12|u(e.charAt(n+2))<<6|u(e.charAt(n+3));f((o&16711680)>>16);f((o&65280)>>8);f(o&255)}if(a===2){o=u(e.charAt(n))<<2|u(e.charAt(n+1))>>4;f(o&255)}else if(a===1){o=u(e.charAt(n))<<10|u(e.charAt(n+1))<<4|u(e.charAt(n+2))>>2;f(o>>8&255);f(o&255)}return s}function c(e){var t,n=e.length%3,i="",o,a;function s(e){return r.charAt(e)}function u(e){return s(e>>18&63)+s(e>>12&63)+s(e>>6&63)+s(e&63)}for(t=0,a=e.length-n;t<a;t+=3){o=(e[t]<<16)+(e[t+1]<<8)+e[t+2];i+=u(o)}switch(n){case 1:o=e[e.length-1];i+=s(o>>2);i+=s(o<<4&63);i+="==";break;case 2:o=(e[e.length-2]<<8)+e[e.length-1];i+=s(o>>10);i+=s(o>>4&63);i+=s(o<<2&63);i+="=";break}return i}e.toByteArray=l;e.fromByteArray=c})(typeof n==="undefined"?this.base64js={}:n)},{}],81:[function(e,t,n){n.read=function(e,t,n,r,i){var o,a;var s=i*8-r-1;var u=(1<<s)-1;var l=u>>1;var c=-7;var f=n?i-1:0;var d=n?-1:1;var _=e[t+f];f+=d;o=_&(1<<-c)-1;_>>=-c;c+=s;for(;c>0;o=o*256+e[t+f],f+=d,c-=8){}a=o&(1<<-c)-1;o>>=-c;c+=r;for(;c>0;a=a*256+e[t+f],f+=d,c-=8){}if(o===0){o=1-l}else if(o===u){return a?NaN:(_?-1:1)*Infinity}else{a=a+Math.pow(2,r);o=o-l}return(_?-1:1)*a*Math.pow(2,o-r)};n.write=function(e,t,n,r,i,o){var a,s,u;var l=o*8-i-1;var c=(1<<l)-1;var f=c>>1;var d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0;var _=r?0:o-1;var p=r?1:-1;var h=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){s=isNaN(t)?1:0;a=c}else{a=Math.floor(Math.log(t)/Math.LN2);if(t*(u=Math.pow(2,-a))<1){a--;u*=2}if(a+f>=1){t+=d/u}else{t+=d*Math.pow(2,1-f)}if(t*u>=2){a++;u/=2}if(a+f>=c){s=0;a=c}else if(a+f>=1){s=(t*u-1)*Math.pow(2,i);a=a+f}else{s=t*Math.pow(2,f-1)*Math.pow(2,i);a=0}}for(;i>=8;e[n+_]=s&255,_+=p,s/=256,i-=8){}a=a<<i|s;l+=i;for(;l>0;e[n+_]=a&255,_+=p,a/=256,l-=8){}e[n+_-p]|=h*128}},{}],82:[function(e,t,n){var r=Array.isArray;var i=Object.prototype.toString;t.exports=r||function(e){return!!e&&"[object Array]"==i.call(e)}},{}],83:[function(e,t,n){"use strict";n.randomBytes=n.rng=n.pseudoRandomBytes=n.prng=e("randombytes");n.createHash=n.Hash=e("create-hash");n.createHmac=n.Hmac=e("create-hmac");var r=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(Object.keys(e("browserify-sign/algos")));n.getHashes=function(){return r};var i=e("pbkdf2");n.pbkdf2=i.pbkdf2;n.pbkdf2Sync=i.pbkdf2Sync;var o=e("browserify-cipher");["Cipher","createCipher","Cipheriv","createCipheriv","Decipher","createDecipher","Decipheriv","createDecipheriv","getCiphers","listCiphers"].forEach(function(e){n[e]=o[e]});var a=e("diffie-hellman");["DiffieHellmanGroup","createDiffieHellmanGroup","getDiffieHellman","createDiffieHellman","DiffieHellman"].forEach(function(e){n[e]=a[e]});var s=e("browserify-sign");["createSign","Sign","createVerify","Verify"].forEach(function(e){n[e]=s[e]});n.createECDH=e("create-ecdh");var u=e("public-encrypt");["publicEncrypt","privateEncrypt","publicDecrypt","privateDecrypt"].forEach(function(e){n[e]=u[e]});["createCredentials"].forEach(function(e){n[e]=function(){throw new Error(["sorry, "+e+" is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))}})},{"browserify-cipher":84,"browserify-sign":114,"browserify-sign/algos":113,"create-ecdh":181,"create-hash":207,"create-hmac":220,"diffie-hellman":221,pbkdf2:228,"public-encrypt":230,randombytes:275}],84:[function(e,t,n){var r=e("evp_bytestokey");var i=e("browserify-aes/browser");var o=e("browserify-des");var a=e("browserify-des/modes");var s=e("browserify-aes/modes");function u(e,t){var n,i;e=e.toLowerCase();if(s[e]){n=s[e].key;i=s[e].iv}else if(a[e]){n=a[e].key*8;i=a[e].iv}else{throw new TypeError("invalid suite type")}var o=r(t,false,n,i);return c(e,o.key,o.iv)}function l(e,t){var n,i;e=e.toLowerCase();if(s[e]){n=s[e].key;i=s[e].iv}else if(a[e]){n=a[e].key*8;i=a[e].iv}else{throw new TypeError("invalid suite type")}var o=r(t,false,n,i);return f(e,o.key,o.iv)}function c(e,t,n){e=e.toLowerCase();if(s[e]){return i.createCipheriv(e,t,n)}else if(a[e]){return new o({key:t,iv:n,mode:e})}else{throw new TypeError("invalid suite type")}}function f(e,t,n){e=e.toLowerCase();if(s[e]){return i.createDecipheriv(e,t,n)}else if(a[e]){return new o({key:t,iv:n,mode:e,decrypt:true})}else{throw new TypeError("invalid suite type")}}n.createCipher=n.Cipher=u;n.createCipheriv=n.Cipheriv=c;n.createDecipher=n.Decipher=l;n.createDecipheriv=n.Decipheriv=f;function d(){return Object.keys(a).concat(i.getCiphers())}n.listCiphers=n.getCiphers=d},{"browserify-aes/browser":87,"browserify-aes/modes":91,"browserify-des":102,"browserify-des/modes":103,evp_bytestokey:112}],85:[function(e,t,n){(function(e){var t=Math.pow(2,32);function r(e){var n,r;n=e>t||e<0?(r=Math.abs(e)%t,e<0?t-r:r):e;return n}function i(e){for(var t=0;t<e.length;e++){e[t]=0}return false}function o(){this.SBOX=[];this.INV_SBOX=[];this.SUB_MIX=[[],[],[],[]];this.INV_SUB_MIX=[[],[],[],[]];this.init();this.RCON=[0,1,2,4,8,16,32,64,128,27,54]}o.prototype.init=function(){var e,t,n,r,i,o,a,s,u,l;e=function(){var e,n;n=[];for(t=e=0;e<256;t=++e){if(t<128){n.push(t<<1)}else{n.push(t<<1^283)}}return n}();i=0;u=0;for(t=l=0;l<256;t=++l){n=u^u<<1^u<<2^u<<3^u<<4;n=n>>>8^n&255^99;this.SBOX[i]=n;this.INV_SBOX[n]=i;o=e[i];a=e[o];s=e[a];r=e[n]*257^n*16843008;this.SUB_MIX[0][i]=r<<24|r>>>8;this.SUB_MIX[1][i]=r<<16|r>>>16;this.SUB_MIX[2][i]=r<<8|r>>>24;this.SUB_MIX[3][i]=r;r=s*16843009^a*65537^o*257^i*16843008;this.INV_SUB_MIX[0][n]=r<<24|r>>>8;this.INV_SUB_MIX[1][n]=r<<16|r>>>16;this.INV_SUB_MIX[2][n]=r<<8|r>>>24;this.INV_SUB_MIX[3][n]=r;if(i===0){i=u=1}else{i=o^e[e[e[s^o]]];u^=e[e[u]]}}return true};var a=new o;u.blockSize=4*4;u.prototype.blockSize=u.blockSize;u.keySize=256/8;u.prototype.keySize=u.keySize;function s(e){var t=e.length/4;var n=new Array(t);var r=-1;while(++r<t){n[r]=e.readUInt32BE(r*4)}return n}function u(e){this._key=s(e);this._doReset()}u.prototype._doReset=function(){var e,t,n,r,i,o;n=this._key;t=n.length;this._nRounds=t+6;i=(this._nRounds+1)*4;this._keySchedule=[];for(r=0;r<i;r++){this._keySchedule[r]=r<t?n[r]:(o=this._keySchedule[r-1],r%t===0?(o=o<<8|o>>>24,o=a.SBOX[o>>>24]<<24|a.SBOX[o>>>16&255]<<16|a.SBOX[o>>>8&255]<<8|a.SBOX[o&255],o^=a.RCON[r/t|0]<<24):t>6&&r%t===4?o=a.SBOX[o>>>24]<<24|a.SBOX[o>>>16&255]<<16|a.SBOX[o>>>8&255]<<8|a.SBOX[o&255]:void 0,this._keySchedule[r-t]^o)}this._invKeySchedule=[];for(e=0;e<i;e++){r=i-e;o=this._keySchedule[r-(e%4?0:4)];this._invKeySchedule[e]=e<4||r<=4?o:a.INV_SUB_MIX[0][a.SBOX[o>>>24]]^a.INV_SUB_MIX[1][a.SBOX[o>>>16&255]]^a.INV_SUB_MIX[2][a.SBOX[o>>>8&255]]^a.INV_SUB_MIX[3][a.SBOX[o&255]]}return true};u.prototype.encryptBlock=function(t){t=s(new e(t));var n=this._doCryptBlock(t,this._keySchedule,a.SUB_MIX,a.SBOX);var r=new e(16);r.writeUInt32BE(n[0],0);r.writeUInt32BE(n[1],4);r.writeUInt32BE(n[2],8);r.writeUInt32BE(n[3],12);return r};u.prototype.decryptBlock=function(t){t=s(new e(t));var n=[t[3],t[1]];t[1]=n[0];t[3]=n[1];var r=this._doCryptBlock(t,this._invKeySchedule,a.INV_SUB_MIX,a.INV_SBOX);var i=new e(16);i.writeUInt32BE(r[0],0);i.writeUInt32BE(r[3],4);i.writeUInt32BE(r[2],8);i.writeUInt32BE(r[1],12);return i};u.prototype.scrub=function(){i(this._keySchedule);i(this._invKeySchedule);i(this._key)};u.prototype._doCryptBlock=function(e,t,n,i){var o,a,s,u,l,c,f,d,_;a=e[0]^t[0];s=e[1]^t[1];u=e[2]^t[2];l=e[3]^t[3];o=4;for(var p=1;p<this._nRounds;p++){c=n[0][a>>>24]^n[1][s>>>16&255]^n[2][u>>>8&255]^n[3][l&255]^t[o++];f=n[0][s>>>24]^n[1][u>>>16&255]^n[2][l>>>8&255]^n[3][a&255]^t[o++];d=n[0][u>>>24]^n[1][l>>>16&255]^n[2][a>>>8&255]^n[3][s&255]^t[o++];_=n[0][l>>>24]^n[1][a>>>16&255]^n[2][s>>>8&255]^n[3][u&255]^t[o++];a=c;s=f;u=d;l=_}c=(i[a>>>24]<<24|i[s>>>16&255]<<16|i[u>>>8&255]<<8|i[l&255])^t[o++];f=(i[s>>>24]<<24|i[u>>>16&255]<<16|i[l>>>8&255]<<8|i[a&255])^t[o++];d=(i[u>>>24]<<24|i[l>>>16&255]<<16|i[a>>>8&255]<<8|i[s&255])^t[o++];_=(i[l>>>24]<<24|i[a>>>16&255]<<16|i[s>>>8&255]<<8|i[u&255])^t[o++];return[r(c),r(f),r(d),r(_)]};n.AES=u}).call(this,e("buffer").Buffer)},{buffer:79}],86:[function(e,t,n){(function(n){var r=e("./aes");var i=e("cipher-base");var o=e("inherits");var a=e("./ghash");var s=e("buffer-xor");o(u,i);t.exports=u;function u(e,t,o,s){if(!(this instanceof u)){return new u(e,t,o)}i.call(this);this._finID=n.concat([o,new n([0,0,0,1])]);o=n.concat([o,new n([0,0,0,2])]);this._cipher=new r.AES(t);this._prev=new n(o.length);this._cache=new n("");this._secCache=new n("");this._decrypt=s;this._alen=0;this._len=0;o.copy(this._prev);this._mode=e;var l=new n(4);l.fill(0);this._ghash=new a(this._cipher.encryptBlock(l));this._authTag=null;this._called=false}u.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;if(t<16){t=new n(t);t.fill(0);this._ghash.update(t)}}this._called=true;var r=this._mode.encrypt(this,e);if(this._decrypt){this._ghash.update(e)}else{this._ghash.update(r)}this._len+=e.length;return r};u.prototype._final=function(){
if(this._decrypt&&!this._authTag){throw new Error("Unsupported state or unable to authenticate data")}var e=s(this._ghash.final(this._alen*8,this._len*8),this._cipher.encryptBlock(this._finID));if(this._decrypt){if(l(e,this._authTag)){throw new Error("Unsupported state or unable to authenticate data")}}else{this._authTag=e}this._cipher.scrub()};u.prototype.getAuthTag=function c(){if(!this._decrypt&&n.isBuffer(this._authTag)){return this._authTag}else{throw new Error("Attempting to get auth tag in unsupported state")}};u.prototype.setAuthTag=function f(e){if(this._decrypt){this._authTag=e}else{throw new Error("Attempting to set auth tag in unsupported state")}};u.prototype.setAAD=function d(e){if(!this._called){this._ghash.update(e);this._alen+=e.length}else{throw new Error("Attempting to set AAD in unsupported state")}};function l(e,t){var n=0;if(e.length!==t.length){n++}var r=Math.min(e.length,t.length);var i=-1;while(++i<r){n+=e[i]^t[i]}return n}}).call(this,e("buffer").Buffer)},{"./aes":85,"./ghash":90,buffer:79,"buffer-xor":99,"cipher-base":100,inherits:277}],87:[function(e,t,n){var r=e("./encrypter");n.createCipher=n.Cipher=r.createCipher;n.createCipheriv=n.Cipheriv=r.createCipheriv;var i=e("./decrypter");n.createDecipher=n.Decipher=i.createDecipher;n.createDecipheriv=n.Decipheriv=i.createDecipheriv;var o=e("./modes");function a(){return Object.keys(o)}n.listCiphers=n.getCiphers=a},{"./decrypter":88,"./encrypter":89,"./modes":91}],88:[function(e,t,n){(function(t){var r=e("./aes");var i=e("cipher-base");var o=e("inherits");var a=e("./modes");var s=e("./streamCipher");var u=e("./authCipher");var l=e("evp_bytestokey");o(c,i);function c(e,n,o){if(!(this instanceof c)){return new c(e,n,o)}i.call(this);this._cache=new f;this._last=void 0;this._cipher=new r.AES(n);this._prev=new t(o.length);o.copy(this._prev);this._mode=e;this._autopadding=true}c.prototype._update=function(e){this._cache.add(e);var n;var r;var i=[];while(n=this._cache.get(this._autopadding)){r=this._mode.decrypt(this,n);i.push(r)}return t.concat(i)};c.prototype._final=function(){var e=this._cache.flush();if(this._autopadding){return d(this._mode.decrypt(this,e))}else if(e){throw new Error("data not multiple of block length")}};c.prototype.setAutoPadding=function(e){this._autopadding=!!e;return this};function f(){if(!(this instanceof f)){return new f}this.cache=new t("")}f.prototype.add=function(e){this.cache=t.concat([this.cache,e])};f.prototype.get=function(e){var t;if(e){if(this.cache.length>16){t=this.cache.slice(0,16);this.cache=this.cache.slice(16);return t}}else{if(this.cache.length>=16){t=this.cache.slice(0,16);this.cache=this.cache.slice(16);return t}}return null};f.prototype.flush=function(){if(this.cache.length){return this.cache}};function d(e){var t=e[15];var n=-1;while(++n<t){if(e[n+(16-t)]!==t){throw new Error("unable to decrypt data")}}if(t===16){return}return e.slice(0,16-t)}var _={ECB:e("./modes/ecb"),CBC:e("./modes/cbc"),CFB:e("./modes/cfb"),CFB8:e("./modes/cfb8"),CFB1:e("./modes/cfb1"),OFB:e("./modes/ofb"),CTR:e("./modes/ctr"),GCM:e("./modes/ctr")};function p(e,n,r){var i=a[e.toLowerCase()];if(!i){throw new TypeError("invalid suite type")}if(typeof r==="string"){r=new t(r)}if(typeof n==="string"){n=new t(n)}if(n.length!==i.key/8){throw new TypeError("invalid key length "+n.length)}if(r.length!==i.iv){throw new TypeError("invalid iv length "+r.length)}if(i.type==="stream"){return new s(_[i.mode],n,r,true)}else if(i.type==="auth"){return new u(_[i.mode],n,r,true)}return new c(_[i.mode],n,r)}function h(e,t){var n=a[e.toLowerCase()];if(!n){throw new TypeError("invalid suite type")}var r=l(t,false,n.key,n.iv);return p(e,r.key,r.iv)}n.createDecipher=h;n.createDecipheriv=p}).call(this,e("buffer").Buffer)},{"./aes":85,"./authCipher":86,"./modes":91,"./modes/cbc":92,"./modes/cfb":93,"./modes/cfb1":94,"./modes/cfb8":95,"./modes/ctr":96,"./modes/ecb":97,"./modes/ofb":98,"./streamCipher":101,buffer:79,"cipher-base":100,evp_bytestokey:112,inherits:277}],89:[function(e,t,n){(function(t){var r=e("./aes");var i=e("cipher-base");var o=e("inherits");var a=e("./modes");var s=e("evp_bytestokey");var u=e("./streamCipher");var l=e("./authCipher");o(c,i);function c(e,n,o){if(!(this instanceof c)){return new c(e,n,o)}i.call(this);this._cache=new f;this._cipher=new r.AES(n);this._prev=new t(o.length);o.copy(this._prev);this._mode=e;this._autopadding=true}c.prototype._update=function(e){this._cache.add(e);var n;var r;var i=[];while(n=this._cache.get()){r=this._mode.encrypt(this,n);i.push(r)}return t.concat(i)};c.prototype._final=function(){var e=this._cache.flush();if(this._autopadding){e=this._mode.encrypt(this,e);this._cipher.scrub();return e}else if(e.toString("hex")!=="10101010101010101010101010101010"){this._cipher.scrub();throw new Error("data not multiple of block length")}};c.prototype.setAutoPadding=function(e){this._autopadding=!!e;return this};function f(){if(!(this instanceof f)){return new f}this.cache=new t("")}f.prototype.add=function(e){this.cache=t.concat([this.cache,e])};f.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);this.cache=this.cache.slice(16);return e}return null};f.prototype.flush=function(){var e=16-this.cache.length;var n=new t(e);var r=-1;while(++r<e){n.writeUInt8(e,r)}var i=t.concat([this.cache,n]);return i};var d={ECB:e("./modes/ecb"),CBC:e("./modes/cbc"),CFB:e("./modes/cfb"),CFB8:e("./modes/cfb8"),CFB1:e("./modes/cfb1"),OFB:e("./modes/ofb"),CTR:e("./modes/ctr"),GCM:e("./modes/ctr")};function _(e,n,r){var i=a[e.toLowerCase()];if(!i){throw new TypeError("invalid suite type")}if(typeof r==="string"){r=new t(r)}if(typeof n==="string"){n=new t(n)}if(n.length!==i.key/8){throw new TypeError("invalid key length "+n.length)}if(r.length!==i.iv){throw new TypeError("invalid iv length "+r.length)}if(i.type==="stream"){return new u(d[i.mode],n,r)}else if(i.type==="auth"){return new l(d[i.mode],n,r)}return new c(d[i.mode],n,r)}function p(e,t){var n=a[e.toLowerCase()];if(!n){throw new TypeError("invalid suite type")}var r=s(t,false,n.key,n.iv);return _(e,r.key,r.iv)}n.createCipheriv=_;n.createCipher=p}).call(this,e("buffer").Buffer)},{"./aes":85,"./authCipher":86,"./modes":91,"./modes/cbc":92,"./modes/cfb":93,"./modes/cfb1":94,"./modes/cfb8":95,"./modes/ctr":96,"./modes/ecb":97,"./modes/ofb":98,"./streamCipher":101,buffer:79,"cipher-base":100,evp_bytestokey:112,inherits:277}],90:[function(e,t,n){(function(e){var n=new e(16);n.fill(0);t.exports=r;function r(t){this.h=t;this.state=new e(16);this.state.fill(0);this.cache=new e("")}r.prototype.ghash=function(e){var t=-1;while(++t<e.length){this.state[t]^=e[t]}this._multiply()};r.prototype._multiply=function(){var e=i(this.h);var t=[0,0,0,0];var n,r,a;var s=-1;while(++s<128){r=(this.state[~~(s/8)]&1<<7-s%8)!==0;if(r){t=u(t,e)}a=(e[3]&1)!==0;for(n=3;n>0;n--){e[n]=e[n]>>>1|(e[n-1]&1)<<31}e[0]=e[0]>>>1;if(a){e[0]=e[0]^225<<24}}this.state=o(t)};r.prototype.update=function(t){this.cache=e.concat([this.cache,t]);var n;while(this.cache.length>=16){n=this.cache.slice(0,16);this.cache=this.cache.slice(16);this.ghash(n)}};r.prototype.final=function(t,r){if(this.cache.length){this.ghash(e.concat([this.cache,n],16))}this.ghash(o([0,t,0,r]));return this.state};function i(e){return[e.readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)]}function o(t){t=t.map(s);var n=new e(16);n.writeUInt32BE(t[0],0);n.writeUInt32BE(t[1],4);n.writeUInt32BE(t[2],8);n.writeUInt32BE(t[3],12);return n}var a=Math.pow(2,32);function s(e){var t,n;t=e>a||e<0?(n=Math.abs(e)%a,e<0?a-n:n):e;return t}function u(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]}}).call(this,e("buffer").Buffer)},{buffer:79}],91:[function(e,t,n){n["aes-128-ecb"]={cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"};n["aes-192-ecb"]={cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"};n["aes-256-ecb"]={cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"};n["aes-128-cbc"]={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"};n["aes-192-cbc"]={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"};n["aes-256-cbc"]={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"};n["aes128"]=n["aes-128-cbc"];n["aes192"]=n["aes-192-cbc"];n["aes256"]=n["aes-256-cbc"];n["aes-128-cfb"]={cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"};n["aes-192-cfb"]={cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"};n["aes-256-cfb"]={cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"};n["aes-128-cfb8"]={cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"};n["aes-192-cfb8"]={cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"};n["aes-256-cfb8"]={cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"};n["aes-128-cfb1"]={cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"};n["aes-192-cfb1"]={cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"};n["aes-256-cfb1"]={cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"};n["aes-128-ofb"]={cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"};n["aes-192-ofb"]={cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"};n["aes-256-ofb"]={cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"};n["aes-128-ctr"]={cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"};n["aes-192-ctr"]={cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"};n["aes-256-ctr"]={cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"};n["aes-128-gcm"]={cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"};n["aes-192-gcm"]={cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"};n["aes-256-gcm"]={cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}},{}],92:[function(e,t,n){var r=e("buffer-xor");n.encrypt=function(e,t){var n=r(t,e._prev);e._prev=e._cipher.encryptBlock(n);return e._prev};n.decrypt=function(e,t){var n=e._prev;e._prev=t;var i=e._cipher.decryptBlock(t);return r(i,n)}},{"buffer-xor":99}],93:[function(e,t,n){(function(t){var r=e("buffer-xor");n.encrypt=function(e,n,r){var o=new t("");var a;while(n.length){if(e._cache.length===0){e._cache=e._cipher.encryptBlock(e._prev);e._prev=new t("")}if(e._cache.length<=n.length){a=e._cache.length;o=t.concat([o,i(e,n.slice(0,a),r)]);n=n.slice(a)}else{o=t.concat([o,i(e,n,r)]);break}}return o};function i(e,n,i){var o=n.length;var a=r(n,e._cache);e._cache=e._cache.slice(o);e._prev=t.concat([e._prev,i?n:a]);return a}}).call(this,e("buffer").Buffer)},{buffer:79,"buffer-xor":99}],94:[function(e,t,n){(function(e){function t(e,t,n){var i;var o=-1;var a=8;var s=0;var u,l;while(++o<a){i=e._cipher.encryptBlock(e._prev);u=t&1<<7-o?128:0;l=i[0]^u;s+=(l&128)>>o%8;e._prev=r(e._prev,n?u:l)}return s}n.encrypt=function(n,r,i){var o=r.length;var a=new e(o);var s=-1;while(++s<o){a[s]=t(n,r[s],i)}return a};function r(t,n){var r=t.length;var i=-1;var o=new e(t.length);t=e.concat([t,new e([n])]);while(++i<r){o[i]=t[i]<<1|t[i+1]>>7}return o}}).call(this,e("buffer").Buffer)},{buffer:79}],95:[function(e,t,n){(function(e){function t(t,n,r){var i=t._cipher.encryptBlock(t._prev);var o=i[0]^n;t._prev=e.concat([t._prev.slice(1),new e([r?n:o])]);return o}n.encrypt=function(n,r,i){var o=r.length;var a=new e(o);var s=-1;while(++s<o){a[s]=t(n,r[s],i)}return a}}).call(this,e("buffer").Buffer)},{buffer:79}],96:[function(e,t,n){(function(t){var r=e("buffer-xor");function i(e){var t=e.length;var n;while(t--){n=e.readUInt8(t);if(n===255){e.writeUInt8(0,t)}else{n++;e.writeUInt8(n,t);break}}}function o(e){var t=e._cipher.encryptBlock(e._prev);i(e._prev);return t}n.encrypt=function(e,n){while(e._cache.length<n.length){e._cache=t.concat([e._cache,o(e)])}var i=e._cache.slice(0,n.length);e._cache=e._cache.slice(n.length);return r(n,i)}}).call(this,e("buffer").Buffer)},{buffer:79,"buffer-xor":99}],97:[function(e,t,n){n.encrypt=function(e,t){return e._cipher.encryptBlock(t)};n.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},{}],98:[function(e,t,n){(function(t){var r=e("buffer-xor");function i(e){e._prev=e._cipher.encryptBlock(e._prev);return e._prev}n.encrypt=function(e,n){while(e._cache.length<n.length){e._cache=t.concat([e._cache,i(e)])}var o=e._cache.slice(0,n.length);e._cache=e._cache.slice(n.length);return r(n,o)}}).call(this,e("buffer").Buffer)},{buffer:79,"buffer-xor":99}],99:[function(e,t,n){(function(e){t.exports=function n(t,r){var i=Math.min(t.length,r.length);var o=new e(i);for(var a=0;a<i;++a){o[a]=t[a]^r[a]}return o}}).call(this,e("buffer").Buffer)},{buffer:79}],100:[function(e,t,n){(function(n){var r=e("stream").Transform;var i=e("inherits");var o=e("string_decoder").StringDecoder;t.exports=a;i(a,r);function a(e){r.call(this);this.hashMode=typeof e==="string";if(this.hashMode){this[e]=this._finalOrDigest}else{this.final=this._finalOrDigest}this._decoder=null;this._encoding=null}a.prototype.update=function(e,t,r){if(typeof e==="string"){e=new n(e,t)}var i=this._update(e);if(this.hashMode){return this}if(r){i=this._toString(i,r)}return i};a.prototype.setAutoPadding=function(){};a.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")};a.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")};a.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")};a.prototype._transform=function(e,t,n){var r;try{if(this.hashMode){this._update(e)}else{this.push(this._update(e))}}catch(i){r=i}finally{n(r)}};a.prototype._flush=function(e){var t;try{this.push(this._final())}catch(n){t=n}finally{e(t)}};a.prototype._finalOrDigest=function(e){var t=this._final()||new n("");if(e){t=this._toString(t,e,true)}return t};a.prototype._toString=function(e,t,n){if(!this._decoder){this._decoder=new o(t);this._encoding=t}if(this._encoding!==t){throw new Error("can't switch encodings")}var r=this._decoder.write(e);if(n){r+=this._decoder.end()}return r}}).call(this,e("buffer").Buffer)},{buffer:79,inherits:277,stream:297,string_decoder:298}],101:[function(e,t,n){(function(n){var r=e("./aes");var i=e("cipher-base");var o=e("inherits");o(a,i);t.exports=a;function a(e,t,o,s){if(!(this instanceof a)){return new a(e,t,o)}i.call(this);this._cipher=new r.AES(t);this._prev=new n(o.length);this._cache=new n("");this._secCache=new n("");this._decrypt=s;o.copy(this._prev);this._mode=e}a.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)};a.prototype._final=function(){this._cipher.scrub()}}).call(this,e("buffer").Buffer)},{"./aes":85,buffer:79,"cipher-base":100,inherits:277}],102:[function(e,t,n){(function(n){var r=e("cipher-base");var i=e("des.js");var o=e("inherits");var a={"des-ede3-cbc":i.CBC.instantiate(i.EDE),"des-ede3":i.EDE,"des-ede-cbc":i.CBC.instantiate(i.EDE),"des-ede":i.EDE,"des-cbc":i.CBC.instantiate(i.DES),"des-ecb":i.DES};a.des=a["des-cbc"];a.des3=a["des-ede3-cbc"];t.exports=s;o(s,r);function s(e){r.call(this);var t=e.mode.toLowerCase();var i=a[t];var o;if(e.decrypt){o="decrypt"}else{o="encrypt"}var s=e.key;if(t==="des-ede"||t==="des-ede-cbc"){s=n.concat([s,s.slice(0,8)])}var u=e.iv;this._des=i.create({key:s,iv:u,type:o})}s.prototype._update=function(e){return new n(this._des.update(e))};s.prototype._final=function(){return new n(this._des.final())}}).call(this,e("buffer").Buffer)},{buffer:79,"cipher-base":104,"des.js":105,inherits:277}],103:[function(e,t,n){n["des-ecb"]={key:8,iv:0};n["des-cbc"]=n.des={key:8,iv:8};n["des-ede3-cbc"]=n.des3={key:24,iv:8};n["des-ede3"]={key:24,iv:0};n["des-ede-cbc"]={key:16,iv:8};n["des-ede"]={key:16,iv:0}},{}],104:[function(e,t,n){t.exports=e(100)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/node_modules/cipher-base/index.js":100,buffer:79,inherits:277,stream:297,string_decoder:298}],105:[function(e,t,n){"use strict";n.utils=e("./des/utils");n.Cipher=e("./des/cipher");n.DES=e("./des/des");n.CBC=e("./des/cbc");n.EDE=e("./des/ede")},{"./des/cbc":106,"./des/cipher":107,"./des/des":108,"./des/ede":109,"./des/utils":110}],106:[function(e,t,n){"use strict";var r=e("minimalistic-assert");var i=e("inherits");var o={};function a(e){r.equal(e.length,8,"Invalid IV length");this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}function s(e){function t(t){e.call(this,t);this._cbcInit()}i(t,e);var n=Object.keys(o);for(var r=0;r<n.length;r++){var a=n[r];t.prototype[a]=o[a]}t.create=function s(e){return new t(e)};return t}n.instantiate=s;o._cbcInit=function u(){var e=new a(this.options.iv);this._cbcState=e};o._update=function l(e,t,n,r){var i=this._cbcState;var o=this.constructor.super_.prototype;var a=i.iv;if(this.type==="encrypt"){for(var s=0;s<this.blockSize;s++)a[s]^=e[t+s];o._update.call(this,a,0,n,r);for(var s=0;s<this.blockSize;s++)a[s]=n[r+s]}else{o._update.call(this,e,t,n,r);for(var s=0;s<this.blockSize;s++)n[r+s]^=a[s];for(var s=0;s<this.blockSize;s++)a[s]=e[t+s]}}},{inherits:277,"minimalistic-assert":111}],107:[function(e,t,n){"use strict";var r=e("minimalistic-assert");function i(e){this.options=e;this.type=this.options.type;this.blockSize=8;this._init();this.buffer=new Array(this.blockSize);this.bufferOff=0}t.exports=i;i.prototype._init=function o(){};i.prototype.update=function a(e){if(e.length===0)return[];if(this.type==="decrypt")return this._updateDecrypt(e);else return this._updateEncrypt(e)};i.prototype._buffer=function s(e,t){var n=Math.min(this.buffer.length-this.bufferOff,e.length-t);for(var r=0;r<n;r++)this.buffer[this.bufferOff+r]=e[t+r];this.bufferOff+=n;return n};i.prototype._flushBuffer=function u(e,t){this._update(this.buffer,0,e,t);this.bufferOff=0;return this.blockSize};i.prototype._updateEncrypt=function l(e){var t=0;var n=0;var r=(this.bufferOff+e.length)/this.blockSize|0;var i=new Array(r*this.blockSize);if(this.bufferOff!==0){t+=this._buffer(e,t);if(this.bufferOff===this.buffer.length)n+=this._flushBuffer(i,n)}var o=e.length-(e.length-t)%this.blockSize;for(;t<o;t+=this.blockSize){this._update(e,t,i,n);n+=this.blockSize}for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return i};i.prototype._updateDecrypt=function c(e){var t=0;var n=0;var r=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1;var i=new Array(r*this.blockSize);for(;r>0;r--){t+=this._buffer(e,t);n+=this._flushBuffer(i,n)}t+=this._buffer(e,t);return i};i.prototype.final=function f(e){var t;if(e)t=this.update(e);var n;if(this.type==="encrypt")n=this._finalEncrypt();else n=this._finalDecrypt();if(t)return t.concat(n);else return n};i.prototype._pad=function d(e,t){if(t===0)return false;while(t<e.length)e[t++]=0;return true};i.prototype._finalEncrypt=function _(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);this._update(this.buffer,0,e,0);return e};i.prototype._unpad=function p(e){return e};i.prototype._finalDecrypt=function h(){r.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);this._flushBuffer(e,0);return this._unpad(e)}},{"minimalistic-assert":111}],108:[function(e,t,n){"use strict";var r=e("minimalistic-assert");var i=e("inherits");var o=e("../des");var a=o.utils;var s=o.Cipher;function u(){this.tmp=new Array(2);this.keys=null}function l(e){s.call(this,e);var t=new u;this._desState=t;this.deriveKeys(t,e.key)}i(l,s);t.exports=l;l.create=function f(e){return new l(e)};var c=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];l.prototype.deriveKeys=function d(e,t){e.keys=new Array(16*2);r.equal(t.length,this.blockSize,"Invalid key length");var n=a.readUInt32BE(t,0);var i=a.readUInt32BE(t,4);a.pc1(n,i,e.tmp,0);n=e.tmp[0];i=e.tmp[1];for(var o=0;o<e.keys.length;o+=2){var s=c[o>>>1];n=a.r28shl(n,s);i=a.r28shl(i,s);a.pc2(n,i,e.keys,o)}};l.prototype._update=function _(e,t,n,r){var i=this._desState;var o=a.readUInt32BE(e,t);var s=a.readUInt32BE(e,t+4);a.ip(o,s,i.tmp,0);o=i.tmp[0];s=i.tmp[1];if(this.type==="encrypt")this._encrypt(i,o,s,i.tmp,0);else this._decrypt(i,o,s,i.tmp,0);o=i.tmp[0];s=i.tmp[1];a.writeUInt32BE(n,o,r);a.writeUInt32BE(n,s,r+4)};l.prototype._pad=function p(e,t){var n=e.length-t;for(var r=t;r<e.length;r++)e[r]=n;return true};l.prototype._unpad=function h(e){var t=e[e.length-1];for(var n=e.length-t;n<e.length;n++)r.equal(e[n],t);return e.slice(0,e.length-t)};l.prototype._encrypt=function g(e,t,n,r,i){var o=t;var s=n;for(var u=0;u<e.keys.length;u+=2){var l=e.keys[u];var c=e.keys[u+1];a.expand(s,e.tmp,0);l^=e.tmp[0];c^=e.tmp[1];var f=a.substitute(l,c);var d=a.permute(f);var _=s;s=(o^d)>>>0;o=_}a.rip(s,o,r,i)};l.prototype._decrypt=function m(e,t,n,r,i){var o=n;var s=t;for(var u=e.keys.length-2;u>=0;u-=2){var l=e.keys[u];var c=e.keys[u+1];a.expand(o,e.tmp,0);l^=e.tmp[0];c^=e.tmp[1];var f=a.substitute(l,c);var d=a.permute(f);var _=o;o=(s^d)>>>0;s=_}a.rip(o,s,r,i)}},{"../des":105,inherits:277,"minimalistic-assert":111}],109:[function(e,t,n){"use strict";var r=e("minimalistic-assert");var i=e("inherits");var o=e("../des");var a=o.Cipher;var s=o.DES;function u(e,t){r.equal(t.length,24,"Invalid key length");var n=t.slice(0,8);var i=t.slice(8,16);var o=t.slice(16,24);if(e==="encrypt"){this.ciphers=[s.create({type:"encrypt",key:n}),s.create({type:"decrypt",key:i}),s.create({type:"encrypt",key:o})]}else{this.ciphers=[s.create({type:"decrypt",key:o}),s.create({type:"encrypt",key:i}),s.create({type:"decrypt",key:n})]}}function l(e){a.call(this,e);var t=new u(this.type,this.options.key);this._edeState=t}i(l,a);t.exports=l;l.create=function c(e){return new l(e)};l.prototype._update=function f(e,t,n,r){var i=this._edeState;i.ciphers[0]._update(e,t,n,r);i.ciphers[1]._update(n,r,n,r);i.ciphers[2]._update(n,r,n,r)};l.prototype._pad=s.prototype._pad;l.prototype._unpad=s.prototype._unpad},{"../des":105,inherits:277,"minimalistic-assert":111}],110:[function(e,t,n){"use strict";n.readUInt32BE=function a(e,t){var n=e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t];return n>>>0};n.writeUInt32BE=function s(e,t,n){e[0+n]=t>>>24;e[1+n]=t>>>16&255;e[2+n]=t>>>8&255;e[3+n]=t&255};n.ip=function u(e,t,n,r){var i=0;var o=0;for(var a=6;a>=0;a-=2){for(var s=0;s<=24;s+=8){i<<=1;i|=t>>>s+a&1}for(var s=0;s<=24;s+=8){i<<=1;i|=e>>>s+a&1}}for(var a=6;a>=0;a-=2){for(var s=1;s<=25;s+=8){o<<=1;o|=t>>>s+a&1}for(var s=1;s<=25;s+=8){o<<=1;o|=e>>>s+a&1}}n[r+0]=i>>>0;n[r+1]=o>>>0};n.rip=function l(e,t,n,r){var i=0;var o=0;for(var a=0;a<4;a++){for(var s=24;s>=0;s-=8){i<<=1;i|=t>>>s+a&1;i<<=1;i|=e>>>s+a&1}}for(var a=4;a<8;a++){for(var s=24;s>=0;s-=8){o<<=1;o|=t>>>s+a&1;o<<=1;o|=e>>>s+a&1}}n[r+0]=i>>>0;n[r+1]=o>>>0};n.pc1=function c(e,t,n,r){var i=0;var o=0;for(var a=7;a>=5;a--){for(var s=0;s<=24;s+=8){i<<=1;i|=t>>s+a&1}for(var s=0;s<=24;s+=8){i<<=1;i|=e>>s+a&1}}for(var s=0;s<=24;s+=8){i<<=1;i|=t>>s+a&1}for(var a=1;a<=3;a++){for(var s=0;s<=24;s+=8){o<<=1;o|=t>>s+a&1}for(var s=0;s<=24;s+=8){o<<=1;o|=e>>s+a&1}}for(var s=0;s<=24;s+=8){o<<=1;o|=e>>s+a&1}n[r+0]=i>>>0;n[r+1]=o>>>0};n.r28shl=function f(e,t){return e<<t&268435455|e>>>28-t};var r=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];n.pc2=function d(e,t,n,i){var o=0;var a=0;var s=r.length>>>1;for(var u=0;u<s;u++){o<<=1;o|=e>>>r[u]&1}for(var u=s;u<r.length;u++){a<<=1;a|=t>>>r[u]&1}n[i+0]=o>>>0;n[i+1]=a>>>0};n.expand=function _(e,t,n){var r=0;var i=0;r=(e&1)<<5|e>>>27;for(var o=23;o>=15;o-=4){r<<=6;r|=e>>>o&63}for(var o=11;o>=3;o-=4){i|=e>>>o&63;i<<=6}i|=(e&31)<<1|e>>>31;t[n+0]=r>>>0;t[n+1]=i>>>0};var i=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];n.substitute=function p(e,t){var n=0;for(var r=0;r<4;r++){var o=e>>>18-r*6&63;var a=i[r*64+o];n<<=4;n|=a}for(var r=0;r<4;r++){var o=t>>>18-r*6&63;var a=i[4*64+r*64+o];n<<=4;n|=a}return n>>>0};var o=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];n.permute=function h(e){var t=0;for(var n=0;n<o.length;n++){t<<=1;t|=e>>>o[n]&1}return t>>>0};n.padSplit=function g(e,t,n){var r=e.toString(2);while(r.length<t)r="0"+r;var i=[];for(var o=0;o<t;o+=n)i.push(r.slice(o,o+n));return i.join(" ")}},{}],111:[function(e,t,n){t.exports=r;function r(e,t){if(!e)throw new Error(t||"Assertion failed")}r.equal=function i(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},{}],112:[function(e,t,n){(function(n){var r=e("create-hash/md5");t.exports=i;function i(e,t,i,o){if(!n.isBuffer(e)){e=new n(e,"binary")}if(t&&!n.isBuffer(t)){t=new n(t,"binary")}i=i/8;o=o||0;var a=0;var s=0;var u=new n(i);var l=new n(o);var c=0;var f;var d;var _=[];while(true){if(c++>0){_.push(f)}_.push(e);if(t){_.push(t)}f=r(n.concat(_));_=[];d=0;if(i>0){while(true){if(i===0){break}if(d===f.length){break}u[a++]=f[d];i--;d++}}if(o>0&&d!==f.length){while(true){if(o===0){break}if(d===f.length){break}l[s++]=f[d];o--;d++}}if(i===0&&o===0){break}}for(d=0;d<f.length;d++){f[d]=0}return{key:u,iv:l}}}).call(this,e("buffer").Buffer)},{buffer:79,"create-hash/md5":209}],113:[function(e,t,n){(function(e){"use strict";n["RSA-SHA224"]=n.sha224WithRSAEncryption={sign:"rsa",hash:"sha224",id:new e("302d300d06096086480165030402040500041c","hex")};n["RSA-SHA256"]=n.sha256WithRSAEncryption={sign:"rsa",hash:"sha256",id:new e("3031300d060960864801650304020105000420","hex")};n["RSA-SHA384"]=n.sha384WithRSAEncryption={sign:"rsa",hash:"sha384",id:new e("3041300d060960864801650304020205000430","hex")};n["RSA-SHA512"]=n.sha512WithRSAEncryption={sign:"rsa",hash:"sha512",id:new e("3051300d060960864801650304020305000440","hex")};n["RSA-SHA1"]={sign:"rsa",hash:"sha1",id:new e("3021300906052b0e03021a05000414","hex")};n["ecdsa-with-SHA1"]={sign:"ecdsa",hash:"sha1",id:new e("","hex")};n.DSA=n["DSA-SHA1"]=n["DSA-SHA"]={sign:"dsa",hash:"sha1",id:new e("","hex")};n["DSA-SHA224"]=n["DSA-WITH-SHA224"]={sign:"dsa",hash:"sha224",id:new e("","hex")};n["DSA-SHA256"]=n["DSA-WITH-SHA256"]={sign:"dsa",hash:"sha256",id:new e("","hex")};n["DSA-SHA384"]=n["DSA-WITH-SHA384"]={sign:"dsa",hash:"sha384",id:new e("","hex")};n["DSA-SHA512"]=n["DSA-WITH-SHA512"]={sign:"dsa",hash:"sha512",id:new e("","hex")};n["DSA-RIPEMD160"]={sign:"dsa",hash:"rmd160",id:new e("","hex")};n["RSA-RIPEMD160"]=n.ripemd160WithRSA={sign:"rsa",hash:"rmd160",id:new e("3021300906052b2403020105000414","hex")};n["RSA-MD5"]=n.md5WithRSAEncryption={sign:"rsa",hash:"md5",id:new e("3020300c06082a864886f70d020505000410","hex")}}).call(this,e("buffer").Buffer)},{buffer:79}],114:[function(e,t,n){(function(n){var r=e("./algos");var i=e("create-hash");var o=e("inherits");var a=e("./sign");var s=e("stream");var u=e("./verify");var l={};Object.keys(r).forEach(function(e){l[e]=l[e.toLowerCase()]=r[e]});function c(e){s.Writable.call(this);var t=l[e];if(!t){throw new Error("Unknown message digest")}this._hashType=t.hash;this._hash=i(t.hash);this._tag=t.id;this._signType=t.sign}o(c,s.Writable);c.prototype._write=function p(e,t,n){this._hash.update(e);n()};c.prototype.update=function h(e,t){if(typeof e==="string"){e=new n(e,t)}this._hash.update(e);return this};c.prototype.sign=function g(e,t){this.end();var r=this._hash.digest();var i=a(n.concat([this._tag,r]),e,this._hashType,this._signType);return t?i.toString(t):i};function f(e){s.Writable.call(this);var t=l[e];if(!t){throw new Error("Unknown message digest")}this._hash=i(t.hash);this._tag=t.id;this._signType=t.sign}o(f,s.Writable);f.prototype._write=function m(e,t,n){this._hash.update(e);n()};f.prototype.update=function v(e,t){if(typeof e==="string"){e=new n(e,t)}this._hash.update(e);return this};f.prototype.verify=function y(e,t,r){if(typeof t==="string"){t=new n(t,r)}this.end();var i=this._hash.digest();return u(t,n.concat([this._tag,i]),e,this._signType)};function d(e){return new c(e)}function _(e){return new f(e)}t.exports={Sign:d,Verify:_,createSign:d,createVerify:_}}).call(this,e("buffer").Buffer)},{"./algos":113,"./sign":179,"./verify":180,buffer:79,"create-hash":207,inherits:277,stream:297}],115:[function(e,t,n){"use strict";n["1.3.132.0.10"]="secp256k1";n["1.3.132.0.33"]="p224";n["1.2.840.10045.3.1.1"]="p192";n["1.2.840.10045.3.1.7"]="p256";n["1.3.132.0.34"]="p384";n["1.3.132.0.35"]="p521"},{}],116:[function(e,t,n){(function(t,n){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype;e.prototype=new n;e.prototype.constructor=e}function o(e,t,n){if(o.isBN(e)){return e}this.negative=0;this.words=null;this.length=0;this.red=null;if(e!==null){if(t==="le"||t==="be"){n=t;t=10}this._init(e||0,t||10,n||"be")}}if(typeof t==="object"){t.exports=o}else{n.BN=o}o.BN=o;o.wordSize=26;var a;try{a=e("buf"+"fer").Buffer}catch(s){}o.isBN=function M(e){if(e instanceof o){return true}return e!==null&&typeof e==="object"&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)};o.max=function T(e,t){if(e.cmp(t)>0)return e;return t};o.min=function C(e,t){if(e.cmp(t)<0)return e;return t};o.prototype._init=function j(e,t,n){if(typeof e==="number"){return this._initNumber(e,t,n)}if(typeof e==="object"){return this._initArray(e,t,n)}if(t==="hex"){t=16}r(t===(t|0)&&t>=2&&t<=36);e=e.toString().replace(/\s+/g,"");var i=0;if(e[0]==="-"){i++}if(t===16){this._parseHex(e,i)}else{this._parseBase(e,t,i)}if(e[0]==="-"){this.negative=1}this.strip();if(n!=="le")return;this._initArray(this.toArray(),t,n)};o.prototype._initNumber=function D(e,t,n){if(e<0){this.negative=1;e=-e}if(e<67108864){this.words=[e&67108863];this.length=1}else if(e<4503599627370496){this.words=[e&67108863,e/67108864&67108863];this.length=2}else{r(e<9007199254740992);this.words=[e&67108863,e/67108864&67108863,1];this.length=3}if(n!=="le")return;this._initArray(this.toArray(),t,n)};o.prototype._initArray=function O(e,t,n){r(typeof e.length==="number");if(e.length<=0){this.words=[0];this.length=1;return this}this.length=Math.ceil(e.length/3);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}var o,a;var s=0;if(n==="be"){for(i=e.length-1,o=0;i>=0;i-=3){a=e[i]|e[i-1]<<8|e[i-2]<<16;this.words[o]|=a<<s&67108863;this.words[o+1]=a>>>26-s&67108863;s+=24;if(s>=26){s-=26;o++}}}else if(n==="le"){for(i=0,o=0;i<e.length;i+=3){a=e[i]|e[i+1]<<8|e[i+2]<<16;this.words[o]|=a<<s&67108863;this.words[o+1]=a>>>26-s&67108863;s+=24;if(s>=26){s-=26;o++}}}return this.strip()};function u(e,t,n){var r=0;var i=Math.min(e.length,n);for(var o=t;o<i;o++){var a=e.charCodeAt(o)-48;r<<=4;if(a>=49&&a<=54){r|=a-49+10}else if(a>=17&&a<=22){r|=a-17+10}else{r|=a&15}}return r}o.prototype._parseHex=function I(e,t){this.length=Math.ceil((e.length-t)/6);this.words=new Array(this.length);for(var n=0;n<this.length;n++){this.words[n]=0}var r,i;var o=0;for(n=e.length-6,r=0;n>=t;n-=6){i=u(e,n,n+6);this.words[r]|=i<<o&67108863;this.words[r+1]|=i>>>26-o&4194303;o+=24;if(o>=26){o-=26;r++}}if(n+6!==t){i=u(e,t,n+6);this.words[r]|=i<<o&67108863;this.words[r+1]|=i>>>26-o&4194303}this.strip()};function l(e,t,n,r){var i=0;var o=Math.min(e.length,n);for(var a=t;a<o;a++){var s=e.charCodeAt(a)-48;i*=r;if(s>=49){i+=s-49+10}else if(s>=17){i+=s-17+10}else{i+=s}}return i}o.prototype._parseBase=function P(e,t,n){this.words=[0];this.length=1;for(var r=0,i=1;i<=67108863;i*=t){
r++}r--;i=i/t|0;var o=e.length-n;var a=o%r;var s=Math.min(o,o-a)+n;var u=0;for(var c=n;c<s;c+=r){u=l(e,c,c+r,t);this.imuln(i);if(this.words[0]+u<67108864){this.words[0]+=u}else{this._iaddn(u)}}if(a!==0){var f=1;u=l(e,c,e.length,t);for(c=0;c<a;c++){f*=t}this.imuln(f);if(this.words[0]+u<67108864){this.words[0]+=u}else{this._iaddn(u)}}};o.prototype.copy=function R(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++){e.words[t]=this.words[t]}e.length=this.length;e.negative=this.negative;e.red=this.red};o.prototype.clone=function z(){var e=new o(null);this.copy(e);return e};o.prototype._expand=function B(e){while(this.length<e){this.words[this.length++]=0}return this};o.prototype.strip=function N(){while(this.length>1&&this.words[this.length-1]===0){this.length--}return this._normSign()};o.prototype._normSign=function L(){if(this.length===1&&this.words[0]===0){this.negative=0}return this};o.prototype.inspect=function q(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var c=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"];var f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5];var d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=function U(e,t){e=e||10;t=t|0||1;var n;if(e===16||e==="hex"){n="";var i=0;var o=0;for(var a=0;a<this.length;a++){var s=this.words[a];var u=((s<<i|o)&16777215).toString(16);o=s>>>24-i&16777215;if(o!==0||a!==this.length-1){n=c[6-u.length]+u+n}else{n=u+n}i+=2;if(i>=26){i-=26;a--}}if(o!==0){n=o.toString(16)+n}while(n.length%t!==0){n="0"+n}if(this.negative!==0){n="-"+n}return n}if(e===(e|0)&&e>=2&&e<=36){var l=f[e];var _=d[e];n="";var p=this.clone();p.negative=0;while(!p.isZero()){var h=p.modn(_).toString(e);p=p.idivn(_);if(!p.isZero()){n=c[l-h.length]+h+n}else{n=h+n}}if(this.isZero()){n="0"+n}while(n.length%t!==0){n="0"+n}if(this.negative!==0){n="-"+n}return n}r(false,"Base should be between 2 and 36")};o.prototype.toNumber=function F(){var e=this.words[0];if(this.length===2){e+=this.words[1]*67108864}else if(this.length===3&&this.words[2]===1){e+=4503599627370496+this.words[1]*67108864}else if(this.length>2){r(false,"Number can only safely store up to 53 bits")}return this.negative!==0?-e:e};o.prototype.toJSON=function W(){return this.toString(16)};o.prototype.toBuffer=function G(e,t){r(typeof a!=="undefined");return this.toArrayLike(a,e,t)};o.prototype.toArray=function V(e,t){return this.toArrayLike(Array,e,t)};o.prototype.toArrayLike=function Y(e,t,n){var i=this.byteLength();var o=n||Math.max(1,i);r(i<=o,"byte array longer than desired length");r(o>0,"Requested array length <= 0");this.strip();var a=t==="le";var s=new e(o);var u,l;var c=this.clone();if(!a){for(l=0;l<o-i;l++){s[l]=0}for(l=0;!c.isZero();l++){u=c.andln(255);c.iushrn(8);s[o-l-1]=u}}else{for(l=0;!c.isZero();l++){u=c.andln(255);c.iushrn(8);s[l]=u}for(;l<o;l++){s[l]=0}}return s};if(Math.clz32){o.prototype._countBits=function H(e){return 32-Math.clz32(e)}}else{o.prototype._countBits=function $(e){var t=e;var n=0;if(t>=4096){n+=13;t>>>=13}if(t>=64){n+=7;t>>>=7}if(t>=8){n+=4;t>>>=4}if(t>=2){n+=2;t>>>=2}return n+t}}o.prototype._zeroBits=function K(e){if(e===0)return 26;var t=e;var n=0;if((t&8191)===0){n+=13;t>>>=13}if((t&127)===0){n+=7;t>>>=7}if((t&15)===0){n+=4;t>>>=4}if((t&3)===0){n+=2;t>>>=2}if((t&1)===0){n++}return n};o.prototype.bitLength=function J(){var e=this.words[this.length-1];var t=this._countBits(e);return(this.length-1)*26+t};function _(e){var t=new Array(e.bitLength());for(var n=0;n<t.length;n++){var r=n/26|0;var i=n%26;t[n]=(e.words[r]&1<<i)>>>i}return t}o.prototype.zeroBits=function X(){if(this.isZero())return 0;var e=0;for(var t=0;t<this.length;t++){var n=this._zeroBits(this.words[t]);e+=n;if(n!==26)break}return e};o.prototype.byteLength=function Z(){return Math.ceil(this.bitLength()/8)};o.prototype.toTwos=function Q(e){if(this.negative!==0){return this.abs().inotn(e).iaddn(1)}return this.clone()};o.prototype.fromTwos=function ee(e){if(this.testn(e-1)){return this.notn(e).iaddn(1).ineg()}return this.clone()};o.prototype.isNeg=function te(){return this.negative!==0};o.prototype.neg=function ne(){return this.clone().ineg()};o.prototype.ineg=function re(){if(!this.isZero()){this.negative^=1}return this};o.prototype.iuor=function ie(e){while(this.length<e.length){this.words[this.length++]=0}for(var t=0;t<e.length;t++){this.words[t]=this.words[t]|e.words[t]}return this.strip()};o.prototype.ior=function oe(e){r((this.negative|e.negative)===0);return this.iuor(e)};o.prototype.or=function ae(e){if(this.length>e.length)return this.clone().ior(e);return e.clone().ior(this)};o.prototype.uor=function se(e){if(this.length>e.length)return this.clone().iuor(e);return e.clone().iuor(this)};o.prototype.iuand=function ue(e){var t;if(this.length>e.length){t=e}else{t=this}for(var n=0;n<t.length;n++){this.words[n]=this.words[n]&e.words[n]}this.length=t.length;return this.strip()};o.prototype.iand=function le(e){r((this.negative|e.negative)===0);return this.iuand(e)};o.prototype.and=function ce(e){if(this.length>e.length)return this.clone().iand(e);return e.clone().iand(this)};o.prototype.uand=function fe(e){if(this.length>e.length)return this.clone().iuand(e);return e.clone().iuand(this)};o.prototype.iuxor=function de(e){var t;var n;if(this.length>e.length){t=this;n=e}else{t=e;n=this}for(var r=0;r<n.length;r++){this.words[r]=t.words[r]^n.words[r]}if(this!==t){for(;r<t.length;r++){this.words[r]=t.words[r]}}this.length=t.length;return this.strip()};o.prototype.ixor=function _e(e){r((this.negative|e.negative)===0);return this.iuxor(e)};o.prototype.xor=function pe(e){if(this.length>e.length)return this.clone().ixor(e);return e.clone().ixor(this)};o.prototype.uxor=function he(e){if(this.length>e.length)return this.clone().iuxor(e);return e.clone().iuxor(this)};o.prototype.inotn=function ge(e){r(typeof e==="number"&&e>=0);var t=Math.ceil(e/26)|0;var n=e%26;this._expand(t);if(n>0){t--}for(var i=0;i<t;i++){this.words[i]=~this.words[i]&67108863}if(n>0){this.words[i]=~this.words[i]&67108863>>26-n}return this.strip()};o.prototype.notn=function me(e){return this.clone().inotn(e)};o.prototype.setn=function ve(e,t){r(typeof e==="number"&&e>=0);var n=e/26|0;var i=e%26;this._expand(n+1);if(t){this.words[n]=this.words[n]|1<<i}else{this.words[n]=this.words[n]&~(1<<i)}return this.strip()};o.prototype.iadd=function ye(e){var t;if(this.negative!==0&&e.negative===0){this.negative=0;t=this.isub(e);this.negative^=1;return this._normSign()}else if(this.negative===0&&e.negative!==0){e.negative=0;t=this.isub(e);e.negative=1;return t._normSign()}var n,r;if(this.length>e.length){n=this;r=e}else{n=e;r=this}var i=0;for(var o=0;o<r.length;o++){t=(n.words[o]|0)+(r.words[o]|0)+i;this.words[o]=t&67108863;i=t>>>26}for(;i!==0&&o<n.length;o++){t=(n.words[o]|0)+i;this.words[o]=t&67108863;i=t>>>26}this.length=n.length;if(i!==0){this.words[this.length]=i;this.length++}else if(n!==this){for(;o<n.length;o++){this.words[o]=n.words[o]}}return this};o.prototype.add=function be(e){var t;if(e.negative!==0&&this.negative===0){e.negative=0;t=this.sub(e);e.negative^=1;return t}else if(e.negative===0&&this.negative!==0){this.negative=0;t=e.sub(this);this.negative=1;return t}if(this.length>e.length)return this.clone().iadd(e);return e.clone().iadd(this)};o.prototype.isub=function we(e){if(e.negative!==0){e.negative=0;var t=this.iadd(e);e.negative=1;return t._normSign()}else if(this.negative!==0){this.negative=0;this.iadd(e);this.negative=1;return this._normSign()}var n=this.cmp(e);if(n===0){this.negative=0;this.length=1;this.words[0]=0;return this}var r,i;if(n>0){r=this;i=e}else{r=e;i=this}var o=0;for(var a=0;a<i.length;a++){t=(r.words[a]|0)-(i.words[a]|0)+o;o=t>>26;this.words[a]=t&67108863}for(;o!==0&&a<r.length;a++){t=(r.words[a]|0)+o;o=t>>26;this.words[a]=t&67108863}if(o===0&&a<r.length&&r!==this){for(;a<r.length;a++){this.words[a]=r.words[a]}}this.length=Math.max(this.length,a);if(r!==this){this.negative=1}return this.strip()};o.prototype.sub=function xe(e){return this.clone().isub(e)};function p(e,t,n){n.negative=t.negative^e.negative;var r=e.length+t.length|0;n.length=r;r=r-1|0;var i=e.words[0]|0;var o=t.words[0]|0;var a=i*o;var s=a&67108863;var u=a/67108864|0;n.words[0]=s;for(var l=1;l<r;l++){var c=u>>>26;var f=u&67108863;var d=Math.min(l,t.length-1);for(var _=Math.max(0,l-e.length+1);_<=d;_++){var p=l-_|0;i=e.words[p]|0;o=t.words[_]|0;a=i*o+f;c+=a/67108864|0;f=a&67108863}n.words[l]=f|0;u=c|0}if(u!==0){n.words[l]=u|0}else{n.length--}return n.strip()}var h=function ke(e,t,n){var r=e.words;var i=t.words;var o=n.words;var a=0;var s;var u;var l;var c=r[0]|0;var f=c&8191;var d=c>>>13;var _=r[1]|0;var p=_&8191;var h=_>>>13;var g=r[2]|0;var m=g&8191;var v=g>>>13;var y=r[3]|0;var b=y&8191;var w=y>>>13;var x=r[4]|0;var k=x&8191;var S=x>>>13;var A=r[5]|0;var E=A&8191;var M=A>>>13;var T=r[6]|0;var C=T&8191;var j=T>>>13;var D=r[7]|0;var O=D&8191;var I=D>>>13;var P=r[8]|0;var R=P&8191;var z=P>>>13;var B=r[9]|0;var N=B&8191;var L=B>>>13;var q=i[0]|0;var U=q&8191;var F=q>>>13;var W=i[1]|0;var G=W&8191;var V=W>>>13;var Y=i[2]|0;var H=Y&8191;var $=Y>>>13;var K=i[3]|0;var J=K&8191;var X=K>>>13;var Z=i[4]|0;var Q=Z&8191;var ee=Z>>>13;var te=i[5]|0;var ne=te&8191;var re=te>>>13;var ie=i[6]|0;var oe=ie&8191;var ae=ie>>>13;var se=i[7]|0;var ue=se&8191;var le=se>>>13;var ce=i[8]|0;var fe=ce&8191;var de=ce>>>13;var _e=i[9]|0;var pe=_e&8191;var he=_e>>>13;n.negative=e.negative^t.negative;n.length=19;s=Math.imul(f,U);u=Math.imul(f,F);u=u+Math.imul(d,U)|0;l=Math.imul(d,F);var ge=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(ge>>>26)|0;ge&=67108863;s=Math.imul(p,U);u=Math.imul(p,F);u=u+Math.imul(h,U)|0;l=Math.imul(h,F);s=s+Math.imul(f,G)|0;u=u+Math.imul(f,V)|0;u=u+Math.imul(d,G)|0;l=l+Math.imul(d,V)|0;var me=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(me>>>26)|0;me&=67108863;s=Math.imul(m,U);u=Math.imul(m,F);u=u+Math.imul(v,U)|0;l=Math.imul(v,F);s=s+Math.imul(p,G)|0;u=u+Math.imul(p,V)|0;u=u+Math.imul(h,G)|0;l=l+Math.imul(h,V)|0;s=s+Math.imul(f,H)|0;u=u+Math.imul(f,$)|0;u=u+Math.imul(d,H)|0;l=l+Math.imul(d,$)|0;var ve=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(ve>>>26)|0;ve&=67108863;s=Math.imul(b,U);u=Math.imul(b,F);u=u+Math.imul(w,U)|0;l=Math.imul(w,F);s=s+Math.imul(m,G)|0;u=u+Math.imul(m,V)|0;u=u+Math.imul(v,G)|0;l=l+Math.imul(v,V)|0;s=s+Math.imul(p,H)|0;u=u+Math.imul(p,$)|0;u=u+Math.imul(h,H)|0;l=l+Math.imul(h,$)|0;s=s+Math.imul(f,J)|0;u=u+Math.imul(f,X)|0;u=u+Math.imul(d,J)|0;l=l+Math.imul(d,X)|0;var ye=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(ye>>>26)|0;ye&=67108863;s=Math.imul(k,U);u=Math.imul(k,F);u=u+Math.imul(S,U)|0;l=Math.imul(S,F);s=s+Math.imul(b,G)|0;u=u+Math.imul(b,V)|0;u=u+Math.imul(w,G)|0;l=l+Math.imul(w,V)|0;s=s+Math.imul(m,H)|0;u=u+Math.imul(m,$)|0;u=u+Math.imul(v,H)|0;l=l+Math.imul(v,$)|0;s=s+Math.imul(p,J)|0;u=u+Math.imul(p,X)|0;u=u+Math.imul(h,J)|0;l=l+Math.imul(h,X)|0;s=s+Math.imul(f,Q)|0;u=u+Math.imul(f,ee)|0;u=u+Math.imul(d,Q)|0;l=l+Math.imul(d,ee)|0;var be=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(be>>>26)|0;be&=67108863;s=Math.imul(E,U);u=Math.imul(E,F);u=u+Math.imul(M,U)|0;l=Math.imul(M,F);s=s+Math.imul(k,G)|0;u=u+Math.imul(k,V)|0;u=u+Math.imul(S,G)|0;l=l+Math.imul(S,V)|0;s=s+Math.imul(b,H)|0;u=u+Math.imul(b,$)|0;u=u+Math.imul(w,H)|0;l=l+Math.imul(w,$)|0;s=s+Math.imul(m,J)|0;u=u+Math.imul(m,X)|0;u=u+Math.imul(v,J)|0;l=l+Math.imul(v,X)|0;s=s+Math.imul(p,Q)|0;u=u+Math.imul(p,ee)|0;u=u+Math.imul(h,Q)|0;l=l+Math.imul(h,ee)|0;s=s+Math.imul(f,ne)|0;u=u+Math.imul(f,re)|0;u=u+Math.imul(d,ne)|0;l=l+Math.imul(d,re)|0;var we=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(we>>>26)|0;we&=67108863;s=Math.imul(C,U);u=Math.imul(C,F);u=u+Math.imul(j,U)|0;l=Math.imul(j,F);s=s+Math.imul(E,G)|0;u=u+Math.imul(E,V)|0;u=u+Math.imul(M,G)|0;l=l+Math.imul(M,V)|0;s=s+Math.imul(k,H)|0;u=u+Math.imul(k,$)|0;u=u+Math.imul(S,H)|0;l=l+Math.imul(S,$)|0;s=s+Math.imul(b,J)|0;u=u+Math.imul(b,X)|0;u=u+Math.imul(w,J)|0;l=l+Math.imul(w,X)|0;s=s+Math.imul(m,Q)|0;u=u+Math.imul(m,ee)|0;u=u+Math.imul(v,Q)|0;l=l+Math.imul(v,ee)|0;s=s+Math.imul(p,ne)|0;u=u+Math.imul(p,re)|0;u=u+Math.imul(h,ne)|0;l=l+Math.imul(h,re)|0;s=s+Math.imul(f,oe)|0;u=u+Math.imul(f,ae)|0;u=u+Math.imul(d,oe)|0;l=l+Math.imul(d,ae)|0;var xe=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(xe>>>26)|0;xe&=67108863;s=Math.imul(O,U);u=Math.imul(O,F);u=u+Math.imul(I,U)|0;l=Math.imul(I,F);s=s+Math.imul(C,G)|0;u=u+Math.imul(C,V)|0;u=u+Math.imul(j,G)|0;l=l+Math.imul(j,V)|0;s=s+Math.imul(E,H)|0;u=u+Math.imul(E,$)|0;u=u+Math.imul(M,H)|0;l=l+Math.imul(M,$)|0;s=s+Math.imul(k,J)|0;u=u+Math.imul(k,X)|0;u=u+Math.imul(S,J)|0;l=l+Math.imul(S,X)|0;s=s+Math.imul(b,Q)|0;u=u+Math.imul(b,ee)|0;u=u+Math.imul(w,Q)|0;l=l+Math.imul(w,ee)|0;s=s+Math.imul(m,ne)|0;u=u+Math.imul(m,re)|0;u=u+Math.imul(v,ne)|0;l=l+Math.imul(v,re)|0;s=s+Math.imul(p,oe)|0;u=u+Math.imul(p,ae)|0;u=u+Math.imul(h,oe)|0;l=l+Math.imul(h,ae)|0;s=s+Math.imul(f,ue)|0;u=u+Math.imul(f,le)|0;u=u+Math.imul(d,ue)|0;l=l+Math.imul(d,le)|0;var ke=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(ke>>>26)|0;ke&=67108863;s=Math.imul(R,U);u=Math.imul(R,F);u=u+Math.imul(z,U)|0;l=Math.imul(z,F);s=s+Math.imul(O,G)|0;u=u+Math.imul(O,V)|0;u=u+Math.imul(I,G)|0;l=l+Math.imul(I,V)|0;s=s+Math.imul(C,H)|0;u=u+Math.imul(C,$)|0;u=u+Math.imul(j,H)|0;l=l+Math.imul(j,$)|0;s=s+Math.imul(E,J)|0;u=u+Math.imul(E,X)|0;u=u+Math.imul(M,J)|0;l=l+Math.imul(M,X)|0;s=s+Math.imul(k,Q)|0;u=u+Math.imul(k,ee)|0;u=u+Math.imul(S,Q)|0;l=l+Math.imul(S,ee)|0;s=s+Math.imul(b,ne)|0;u=u+Math.imul(b,re)|0;u=u+Math.imul(w,ne)|0;l=l+Math.imul(w,re)|0;s=s+Math.imul(m,oe)|0;u=u+Math.imul(m,ae)|0;u=u+Math.imul(v,oe)|0;l=l+Math.imul(v,ae)|0;s=s+Math.imul(p,ue)|0;u=u+Math.imul(p,le)|0;u=u+Math.imul(h,ue)|0;l=l+Math.imul(h,le)|0;s=s+Math.imul(f,fe)|0;u=u+Math.imul(f,de)|0;u=u+Math.imul(d,fe)|0;l=l+Math.imul(d,de)|0;var Se=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(Se>>>26)|0;Se&=67108863;s=Math.imul(N,U);u=Math.imul(N,F);u=u+Math.imul(L,U)|0;l=Math.imul(L,F);s=s+Math.imul(R,G)|0;u=u+Math.imul(R,V)|0;u=u+Math.imul(z,G)|0;l=l+Math.imul(z,V)|0;s=s+Math.imul(O,H)|0;u=u+Math.imul(O,$)|0;u=u+Math.imul(I,H)|0;l=l+Math.imul(I,$)|0;s=s+Math.imul(C,J)|0;u=u+Math.imul(C,X)|0;u=u+Math.imul(j,J)|0;l=l+Math.imul(j,X)|0;s=s+Math.imul(E,Q)|0;u=u+Math.imul(E,ee)|0;u=u+Math.imul(M,Q)|0;l=l+Math.imul(M,ee)|0;s=s+Math.imul(k,ne)|0;u=u+Math.imul(k,re)|0;u=u+Math.imul(S,ne)|0;l=l+Math.imul(S,re)|0;s=s+Math.imul(b,oe)|0;u=u+Math.imul(b,ae)|0;u=u+Math.imul(w,oe)|0;l=l+Math.imul(w,ae)|0;s=s+Math.imul(m,ue)|0;u=u+Math.imul(m,le)|0;u=u+Math.imul(v,ue)|0;l=l+Math.imul(v,le)|0;s=s+Math.imul(p,fe)|0;u=u+Math.imul(p,de)|0;u=u+Math.imul(h,fe)|0;l=l+Math.imul(h,de)|0;s=s+Math.imul(f,pe)|0;u=u+Math.imul(f,he)|0;u=u+Math.imul(d,pe)|0;l=l+Math.imul(d,he)|0;var Ae=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(Ae>>>26)|0;Ae&=67108863;s=Math.imul(N,G);u=Math.imul(N,V);u=u+Math.imul(L,G)|0;l=Math.imul(L,V);s=s+Math.imul(R,H)|0;u=u+Math.imul(R,$)|0;u=u+Math.imul(z,H)|0;l=l+Math.imul(z,$)|0;s=s+Math.imul(O,J)|0;u=u+Math.imul(O,X)|0;u=u+Math.imul(I,J)|0;l=l+Math.imul(I,X)|0;s=s+Math.imul(C,Q)|0;u=u+Math.imul(C,ee)|0;u=u+Math.imul(j,Q)|0;l=l+Math.imul(j,ee)|0;s=s+Math.imul(E,ne)|0;u=u+Math.imul(E,re)|0;u=u+Math.imul(M,ne)|0;l=l+Math.imul(M,re)|0;s=s+Math.imul(k,oe)|0;u=u+Math.imul(k,ae)|0;u=u+Math.imul(S,oe)|0;l=l+Math.imul(S,ae)|0;s=s+Math.imul(b,ue)|0;u=u+Math.imul(b,le)|0;u=u+Math.imul(w,ue)|0;l=l+Math.imul(w,le)|0;s=s+Math.imul(m,fe)|0;u=u+Math.imul(m,de)|0;u=u+Math.imul(v,fe)|0;l=l+Math.imul(v,de)|0;s=s+Math.imul(p,pe)|0;u=u+Math.imul(p,he)|0;u=u+Math.imul(h,pe)|0;l=l+Math.imul(h,he)|0;var Ee=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(Ee>>>26)|0;Ee&=67108863;s=Math.imul(N,H);u=Math.imul(N,$);u=u+Math.imul(L,H)|0;l=Math.imul(L,$);s=s+Math.imul(R,J)|0;u=u+Math.imul(R,X)|0;u=u+Math.imul(z,J)|0;l=l+Math.imul(z,X)|0;s=s+Math.imul(O,Q)|0;u=u+Math.imul(O,ee)|0;u=u+Math.imul(I,Q)|0;l=l+Math.imul(I,ee)|0;s=s+Math.imul(C,ne)|0;u=u+Math.imul(C,re)|0;u=u+Math.imul(j,ne)|0;l=l+Math.imul(j,re)|0;s=s+Math.imul(E,oe)|0;u=u+Math.imul(E,ae)|0;u=u+Math.imul(M,oe)|0;l=l+Math.imul(M,ae)|0;s=s+Math.imul(k,ue)|0;u=u+Math.imul(k,le)|0;u=u+Math.imul(S,ue)|0;l=l+Math.imul(S,le)|0;s=s+Math.imul(b,fe)|0;u=u+Math.imul(b,de)|0;u=u+Math.imul(w,fe)|0;l=l+Math.imul(w,de)|0;s=s+Math.imul(m,pe)|0;u=u+Math.imul(m,he)|0;u=u+Math.imul(v,pe)|0;l=l+Math.imul(v,he)|0;var Me=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(Me>>>26)|0;Me&=67108863;s=Math.imul(N,J);u=Math.imul(N,X);u=u+Math.imul(L,J)|0;l=Math.imul(L,X);s=s+Math.imul(R,Q)|0;u=u+Math.imul(R,ee)|0;u=u+Math.imul(z,Q)|0;l=l+Math.imul(z,ee)|0;s=s+Math.imul(O,ne)|0;u=u+Math.imul(O,re)|0;u=u+Math.imul(I,ne)|0;l=l+Math.imul(I,re)|0;s=s+Math.imul(C,oe)|0;u=u+Math.imul(C,ae)|0;u=u+Math.imul(j,oe)|0;l=l+Math.imul(j,ae)|0;s=s+Math.imul(E,ue)|0;u=u+Math.imul(E,le)|0;u=u+Math.imul(M,ue)|0;l=l+Math.imul(M,le)|0;s=s+Math.imul(k,fe)|0;u=u+Math.imul(k,de)|0;u=u+Math.imul(S,fe)|0;l=l+Math.imul(S,de)|0;s=s+Math.imul(b,pe)|0;u=u+Math.imul(b,he)|0;u=u+Math.imul(w,pe)|0;l=l+Math.imul(w,he)|0;var Te=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(Te>>>26)|0;Te&=67108863;s=Math.imul(N,Q);u=Math.imul(N,ee);u=u+Math.imul(L,Q)|0;l=Math.imul(L,ee);s=s+Math.imul(R,ne)|0;u=u+Math.imul(R,re)|0;u=u+Math.imul(z,ne)|0;l=l+Math.imul(z,re)|0;s=s+Math.imul(O,oe)|0;u=u+Math.imul(O,ae)|0;u=u+Math.imul(I,oe)|0;l=l+Math.imul(I,ae)|0;s=s+Math.imul(C,ue)|0;u=u+Math.imul(C,le)|0;u=u+Math.imul(j,ue)|0;l=l+Math.imul(j,le)|0;s=s+Math.imul(E,fe)|0;u=u+Math.imul(E,de)|0;u=u+Math.imul(M,fe)|0;l=l+Math.imul(M,de)|0;s=s+Math.imul(k,pe)|0;u=u+Math.imul(k,he)|0;u=u+Math.imul(S,pe)|0;l=l+Math.imul(S,he)|0;var Ce=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(Ce>>>26)|0;Ce&=67108863;s=Math.imul(N,ne);u=Math.imul(N,re);u=u+Math.imul(L,ne)|0;l=Math.imul(L,re);s=s+Math.imul(R,oe)|0;u=u+Math.imul(R,ae)|0;u=u+Math.imul(z,oe)|0;l=l+Math.imul(z,ae)|0;s=s+Math.imul(O,ue)|0;u=u+Math.imul(O,le)|0;u=u+Math.imul(I,ue)|0;l=l+Math.imul(I,le)|0;s=s+Math.imul(C,fe)|0;u=u+Math.imul(C,de)|0;u=u+Math.imul(j,fe)|0;l=l+Math.imul(j,de)|0;s=s+Math.imul(E,pe)|0;u=u+Math.imul(E,he)|0;u=u+Math.imul(M,pe)|0;l=l+Math.imul(M,he)|0;var je=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(je>>>26)|0;je&=67108863;s=Math.imul(N,oe);u=Math.imul(N,ae);u=u+Math.imul(L,oe)|0;l=Math.imul(L,ae);s=s+Math.imul(R,ue)|0;u=u+Math.imul(R,le)|0;u=u+Math.imul(z,ue)|0;l=l+Math.imul(z,le)|0;s=s+Math.imul(O,fe)|0;u=u+Math.imul(O,de)|0;u=u+Math.imul(I,fe)|0;l=l+Math.imul(I,de)|0;s=s+Math.imul(C,pe)|0;u=u+Math.imul(C,he)|0;u=u+Math.imul(j,pe)|0;l=l+Math.imul(j,he)|0;var De=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(De>>>26)|0;De&=67108863;s=Math.imul(N,ue);u=Math.imul(N,le);u=u+Math.imul(L,ue)|0;l=Math.imul(L,le);s=s+Math.imul(R,fe)|0;u=u+Math.imul(R,de)|0;u=u+Math.imul(z,fe)|0;l=l+Math.imul(z,de)|0;s=s+Math.imul(O,pe)|0;u=u+Math.imul(O,he)|0;u=u+Math.imul(I,pe)|0;l=l+Math.imul(I,he)|0;var Oe=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(Oe>>>26)|0;Oe&=67108863;s=Math.imul(N,fe);u=Math.imul(N,de);u=u+Math.imul(L,fe)|0;l=Math.imul(L,de);s=s+Math.imul(R,pe)|0;u=u+Math.imul(R,he)|0;u=u+Math.imul(z,pe)|0;l=l+Math.imul(z,he)|0;var Ie=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(Ie>>>26)|0;Ie&=67108863;s=Math.imul(N,pe);u=Math.imul(N,he);u=u+Math.imul(L,pe)|0;l=Math.imul(L,he);var Pe=(a+s|0)+((u&8191)<<13)|0;a=(l+(u>>>13)|0)+(Pe>>>26)|0;Pe&=67108863;o[0]=ge;o[1]=me;o[2]=ve;o[3]=ye;o[4]=be;o[5]=we;o[6]=xe;o[7]=ke;o[8]=Se;o[9]=Ae;o[10]=Ee;o[11]=Me;o[12]=Te;o[13]=Ce;o[14]=je;o[15]=De;o[16]=Oe;o[17]=Ie;o[18]=Pe;if(a!==0){o[19]=a;n.length++}return n};if(!Math.imul){h=p}function g(e,t,n){n.negative=t.negative^e.negative;n.length=e.length+t.length;var r=0;var i=0;for(var o=0;o<n.length-1;o++){var a=i;i=0;var s=r&67108863;var u=Math.min(o,t.length-1);for(var l=Math.max(0,o-e.length+1);l<=u;l++){var c=o-l;var f=e.words[c]|0;var d=t.words[l]|0;var _=f*d;var p=_&67108863;a=a+(_/67108864|0)|0;p=p+s|0;s=p&67108863;a=a+(p>>>26)|0;i+=a>>>26;a&=67108863}n.words[o]=s;r=a;a=i}if(r!==0){n.words[o]=r}else{n.length--}return n.strip()}function m(e,t,n){var r=new v;return r.mulp(e,t,n)}o.prototype.mulTo=function Se(e,t){var n;var r=this.length+e.length;if(this.length===10&&e.length===10){n=h(this,e,t)}else if(r<63){n=p(this,e,t)}else if(r<1024){n=g(this,e,t)}else{n=m(this,e,t)}return n};function v(e,t){this.x=e;this.y=t}v.prototype.makeRBT=function Ae(e){var t=new Array(e);var n=o.prototype._countBits(e)-1;for(var r=0;r<e;r++){t[r]=this.revBin(r,n,e)}return t};v.prototype.revBin=function Ee(e,t,n){if(e===0||e===n-1)return e;var r=0;for(var i=0;i<t;i++){r|=(e&1)<<t-i-1;e>>=1}return r};v.prototype.permute=function Me(e,t,n,r,i,o){for(var a=0;a<o;a++){r[a]=t[e[a]];i[a]=n[e[a]]}};v.prototype.transform=function Te(e,t,n,r,i,o){this.permute(o,e,t,n,r,i);for(var a=1;a<i;a<<=1){var s=a<<1;var u=Math.cos(2*Math.PI/s);var l=Math.sin(2*Math.PI/s);for(var c=0;c<i;c+=s){var f=u;var d=l;for(var _=0;_<a;_++){var p=n[c+_];var h=r[c+_];var g=n[c+_+a];var m=r[c+_+a];var v=f*g-d*m;m=f*m+d*g;g=v;n[c+_]=p+g;r[c+_]=h+m;n[c+_+a]=p-g;r[c+_+a]=h-m;if(_!==s){v=u*f-l*d;d=u*d+l*f;f=v}}}}};v.prototype.guessLen13b=function Ce(e,t){var n=Math.max(t,e)|1;var r=n&1;var i=0;for(n=n/2|0;n;n=n>>>1){i++}return 1<<i+1+r};v.prototype.conjugate=function je(e,t,n){if(n<=1)return;for(var r=0;r<n/2;r++){var i=e[r];e[r]=e[n-r-1];e[n-r-1]=i;i=t[r];t[r]=-t[n-r-1];t[n-r-1]=-i}};v.prototype.normalize13b=function De(e,t){var n=0;for(var r=0;r<t/2;r++){var i=Math.round(e[2*r+1]/t)*8192+Math.round(e[2*r]/t)+n;e[r]=i&67108863;if(i<67108864){n=0}else{n=i/67108864|0}}return e};v.prototype.convert13b=function Oe(e,t,n,i){var o=0;for(var a=0;a<t;a++){o=o+(e[a]|0);n[2*a]=o&8191;o=o>>>13;n[2*a+1]=o&8191;o=o>>>13}for(a=2*t;a<i;++a){n[a]=0}r(o===0);r((o&~8191)===0)};v.prototype.stub=function Ie(e){var t=new Array(e);for(var n=0;n<e;n++){t[n]=0}return t};v.prototype.mulp=function Pe(e,t,n){var r=2*this.guessLen13b(e.length,t.length);var i=this.makeRBT(r);var o=this.stub(r);var a=new Array(r);var s=new Array(r);var u=new Array(r);var l=new Array(r);var c=new Array(r);var f=new Array(r);var d=n.words;d.length=r;this.convert13b(e.words,e.length,a,r);this.convert13b(t.words,t.length,l,r);this.transform(a,o,s,u,r,i);this.transform(l,o,c,f,r,i);for(var _=0;_<r;_++){var p=s[_]*c[_]-u[_]*f[_];u[_]=s[_]*f[_]+u[_]*c[_];s[_]=p}this.conjugate(s,u,r);this.transform(s,u,d,o,r,i);this.conjugate(d,o,r);this.normalize13b(d,r);n.negative=e.negative^t.negative;n.length=e.length+t.length;return n.strip()};o.prototype.mul=function Re(e){var t=new o(null);t.words=new Array(this.length+e.length);return this.mulTo(e,t)};o.prototype.mulf=function ze(e){var t=new o(null);t.words=new Array(this.length+e.length);return m(this,e,t)};o.prototype.imul=function Be(e){return this.clone().mulTo(e,this)};o.prototype.imuln=function Ne(e){r(typeof e==="number");r(e<67108864);var t=0;for(var n=0;n<this.length;n++){var i=(this.words[n]|0)*e;var o=(i&67108863)+(t&67108863);t>>=26;t+=i/67108864|0;t+=o>>>26;this.words[n]=o&67108863}if(t!==0){this.words[n]=t;this.length++}return this};o.prototype.muln=function Le(e){return this.clone().imuln(e)};o.prototype.sqr=function qe(){return this.mul(this)};o.prototype.isqr=function Ue(){return this.imul(this.clone())};o.prototype.pow=function Fe(e){var t=_(e);if(t.length===0)return new o(1);var n=this;for(var r=0;r<t.length;r++,n=n.sqr()){if(t[r]!==0)break}if(++r<t.length){for(var i=n.sqr();r<t.length;r++,i=i.sqr()){if(t[r]===0)continue;n=n.mul(i)}}return n};o.prototype.iushln=function We(e){r(typeof e==="number"&&e>=0);var t=e%26;var n=(e-t)/26;var i=67108863>>>26-t<<26-t;var o;if(t!==0){var a=0;for(o=0;o<this.length;o++){var s=this.words[o]&i;var u=(this.words[o]|0)-s<<t;this.words[o]=u|a;a=s>>>26-t}if(a){this.words[o]=a;this.length++}}if(n!==0){for(o=this.length-1;o>=0;o--){this.words[o+n]=this.words[o]}for(o=0;o<n;o++){this.words[o]=0}this.length+=n}return this.strip()};o.prototype.ishln=function Ge(e){r(this.negative===0);return this.iushln(e)};o.prototype.iushrn=function Ve(e,t,n){r(typeof e==="number"&&e>=0);var i;if(t){i=(t-t%26)/26}else{i=0}var o=e%26;var a=Math.min((e-o)/26,this.length);var s=67108863^67108863>>>o<<o;var u=n;i-=a;i=Math.max(0,i);if(u){for(var l=0;l<a;l++){u.words[l]=this.words[l]}u.length=a}if(a===0){}else if(this.length>a){this.length-=a;for(l=0;l<this.length;l++){this.words[l]=this.words[l+a]}}else{this.words[0]=0;this.length=1}var c=0;for(l=this.length-1;l>=0&&(c!==0||l>=i);l--){var f=this.words[l]|0;this.words[l]=c<<26-o|f>>>o;c=f&s}if(u&&c!==0){u.words[u.length++]=c}if(this.length===0){this.words[0]=0;this.length=1}return this.strip()};o.prototype.ishrn=function Ye(e,t,n){r(this.negative===0);return this.iushrn(e,t,n)};o.prototype.shln=function He(e){return this.clone().ishln(e)};o.prototype.ushln=function $e(e){return this.clone().iushln(e)};o.prototype.shrn=function Ke(e){return this.clone().ishrn(e)};o.prototype.ushrn=function Je(e){return this.clone().iushrn(e)};o.prototype.testn=function Xe(e){r(typeof e==="number"&&e>=0);var t=e%26;var n=(e-t)/26;var i=1<<t;if(this.length<=n)return false;var o=this.words[n];return!!(o&i)};o.prototype.imaskn=function Ze(e){r(typeof e==="number"&&e>=0);var t=e%26;var n=(e-t)/26;r(this.negative===0,"imaskn works only with positive numbers");if(this.length<=n){return this}if(t!==0){n++}this.length=Math.min(n,this.length);if(t!==0){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()};o.prototype.maskn=function Qe(e){return this.clone().imaskn(e)};o.prototype.iaddn=function et(e){r(typeof e==="number");r(e<67108864);if(e<0)return this.isubn(-e);if(this.negative!==0){if(this.length===1&&(this.words[0]|0)<e){this.words[0]=e-(this.words[0]|0);this.negative=0;return this}this.negative=0;this.isubn(e);this.negative=1;return this}return this._iaddn(e)};o.prototype._iaddn=function tt(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++){this.words[t]-=67108864;if(t===this.length-1){this.words[t+1]=1}else{this.words[t+1]++}}this.length=Math.max(this.length,t+1);return this};o.prototype.isubn=function nt(e){r(typeof e==="number");r(e<67108864);if(e<0)return this.iaddn(-e);if(this.negative!==0){this.negative=0;this.iaddn(e);this.negative=1;return this}this.words[0]-=e;if(this.length===1&&this.words[0]<0){this.words[0]=-this.words[0];this.negative=1}else{for(var t=0;t<this.length&&this.words[t]<0;t++){this.words[t]+=67108864;this.words[t+1]-=1}}return this.strip()};o.prototype.addn=function rt(e){return this.clone().iaddn(e)};o.prototype.subn=function it(e){return this.clone().isubn(e)};o.prototype.iabs=function ot(){this.negative=0;return this};o.prototype.abs=function at(){return this.clone().iabs()};o.prototype._ishlnsubmul=function st(e,t,n){var i=e.length+n;var o;this._expand(i);var a;var s=0;for(o=0;o<e.length;o++){a=(this.words[o+n]|0)+s;var u=(e.words[o]|0)*t;a-=u&67108863;s=(a>>26)-(u/67108864|0);this.words[o+n]=a&67108863}for(;o<this.length-n;o++){a=(this.words[o+n]|0)+s;s=a>>26;this.words[o+n]=a&67108863}if(s===0)return this.strip();r(s===-1);s=0;for(o=0;o<this.length;o++){a=-(this.words[o]|0)+s;s=a>>26;this.words[o]=a&67108863}this.negative=1;return this.strip()};o.prototype._wordDiv=function ut(e,t){var n=this.length-e.length;var r=this.clone();var i=e;var a=i.words[i.length-1]|0;var s=this._countBits(a);n=26-s;if(n!==0){i=i.ushln(n);r.iushln(n);a=i.words[i.length-1]|0}var u=r.length-i.length;var l;if(t!=="mod"){l=new o(null);l.length=u+1;l.words=new Array(l.length);for(var c=0;c<l.length;c++){l.words[c]=0}}var f=r.clone()._ishlnsubmul(i,1,u);if(f.negative===0){r=f;if(l){l.words[u]=1}}for(var d=u-1;d>=0;d--){var _=(r.words[i.length+d]|0)*67108864+(r.words[i.length+d-1]|0);_=Math.min(_/a|0,67108863);r._ishlnsubmul(i,_,d);while(r.negative!==0){_--;r.negative=0;r._ishlnsubmul(i,1,d);if(!r.isZero()){r.negative^=1}}if(l){l.words[d]=_}}if(l){l.strip()}r.strip();if(t!=="div"&&n!==0){r.iushrn(n)}return{div:l||null,mod:r}};o.prototype.divmod=function lt(e,t,n){r(!e.isZero());if(this.isZero()){return{div:new o(0),mod:new o(0)}}var i,a,s;if(this.negative!==0&&e.negative===0){s=this.neg().divmod(e,t);if(t!=="mod"){i=s.div.neg()}if(t!=="div"){a=s.mod.neg();if(n&&a.negative!==0){a.iadd(e)}}return{div:i,mod:a}}if(this.negative===0&&e.negative!==0){s=this.divmod(e.neg(),t);if(t!=="mod"){i=s.div.neg()}return{div:i,mod:s.mod}}if((this.negative&e.negative)!==0){s=this.neg().divmod(e.neg(),t);if(t!=="div"){a=s.mod.neg();if(n&&a.negative!==0){a.isub(e)}}return{div:s.div,mod:a}}if(e.length>this.length||this.cmp(e)<0){return{div:new o(0),mod:this}}if(e.length===1){if(t==="div"){return{div:this.divn(e.words[0]),mod:null}}if(t==="mod"){return{div:null,mod:new o(this.modn(e.words[0]))}}return{div:this.divn(e.words[0]),mod:new o(this.modn(e.words[0]))}}return this._wordDiv(e,t)};o.prototype.div=function ct(e){return this.divmod(e,"div",false).div};o.prototype.mod=function ft(e){return this.divmod(e,"mod",false).mod};o.prototype.umod=function dt(e){return this.divmod(e,"mod",true).mod};o.prototype.divRound=function _t(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var n=t.div.negative!==0?t.mod.isub(e):t.mod;var r=e.ushrn(1);var i=e.andln(1);var o=n.cmp(r);if(o<0||i===1&&o===0)return t.div;return t.div.negative!==0?t.div.isubn(1):t.div.iaddn(1)};o.prototype.modn=function pt(e){r(e<=67108863);var t=(1<<26)%e;var n=0;for(var i=this.length-1;i>=0;i--){n=(t*n+(this.words[i]|0))%e}return n};o.prototype.idivn=function ht(e){r(e<=67108863);var t=0;for(var n=this.length-1;n>=0;n--){var i=(this.words[n]|0)+t*67108864;this.words[n]=i/e|0;t=i%e}return this.strip()};o.prototype.divn=function gt(e){return this.clone().idivn(e)};o.prototype.egcd=function mt(e){r(e.negative===0);r(!e.isZero());var t=this;var n=e.clone();if(t.negative!==0){t=t.umod(e)}else{t=t.clone()}var i=new o(1);var a=new o(0);var s=new o(0);var u=new o(1);var l=0;while(t.isEven()&&n.isEven()){t.iushrn(1);n.iushrn(1);++l}var c=n.clone();var f=t.clone();while(!t.isZero()){for(var d=0,_=1;(t.words[0]&_)===0&&d<26;++d,_<<=1);if(d>0){t.iushrn(d);while(d-->0){if(i.isOdd()||a.isOdd()){i.iadd(c);a.isub(f)}i.iushrn(1);a.iushrn(1)}}for(var p=0,h=1;(n.words[0]&h)===0&&p<26;++p,h<<=1);if(p>0){n.iushrn(p);while(p-->0){if(s.isOdd()||u.isOdd()){s.iadd(c);u.isub(f)}s.iushrn(1);u.iushrn(1)}}if(t.cmp(n)>=0){t.isub(n);i.isub(s);a.isub(u)}else{n.isub(t);s.isub(i);u.isub(a)}}return{a:s,b:u,gcd:n.iushln(l)}};o.prototype._invmp=function vt(e){r(e.negative===0);r(!e.isZero());var t=this;var n=e.clone();if(t.negative!==0){t=t.umod(e)}else{t=t.clone()}var i=new o(1);var a=new o(0);var s=n.clone();while(t.cmpn(1)>0&&n.cmpn(1)>0){for(var u=0,l=1;(t.words[0]&l)===0&&u<26;++u,l<<=1);if(u>0){t.iushrn(u);while(u-->0){if(i.isOdd()){i.iadd(s)}i.iushrn(1)}}for(var c=0,f=1;(n.words[0]&f)===0&&c<26;++c,f<<=1);if(c>0){n.iushrn(c);while(c-->0){if(a.isOdd()){a.iadd(s)}a.iushrn(1)}}if(t.cmp(n)>=0){t.isub(n);i.isub(a)}else{n.isub(t);a.isub(i)}}var d;if(t.cmpn(1)===0){d=i}else{d=a}if(d.cmpn(0)<0){d.iadd(e)}return d};o.prototype.gcd=function yt(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone();var n=e.clone();t.negative=0;n.negative=0;for(var r=0;t.isEven()&&n.isEven();r++){t.iushrn(1);n.iushrn(1)}do{while(t.isEven()){t.iushrn(1)}while(n.isEven()){n.iushrn(1)}var i=t.cmp(n);if(i<0){var o=t;t=n;n=o}else if(i===0||n.cmpn(1)===0){break}t.isub(n)}while(true);return n.iushln(r)};o.prototype.invm=function bt(e){return this.egcd(e).a.umod(e)};o.prototype.isEven=function wt(){return(this.words[0]&1)===0;
};o.prototype.isOdd=function xt(){return(this.words[0]&1)===1};o.prototype.andln=function kt(e){return this.words[0]&e};o.prototype.bincn=function St(e){r(typeof e==="number");var t=e%26;var n=(e-t)/26;var i=1<<t;if(this.length<=n){this._expand(n+1);this.words[n]|=i;return this}var o=i;for(var a=n;o!==0&&a<this.length;a++){var s=this.words[a]|0;s+=o;o=s>>>26;s&=67108863;this.words[a]=s}if(o!==0){this.words[a]=o;this.length++}return this};o.prototype.isZero=function At(){return this.length===1&&this.words[0]===0};o.prototype.cmpn=function Et(e){var t=e<0;if(this.negative!==0&&!t)return-1;if(this.negative===0&&t)return 1;this.strip();var n;if(this.length>1){n=1}else{if(t){e=-e}r(e<=67108863,"Number is too big");var i=this.words[0]|0;n=i===e?0:i<e?-1:1}if(this.negative!==0)return-n|0;return n};o.prototype.cmp=function Mt(e){if(this.negative!==0&&e.negative===0)return-1;if(this.negative===0&&e.negative!==0)return 1;var t=this.ucmp(e);if(this.negative!==0)return-t|0;return t};o.prototype.ucmp=function Tt(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;var t=0;for(var n=this.length-1;n>=0;n--){var r=this.words[n]|0;var i=e.words[n]|0;if(r===i)continue;if(r<i){t=-1}else if(r>i){t=1}break}return t};o.prototype.gtn=function Ct(e){return this.cmpn(e)===1};o.prototype.gt=function jt(e){return this.cmp(e)===1};o.prototype.gten=function Dt(e){return this.cmpn(e)>=0};o.prototype.gte=function Ot(e){return this.cmp(e)>=0};o.prototype.ltn=function It(e){return this.cmpn(e)===-1};o.prototype.lt=function Pt(e){return this.cmp(e)===-1};o.prototype.lten=function Rt(e){return this.cmpn(e)<=0};o.prototype.lte=function zt(e){return this.cmp(e)<=0};o.prototype.eqn=function Bt(e){return this.cmpn(e)===0};o.prototype.eq=function Nt(e){return this.cmp(e)===0};o.red=function Lt(e){return new A(e)};o.prototype.toRed=function qt(e){r(!this.red,"Already a number in reduction context");r(this.negative===0,"red works only with positives");return e.convertTo(this)._forceRed(e)};o.prototype.fromRed=function Ut(){r(this.red,"fromRed works only with numbers in reduction context");return this.red.convertFrom(this)};o.prototype._forceRed=function Ft(e){this.red=e;return this};o.prototype.forceRed=function Wt(e){r(!this.red,"Already a number in reduction context");return this._forceRed(e)};o.prototype.redAdd=function Gt(e){r(this.red,"redAdd works only with red numbers");return this.red.add(this,e)};o.prototype.redIAdd=function Vt(e){r(this.red,"redIAdd works only with red numbers");return this.red.iadd(this,e)};o.prototype.redSub=function Yt(e){r(this.red,"redSub works only with red numbers");return this.red.sub(this,e)};o.prototype.redISub=function Ht(e){r(this.red,"redISub works only with red numbers");return this.red.isub(this,e)};o.prototype.redShl=function $t(e){r(this.red,"redShl works only with red numbers");return this.red.shl(this,e)};o.prototype.redMul=function Kt(e){r(this.red,"redMul works only with red numbers");this.red._verify2(this,e);return this.red.mul(this,e)};o.prototype.redIMul=function Jt(e){r(this.red,"redMul works only with red numbers");this.red._verify2(this,e);return this.red.imul(this,e)};o.prototype.redSqr=function Xt(){r(this.red,"redSqr works only with red numbers");this.red._verify1(this);return this.red.sqr(this)};o.prototype.redISqr=function Zt(){r(this.red,"redISqr works only with red numbers");this.red._verify1(this);return this.red.isqr(this)};o.prototype.redSqrt=function Qt(){r(this.red,"redSqrt works only with red numbers");this.red._verify1(this);return this.red.sqrt(this)};o.prototype.redInvm=function en(){r(this.red,"redInvm works only with red numbers");this.red._verify1(this);return this.red.invm(this)};o.prototype.redNeg=function tn(){r(this.red,"redNeg works only with red numbers");this.red._verify1(this);return this.red.neg(this)};o.prototype.redPow=function nn(e){r(this.red&&!e.red,"redPow(normalNum)");this.red._verify1(this);return this.red.pow(this,e)};var y={k256:null,p224:null,p192:null,p25519:null};function b(e,t){this.name=e;this.p=new o(t,16);this.n=this.p.bitLength();this.k=new o(1).iushln(this.n).isub(this.p);this.tmp=this._tmp()}b.prototype._tmp=function rn(){var e=new o(null);e.words=new Array(Math.ceil(this.n/13));return e};b.prototype.ireduce=function on(e){var t=e;var n;do{this.split(t,this.tmp);t=this.imulK(t);t=t.iadd(this.tmp);n=t.bitLength()}while(n>this.n);var r=n<this.n?-1:t.ucmp(this.p);if(r===0){t.words[0]=0;t.length=1}else if(r>0){t.isub(this.p)}else{t.strip()}return t};b.prototype.split=function an(e,t){e.iushrn(this.n,0,t)};b.prototype.imulK=function sn(e){return e.imul(this.k)};function w(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(w,b);w.prototype.split=function un(e,t){var n=4194303;var r=Math.min(e.length,9);for(var i=0;i<r;i++){t.words[i]=e.words[i]}t.length=r;if(e.length<=9){e.words[0]=0;e.length=1;return}var o=e.words[9];t.words[t.length++]=o&n;for(i=10;i<e.length;i++){var a=e.words[i]|0;e.words[i-10]=(a&n)<<4|o>>>22;o=a}o>>>=22;e.words[i-10]=o;if(o===0&&e.length>10){e.length-=10}else{e.length-=9}};w.prototype.imulK=function ln(e){e.words[e.length]=0;e.words[e.length+1]=0;e.length+=2;var t=0;for(var n=0;n<e.length;n++){var r=e.words[n]|0;t+=r*977;e.words[n]=t&67108863;t=r*64+(t/67108864|0)}if(e.words[e.length-1]===0){e.length--;if(e.words[e.length-1]===0){e.length--}}return e};function x(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(x,b);function k(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(k,b);function S(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(S,b);S.prototype.imulK=function cn(e){var t=0;for(var n=0;n<e.length;n++){var r=(e.words[n]|0)*19+t;var i=r&67108863;r>>>=26;e.words[n]=i;t=r}if(t!==0){e.words[e.length++]=t}return e};o._prime=function fn(e){if(y[e])return y[e];var fn;if(e==="k256"){fn=new w}else if(e==="p224"){fn=new x}else if(e==="p192"){fn=new k}else if(e==="p25519"){fn=new S}else{throw new Error("Unknown prime "+e)}y[e]=fn;return fn};function A(e){if(typeof e==="string"){var t=o._prime(e);this.m=t.p;this.prime=t}else{r(e.gtn(1),"modulus must be greater than 1");this.m=e;this.prime=null}}A.prototype._verify1=function dn(e){r(e.negative===0,"red works only with positives");r(e.red,"red works only with red numbers")};A.prototype._verify2=function _n(e,t){r((e.negative|t.negative)===0,"red works only with positives");r(e.red&&e.red===t.red,"red works only with red numbers")};A.prototype.imod=function pn(e){if(this.prime)return this.prime.ireduce(e)._forceRed(this);return e.umod(this.m)._forceRed(this)};A.prototype.neg=function hn(e){if(e.isZero()){return e.clone()}return this.m.sub(e)._forceRed(this)};A.prototype.add=function gn(e,t){this._verify2(e,t);var n=e.add(t);if(n.cmp(this.m)>=0){n.isub(this.m)}return n._forceRed(this)};A.prototype.iadd=function mn(e,t){this._verify2(e,t);var n=e.iadd(t);if(n.cmp(this.m)>=0){n.isub(this.m)}return n};A.prototype.sub=function vn(e,t){this._verify2(e,t);var n=e.sub(t);if(n.cmpn(0)<0){n.iadd(this.m)}return n._forceRed(this)};A.prototype.isub=function yn(e,t){this._verify2(e,t);var n=e.isub(t);if(n.cmpn(0)<0){n.iadd(this.m)}return n};A.prototype.shl=function bn(e,t){this._verify1(e);return this.imod(e.ushln(t))};A.prototype.imul=function wn(e,t){this._verify2(e,t);return this.imod(e.imul(t))};A.prototype.mul=function xn(e,t){this._verify2(e,t);return this.imod(e.mul(t))};A.prototype.isqr=function kn(e){return this.imul(e,e.clone())};A.prototype.sqr=function Sn(e){return this.mul(e,e)};A.prototype.sqrt=function An(e){if(e.isZero())return e.clone();var t=this.m.andln(3);r(t%2===1);if(t===3){var n=this.m.add(new o(1)).iushrn(2);return this.pow(e,n)}var i=this.m.subn(1);var a=0;while(!i.isZero()&&i.andln(1)===0){a++;i.iushrn(1)}r(!i.isZero());var s=new o(1).toRed(this);var u=s.redNeg();var l=this.m.subn(1).iushrn(1);var c=this.m.bitLength();c=new o(2*c*c).toRed(this);while(this.pow(c,l).cmp(u)!==0){c.redIAdd(u)}var f=this.pow(c,i);var d=this.pow(e,i.addn(1).iushrn(1));var _=this.pow(e,i);var p=a;while(_.cmp(s)!==0){var h=_;for(var g=0;h.cmp(s)!==0;g++){h=h.redSqr()}r(g<p);var m=this.pow(f,new o(1).iushln(p-g-1));d=d.redMul(m);f=m.redSqr();_=_.redMul(f);p=g}return d};A.prototype.invm=function En(e){var t=e._invmp(this.m);if(t.negative!==0){t.negative=0;return this.imod(t).redNeg()}else{return this.imod(t)}};A.prototype.pow=function Mn(e,t){if(t.isZero())return new o(1);if(t.cmpn(1)===0)return e.clone();var n=4;var r=new Array(1<<n);r[0]=new o(1).toRed(this);r[1]=e;for(var i=2;i<r.length;i++){r[i]=this.mul(r[i-1],e)}var a=r[0];var s=0;var u=0;var l=t.bitLength()%26;if(l===0){l=26}for(i=t.length-1;i>=0;i--){var c=t.words[i];for(var f=l-1;f>=0;f--){var d=c>>f&1;if(a!==r[0]){a=this.sqr(a)}if(d===0&&s===0){u=0;continue}s<<=1;s|=d;u++;if(u!==n&&(i!==0||f!==0))continue;a=this.mul(a,r[s]);u=0;s=0}l=26}return a};A.prototype.convertTo=function Tn(e){var t=e.umod(this.m);return t===e?t.clone():t};A.prototype.convertFrom=function Cn(e){var t=e.clone();t.red=null;return t};o.mont=function jn(e){return new E(e)};function E(e){A.call(this,e);this.shift=this.m.bitLength();if(this.shift%26!==0){this.shift+=26-this.shift%26}this.r=new o(1).iushln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv=this.minv.umod(this.r);this.minv=this.r.sub(this.minv)}i(E,A);E.prototype.convertTo=function Dn(e){return this.imod(e.ushln(this.shift))};E.prototype.convertFrom=function On(e){var t=this.imod(e.mul(this.rinv));t.red=null;return t};E.prototype.imul=function In(e,t){if(e.isZero()||t.isZero()){e.words[0]=0;e.length=1;return e}var n=e.imul(t);var r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var i=n.isub(r).iushrn(this.shift);var o=i;if(i.cmp(this.m)>=0){o=i.isub(this.m)}else if(i.cmpn(0)<0){o=i.iadd(this.m)}return o._forceRed(this)};E.prototype.mul=function Pn(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var n=e.mul(t);var r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var i=n.isub(r).iushrn(this.shift);var a=i;if(i.cmp(this.m)>=0){a=i.isub(this.m)}else if(i.cmpn(0)<0){a=i.iadd(this.m)}return a._forceRed(this)};E.prototype.invm=function Rn(e){var t=this.imod(e._invmp(this.m).mul(this.r2));return t._forceRed(this)}})(typeof t==="undefined"||t,this)},{}],117:[function(e,t,n){(function(n){var r=e("bn.js");var i=e("randombytes");t.exports=a;function o(e){var t=s(e);var n=t.toRed(r.mont(e.modulus)).redPow(new r(e.publicExponent)).fromRed();return{blinder:n,unblinder:t.invm(e.modulus)}}function a(e,t){var i=o(t);var a=t.modulus.byteLength();var s=r.mont(t.modulus);var u=new r(e).mul(i.blinder).umod(t.modulus);var l=u.toRed(r.mont(t.prime1));var c=u.toRed(r.mont(t.prime2));var f=t.coefficient;var d=t.prime1;var _=t.prime2;var p=l.redPow(t.exponent1);var h=c.redPow(t.exponent2);p=p.fromRed();h=h.fromRed();var g=p.isub(h).imul(f).umod(d);g.imul(_);h.iadd(g);return new n(h.imul(i.unblinder).umod(t.modulus).toArray(false,a))}a.getr=s;function s(e){var t=e.modulus.byteLength();var n=new r(i(t));while(n.cmp(e.modulus)>=0||!n.umod(e.prime1)||!n.umod(e.prime2)){n=new r(i(t))}return n}}).call(this,e("buffer").Buffer)},{"bn.js":116,buffer:79,randombytes:275}],118:[function(e,t,n){"use strict";var r=n;r.version=e("../package.json").version;r.utils=e("./elliptic/utils");r.rand=e("brorand");r.hmacDRBG=e("./elliptic/hmac-drbg");r.curve=e("./elliptic/curve");r.curves=e("./elliptic/curves");r.ec=e("./elliptic/ec");r.eddsa=e("./elliptic/eddsa")},{"../package.json":141,"./elliptic/curve":121,"./elliptic/curves":124,"./elliptic/ec":125,"./elliptic/eddsa":128,"./elliptic/hmac-drbg":131,"./elliptic/utils":133,brorand:134}],119:[function(e,t,n){"use strict";var r=e("bn.js");var i=e("../../elliptic");var o=i.utils;var a=o.getNAF;var s=o.getJSF;var u=o.assert;function l(e,t){this.type=e;this.p=new r(t.p,16);this.red=t.prime?r.red(t.prime):r.mont(this.p);this.zero=new r(0).toRed(this.red);this.one=new r(1).toRed(this.red);this.two=new r(2).toRed(this.red);this.n=t.n&&new r(t.n,16);this.g=t.g&&this.pointFromJSON(t.g,t.gRed);this._wnafT1=new Array(4);this._wnafT2=new Array(4);this._wnafT3=new Array(4);this._wnafT4=new Array(4);var n=this.n&&this.p.div(this.n);if(!n||n.cmpn(100)>0){this.redN=null}else{this._maxwellTrick=true;this.redN=this.n.toRed(this.red)}}t.exports=l;l.prototype.point=function f(){throw new Error("Not implemented")};l.prototype.validate=function d(){throw new Error("Not implemented")};l.prototype._fixedNafMul=function _(e,t){u(e.precomputed);var n=e._getDoubles();var r=a(t,1);var i=(1<<n.step+1)-(n.step%2===0?2:1);i/=3;var o=[];for(var s=0;s<r.length;s+=n.step){var l=0;for(var t=s+n.step-1;t>=s;t--)l=(l<<1)+r[t];o.push(l)}var c=this.jpoint(null,null,null);var f=this.jpoint(null,null,null);for(var d=i;d>0;d--){for(var s=0;s<o.length;s++){var l=o[s];if(l===d)f=f.mixedAdd(n.points[s]);else if(l===-d)f=f.mixedAdd(n.points[s].neg())}c=c.add(f)}return c.toP()};l.prototype._wnafMul=function p(e,t){var n=4;var r=e._getNAFPoints(n);n=r.wnd;var i=r.points;var o=a(t,n);var s=this.jpoint(null,null,null);for(var l=o.length-1;l>=0;l--){for(var t=0;l>=0&&o[l]===0;l--)t++;if(l>=0)t++;s=s.dblp(t);if(l<0)break;var c=o[l];u(c!==0);if(e.type==="affine"){if(c>0)s=s.mixedAdd(i[c-1>>1]);else s=s.mixedAdd(i[-c-1>>1].neg())}else{if(c>0)s=s.add(i[c-1>>1]);else s=s.add(i[-c-1>>1].neg())}}return e.type==="affine"?s.toP():s};l.prototype._wnafMulAdd=function h(e,t,n,r,i){var o=this._wnafT1;var u=this._wnafT2;var l=this._wnafT3;var c=0;for(var f=0;f<r;f++){var d=t[f];var _=d._getNAFPoints(e);o[f]=_.wnd;u[f]=_.points}for(var f=r-1;f>=1;f-=2){var p=f-1;var h=f;if(o[p]!==1||o[h]!==1){l[p]=a(n[p],o[p]);l[h]=a(n[h],o[h]);c=Math.max(l[p].length,c);c=Math.max(l[h].length,c);continue}var g=[t[p],null,null,t[h]];if(t[p].y.cmp(t[h].y)===0){g[1]=t[p].add(t[h]);g[2]=t[p].toJ().mixedAdd(t[h].neg())}else if(t[p].y.cmp(t[h].y.redNeg())===0){g[1]=t[p].toJ().mixedAdd(t[h]);g[2]=t[p].add(t[h].neg())}else{g[1]=t[p].toJ().mixedAdd(t[h]);g[2]=t[p].toJ().mixedAdd(t[h].neg())}var m=[-3,-1,-5,-7,0,7,5,1,3];var v=s(n[p],n[h]);c=Math.max(v[0].length,c);l[p]=new Array(c);l[h]=new Array(c);for(var y=0;y<c;y++){var b=v[0][y]|0;var w=v[1][y]|0;l[p][y]=m[(b+1)*3+(w+1)];l[h][y]=0;u[p]=g}}var x=this.jpoint(null,null,null);var k=this._wnafT4;for(var f=c;f>=0;f--){var S=0;while(f>=0){var A=true;for(var y=0;y<r;y++){k[y]=l[y][f]|0;if(k[y]!==0)A=false}if(!A)break;S++;f--}if(f>=0)S++;x=x.dblp(S);if(f<0)break;for(var y=0;y<r;y++){var E=k[y];var d;if(E===0)continue;else if(E>0)d=u[y][E-1>>1];else if(E<0)d=u[y][-E-1>>1].neg();if(d.type==="affine")x=x.mixedAdd(d);else x=x.add(d)}}for(var f=0;f<r;f++)u[f]=null;if(i)return x;else return x.toP()};function c(e,t){this.curve=e;this.type=t;this.precomputed=null}l.BasePoint=c;c.prototype.eq=function g(){throw new Error("Not implemented")};c.prototype.validate=function m(){return this.curve.validate(this)};l.prototype.decodePoint=function v(e,t){e=o.toArray(e,t);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){if(e[0]===6)u(e[e.length-1]%2===0);else if(e[0]===7)u(e[e.length-1]%2===1);var r=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return r}else if((e[0]===2||e[0]===3)&&e.length-1===n){return this.pointFromX(e.slice(1,1+n),e[0]===3)}throw new Error("Unknown point format")};c.prototype.encodeCompressed=function y(e){return this.encode(e,true)};c.prototype._encode=function b(e){var t=this.curve.p.byteLength();var n=this.getX().toArray("be",t);if(e)return[this.getY().isEven()?2:3].concat(n);return[4].concat(n,this.getY().toArray("be",t))};c.prototype.encode=function w(e,t){return o.encode(this._encode(t),e)};c.prototype.precompute=function x(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};t.naf=this._getNAFPoints(8);t.doubles=this._getDoubles(4,e);t.beta=this._getBeta();this.precomputed=t;return this};c.prototype._hasDoubles=function k(e){if(!this.precomputed)return false;var t=this.precomputed.doubles;if(!t)return false;return t.points.length>=Math.ceil((e.bitLength()+1)/t.step)};c.prototype._getDoubles=function S(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;var n=[this];var r=this;for(var i=0;i<t;i+=e){for(var o=0;o<e;o++)r=r.dbl();n.push(r)}return{step:e,points:n}};c.prototype._getNAFPoints=function A(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;var t=[this];var n=(1<<e)-1;var r=n===1?null:this.dbl();for(var i=1;i<n;i++)t[i]=t[i-1].add(r);return{wnd:e,points:t}};c.prototype._getBeta=function E(){return null};c.prototype.dblp=function M(e){var t=this;for(var n=0;n<e;n++)t=t.dbl();return t}},{"../../elliptic":118,"bn.js":116}],120:[function(e,t,n){"use strict";var r=e("../curve");var i=e("../../elliptic");var o=e("bn.js");var a=e("inherits");var s=r.base;var u=i.utils.assert;function l(e){this.twisted=(e.a|0)!==1;this.mOneA=this.twisted&&(e.a|0)===-1;this.extended=this.mOneA;s.call(this,"edwards",e);this.a=new o(e.a,16).umod(this.red.m);this.a=this.a.toRed(this.red);this.c=new o(e.c,16).toRed(this.red);this.c2=this.c.redSqr();this.d=new o(e.d,16).toRed(this.red);this.dd=this.d.redAdd(this.d);u(!this.twisted||this.c.fromRed().cmpn(1)===0);this.oneC=(e.c|0)===1}a(l,s);t.exports=l;l.prototype._mulA=function f(e){if(this.mOneA)return e.redNeg();else return this.a.redMul(e)};l.prototype._mulC=function d(e){if(this.oneC)return e;else return this.c.redMul(e)};l.prototype.jpoint=function _(e,t,n,r){return this.point(e,t,n,r)};l.prototype.pointFromX=function p(e,t){e=new o(e,16);if(!e.red)e=e.toRed(this.red);var n=e.redSqr();var r=this.c2.redSub(this.a.redMul(n));var i=this.one.redSub(this.c2.redMul(this.d).redMul(n));var a=r.redMul(i.redInvm());var s=a.redSqrt();if(s.redSqr().redSub(a).cmp(this.zero)!==0)throw new Error("invalid point");var u=s.fromRed().isOdd();if(t&&!u||!t&&u)s=s.redNeg();return this.point(e,s)};l.prototype.pointFromY=function h(e,t){e=new o(e,16);if(!e.red)e=e.toRed(this.red);var n=e.redSqr();var r=n.redSub(this.one);var i=n.redMul(this.d).redAdd(this.one);var a=r.redMul(i.redInvm());if(a.cmp(this.zero)===0){if(t)throw new Error("invalid point");else return this.point(this.zero,e)}var s=a.redSqrt();if(s.redSqr().redSub(a).cmp(this.zero)!==0)throw new Error("invalid point");if(s.isOdd()!==t)s=s.redNeg();return this.point(s,e)};l.prototype.validate=function g(e){if(e.isInfinity())return true;e.normalize();var t=e.x.redSqr();var n=e.y.redSqr();var r=t.redMul(this.a).redAdd(n);var i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(n)));return r.cmp(i)===0};function c(e,t,n,r,i){s.BasePoint.call(this,e,"projective");if(t===null&&n===null&&r===null){this.x=this.curve.zero;this.y=this.curve.one;this.z=this.curve.one;this.t=this.curve.zero;this.zOne=true}else{this.x=new o(t,16);this.y=new o(n,16);this.z=r?new o(r,16):this.curve.one;this.t=i&&new o(i,16);if(!this.x.red)this.x=this.x.toRed(this.curve.red);if(!this.y.red)this.y=this.y.toRed(this.curve.red);if(!this.z.red)this.z=this.z.toRed(this.curve.red);if(this.t&&!this.t.red)this.t=this.t.toRed(this.curve.red);this.zOne=this.z===this.curve.one;if(this.curve.extended&&!this.t){this.t=this.x.redMul(this.y);if(!this.zOne)this.t=this.t.redMul(this.z.redInvm())}}}a(c,s.BasePoint);l.prototype.pointFromJSON=function m(e){return c.fromJSON(this,e)};l.prototype.point=function v(e,t,n,r){return new c(this,e,t,n,r)};c.fromJSON=function y(e,t){return new c(e,t[0],t[1],t[2])};c.prototype.inspect=function b(){if(this.isInfinity())return"<EC Point Infinity>";return"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};c.prototype.isInfinity=function w(){return this.x.cmpn(0)===0&&this.y.cmp(this.z)===0};c.prototype._extDbl=function x(){var e=this.x.redSqr();var t=this.y.redSqr();var n=this.z.redSqr();n=n.redIAdd(n);var r=this.curve._mulA(e);var i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t);var o=r.redAdd(t);var a=o.redSub(n);var s=r.redSub(t);var u=i.redMul(a);var l=o.redMul(s);var c=i.redMul(s);var f=a.redMul(o);return this.curve.point(u,l,f,c)};c.prototype._projDbl=function k(){var e=this.x.redAdd(this.y).redSqr();var t=this.x.redSqr();var n=this.y.redSqr();var r;var i;var o;if(this.curve.twisted){var a=this.curve._mulA(t);var s=a.redAdd(n);if(this.zOne){r=e.redSub(t).redSub(n).redMul(s.redSub(this.curve.two));i=s.redMul(a.redSub(n));o=s.redSqr().redSub(s).redSub(s)}else{var u=this.z.redSqr();var l=s.redSub(u).redISub(u);r=e.redSub(t).redISub(n).redMul(l);i=s.redMul(a.redSub(n));o=s.redMul(l)}}else{var a=t.redAdd(n);var u=this.curve._mulC(this.c.redMul(this.z)).redSqr();var l=a.redSub(u).redSub(u);r=this.curve._mulC(e.redISub(a)).redMul(l);i=this.curve._mulC(a).redMul(t.redISub(n));o=a.redMul(l)}return this.curve.point(r,i,o)};c.prototype.dbl=function S(){if(this.isInfinity())return this;if(this.curve.extended)return this._extDbl();else return this._projDbl()};c.prototype._extAdd=function A(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x));var n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x));var r=this.t.redMul(this.curve.dd).redMul(e.t);var i=this.z.redMul(e.z.redAdd(e.z));var o=n.redSub(t);var a=i.redSub(r);var s=i.redAdd(r);var u=n.redAdd(t);var l=o.redMul(a);var c=s.redMul(u);var f=o.redMul(u);var d=a.redMul(s);return this.curve.point(l,c,d,f)};c.prototype._projAdd=function E(e){var t=this.z.redMul(e.z);var n=t.redSqr();var r=this.x.redMul(e.x);var i=this.y.redMul(e.y);var o=this.curve.d.redMul(r).redMul(i);var a=n.redSub(o);var s=n.redAdd(o);var u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(r).redISub(i);var l=t.redMul(a).redMul(u);var c;var f;if(this.curve.twisted){c=t.redMul(s).redMul(i.redSub(this.curve._mulA(r)));f=a.redMul(s)}else{c=t.redMul(s).redMul(i.redSub(r));f=this.curve._mulC(a).redMul(s)}return this.curve.point(l,c,f)};c.prototype.add=function M(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.curve.extended)return this._extAdd(e);else return this._projAdd(e)};c.prototype.mul=function T(e){if(this._hasDoubles(e))return this.curve._fixedNafMul(this,e);else return this.curve._wnafMul(this,e)};c.prototype.mulAdd=function C(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,false)};c.prototype.jmulAdd=function j(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,true)};c.prototype.normalize=function D(){if(this.zOne)return this;var e=this.z.redInvm();this.x=this.x.redMul(e);this.y=this.y.redMul(e);if(this.t)this.t=this.t.redMul(e);this.z=this.curve.one;this.zOne=true;return this};c.prototype.neg=function O(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};c.prototype.getX=function I(){this.normalize();return this.x.fromRed()};c.prototype.getY=function P(){this.normalize();return this.y.fromRed()};c.prototype.eq=function R(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};c.prototype.eqXToP=function z(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return true;var n=e.clone();var r=this.curve.redN.redMul(this.z);for(;;){n.iadd(this.curve.n);if(n.cmp(this.curve.p)>=0)return false;t.redIAdd(r);if(this.x.cmp(t)===0)return true}return false};c.prototype.toP=c.prototype.normalize;c.prototype.mixedAdd=c.prototype.add},{"../../elliptic":118,"../curve":121,"bn.js":116,inherits:277}],121:[function(e,t,n){"use strict";var r=n;r.base=e("./base");r.short=e("./short");r.mont=e("./mont");r.edwards=e("./edwards")},{"./base":119,"./edwards":120,"./mont":122,"./short":123}],122:[function(e,t,n){"use strict";var r=e("../curve");var i=e("bn.js");var o=e("inherits");var a=r.base;var s=e("../../elliptic");var u=s.utils;function l(e){a.call(this,"mont",e);this.a=new i(e.a,16).toRed(this.red);this.b=new i(e.b,16).toRed(this.red);this.i4=new i(4).toRed(this.red).redInvm();this.two=new i(2).toRed(this.red);this.a24=this.i4.redMul(this.a.redAdd(this.two))}o(l,a);t.exports=l;l.prototype.validate=function f(e){var t=e.normalize().x;var n=t.redSqr();var r=n.redMul(t).redAdd(n.redMul(this.a)).redAdd(t);var i=r.redSqrt();return i.redSqr().cmp(r)===0};function c(e,t,n){a.BasePoint.call(this,e,"projective");if(t===null&&n===null){this.x=this.curve.one;this.z=this.curve.zero}else{this.x=new i(t,16);this.z=new i(n,16);if(!this.x.red)this.x=this.x.toRed(this.curve.red);if(!this.z.red)this.z=this.z.toRed(this.curve.red)}}o(c,a.BasePoint);l.prototype.decodePoint=function d(e,t){return this.point(u.toArray(e,t),1)};l.prototype.point=function _(e,t){return new c(this,e,t)};l.prototype.pointFromJSON=function p(e){return c.fromJSON(this,e)};c.prototype.precompute=function h(){};c.prototype._encode=function g(){return this.getX().toArray("be",this.curve.p.byteLength())};c.fromJSON=function m(e,t){return new c(e,t[0],t[1]||e.one)};c.prototype.inspect=function v(){if(this.isInfinity())return"<EC Point Infinity>";return"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};c.prototype.isInfinity=function y(){return this.z.cmpn(0)===0};c.prototype.dbl=function b(){var e=this.x.redAdd(this.z);var t=e.redSqr();var n=this.x.redSub(this.z);var r=n.redSqr();var i=t.redSub(r);var o=t.redMul(r);var a=i.redMul(r.redAdd(this.curve.a24.redMul(i)));return this.curve.point(o,a)};c.prototype.add=function w(){throw new Error("Not supported on Montgomery curve")};c.prototype.diffAdd=function x(e,t){var n=this.x.redAdd(this.z);var r=this.x.redSub(this.z);var i=e.x.redAdd(e.z);var o=e.x.redSub(e.z);var a=o.redMul(n);var s=i.redMul(r);var u=t.z.redMul(a.redAdd(s).redSqr());var l=t.x.redMul(a.redISub(s).redSqr());return this.curve.point(u,l)};c.prototype.mul=function k(e){var t=e.clone();var n=this;var r=this.curve.point(null,null);var i=this;for(var o=[];t.cmpn(0)!==0;t.iushrn(1))o.push(t.andln(1));for(var a=o.length-1;a>=0;a--){if(o[a]===0){n=n.diffAdd(r,i);r=r.dbl()}else{r=n.diffAdd(r,i);n=n.dbl()}}return r};c.prototype.mulAdd=function S(){throw new Error("Not supported on Montgomery curve")};c.prototype.jumlAdd=function A(){throw new Error("Not supported on Montgomery curve")};c.prototype.eq=function E(e){return this.getX().cmp(e.getX())===0};c.prototype.normalize=function M(){this.x=this.x.redMul(this.z.redInvm());this.z=this.curve.one;return this};c.prototype.getX=function T(){this.normalize();return this.x.fromRed()}},{"../../elliptic":118,"../curve":121,"bn.js":116,inherits:277}],123:[function(e,t,n){"use strict";var r=e("../curve");var i=e("../../elliptic");var o=e("bn.js");var a=e("inherits");var s=r.base;var u=i.utils.assert;function l(e){s.call(this,"short",e);this.a=new o(e.a,16).toRed(this.red);this.b=new o(e.b,16).toRed(this.red);this.tinv=this.two.redInvm();this.zeroA=this.a.fromRed().cmpn(0)===0;this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0;this.endo=this._getEndomorphism(e);this._endoWnafT1=new Array(4);this._endoWnafT2=new Array(4)}a(l,s);t.exports=l;l.prototype._getEndomorphism=function d(e){if(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)return;var t;var n;if(e.beta){t=new o(e.beta,16).toRed(this.red)}else{var r=this._getEndoRoots(this.p);t=r[0].cmp(r[1])<0?r[0]:r[1];t=t.toRed(this.red)}if(e.lambda){n=new o(e.lambda,16)}else{var i=this._getEndoRoots(this.n);if(this.g.mul(i[0]).x.cmp(this.g.x.redMul(t))===0){n=i[0]}else{n=i[1];u(this.g.mul(n).x.cmp(this.g.x.redMul(t))===0)}}var a;if(e.basis){a=e.basis.map(function(e){return{a:new o(e.a,16),b:new o(e.b,16)}})}else{a=this._getEndoBasis(n)}return{beta:t,lambda:n,basis:a}};l.prototype._getEndoRoots=function _(e){var t=e===this.p?this.red:o.mont(e);var n=new o(2).toRed(t).redInvm();var r=n.redNeg();var i=new o(3).toRed(t).redNeg().redSqrt().redMul(n);var a=r.redAdd(i).fromRed();var s=r.redSub(i).fromRed();return[a,s]};l.prototype._getEndoBasis=function p(e){var t=this.n.ushrn(Math.floor(this.n.bitLength()/2));var n=e;var r=this.n.clone();var i=new o(1);var a=new o(0);var s=new o(0);var u=new o(1);var l;var c;var f;var d;var _;var p;var h;var g=0;var m;var v;while(n.cmpn(0)!==0){var y=r.div(n);m=r.sub(y.mul(n));v=s.sub(y.mul(i));var b=u.sub(y.mul(a));if(!f&&m.cmp(t)<0){l=h.neg();c=i;f=m.neg();d=v}else if(f&&++g===2){break}h=m;r=n;n=m;s=i;i=v;u=a;a=b}_=m.neg();p=v;var w=f.sqr().add(d.sqr());var x=_.sqr().add(p.sqr());if(x.cmp(w)>=0){_=l;p=c}if(f.negative){f=f.neg();d=d.neg()}if(_.negative){_=_.neg();p=p.neg()}return[{a:f,b:d},{a:_,b:p}]};l.prototype._endoSplit=function h(e){var t=this.endo.basis;var n=t[0];var r=t[1];var i=r.b.mul(e).divRound(this.n);var o=n.b.neg().mul(e).divRound(this.n);var a=i.mul(n.a);var s=o.mul(r.a);var u=i.mul(n.b);var l=o.mul(r.b);var c=e.sub(a).sub(s);var f=u.add(l).neg();return{k1:c,k2:f}};l.prototype.pointFromX=function g(e,t){e=new o(e,16);if(!e.red)e=e.toRed(this.red);var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b);var r=n.redSqrt();if(r.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var i=r.fromRed().isOdd();if(t&&!i||!t&&i)r=r.redNeg();return this.point(e,r)};l.prototype.validate=function m(e){if(e.inf)return true;var t=e.x;var n=e.y;var r=this.a.redMul(t);var i=t.redSqr().redMul(t).redIAdd(r).redIAdd(this.b);return n.redSqr().redISub(i).cmpn(0)===0};l.prototype._endoWnafMulAdd=function v(e,t,n){var r=this._endoWnafT1;var i=this._endoWnafT2;for(var o=0;o<e.length;o++){var a=this._endoSplit(t[o]);var s=e[o];var u=s._getBeta();if(a.k1.negative){a.k1.ineg();s=s.neg(true)}if(a.k2.negative){a.k2.ineg();u=u.neg(true)}r[o*2]=s;r[o*2+1]=u;i[o*2]=a.k1;i[o*2+1]=a.k2}var l=this._wnafMulAdd(1,r,i,o*2,n);for(var c=0;c<o*2;c++){r[c]=null;i[c]=null}return l};function c(e,t,n,r){s.BasePoint.call(this,e,"affine");if(t===null&&n===null){this.x=null;this.y=null;this.inf=true}else{this.x=new o(t,16);this.y=new o(n,16);if(r){this.x.forceRed(this.curve.red);this.y.forceRed(this.curve.red)}if(!this.x.red)this.x=this.x.toRed(this.curve.red);if(!this.y.red)this.y=this.y.toRed(this.curve.red);this.inf=false}}a(c,s.BasePoint);l.prototype.point=function y(e,t,n){return new c(this,e,t,n)};l.prototype.pointFromJSON=function b(e,t){return c.fromJSON(this,e,t)};c.prototype._getBeta=function w(){if(!this.curve.endo)return;var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve;var r=function(e){return n.point(e.x.redMul(n.endo.beta),e.y)};e.beta=t;t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(r)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(r)}}}return t};c.prototype.toJSON=function x(){if(!this.precomputed)return[this.x,this.y];return[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]};c.fromJSON=function k(e,t,n){if(typeof t==="string")t=JSON.parse(t);var r=e.point(t[0],t[1],n);if(!t[2])return r;function i(t){return e.point(t[0],t[1],n)}var o=t[2];r.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[r].concat(o.doubles.points.map(i))},naf:o.naf&&{wnd:o.naf.wnd,points:[r].concat(o.naf.points.map(i))}};return r};c.prototype.inspect=function S(){if(this.isInfinity())return"<EC Point Infinity>";return"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};c.prototype.isInfinity=function A(){return this.inf};c.prototype.add=function E(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);if(t.cmpn(0)!==0)t=t.redMul(this.x.redSub(e.x).redInvm());var n=t.redSqr().redISub(this.x).redISub(e.x);var r=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,r)};c.prototype.dbl=function M(){
if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a;var n=this.x.redSqr();var r=e.redInvm();var i=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(r);var o=i.redSqr().redISub(this.x.redAdd(this.x));var a=i.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};c.prototype.getX=function T(){return this.x.fromRed()};c.prototype.getY=function C(){return this.y.fromRed()};c.prototype.mul=function j(e){e=new o(e,16);if(this._hasDoubles(e))return this.curve._fixedNafMul(this,e);else if(this.curve.endo)return this.curve._endoWnafMulAdd([this],[e]);else return this.curve._wnafMul(this,e)};c.prototype.mulAdd=function D(e,t,n){var r=[this,t];var i=[e,n];if(this.curve.endo)return this.curve._endoWnafMulAdd(r,i);else return this.curve._wnafMulAdd(1,r,i,2)};c.prototype.jmulAdd=function O(e,t,n){var r=[this,t];var i=[e,n];if(this.curve.endo)return this.curve._endoWnafMulAdd(r,i,true);else return this.curve._wnafMulAdd(1,r,i,2,true)};c.prototype.eq=function I(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};c.prototype.neg=function P(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed;var r=function(e){return e.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(r)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(r)}}}return t};c.prototype.toJ=function R(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function f(e,t,n,r){s.BasePoint.call(this,e,"jacobian");if(t===null&&n===null&&r===null){this.x=this.curve.one;this.y=this.curve.one;this.z=new o(0)}else{this.x=new o(t,16);this.y=new o(n,16);this.z=new o(r,16)}if(!this.x.red)this.x=this.x.toRed(this.curve.red);if(!this.y.red)this.y=this.y.toRed(this.curve.red);if(!this.z.red)this.z=this.z.toRed(this.curve.red);this.zOne=this.z===this.curve.one}a(f,s.BasePoint);l.prototype.jpoint=function z(e,t,n){return new f(this,e,t,n)};f.prototype.toP=function B(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm();var t=e.redSqr();var n=this.x.redMul(t);var r=this.y.redMul(t).redMul(e);return this.curve.point(n,r)};f.prototype.neg=function N(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};f.prototype.add=function L(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr();var n=this.z.redSqr();var r=this.x.redMul(t);var i=e.x.redMul(n);var o=this.y.redMul(t.redMul(e.z));var a=e.y.redMul(n.redMul(this.z));var s=r.redSub(i);var u=o.redSub(a);if(s.cmpn(0)===0){if(u.cmpn(0)!==0)return this.curve.jpoint(null,null,null);else return this.dbl()}var l=s.redSqr();var c=l.redMul(s);var f=r.redMul(l);var d=u.redSqr().redIAdd(c).redISub(f).redISub(f);var _=u.redMul(f.redISub(d)).redISub(o.redMul(c));var p=this.z.redMul(e.z).redMul(s);return this.curve.jpoint(d,_,p)};f.prototype.mixedAdd=function q(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr();var n=this.x;var r=e.x.redMul(t);var i=this.y;var o=e.y.redMul(t).redMul(this.z);var a=n.redSub(r);var s=i.redSub(o);if(a.cmpn(0)===0){if(s.cmpn(0)!==0)return this.curve.jpoint(null,null,null);else return this.dbl()}var u=a.redSqr();var l=u.redMul(a);var c=n.redMul(u);var f=s.redSqr().redIAdd(l).redISub(c).redISub(c);var d=s.redMul(c.redISub(f)).redISub(i.redMul(l));var _=this.z.redMul(a);return this.curve.jpoint(f,d,_)};f.prototype.dblp=function U(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){var t=this;for(var n=0;n<e;n++)t=t.dbl();return t}var r=this.curve.a;var i=this.curve.tinv;var o=this.x;var a=this.y;var s=this.z;var u=s.redSqr().redSqr();var l=a.redAdd(a);for(var n=0;n<e;n++){var c=o.redSqr();var f=l.redSqr();var d=f.redSqr();var _=c.redAdd(c).redIAdd(c).redIAdd(r.redMul(u));var p=o.redMul(f);var h=_.redSqr().redISub(p.redAdd(p));var g=p.redISub(h);var m=_.redMul(g);m=m.redIAdd(m).redISub(d);var v=l.redMul(s);if(n+1<e)u=u.redMul(d);o=h;s=v;l=m}return this.curve.jpoint(o,l.redMul(i),s)};f.prototype.dbl=function F(){if(this.isInfinity())return this;if(this.curve.zeroA)return this._zeroDbl();else if(this.curve.threeA)return this._threeDbl();else return this._dbl()};f.prototype._zeroDbl=function W(){var e;var t;var n;if(this.zOne){var r=this.x.redSqr();var i=this.y.redSqr();var o=i.redSqr();var a=this.x.redAdd(i).redSqr().redISub(r).redISub(o);a=a.redIAdd(a);var s=r.redAdd(r).redIAdd(r);var u=s.redSqr().redISub(a).redISub(a);var l=o.redIAdd(o);l=l.redIAdd(l);l=l.redIAdd(l);e=u;t=s.redMul(a.redISub(u)).redISub(l);n=this.y.redAdd(this.y)}else{var c=this.x.redSqr();var f=this.y.redSqr();var d=f.redSqr();var _=this.x.redAdd(f).redSqr().redISub(c).redISub(d);_=_.redIAdd(_);var p=c.redAdd(c).redIAdd(c);var h=p.redSqr();var g=d.redIAdd(d);g=g.redIAdd(g);g=g.redIAdd(g);e=h.redISub(_).redISub(_);t=p.redMul(_.redISub(e)).redISub(g);n=this.y.redMul(this.z);n=n.redIAdd(n)}return this.curve.jpoint(e,t,n)};f.prototype._threeDbl=function G(){var e;var t;var n;if(this.zOne){var r=this.x.redSqr();var i=this.y.redSqr();var o=i.redSqr();var a=this.x.redAdd(i).redSqr().redISub(r).redISub(o);a=a.redIAdd(a);var s=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a);var u=s.redSqr().redISub(a).redISub(a);e=u;var l=o.redIAdd(o);l=l.redIAdd(l);l=l.redIAdd(l);t=s.redMul(a.redISub(u)).redISub(l);n=this.y.redAdd(this.y)}else{var c=this.z.redSqr();var f=this.y.redSqr();var d=this.x.redMul(f);var _=this.x.redSub(c).redMul(this.x.redAdd(c));_=_.redAdd(_).redIAdd(_);var p=d.redIAdd(d);p=p.redIAdd(p);var h=p.redAdd(p);e=_.redSqr().redISub(h);n=this.y.redAdd(this.z).redSqr().redISub(f).redISub(c);var g=f.redSqr();g=g.redIAdd(g);g=g.redIAdd(g);g=g.redIAdd(g);t=_.redMul(p.redISub(e)).redISub(g)}return this.curve.jpoint(e,t,n)};f.prototype._dbl=function V(){var e=this.curve.a;var t=this.x;var n=this.y;var r=this.z;var i=r.redSqr().redSqr();var o=t.redSqr();var a=n.redSqr();var s=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(i));var u=t.redAdd(t);u=u.redIAdd(u);var l=u.redMul(a);var c=s.redSqr().redISub(l.redAdd(l));var f=l.redISub(c);var d=a.redSqr();d=d.redIAdd(d);d=d.redIAdd(d);d=d.redIAdd(d);var _=s.redMul(f).redISub(d);var p=n.redAdd(n).redMul(r);return this.curve.jpoint(c,_,p)};f.prototype.trpl=function Y(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr();var t=this.y.redSqr();var n=this.z.redSqr();var r=t.redSqr();var i=e.redAdd(e).redIAdd(e);var o=i.redSqr();var a=this.x.redAdd(t).redSqr().redISub(e).redISub(r);a=a.redIAdd(a);a=a.redAdd(a).redIAdd(a);a=a.redISub(o);var s=a.redSqr();var u=r.redIAdd(r);u=u.redIAdd(u);u=u.redIAdd(u);u=u.redIAdd(u);var l=i.redIAdd(a).redSqr().redISub(o).redISub(s).redISub(u);var c=t.redMul(l);c=c.redIAdd(c);c=c.redIAdd(c);var f=this.x.redMul(s).redISub(c);f=f.redIAdd(f);f=f.redIAdd(f);var d=this.y.redMul(l.redMul(u.redISub(l)).redISub(a.redMul(s)));d=d.redIAdd(d);d=d.redIAdd(d);d=d.redIAdd(d);var _=this.z.redAdd(a).redSqr().redISub(n).redISub(s);return this.curve.jpoint(f,d,_)};f.prototype.mul=function H(e,t){e=new o(e,t);return this.curve._wnafMul(this,e)};f.prototype.eq=function $(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return true;var t=this.z.redSqr();var n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0)!==0)return false;var r=t.redMul(this.z);var i=n.redMul(e.z);return this.y.redMul(i).redISub(e.y.redMul(r)).cmpn(0)===0};f.prototype.eqXToP=function K(e){var t=this.z.redSqr();var n=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(n)===0)return true;var r=e.clone();var i=this.curve.redN.redMul(t);for(;;){r.iadd(this.curve.n);if(r.cmp(this.curve.p)>=0)return false;n.redIAdd(i);if(this.x.cmp(n)===0)return true}return false};f.prototype.inspect=function J(){if(this.isInfinity())return"<EC JPoint Infinity>";return"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};f.prototype.isInfinity=function X(){return this.z.cmpn(0)===0}},{"../../elliptic":118,"../curve":121,"bn.js":116,inherits:277}],124:[function(e,t,n){"use strict";var r=n;var i=e("hash.js");var o=e("../elliptic");var a=o.utils.assert;function s(e){if(e.type==="short")this.curve=new o.curve.short(e);else if(e.type==="edwards")this.curve=new o.curve.edwards(e);else this.curve=new o.curve.mont(e);this.g=this.curve.g;this.n=this.curve.n;this.hash=e.hash;a(this.g.validate(),"Invalid curve");a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}r.PresetCurve=s;function u(e,t){Object.defineProperty(r,e,{configurable:true,enumerable:true,get:function(){var n=new s(t);Object.defineProperty(r,e,{configurable:true,enumerable:true,value:n});return n}})}u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:i.sha256,gRed:false,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:i.sha256,gRed:false,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:i.sha256,gRed:false,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff "+"fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff "+"fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f "+"5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 "+"f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:i.sha384,gRed:false,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 "+"5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 "+"0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff "+"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff "+"ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff "+"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff "+"ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b "+"99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd "+"3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff "+"ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 "+"f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:i.sha512,gRed:false,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 "+"053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 "+"a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 "+"579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 "+"3fad0761 353c7086 a272c240 88be9476 9fd16650"]});u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"0",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:i.sha256,gRed:false,g:["9"]});u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:i.sha256,gRed:false,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var l;try{l=e("./precomputed/secp256k1")}catch(c){l=undefined}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:i.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:false,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",l]})},{"../elliptic":118,"./precomputed/secp256k1":132,"hash.js":135}],125:[function(e,t,n){"use strict";var r=e("bn.js");var i=e("../../elliptic");var o=i.utils;var a=o.assert;var s=e("./key");var u=e("./signature");function l(e){if(!(this instanceof l))return new l(e);if(typeof e==="string"){a(i.curves.hasOwnProperty(e),"Unknown curve "+e);e=i.curves[e]}if(e instanceof i.curves.PresetCurve)e={curve:e};this.curve=e.curve.curve;this.n=this.curve.n;this.nh=this.n.ushrn(1);this.g=this.curve.g;this.g=e.curve.g;this.g.precompute(e.curve.n.bitLength()+1);this.hash=e.hash||e.curve.hash}t.exports=l;l.prototype.keyPair=function c(e){return new s(this,e)};l.prototype.keyFromPrivate=function f(e,t){return s.fromPrivate(this,e,t)};l.prototype.keyFromPublic=function d(e,t){return s.fromPublic(this,e,t)};l.prototype.genKeyPair=function _(e){if(!e)e={};var t=new i.hmacDRBG({hash:this.hash,pers:e.pers,entropy:e.entropy||i.rand(this.hash.hmacStrength),nonce:this.n.toArray()});var n=this.n.byteLength();var o=this.n.sub(new r(2));do{var a=new r(t.generate(n));if(a.cmp(o)>0)continue;a.iaddn(1);return this.keyFromPrivate(a)}while(true)};l.prototype._truncateToN=function p(e,t){var n=e.byteLength()*8-this.n.bitLength();if(n>0)e=e.ushrn(n);if(!t&&e.cmp(this.n)>=0)return e.sub(this.n);else return e};l.prototype.sign=function h(e,t,n,o){if(typeof n==="object"){o=n;n=null}if(!o)o={};t=this.keyFromPrivate(t,n);e=this._truncateToN(new r(e,16));var a=this.n.byteLength();var s=t.getPrivate().toArray("be",a);var l=e.toArray("be",a);var c=new i.hmacDRBG({hash:this.hash,entropy:s,nonce:l,pers:o.pers,persEnc:o.persEnc});var f=this.n.sub(new r(1));for(var d=0;true;d++){var _=o.k?o.k(d):new r(c.generate(this.n.byteLength()));_=this._truncateToN(_,true);if(_.cmpn(1)<=0||_.cmp(f)>=0)continue;var p=this.g.mul(_);if(p.isInfinity())continue;var h=p.getX();var g=h.umod(this.n);if(g.cmpn(0)===0)continue;var m=_.invm(this.n).mul(g.mul(t.getPrivate()).iadd(e));m=m.umod(this.n);if(m.cmpn(0)===0)continue;var v=(p.getY().isOdd()?1:0)|(h.cmp(g)!==0?2:0);if(o.canonical&&m.cmp(this.nh)>0){m=this.n.sub(m);v^=1}return new u({r:g,s:m,recoveryParam:v})}};l.prototype.verify=function g(e,t,n,i){e=this._truncateToN(new r(e,16));n=this.keyFromPublic(n,i);t=new u(t,"hex");var o=t.r;var a=t.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return false;if(a.cmpn(1)<0||a.cmp(this.n)>=0)return false;var s=a.invm(this.n);var l=s.mul(e).umod(this.n);var c=s.mul(o).umod(this.n);if(!this.curve._maxwellTrick){var f=this.g.mulAdd(l,n.getPublic(),c);if(f.isInfinity())return false;return f.getX().umod(this.n).cmp(o)===0}var f=this.g.jmulAdd(l,n.getPublic(),c);if(f.isInfinity())return false;return f.eqXToP(o)};l.prototype.recoverPubKey=function(e,t,n,i){a((3&n)===n,"The recovery param is more than two bits");t=new u(t,i);var o=this.n;var s=new r(e);var l=t.r;var c=t.s;var f=n&1;var d=n>>1;if(l.cmp(this.curve.p.umod(this.curve.n))>=0&&d)throw new Error("Unable to find sencond key candinate");if(d)l=this.curve.pointFromX(l.add(this.curve.n),f);else l=this.curve.pointFromX(l,f);var _=t.r.invm(o);var p=o.sub(s).mul(_).umod(o);var h=c.mul(_).umod(o);return this.g.mulAdd(p,l,h)};l.prototype.getKeyRecoveryParam=function(e,t,n,r){t=new u(t,r);if(t.recoveryParam!==null)return t.recoveryParam;for(var i=0;i<4;i++){var o;try{o=this.recoverPubKey(e,t,i)}catch(e){continue}if(o.eq(n))return i}throw new Error("Unable to find valid recovery factor")}},{"../../elliptic":118,"./key":126,"./signature":127,"bn.js":116}],126:[function(e,t,n){"use strict";var r=e("bn.js");function i(e,t){this.ec=e;this.priv=null;this.pub=null;if(t.priv)this._importPrivate(t.priv,t.privEnc);if(t.pub)this._importPublic(t.pub,t.pubEnc)}t.exports=i;i.fromPublic=function o(e,t,n){if(t instanceof i)return t;return new i(e,{pub:t,pubEnc:n})};i.fromPrivate=function a(e,t,n){if(t instanceof i)return t;return new i(e,{priv:t,privEnc:n})};i.prototype.validate=function s(){var e=this.getPublic();if(e.isInfinity())return{result:false,reason:"Invalid public key"};if(!e.validate())return{result:false,reason:"Public key is not a point"};if(!e.mul(this.ec.curve.n).isInfinity())return{result:false,reason:"Public key * N != O"};return{result:true,reason:null}};i.prototype.getPublic=function u(e,t){if(typeof e==="string"){t=e;e=null}if(!this.pub)this.pub=this.ec.g.mul(this.priv);if(!t)return this.pub;return this.pub.encode(t,e)};i.prototype.getPrivate=function l(e){if(e==="hex")return this.priv.toString(16,2);else return this.priv};i.prototype._importPrivate=function c(e,t){this.priv=new r(e,t||16);this.priv=this.priv.umod(this.ec.curve.n)};i.prototype._importPublic=function f(e,t){if(e.x||e.y){this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};i.prototype.derive=function d(e){return e.mul(this.priv).getX()};i.prototype.sign=function _(e,t,n){return this.ec.sign(e,this,t,n)};i.prototype.verify=function p(e,t){return this.ec.verify(e,t,this)};i.prototype.inspect=function h(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"bn.js":116}],127:[function(e,t,n){"use strict";var r=e("bn.js");var i=e("../../elliptic");var o=i.utils;var a=o.assert;function s(e,t){if(e instanceof s)return e;if(this._importDER(e,t))return;a(e.r&&e.s,"Signature without r or s");this.r=new r(e.r,16);this.s=new r(e.s,16);if(e.recoveryParam===undefined)this.recoveryParam=null;else this.recoveryParam=e.recoveryParam}t.exports=s;function u(){this.place=0}function l(e,t){var n=e[t.place++];if(!(n&128)){return n}var r=n&15;var i=0;for(var o=0,a=t.place;o<r;o++,a++){i<<=8;i|=e[a]}t.place=a;return i}function c(e){var t=0;var n=e.length-1;while(!e[t]&&!(e[t+1]&128)&&t<n){t++}if(t===0){return e}return e.slice(t)}s.prototype._importDER=function d(e,t){e=o.toArray(e,t);var n=new u;if(e[n.place++]!==48){return false}var i=l(e,n);if(i+n.place!==e.length){return false}if(e[n.place++]!==2){return false}var a=l(e,n);var s=e.slice(n.place,a+n.place);n.place+=a;if(e[n.place++]!==2){return false}var c=l(e,n);if(e.length!==c+n.place){return false}var f=e.slice(n.place,c+n.place);if(s[0]===0&&s[1]&128){s=s.slice(1)}if(f[0]===0&&f[1]&128){f=f.slice(1)}this.r=new r(s);this.s=new r(f);this.recoveryParam=null;return true};function f(e,t){if(t<128){e.push(t);return}var n=1+(Math.log(t)/Math.LN2>>>3);e.push(n|128);while(--n){e.push(t>>>(n<<3)&255)}e.push(t)}s.prototype.toDER=function _(e){var t=this.r.toArray();var n=this.s.toArray();if(t[0]&128)t=[0].concat(t);if(n[0]&128)n=[0].concat(n);t=c(t);n=c(n);while(!n[0]&&!(n[1]&128)){n=n.slice(1)}var r=[2];f(r,t.length);r=r.concat(t);r.push(2);f(r,n.length);var i=r.concat(n);var a=[48];f(a,i.length);a=a.concat(i);return o.encode(a,e)}},{"../../elliptic":118,"bn.js":116}],128:[function(e,t,n){"use strict";var r=e("hash.js");var i=e("../../elliptic");var o=i.utils;var a=o.assert;var s=o.parseBytes;var u=e("./key");var l=e("./signature");function c(e){a(e==="ed25519","only tested with ed25519 so far");if(!(this instanceof c))return new c(e);var e=i.curves[e].curve;this.curve=e;this.g=e.g;this.g.precompute(e.n.bitLength()+1);this.pointClass=e.point().constructor;this.encodingLength=Math.ceil(e.n.bitLength()/8);this.hash=r.sha512}t.exports=c;c.prototype.sign=function f(e,t){e=s(e);var n=this.keyFromSecret(t);var r=this.hashInt(n.messagePrefix(),e);var i=this.g.mul(r);var o=this.encodePoint(i);var a=this.hashInt(o,n.pubBytes(),e).mul(n.priv());var u=r.add(a).umod(this.curve.n);return this.makeSignature({R:i,S:u,Rencoded:o})};c.prototype.verify=function d(e,t,n){e=s(e);t=this.makeSignature(t);var r=this.keyFromPublic(n);var i=this.hashInt(t.Rencoded(),r.pubBytes(),e);var o=this.g.mul(t.S());var a=t.R().add(r.pub().mul(i));return a.eq(o)};c.prototype.hashInt=function _(){var e=this.hash();for(var t=0;t<arguments.length;t++)e.update(arguments[t]);return o.intFromLE(e.digest()).umod(this.curve.n)};c.prototype.keyFromPublic=function p(e){return u.fromPublic(this,e)};c.prototype.keyFromSecret=function h(e){return u.fromSecret(this,e)};c.prototype.makeSignature=function g(e){if(e instanceof l)return e;return new l(this,e)};c.prototype.encodePoint=function m(e){var t=e.getY().toArray("le",this.encodingLength);t[this.encodingLength-1]|=e.getX().isOdd()?128:0;return t};c.prototype.decodePoint=function v(e){e=o.parseBytes(e);var t=e.length-1;var n=e.slice(0,t).concat(e[t]&~128);var r=(e[t]&128)!==0;var i=o.intFromLE(n);return this.curve.pointFromY(i,r)};c.prototype.encodeInt=function y(e){return e.toArray("le",this.encodingLength)};c.prototype.decodeInt=function b(e){return o.intFromLE(e)};c.prototype.isPoint=function w(e){return e instanceof this.pointClass}},{"../../elliptic":118,"./key":129,"./signature":130,"hash.js":135}],129:[function(e,t,n){"use strict";var r=e("../../elliptic");var i=r.utils;var o=i.assert;var a=i.parseBytes;var s=i.cachedProperty;function u(e,t){this.eddsa=e;this._secret=a(t.secret);if(e.isPoint(t.pub))this._pub=t.pub;else this._pubBytes=a(t.pub)}u.fromPublic=function l(e,t){if(t instanceof u)return t;return new u(e,{pub:t})};u.fromSecret=function c(e,t){if(t instanceof u)return t;return new u(e,{secret:t})};u.prototype.secret=function f(){return this._secret};s(u,"pubBytes",function d(){return this.eddsa.encodePoint(this.pub())});s(u,"pub",function _(){if(this._pubBytes)return this.eddsa.decodePoint(this._pubBytes);return this.eddsa.g.mul(this.priv())});s(u,"privBytes",function p(){var e=this.eddsa;var t=this.hash();var n=e.encodingLength-1;var r=t.slice(0,e.encodingLength);r[0]&=248;r[n]&=127;r[n]|=64;return r});s(u,"priv",function h(){return this.eddsa.decodeInt(this.privBytes())});s(u,"hash",function g(){return this.eddsa.hash().update(this.secret()).digest()});s(u,"messagePrefix",function m(){return this.hash().slice(this.eddsa.encodingLength)});u.prototype.sign=function v(e){o(this._secret,"KeyPair can only verify");return this.eddsa.sign(e,this)};u.prototype.verify=function y(e,t){return this.eddsa.verify(e,t,this)};u.prototype.getSecret=function b(e){o(this._secret,"KeyPair is public only");return i.encode(this.secret(),e)};u.prototype.getPublic=function w(e){return i.encode(this.pubBytes(),e)};t.exports=u},{"../../elliptic":118}],130:[function(e,t,n){"use strict";var r=e("bn.js");var i=e("../../elliptic");var o=i.utils;var a=o.assert;var s=o.cachedProperty;var u=o.parseBytes;function l(e,t){this.eddsa=e;if(typeof t!=="object")t=u(t);if(Array.isArray(t)){t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}}a(t.R&&t.S,"Signature without R or S");if(e.isPoint(t.R))this._R=t.R;if(t.S instanceof r)this._S=t.S;this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded;this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}s(l,"S",function c(){return this.eddsa.decodeInt(this.Sencoded())});s(l,"R",function f(){return this.eddsa.decodePoint(this.Rencoded())});s(l,"Rencoded",function d(){return this.eddsa.encodePoint(this.R())});s(l,"Sencoded",function _(){return this.eddsa.encodeInt(this.S())});l.prototype.toBytes=function p(){return this.Rencoded().concat(this.Sencoded())};l.prototype.toHex=function h(){return o.encode(this.toBytes(),"hex").toUpperCase()};t.exports=l},{"../../elliptic":118,"bn.js":116}],131:[function(e,t,n){"use strict";var r=e("hash.js");var i=e("../elliptic");var o=i.utils;var a=o.assert;function s(e){if(!(this instanceof s))return new s(e);this.hash=e.hash;this.predResist=!!e.predResist;this.outLen=this.hash.outSize;this.minEntropy=e.minEntropy||this.hash.hmacStrength;this.reseed=null;this.reseedInterval=null;this.K=null;this.V=null;var t=o.toArray(e.entropy,e.entropyEnc);var n=o.toArray(e.nonce,e.nonceEnc);var r=o.toArray(e.pers,e.persEnc);a(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits");this._init(t,n,r)}t.exports=s;s.prototype._init=function u(e,t,n){var r=e.concat(t).concat(n);this.K=new Array(this.outLen/8);this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++){this.K[i]=0;this.V[i]=1}this._update(r);this.reseed=1;this.reseedInterval=281474976710656};s.prototype._hmac=function l(){return new r.hmac(this.hash,this.K)};s.prototype._update=function c(e){var t=this._hmac().update(this.V).update([0]);if(e)t=t.update(e);this.K=t.digest();this.V=this._hmac().update(this.V).digest();if(!e)return;this.K=this._hmac().update(this.V).update([1]).update(e).digest();this.V=this._hmac().update(this.V).digest()};s.prototype.reseed=function f(e,t,n,r){if(typeof t!=="string"){r=n;n=t;t=null}e=o.toBuffer(e,t);n=o.toBuffer(n,r);a(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits");this._update(e.concat(n||[]));this.reseed=1};s.prototype.generate=function d(e,t,n,r){if(this.reseed>this.reseedInterval)throw new Error("Reseed is required");if(typeof t!=="string"){r=n;n=t;t=null}if(n){n=o.toArray(n,r);this._update(n)}var i=[];while(i.length<e){this.V=this._hmac().update(this.V).digest();i=i.concat(this.V)}var a=i.slice(0,e);this._update(n);this.reseed++;return o.encode(a,t)}},{"../elliptic":118,"hash.js":135}],132:[function(e,t,n){t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]
},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],133:[function(e,t,n){"use strict";var r=n;var i=e("bn.js");r.assert=function _(e,t){if(!e)throw new Error(t||"Assertion failed")};function o(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if(typeof e!=="string"){for(var r=0;r<e.length;r++)n[r]=e[r]|0;return n}if(!t){for(var r=0;r<e.length;r++){var i=e.charCodeAt(r);var o=i>>8;var a=i&255;if(o)n.push(o,a);else n.push(a)}}else if(t==="hex"){e=e.replace(/[^a-z0-9]+/gi,"");if(e.length%2!==0)e="0"+e;for(var r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16))}return n}r.toArray=o;function a(e){if(e.length===1)return"0"+e;else return e}r.zero2=a;function s(e){var t="";for(var n=0;n<e.length;n++)t+=a(e[n].toString(16));return t}r.toHex=s;r.encode=function p(e,t){if(t==="hex")return s(e);else return e};function u(e,t){var n=[];var r=1<<t+1;var i=e.clone();while(i.cmpn(1)>=0){var o;if(i.isOdd()){var a=i.andln(r-1);if(a>(r>>1)-1)o=(r>>1)-a;else o=a;i.isubn(o)}else{o=0}n.push(o);var s=i.cmpn(0)!==0&&i.andln(r-1)===0?t+1:1;for(var u=1;u<s;u++)n.push(0);i.iushrn(s)}return n}r.getNAF=u;function l(e,t){var n=[[],[]];e=e.clone();t=t.clone();var r=0;var i=0;while(e.cmpn(-r)>0||t.cmpn(-i)>0){var o=e.andln(3)+r&3;var a=t.andln(3)+i&3;if(o===3)o=-1;if(a===3)a=-1;var s;if((o&1)===0){s=0}else{var u=e.andln(7)+r&7;if((u===3||u===5)&&a===2)s=-o;else s=o}n[0].push(s);var l;if((a&1)===0){l=0}else{var u=t.andln(7)+i&7;if((u===3||u===5)&&o===2)l=-a;else l=a}n[1].push(l);if(2*r===s+1)r=1-r;if(2*i===l+1)i=1-i;e.iushrn(1);t.iushrn(1)}return n}r.getJSF=l;function c(e,t,n){var r="_"+t;e.prototype[t]=function i(){return this[r]!==undefined?this[r]:this[r]=n.call(this)}}r.cachedProperty=c;function f(e){return typeof e==="string"?r.toArray(e,"hex"):e}r.parseBytes=f;function d(e){return new i(e,"hex","le")}r.intFromLE=d},{"bn.js":116}],134:[function(e,t,n){var r;t.exports=function s(e){if(!r)r=new i(null);return r.generate(e)};function i(e){this.rand=e}t.exports.Rand=i;i.prototype.generate=function u(e){return this._rand(e)};if(typeof window==="object"){if(window.crypto&&window.crypto.getRandomValues){i.prototype._rand=function l(e){var t=new Uint8Array(e);window.crypto.getRandomValues(t);return t}}else if(window.msCrypto&&window.msCrypto.getRandomValues){i.prototype._rand=function c(e){var t=new Uint8Array(e);window.msCrypto.getRandomValues(t);return t}}else{i.prototype._rand=function(){throw new Error("Not implemented yet")}}}else{try{var o=e("crypto");i.prototype._rand=function f(e){return o.randomBytes(e)}}catch(a){i.prototype._rand=function d(e){var t=new Uint8Array(e);for(var n=0;n<t.length;n++)t[n]=this.rand.getByte();return t}}}},{crypto:78}],135:[function(e,t,n){var r=n;r.utils=e("./hash/utils");r.common=e("./hash/common");r.sha=e("./hash/sha");r.ripemd=e("./hash/ripemd");r.hmac=e("./hash/hmac");r.sha1=r.sha.sha1;r.sha256=r.sha.sha256;r.sha224=r.sha.sha224;r.sha384=r.sha.sha384;r.sha512=r.sha.sha512;r.ripemd160=r.ripemd.ripemd160},{"./hash/common":136,"./hash/hmac":137,"./hash/ripemd":138,"./hash/sha":139,"./hash/utils":140}],136:[function(e,t,n){var r=e("../hash");var i=r.utils;var o=i.assert;function a(){this.pending=null;this.pendingTotal=0;this.blockSize=this.constructor.blockSize;this.outSize=this.constructor.outSize;this.hmacStrength=this.constructor.hmacStrength;this.padLength=this.constructor.padLength/8;this.endian="big";this._delta8=this.blockSize/8;this._delta32=this.blockSize/32}n.BlockHash=a;a.prototype.update=function s(e,t){e=i.toArray(e,t);if(!this.pending)this.pending=e;else this.pending=this.pending.concat(e);this.pendingTotal+=e.length;if(this.pending.length>=this._delta8){e=this.pending;var n=e.length%this._delta8;this.pending=e.slice(e.length-n,e.length);if(this.pending.length===0)this.pending=null;e=i.join32(e,0,e.length-n,this.endian);for(var r=0;r<e.length;r+=this._delta32)this._update(e,r,r+this._delta32)}return this};a.prototype.digest=function u(e){this.update(this._pad());o(this.pending===null);return this._digest(e)};a.prototype._pad=function l(){var e=this.pendingTotal;var t=this._delta8;var n=t-(e+this.padLength)%t;var r=new Array(n+this.padLength);r[0]=128;for(var i=1;i<n;i++)r[i]=0;e<<=3;if(this.endian==="big"){for(var o=8;o<this.padLength;o++)r[i++]=0;r[i++]=0;r[i++]=0;r[i++]=0;r[i++]=0;r[i++]=e>>>24&255;r[i++]=e>>>16&255;r[i++]=e>>>8&255;r[i++]=e&255}else{r[i++]=e&255;r[i++]=e>>>8&255;r[i++]=e>>>16&255;r[i++]=e>>>24&255;r[i++]=0;r[i++]=0;r[i++]=0;r[i++]=0;for(var o=8;o<this.padLength;o++)r[i++]=0}return r}},{"../hash":135}],137:[function(e,t,n){var r=n;var i=e("../hash");var o=i.utils;var a=o.assert;function s(e,t,n){if(!(this instanceof s))return new s(e,t,n);this.Hash=e;this.blockSize=e.blockSize/8;this.outSize=e.outSize/8;this.inner=null;this.outer=null;this._init(o.toArray(t,n))}t.exports=s;s.prototype._init=function u(e){if(e.length>this.blockSize)e=(new this.Hash).update(e).digest();a(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(var t=0;t<e.length;t++)e[t]^=54;this.inner=(new this.Hash).update(e);for(var t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)};s.prototype.update=function l(e,t){this.inner.update(e,t);return this};s.prototype.digest=function c(e){this.outer.update(this.inner.digest());return this.outer.digest(e)}},{"../hash":135}],138:[function(e,t,n){var r=e("../hash");var i=r.utils;var o=i.rotl32;var a=i.sum32;var s=i.sum32_3;var u=i.sum32_4;var l=r.common.BlockHash;function c(){if(!(this instanceof c))return new c;l.call(this);this.h=[1732584193,4023233417,2562383102,271733878,3285377520];this.endian="little"}i.inherits(c,l);n.ripemd160=c;c.blockSize=512;c.outSize=160;c.hmacStrength=192;c.padLength=64;c.prototype._update=function v(e,t){var n=this.h[0];var r=this.h[1];var i=this.h[2];var l=this.h[3];var c=this.h[4];var v=n;var y=r;var b=i;var w=l;var x=c;for(var k=0;k<80;k++){var S=a(o(u(n,f(k,r,i,l),e[p[k]+t],d(k)),g[k]),c);n=c;c=l;l=o(i,10);i=r;r=S;S=a(o(u(v,f(79-k,y,b,w),e[h[k]+t],_(k)),m[k]),x);v=x;x=w;w=o(b,10);b=y;y=S}S=s(this.h[1],i,w);this.h[1]=s(this.h[2],l,x);this.h[2]=s(this.h[3],c,v);this.h[3]=s(this.h[4],n,y);this.h[4]=s(this.h[0],r,b);this.h[0]=S};c.prototype._digest=function y(e){if(e==="hex")return i.toHex32(this.h,"little");else return i.split32(this.h,"little")};function f(e,t,n,r){if(e<=15)return t^n^r;else if(e<=31)return t&n|~t&r;else if(e<=47)return(t|~n)^r;else if(e<=63)return t&r|n&~r;else return t^(n|~r)}function d(e){if(e<=15)return 0;else if(e<=31)return 1518500249;else if(e<=47)return 1859775393;else if(e<=63)return 2400959708;else return 2840853838}function _(e){if(e<=15)return 1352829926;else if(e<=31)return 1548603684;else if(e<=47)return 1836072691;else if(e<=63)return 2053994217;else return 0}var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var h=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"../hash":135}],139:[function(e,t,n){var r=e("../hash");var i=r.utils;var o=i.assert;var a=i.rotr32;var s=i.rotl32;var u=i.sum32;var l=i.sum32_4;var c=i.sum32_5;var f=i.rotr64_hi;var d=i.rotr64_lo;var _=i.shr64_hi;var p=i.shr64_lo;var h=i.sum64;var g=i.sum64_hi;var m=i.sum64_lo;var v=i.sum64_4_hi;var y=i.sum64_4_lo;var b=i.sum64_5_hi;var w=i.sum64_5_lo;var x=r.common.BlockHash;var k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];var S=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];var A=[1518500249,1859775393,2400959708,3395469782];function E(){if(!(this instanceof E))return new E;x.call(this);this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];this.k=k;this.W=new Array(64)}i.inherits(E,x);n.sha256=E;E.blockSize=512;E.outSize=256;E.hmacStrength=192;E.padLength=64;E.prototype._update=function X(e,t){var n=this.W;for(var r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=l(B(n[r-2]),n[r-7],z(n[r-15]),n[r-16]);var i=this.h[0];var a=this.h[1];var s=this.h[2];var f=this.h[3];var d=this.h[4];var _=this.h[5];var p=this.h[6];var h=this.h[7];o(this.k.length===n.length);for(var r=0;r<n.length;r++){var g=c(h,R(d),D(d,_,p),this.k[r],n[r]);var m=u(P(i),O(i,a,s));h=p;p=_;_=d;d=u(f,g);f=s;s=a;a=i;i=u(g,m)}this.h[0]=u(this.h[0],i);this.h[1]=u(this.h[1],a);this.h[2]=u(this.h[2],s);this.h[3]=u(this.h[3],f);this.h[4]=u(this.h[4],d);this.h[5]=u(this.h[5],_);this.h[6]=u(this.h[6],p);this.h[7]=u(this.h[7],h)};E.prototype._digest=function Z(e){if(e==="hex")return i.toHex32(this.h,"big");else return i.split32(this.h,"big")};function M(){if(!(this instanceof M))return new M;E.call(this);this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}i.inherits(M,E);n.sha224=M;M.blockSize=512;M.outSize=224;M.hmacStrength=192;M.padLength=64;M.prototype._digest=function Q(e){if(e==="hex")return i.toHex32(this.h.slice(0,7),"big");else return i.split32(this.h.slice(0,7),"big")};function T(){if(!(this instanceof T))return new T;x.call(this);this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209];this.k=S;this.W=new Array(160)}i.inherits(T,x);n.sha512=T;T.blockSize=1024;T.outSize=512;T.hmacStrength=192;T.padLength=128;T.prototype._prepareBlock=function ee(e,t){var n=this.W;for(var r=0;r<32;r++)n[r]=e[t+r];for(;r<n.length;r+=2){var i=K(n[r-4],n[r-3]);var o=J(n[r-4],n[r-3]);var a=n[r-14];var s=n[r-13];var u=H(n[r-30],n[r-29]);var l=$(n[r-30],n[r-29]);var c=n[r-32];var f=n[r-31];n[r]=v(i,o,a,s,u,l,c,f);n[r+1]=y(i,o,a,s,u,l,c,f)}};T.prototype._update=function te(e,t){this._prepareBlock(e,t);var n=this.W;var r=this.h[0];var i=this.h[1];var a=this.h[2];var s=this.h[3];var u=this.h[4];var l=this.h[5];var c=this.h[6];var f=this.h[7];var d=this.h[8];var _=this.h[9];var p=this.h[10];var v=this.h[11];var y=this.h[12];var x=this.h[13];var k=this.h[14];var S=this.h[15];o(this.k.length===n.length);for(var A=0;A<n.length;A+=2){var E=k;var M=S;var T=V(d,_);var C=Y(d,_);var j=L(d,_,p,v,y,x);var D=q(d,_,p,v,y,x);var O=this.k[A];var I=this.k[A+1];var P=n[A];var R=n[A+1];var z=b(E,M,T,C,j,D,O,I,P,R);var B=w(E,M,T,C,j,D,O,I,P,R);var E=W(r,i);var M=G(r,i);var T=U(r,i,a,s,u,l);var C=F(r,i,a,s,u,l);var N=g(E,M,T,C);var H=m(E,M,T,C);k=y;S=x;y=p;x=v;p=d;v=_;d=g(c,f,z,B);_=m(f,f,z,B);c=u;f=l;u=a;l=s;a=r;s=i;r=g(z,B,N,H);i=m(z,B,N,H)}h(this.h,0,r,i);h(this.h,2,a,s);h(this.h,4,u,l);h(this.h,6,c,f);h(this.h,8,d,_);h(this.h,10,p,v);h(this.h,12,y,x);h(this.h,14,k,S)};T.prototype._digest=function ne(e){if(e==="hex")return i.toHex32(this.h,"big");else return i.split32(this.h,"big")};function C(){if(!(this instanceof C))return new C;T.call(this);this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}i.inherits(C,T);n.sha384=C;C.blockSize=1024;C.outSize=384;C.hmacStrength=192;C.padLength=128;C.prototype._digest=function re(e){if(e==="hex")return i.toHex32(this.h.slice(0,12),"big");else return i.split32(this.h.slice(0,12),"big")};function j(){if(!(this instanceof j))return new j;x.call(this);this.h=[1732584193,4023233417,2562383102,271733878,3285377520];this.W=new Array(80)}i.inherits(j,x);n.sha1=j;j.blockSize=512;j.outSize=160;j.hmacStrength=80;j.padLength=64;j.prototype._update=function ie(e,t){var n=this.W;for(var r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=s(n[r-3]^n[r-8]^n[r-14]^n[r-16],1);var i=this.h[0];var o=this.h[1];var a=this.h[2];var l=this.h[3];var f=this.h[4];for(var r=0;r<n.length;r++){var d=~~(r/20);var _=c(s(i,5),N(d,o,a,l),f,n[r],A[d]);f=l;l=a;a=s(o,30);o=i;i=_}this.h[0]=u(this.h[0],i);this.h[1]=u(this.h[1],o);this.h[2]=u(this.h[2],a);this.h[3]=u(this.h[3],l);this.h[4]=u(this.h[4],f)};j.prototype._digest=function oe(e){if(e==="hex")return i.toHex32(this.h,"big");else return i.split32(this.h,"big");
};function D(e,t,n){return e&t^~e&n}function O(e,t,n){return e&t^e&n^t&n}function I(e,t,n){return e^t^n}function P(e){return a(e,2)^a(e,13)^a(e,22)}function R(e){return a(e,6)^a(e,11)^a(e,25)}function z(e){return a(e,7)^a(e,18)^e>>>3}function B(e){return a(e,17)^a(e,19)^e>>>10}function N(e,t,n,r){if(e===0)return D(t,n,r);if(e===1||e===3)return I(t,n,r);if(e===2)return O(t,n,r)}function L(e,t,n,r,i,o){var a=e&n^~e&i;if(a<0)a+=4294967296;return a}function q(e,t,n,r,i,o){var a=t&r^~t&o;if(a<0)a+=4294967296;return a}function U(e,t,n,r,i,o){var a=e&n^e&i^n&i;if(a<0)a+=4294967296;return a}function F(e,t,n,r,i,o){var a=t&r^t&o^r&o;if(a<0)a+=4294967296;return a}function W(e,t){var n=f(e,t,28);var r=f(t,e,2);var i=f(t,e,7);var o=n^r^i;if(o<0)o+=4294967296;return o}function G(e,t){var n=d(e,t,28);var r=d(t,e,2);var i=d(t,e,7);var o=n^r^i;if(o<0)o+=4294967296;return o}function V(e,t){var n=f(e,t,14);var r=f(e,t,18);var i=f(t,e,9);var o=n^r^i;if(o<0)o+=4294967296;return o}function Y(e,t){var n=d(e,t,14);var r=d(e,t,18);var i=d(t,e,9);var o=n^r^i;if(o<0)o+=4294967296;return o}function H(e,t){var n=f(e,t,1);var r=f(e,t,8);var i=_(e,t,7);var o=n^r^i;if(o<0)o+=4294967296;return o}function $(e,t){var n=d(e,t,1);var r=d(e,t,8);var i=p(e,t,7);var o=n^r^i;if(o<0)o+=4294967296;return o}function K(e,t){var n=f(e,t,19);var r=f(t,e,29);var i=_(e,t,6);var o=n^r^i;if(o<0)o+=4294967296;return o}function J(e,t){var n=d(e,t,19);var r=d(t,e,29);var i=p(e,t,6);var o=n^r^i;if(o<0)o+=4294967296;return o}},{"../hash":135}],140:[function(e,t,n){var r=n;var i=e("inherits");function o(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if(typeof e==="string"){if(!t){for(var r=0;r<e.length;r++){var i=e.charCodeAt(r);var o=i>>8;var a=i&255;if(o)n.push(o,a);else n.push(a)}}else if(t==="hex"){e=e.replace(/[^a-z0-9]+/gi,"");if(e.length%2!==0)e="0"+e;for(var r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16))}}else{for(var r=0;r<e.length;r++)n[r]=e[r]|0}return n}r.toArray=o;function a(e){var t="";for(var n=0;n<e.length;n++)t+=l(e[n].toString(16));return t}r.toHex=a;function s(e){var t=e>>>24|e>>>8&65280|e<<8&16711680|(e&255)<<24;return t>>>0}r.htonl=s;function u(e,t){var n="";for(var r=0;r<e.length;r++){var i=e[r];if(t==="little")i=s(i);n+=c(i.toString(16))}return n}r.toHex32=u;function l(e){if(e.length===1)return"0"+e;else return e}r.zero2=l;function c(e){if(e.length===7)return"0"+e;else if(e.length===6)return"00"+e;else if(e.length===5)return"000"+e;else if(e.length===4)return"0000"+e;else if(e.length===3)return"00000"+e;else if(e.length===2)return"000000"+e;else if(e.length===1)return"0000000"+e;else return e}r.zero8=c;function f(e,t,n,r){var i=n-t;y(i%4===0);var o=new Array(i/4);for(var a=0,s=t;a<o.length;a++,s+=4){var u;if(r==="big")u=e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3];else u=e[s+3]<<24|e[s+2]<<16|e[s+1]<<8|e[s];o[a]=u>>>0}return o}r.join32=f;function d(e,t){var n=new Array(e.length*4);for(var r=0,i=0;r<e.length;r++,i+=4){var o=e[r];if(t==="big"){n[i]=o>>>24;n[i+1]=o>>>16&255;n[i+2]=o>>>8&255;n[i+3]=o&255}else{n[i+3]=o>>>24;n[i+2]=o>>>16&255;n[i+1]=o>>>8&255;n[i]=o&255}}return n}r.split32=d;function _(e,t){return e>>>t|e<<32-t}r.rotr32=_;function p(e,t){return e<<t|e>>>32-t}r.rotl32=p;function h(e,t){return e+t>>>0}r.sum32=h;function g(e,t,n){return e+t+n>>>0}r.sum32_3=g;function m(e,t,n,r){return e+t+n+r>>>0}r.sum32_4=m;function v(e,t,n,r,i){return e+t+n+r+i>>>0}r.sum32_5=v;function y(e,t){if(!e)throw new Error(t||"Assertion failed")}r.assert=y;r.inherits=i;function b(e,t,n,r){var i=e[t];var o=e[t+1];var a=r+o>>>0;var s=(a<r?1:0)+n+i;e[t]=s>>>0;e[t+1]=a}n.sum64=b;function w(e,t,n,r){var i=t+r>>>0;var o=(i<t?1:0)+e+n;return o>>>0}n.sum64_hi=w;function x(e,t,n,r){var i=t+r;return i>>>0}n.sum64_lo=x;function k(e,t,n,r,i,o,a,s){var u=0;var l=t;l=l+r>>>0;u+=l<t?1:0;l=l+o>>>0;u+=l<o?1:0;l=l+s>>>0;u+=l<s?1:0;var c=e+n+i+a+u;return c>>>0}n.sum64_4_hi=k;function S(e,t,n,r,i,o,a,s){var u=t+r+o+s;return u>>>0}n.sum64_4_lo=S;function A(e,t,n,r,i,o,a,s,u,l){var c=0;var f=t;f=f+r>>>0;c+=f<t?1:0;f=f+o>>>0;c+=f<o?1:0;f=f+s>>>0;c+=f<s?1:0;f=f+l>>>0;c+=f<l?1:0;var d=e+n+i+a+u+c;return d>>>0}n.sum64_5_hi=A;function E(e,t,n,r,i,o,a,s,u,l){var c=t+r+o+s+l;return c>>>0}n.sum64_5_lo=E;function M(e,t,n){var r=t<<32-n|e>>>n;return r>>>0}n.rotr64_hi=M;function T(e,t,n){var r=e<<32-n|t>>>n;return r>>>0}n.rotr64_lo=T;function C(e,t,n){return e>>>n}n.shr64_hi=C;function j(e,t,n){var r=e<<32-n|t>>>n;return r>>>0}n.shr64_lo=j},{inherits:277}],141:[function(e,t,n){t.exports={name:"elliptic",version:"6.3.2",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},keywords:["EC","Elliptic","curve","Cryptography"],author:{name:"Fedor Indutny",email:"fedor@indutny.com"},license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^1.4.3",coveralls:"^2.11.3",grunt:"^0.4.5","grunt-browserify":"^5.0.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^8.6.2",istanbul:"^0.4.2",jscs:"^2.9.0",jshint:"^2.6.0",mocha:"^2.1.0"},dependencies:{"bn.js":"^4.4.0",brorand:"^1.0.1","hash.js":"^1.0.0",inherits:"^2.0.1"},readme:"# Elliptic [![Build Status](https://secure.travis-ci.org/indutny/elliptic.png)](http://travis-ci.org/indutny/elliptic) [![Coverage Status](https://coveralls.io/repos/indutny/elliptic/badge.svg?branch=master&service=github)](https://coveralls.io/github/indutny/elliptic?branch=master) [![Code Climate](https://codeclimate.com/github/indutny/elliptic/badges/gpa.svg)](https://codeclimate.com/github/indutny/elliptic)\n\n[![Saucelabs Test Status](https://saucelabs.com/browser-matrix/gh-indutny-elliptic.svg)](https://saucelabs.com/u/gh-indutny-elliptic)\n\nFast elliptic-curve cryptography in a plain javascript implementation.\n\nNOTE: Please take a look at http://safecurves.cr.yp.to/ before choosing a curve\nfor your cryptography operations.\n\n## Incentive\n\nECC is much slower than regular RSA cryptography, the JS implementations are\neven more slower.\n\n## Benchmarks\n\n```bash\n$ node benchmarks/index.js\nBenchmarking: sign\nelliptic#sign x 262 ops/sec ±0.51% (177 runs sampled)\neccjs#sign x 55.91 ops/sec ±0.90% (144 runs sampled)\n------------------------\nFastest is elliptic#sign\n========================\nBenchmarking: verify\nelliptic#verify x 113 ops/sec ±0.50% (166 runs sampled)\neccjs#verify x 48.56 ops/sec ±0.36% (125 runs sampled)\n------------------------\nFastest is elliptic#verify\n========================\nBenchmarking: gen\nelliptic#gen x 294 ops/sec ±0.43% (176 runs sampled)\neccjs#gen x 62.25 ops/sec ±0.63% (129 runs sampled)\n------------------------\nFastest is elliptic#gen\n========================\nBenchmarking: ecdh\nelliptic#ecdh x 136 ops/sec ±0.85% (156 runs sampled)\n------------------------\nFastest is elliptic#ecdh\n========================\n```\n\n## API\n\n### ECDSA\n\n```javascript\nvar EC = require('elliptic').ec;\n\n// Create and initialize EC context\n// (better do it once and reuse it)\nvar ec = new EC('secp256k1');\n\n// Generate keys\nvar key = ec.genKeyPair();\n\n// Sign message (must be an array, or it'll be treated as a hex sequence)\nvar msg = [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ];\nvar signature = key.sign(msg);\n\n// Export DER encoded signature in Array\nvar derSign = signature.toDER();\n\n// Verify signature\nconsole.log(key.verify(msg, derSign));\n\n// CHECK WITH NO PRIVATE KEY\n\n// Public key as '04 + x + y'\nvar pub = '04bb1fa3...';\n\n// Signature MUST be either:\n// 1) hex-string of DER-encoded signature; or\n// 2) DER-encoded signature as buffer; or\n// 3) object with two hex-string properties (r and s)\n\nvar signature = 'b102ac...'; // case 1\nvar signature = new Buffer('...'); // case 2\nvar signature = { r: 'b1fc...', s: '9c42...' }; // case 3\n\n// Import public key\nvar key = ec.keyFromPublic(pub, 'hex');\n\n// Verify signature\nconsole.log(key.verify(msg, signature));\n```\n\n### EdDSA\n\n```javascript\nvar EdDSA = require('elliptic').eddsa;\n\n// Create and initialize EdDSA context\n// (better do it once and reuse it)\nvar ec = new EdDSA('ed25519');\n\n// Create key pair from secret\nvar key = ec.keyFromSecret('693e3c...'); // hex string, array or Buffer\n\n// Sign message (must be an array, or it'll be treated as a hex sequence)\nvar msg = [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ];\nvar signature = key.sign(msg).toHex();\n\n// Verify signature\nconsole.log(key.verify(msg, signature));\n\n// CHECK WITH NO PRIVATE KEY\n\n// Import public key\nvar pub = '0a1af638...';\nvar key = ec.keyFromPublic(pub, 'hex');\n\n// Verify signature\nvar signature = '70bed1...';\nconsole.log(key.verify(msg, signature));\n```\n\n### ECDH\n\n```javascript\nvar ECDH = require('elliptic').ec;\nvar ec = new ECDH('curve25519');\n\n// Generate keys\nvar key1 = ec.genKeyPair();\nvar key2 = ec.genKeyPair();\n\nvar shared1 = key1.derive(key2.getPublic());\nvar shared2 = key2.derive(key1.getPublic());\n\nconsole.log('Both shared secrets are BN instances');\nconsole.log(shared1.toString(16));\nconsole.log(shared2.toString(16));\n```\n\nNOTE: `.derive()` returns a [BN][1] instance.\n\n## Supported curves\n\nElliptic.js support following curve types:\n\n* Short Weierstrass\n* Montgomery\n* Edwards\n* Twisted Edwards\n\nFollowing curve 'presets' are embedded into the library:\n\n* `secp256k1`\n* `p192`\n* `p224`\n* `p256`\n* `p384`\n* `p521`\n* `curve25519`\n* `ed25519`\n\nNOTE: That `curve25519` could not be used for ECDSA, use `ed25519` instead.\n\n### Implementation details\n\nECDSA is using deterministic `k` value generation as per [RFC6979][0]. Most of\nthe curve operations are performed on non-affine coordinates (either projective\nor extended), various windowing techniques are used for different cases.\n\nAll operations are performed in reduction context using [bn.js][1], hashing is\nprovided by [hash.js][2]\n\n### Related projects\n\n* [eccrypto][3]: isomorphic implementation of ECDSA, ECDH and ECIES for both\n  browserify and node (uses `elliptic` for browser and [secp256k1-node][4] for\n  node)\n\n#### LICENSE\n\nThis software is licensed under the MIT License.\n\nCopyright Fedor Indutny, 2014.\n\nPermission is hereby granted, free of charge, to any person obtaining a\ncopy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to permit\npersons to whom the Software is furnished to do so, subject to the\nfollowing conditions:\n\nThe above copyright notice and this permission notice shall be included\nin all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\nOR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\nNO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\nDAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\nOTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\nUSE OR OTHER DEALINGS IN THE SOFTWARE.\n\n[0]: http://tools.ietf.org/html/rfc6979\n[1]: https://github.com/indutny/bn.js\n[2]: https://github.com/indutny/hash.js\n[3]: https://github.com/bitchan/eccrypto\n[4]: https://github.com/wanderer/secp256k1-node\n",readmeFilename:"README.md",_id:"elliptic@6.3.2",_shasum:"e4c81e0829cf0a65ab70e998b8232723b5c1bc48",_resolved:"file:node_shrinkwrap/elliptic-6.3.2.tgz",_from:"node_shrinkwrap/elliptic-6.3.2.tgz"}},{}],142:[function(e,t,n){t.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],143:[function(e,t,n){var r=e("asn1.js");var i=r.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});n.RSAPrivateKey=i;var o=r.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});n.RSAPublicKey=o;var a=r.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(s),this.key("subjectPublicKey").bitstr())});n.PublicKey=a;var s=r.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())});var u=r.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(s),this.key("subjectPrivateKey").octstr())});n.PrivateKey=u;var l=r.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});n.EncryptedPrivateKey=l;var c=r.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});n.DSAPrivateKey=c;n.DSAparam=r.define("DSAparam",function(){this.int()});var f=r.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(d),this.key("publicKey").optional().explicit(1).bitstr())});n.ECPrivateKey=f;var d=r.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});n.signature=r.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"asn1.js":146}],144:[function(e,t,n){(function(n){var r=/Proc-Type: 4,ENCRYPTED\r?\nDEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)\r?\n\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n/m;var i=/^-----BEGIN (.*) KEY-----\r?\n/m;var o=/^-----BEGIN (.*) KEY-----\r?\n([0-9A-z\n\r\+\/\=]+)\r?\n-----END \1 KEY-----$/m;var a=e("evp_bytestokey");var s=e("browserify-aes");t.exports=function(e,t){var u=e.toString();var l=u.match(r);var c;if(!l){var f=u.match(o);c=new n(f[2].replace(/\r?\n/g,""),"base64")}else{var d="aes"+l[1];var _=new n(l[2],"hex");var p=new n(l[3].replace(/\r?\n/g,""),"base64");var h=a(t,_.slice(0,8),parseInt(l[1],10)).key;var g=[];var m=s.createDecipheriv(d,h,_);g.push(m.update(p));g.push(m.final());c=n.concat(g)}var v=u.match(i)[1]+" KEY";return{tag:v,data:c}}}).call(this,e("buffer").Buffer)},{"browserify-aes":163,buffer:79,evp_bytestokey:178}],145:[function(e,t,n){(function(n){var r=e("./asn1");var i=e("./aesid.json");var o=e("./fixProc");var a=e("browserify-aes");var s=e("pbkdf2");t.exports=u;function u(e){var t;if(typeof e==="object"&&!n.isBuffer(e)){t=e.passphrase;e=e.key}if(typeof e==="string"){e=new n(e)}var i=o(e,t);var a=i.tag;var s=i.data;var u,c;switch(a){case"PUBLIC KEY":c=r.PublicKey.decode(s,"der");u=c.algorithm.algorithm.join(".");switch(u){case"1.2.840.113549.1.1.1":return r.RSAPublicKey.decode(c.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":c.subjectPrivateKey=c.subjectPublicKey;return{type:"ec",data:c};case"1.2.840.10040.4.1":c.algorithm.params.pub_key=r.DSAparam.decode(c.subjectPublicKey.data,"der");return{type:"dsa",data:c.algorithm.params};default:throw new Error("unknown key id "+u)}throw new Error("unknown key type "+a);case"ENCRYPTED PRIVATE KEY":s=r.EncryptedPrivateKey.decode(s,"der");s=l(s,t);case"PRIVATE KEY":c=r.PrivateKey.decode(s,"der");u=c.algorithm.algorithm.join(".");switch(u){case"1.2.840.113549.1.1.1":return r.RSAPrivateKey.decode(c.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:c.algorithm.curve,privateKey:r.ECPrivateKey.decode(c.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":c.algorithm.params.priv_key=r.DSAparam.decode(c.subjectPrivateKey,"der");return{type:"dsa",params:c.algorithm.params};default:throw new Error("unknown key id "+u)}throw new Error("unknown key type "+a);case"RSA PUBLIC KEY":return r.RSAPublicKey.decode(s,"der");case"RSA PRIVATE KEY":return r.RSAPrivateKey.decode(s,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:r.DSAPrivateKey.decode(s,"der")};case"EC PRIVATE KEY":s=r.ECPrivateKey.decode(s,"der");return{curve:s.parameters.value,privateKey:s.privateKey};default:throw new Error("unknown key type "+a)}}u.signature=r.signature;function l(e,t){var r=e.algorithm.decrypt.kde.kdeparams.salt;var o=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10);var u=i[e.algorithm.decrypt.cipher.algo.join(".")];var l=e.algorithm.decrypt.cipher.iv;var c=e.subjectPrivateKey;var f=parseInt(u.split("-")[1],10)/8;var d=s.pbkdf2Sync(t,r,o,f);var _=a.createDecipheriv(u,d,l);var p=[];p.push(_.update(c));p.push(_.final());return n.concat(p)}}).call(this,e("buffer").Buffer)},{"./aesid.json":142,"./asn1":143,"./fixProc":144,"browserify-aes":163,buffer:79,pbkdf2:228}],146:[function(e,t,n){var r=n;r.bignum=e("bn.js");r.define=e("./asn1/api").define;r.base=e("./asn1/base");r.constants=e("./asn1/constants");r.decoders=e("./asn1/decoders");r.encoders=e("./asn1/encoders")},{"./asn1/api":147,"./asn1/base":149,"./asn1/constants":153,"./asn1/decoders":155,"./asn1/encoders":158,"bn.js":116}],147:[function(e,t,n){var r=e("../asn1");var i=e("inherits");var o=n;o.define=function s(e,t){return new a(e,t)};function a(e,t){this.name=e;this.body=t;this.decoders={};this.encoders={}}a.prototype._createNamed=function u(t){var n;try{n=e("vm").runInThisContext("(function "+this.name+"(entity) {\n"+"  this._initNamed(entity);\n"+"})")}catch(r){n=function(e){this._initNamed(e)}}i(n,t);n.prototype._initNamed=function o(e){t.call(this,e)};return new n(this)};a.prototype._getDecoder=function l(e){e=e||"der";if(!this.decoders.hasOwnProperty(e))this.decoders[e]=this._createNamed(r.decoders[e]);return this.decoders[e]};a.prototype.decode=function c(e,t,n){return this._getDecoder(t).decode(e,n)};a.prototype._getEncoder=function f(e){e=e||"der";if(!this.encoders.hasOwnProperty(e))this.encoders[e]=this._createNamed(r.encoders[e]);return this.encoders[e]};a.prototype.encode=function d(e,t,n){return this._getEncoder(t).encode(e,n)}},{"../asn1":146,inherits:277,vm:303}],148:[function(e,t,n){var r=e("inherits");var i=e("../base").Reporter;var o=e("buffer").Buffer;function a(e,t){i.call(this,t);if(!o.isBuffer(e)){this.error("Input not Buffer");return}this.base=e;this.offset=0;this.length=e.length}r(a,i);n.DecoderBuffer=a;a.prototype.save=function u(){return{offset:this.offset,reporter:i.prototype.save.call(this)}};a.prototype.restore=function l(e){var t=new a(this.base);t.offset=e.offset;t.length=this.offset;this.offset=e.offset;i.prototype.restore.call(this,e.reporter);return t};a.prototype.isEmpty=function c(){return this.offset===this.length};a.prototype.readUInt8=function f(e){if(this.offset+1<=this.length)return this.base.readUInt8(this.offset++,true);else return this.error(e||"DecoderBuffer overrun")};a.prototype.skip=function d(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");var n=new a(this.base);n._reporterState=this._reporterState;n.offset=this.offset;n.length=this.offset+e;this.offset+=e;return n};a.prototype.raw=function _(e){return this.base.slice(e?e.offset:this.offset,this.length)};function s(e,t){if(Array.isArray(e)){this.length=0;this.value=e.map(function(e){if(!(e instanceof s))e=new s(e,t);this.length+=e.length;return e},this)}else if(typeof e==="number"){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e;this.length=1}else if(typeof e==="string"){this.value=e;this.length=o.byteLength(e)}else if(o.isBuffer(e)){this.value=e;this.length=e.length}else{return t.error("Unsupported type: "+typeof e)}}n.EncoderBuffer=s;s.prototype.join=function p(e,t){if(!e)e=new o(this.length);if(!t)t=0;if(this.length===0)return e;if(Array.isArray(this.value)){this.value.forEach(function(n){n.join(e,t);t+=n.length})}else{if(typeof this.value==="number")e[t]=this.value;else if(typeof this.value==="string")e.write(this.value,t);else if(o.isBuffer(this.value))this.value.copy(e,t);t+=this.length}return e}},{"../base":149,buffer:79,inherits:277}],149:[function(e,t,n){var r=n;r.Reporter=e("./reporter").Reporter;r.DecoderBuffer=e("./buffer").DecoderBuffer;r.EncoderBuffer=e("./buffer").EncoderBuffer;r.Node=e("./node")},{"./buffer":148,"./node":150,"./reporter":151}],150:[function(e,t,n){var r=e("../base").Reporter;var i=e("../base").EncoderBuffer;var o=e("../base").DecoderBuffer;var a=e("minimalistic-assert");var s=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"];var u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(s);var l=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function c(e,t){var n={};this._baseState=n;n.enc=e;n.parent=t||null;n.children=null;n.tag=null;n.args=null;n.reverseArgs=null;n.choice=null;n.optional=false;n.any=false;n.obj=false;n.use=null;n.useDecoder=null;n.key=null;n["default"]=null;n.explicit=null;n.implicit=null;n.contains=null;if(!n.parent){n.children=[];this._wrap()}}t.exports=c;var f=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];c.prototype.clone=function d(){var e=this._baseState;var t={};f.forEach(function(n){t[n]=e[n]});var n=new this.constructor(t.parent);n._baseState=t;return n};c.prototype._wrap=function _(){var e=this._baseState;u.forEach(function(t){this[t]=function n(){var n=new this.constructor(this);e.children.push(n);return n[t].apply(n,arguments)}},this)};c.prototype._init=function p(e){var t=this._baseState;a(t.parent===null);e.call(this);t.children=t.children.filter(function(e){return e._baseState.parent===this},this);a.equal(t.children.length,1,"Root node can have only one child")};c.prototype._useArgs=function h(e){var t=this._baseState;var n=e.filter(function(e){return e instanceof this.constructor},this);e=e.filter(function(e){return!(e instanceof this.constructor)},this);if(n.length!==0){a(t.children===null);t.children=n;n.forEach(function(e){e._baseState.parent=this},this)}if(e.length!==0){a(t.args===null);t.args=e;t.reverseArgs=e.map(function(e){if(typeof e!=="object"||e.constructor!==Object)return e;var t={};Object.keys(e).forEach(function(n){if(n==(n|0))n|=0;var r=e[n];t[r]=n});return t})}};l.forEach(function(e){c.prototype[e]=function t(){var t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}});s.forEach(function(e){c.prototype[e]=function t(){var t=this._baseState;var n=Array.prototype.slice.call(arguments);a(t.tag===null);t.tag=e;this._useArgs(n);return this}});c.prototype.use=function g(e){a(e);var t=this._baseState;a(t.use===null);t.use=e;return this};c.prototype.optional=function m(){var e=this._baseState;e.optional=true;return this};c.prototype.def=function v(e){var t=this._baseState;a(t["default"]===null);t["default"]=e;t.optional=true;return this};c.prototype.explicit=function y(e){var t=this._baseState;a(t.explicit===null&&t.implicit===null);t.explicit=e;return this};c.prototype.implicit=function b(e){var t=this._baseState;a(t.explicit===null&&t.implicit===null);t.implicit=e;return this};c.prototype.obj=function w(){var e=this._baseState;var t=Array.prototype.slice.call(arguments);e.obj=true;if(t.length!==0)this._useArgs(t);return this};c.prototype.key=function x(e){var t=this._baseState;a(t.key===null);t.key=e;return this};c.prototype.any=function k(){var e=this._baseState;e.any=true;return this};c.prototype.choice=function S(e){var t=this._baseState;a(t.choice===null);t.choice=e;this._useArgs(Object.keys(e).map(function(t){return e[t]}));return this};c.prototype.contains=function A(e){var t=this._baseState;a(t.use===null);t.contains=e;return this};c.prototype._decode=function E(e,t){var n=this._baseState;if(n.parent===null)return e.wrapResult(n.children[0]._decode(e,t));var r=n["default"];var i=true;var a=null;if(n.key!==null)a=e.enterKey(n.key);if(n.optional){var s=null;if(n.explicit!==null)s=n.explicit;else if(n.implicit!==null)s=n.implicit;else if(n.tag!==null)s=n.tag;if(s===null&&!n.any){var u=e.save();try{if(n.choice===null)this._decodeGeneric(n.tag,e,t);else this._decodeChoice(e,t);i=true}catch(l){i=false}e.restore(u)}else{i=this._peekTag(e,s,n.any);if(e.isError(i))return i}}var c;if(n.obj&&i)c=e.enterObject();if(i){if(n.explicit!==null){var f=this._decodeTag(e,n.explicit);if(e.isError(f))return f;e=f}var d=e.offset;if(n.use===null&&n.choice===null){if(n.any)var u=e.save();var _=this._decodeTag(e,n.implicit!==null?n.implicit:n.tag,n.any);if(e.isError(_))return _;if(n.any)r=e.raw(u);else e=_}if(t&&t.track&&n.tag!==null)t.track(e.path(),d,e.length,"tagged");if(t&&t.track&&n.tag!==null)t.track(e.path(),e.offset,e.length,"content");if(n.any)r=r;else if(n.choice===null)r=this._decodeGeneric(n.tag,e,t);else r=this._decodeChoice(e,t);if(e.isError(r))return r;if(!n.any&&n.choice===null&&n.children!==null){n.children.forEach(function h(n){n._decode(e,t)})}if(n.contains&&(n.tag==="octstr"||n.tag==="bitstr")){var p=new o(r);r=this._getUse(n.contains,e._reporterState.obj)._decode(p,t)}}if(n.obj&&i)r=e.leaveObject(c);if(n.key!==null&&(r!==null||i===true))e.leaveKey(a,n.key,r);else if(a!==null)e.exitKey(a);return r};c.prototype._decodeGeneric=function M(e,t,n){var r=this._baseState;if(e==="seq"||e==="set")return null;if(e==="seqof"||e==="setof")return this._decodeList(t,e,r.args[0],n);else if(/str$/.test(e))return this._decodeStr(t,e,n);else if(e==="objid"&&r.args)return this._decodeObjid(t,r.args[0],r.args[1],n);else if(e==="objid")return this._decodeObjid(t,null,null,n);else if(e==="gentime"||e==="utctime")return this._decodeTime(t,e,n);else if(e==="null_")return this._decodeNull(t,n);else if(e==="bool")return this._decodeBool(t,n);else if(e==="objDesc")return this._decodeStr(t,e,n);else if(e==="int"||e==="enum")return this._decodeInt(t,r.args&&r.args[0],n);if(r.use!==null){return this._getUse(r.use,t._reporterState.obj)._decode(t,n)}else{return t.error("unknown tag: "+e)}};c.prototype._getUse=function T(e,t){var n=this._baseState;n.useDecoder=this._use(e,t);a(n.useDecoder._baseState.parent===null);n.useDecoder=n.useDecoder._baseState.children[0];if(n.implicit!==n.useDecoder._baseState.implicit){n.useDecoder=n.useDecoder.clone();n.useDecoder._baseState.implicit=n.implicit}return n.useDecoder};c.prototype._decodeChoice=function C(e,t){var n=this._baseState;var r=null;var i=false;Object.keys(n.choice).some(function(o){var a=e.save();var s=n.choice[o];try{var u=s._decode(e,t);if(e.isError(u))return false;r={type:o,value:u};i=true}catch(l){e.restore(a);return false}return true},this);if(!i)return e.error("Choice not matched");return r};c.prototype._createEncoderBuffer=function j(e){return new i(e,this.reporter)};c.prototype._encode=function D(e,t,n){var r=this._baseState;if(r["default"]!==null&&r["default"]===e)return;var i=this._encodeValue(e,t,n);if(i===undefined)return;if(this._skipDefault(i,t,n))return;return i};c.prototype._encodeValue=function O(e,t,n){var i=this._baseState;if(i.parent===null)return i.children[0]._encode(e,t||new r);var o=null;this.reporter=t;if(i.optional&&e===undefined){if(i["default"]!==null)e=i["default"];else return}var a=null;var s=false;if(i.any){o=this._createEncoderBuffer(e)}else if(i.choice){o=this._encodeChoice(e,t)}else if(i.contains){a=this._getUse(i.contains,n)._encode(e,t);s=true}else if(i.children){a=i.children.map(function(n){if(n._baseState.tag==="null_")return n._encode(null,t,e);if(n._baseState.key===null)return t.error("Child should have a key");var r=t.enterKey(n._baseState.key);if(typeof e!=="object")return t.error("Child expected, but input is not object");var i=n._encode(e[n._baseState.key],t,e);t.leaveKey(r);return i},this).filter(function(e){return e});a=this._createEncoderBuffer(a)}else{if(i.tag==="seqof"||i.tag==="setof"){if(!(i.args&&i.args.length===1))return t.error("Too many args for : "+i.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");var u=this.clone();u._baseState.implicit=null;a=this._createEncoderBuffer(e.map(function(n){var r=this._baseState;return this._getUse(r.args[0],e)._encode(n,t)},u))}else if(i.use!==null){o=this._getUse(i.use,n)._encode(e,t)}else{a=this._encodePrimitive(i.tag,e);s=true}}var o;if(!i.any&&i.choice===null){var l=i.implicit!==null?i.implicit:i.tag;var c=i.implicit===null?"universal":"context";if(l===null){if(i.use===null)t.error("Tag could be ommited only for .use()")}else{if(i.use===null)o=this._encodeComposite(l,s,c,a)}}if(i.explicit!==null)o=this._encodeComposite(i.explicit,false,"context",o);return o};c.prototype._encodeChoice=function I(e,t){var n=this._baseState;var r=n.choice[e.type];if(!r){a(false,e.type+" not found in "+JSON.stringify(Object.keys(n.choice)))}return r._encode(e.value,t)};c.prototype._encodePrimitive=function P(e,t){var n=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);else if(e==="objid"&&n.args)return this._encodeObjid(t,n.reverseArgs[0],n.args[1]);else if(e==="objid")return this._encodeObjid(t,null,null);else if(e==="gentime"||e==="utctime")return this._encodeTime(t,e);else if(e==="null_")return this._encodeNull();else if(e==="int"||e==="enum")return this._encodeInt(t,n.args&&n.reverseArgs[0]);else if(e==="bool")return this._encodeBool(t);else if(e==="objDesc")return this._encodeStr(t,e);else throw new Error("Unsupported tag: "+e)};c.prototype._isNumstr=function R(e){return/^[0-9 ]*$/.test(e)};c.prototype._isPrintstr=function z(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)}},{"../base":149,"minimalistic-assert":160}],151:[function(e,t,n){var r=e("inherits");function i(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}n.Reporter=i;i.prototype.isError=function a(e){return e instanceof o};i.prototype.save=function s(){var e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}};i.prototype.restore=function u(e){var t=this._reporterState;t.obj=e.obj;t.path=t.path.slice(0,e.pathLen)};i.prototype.enterKey=function l(e){return this._reporterState.path.push(e)};i.prototype.exitKey=function c(e){var t=this._reporterState;t.path=t.path.slice(0,e-1)};i.prototype.leaveKey=function f(e,t,n){var r=this._reporterState;this.exitKey(e);if(r.obj!==null)r.obj[t]=n};i.prototype.path=function d(){return this._reporterState.path.join("/")};i.prototype.enterObject=function _(){var e=this._reporterState;var t=e.obj;e.obj={};return t};i.prototype.leaveObject=function p(e){
var t=this._reporterState;var n=t.obj;t.obj=e;return n};i.prototype.error=function h(e){var t;var n=this._reporterState;var r=e instanceof o;if(r){t=e}else{t=new o(n.path.map(function(e){return"["+JSON.stringify(e)+"]"}).join(""),e.message||e,e.stack)}if(!n.options.partial)throw t;if(!r)n.errors.push(t);return t};i.prototype.wrapResult=function g(e){var t=this._reporterState;if(!t.options.partial)return e;return{result:this.isError(e)?null:e,errors:t.errors}};function o(e,t){this.path=e;this.rethrow(t)}r(o,Error);o.prototype.rethrow=function m(e){this.message=e+" at: "+(this.path||"(shallow)");if(Error.captureStackTrace)Error.captureStackTrace(this,o);if(!this.stack){try{throw new Error(this.message)}catch(t){this.stack=t.stack}}return this}},{inherits:277}],152:[function(e,t,n){var r=e("../constants");n.tagClass={0:"universal",1:"application",2:"context",3:"private"};n.tagClassByName=r._reverse(n.tagClass);n.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"};n.tagByName=r._reverse(n.tag)},{"../constants":153}],153:[function(e,t,n){var r=n;r._reverse=function i(e){var t={};Object.keys(e).forEach(function(n){if((n|0)==n)n=n|0;var r=e[n];t[r]=n});return t};r.der=e("./der")},{"./der":152}],154:[function(e,t,n){var r=e("inherits");var i=e("../../asn1");var o=i.base;var a=i.bignum;var s=i.constants.der;function u(e){this.enc="der";this.name=e.name;this.entity=e;this.tree=new l;this.tree._init(e.body)}t.exports=u;u.prototype.decode=function d(e,t){if(!(e instanceof o.DecoderBuffer))e=new o.DecoderBuffer(e,t);return this.tree._decode(e,t)};function l(e){o.Node.call(this,"der",e)}r(l,o.Node);l.prototype._peekTag=function _(e,t,n){if(e.isEmpty())return false;var r=e.save();var i=c(e,'Failed to peek tag: "'+t+'"');if(e.isError(i))return i;e.restore(r);return i.tag===t||i.tagStr===t||i.tagStr+"of"===t||n};l.prototype._decodeTag=function p(e,t,n){var r=c(e,'Failed to decode tag of "'+t+'"');if(e.isError(r))return r;var i=f(e,r.primitive,'Failed to get length of "'+t+'"');if(e.isError(i))return i;if(!n&&r.tag!==t&&r.tagStr!==t&&r.tagStr+"of"!==t){return e.error('Failed to match tag: "'+t+'"')}if(r.primitive||i!==null)return e.skip(i,'Failed to match body of: "'+t+'"');var o=e.save();var a=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');if(e.isError(a))return a;i=e.offset-o.offset;e.restore(o);return e.skip(i,'Failed to match body of: "'+t+'"')};l.prototype._skipUntilEnd=function h(e,t){while(true){var n=c(e,t);if(e.isError(n))return n;var r=f(e,n.primitive,t);if(e.isError(r))return r;var i;if(n.primitive||r!==null)i=e.skip(r);else i=this._skipUntilEnd(e,t);if(e.isError(i))return i;if(n.tagStr==="end")break}};l.prototype._decodeList=function g(e,t,n,r){var i=[];while(!e.isEmpty()){var o=this._peekTag(e,"end");if(e.isError(o))return o;var a=n.decode(e,"der",r);if(e.isError(a)&&o)break;i.push(a)}return i};l.prototype._decodeStr=function m(e,t){if(t==="bitstr"){var n=e.readUInt8();if(e.isError(n))return n;return{unused:n,data:e.raw()}}else if(t==="bmpstr"){var r=e.raw();if(r.length%2===1)return e.error("Decoding of string type: bmpstr length mismatch");var i="";for(var o=0;o<r.length/2;o++){i+=String.fromCharCode(r.readUInt16BE(o*2))}return i}else if(t==="numstr"){var a=e.raw().toString("ascii");if(!this._isNumstr(a)){return e.error("Decoding of string type: "+"numstr unsupported characters")}return a}else if(t==="octstr"){return e.raw()}else if(t==="objDesc"){return e.raw()}else if(t==="printstr"){var s=e.raw().toString("ascii");if(!this._isPrintstr(s)){return e.error("Decoding of string type: "+"printstr unsupported characters")}return s}else if(/str$/.test(t)){return e.raw().toString()}else{return e.error("Decoding of string type: "+t+" unsupported")}};l.prototype._decodeObjid=function v(e,t,n){var r;var i=[];var o=0;while(!e.isEmpty()){var a=e.readUInt8();o<<=7;o|=a&127;if((a&128)===0){i.push(o);o=0}}if(a&128)i.push(o);var s=i[0]/40|0;var u=i[0]%40;if(n)r=i;else r=[s,u].concat(i.slice(1));if(t){var l=t[r.join(" ")];if(l===undefined)l=t[r.join(".")];if(l!==undefined)r=l}return r};l.prototype._decodeTime=function y(e,t){var n=e.raw().toString();if(t==="gentime"){var r=n.slice(0,4)|0;var i=n.slice(4,6)|0;var o=n.slice(6,8)|0;var a=n.slice(8,10)|0;var s=n.slice(10,12)|0;var u=n.slice(12,14)|0}else if(t==="utctime"){var r=n.slice(0,2)|0;var i=n.slice(2,4)|0;var o=n.slice(4,6)|0;var a=n.slice(6,8)|0;var s=n.slice(8,10)|0;var u=n.slice(10,12)|0;if(r<70)r=2e3+r;else r=1900+r}else{return e.error("Decoding "+t+" time is not supported yet")}return Date.UTC(r,i-1,o,a,s,u,0)};l.prototype._decodeNull=function b(e){return null};l.prototype._decodeBool=function w(e){var t=e.readUInt8();if(e.isError(t))return t;else return t!==0};l.prototype._decodeInt=function x(e,t){var n=e.raw();var r=new a(n);if(t)r=t[r.toString(10)]||r;return r};l.prototype._use=function k(e,t){if(typeof e==="function")e=e(t);return e._getDecoder("der").tree};function c(e,t){var n=e.readUInt8(t);if(e.isError(n))return n;var r=s.tagClass[n>>6];var i=(n&32)===0;if((n&31)===31){var o=n;n=0;while((o&128)===128){o=e.readUInt8(t);if(e.isError(o))return o;n<<=7;n|=o&127}}else{n&=31}var a=s.tag[n];return{cls:r,primitive:i,tag:n,tagStr:a}}function f(e,t,n){var r=e.readUInt8(n);if(e.isError(r))return r;if(!t&&r===128)return null;if((r&128)===0){return r}var i=r&127;if(i>4)return e.error("length octect is too long");r=0;for(var o=0;o<i;o++){r<<=8;var a=e.readUInt8(n);if(e.isError(a))return a;r|=a}return r}},{"../../asn1":146,inherits:277}],155:[function(e,t,n){var r=n;r.der=e("./der");r.pem=e("./pem")},{"./der":154,"./pem":156}],156:[function(e,t,n){var r=e("inherits");var i=e("buffer").Buffer;var o=e("./der");function a(e){o.call(this,e);this.enc="pem"}r(a,o);t.exports=a;a.prototype.decode=function s(e,t){var n=e.toString().split(/[\r\n]+/g);var r=t.label.toUpperCase();var a=/^-----(BEGIN|END) ([^-]+)-----$/;var s=-1;var u=-1;for(var l=0;l<n.length;l++){var c=n[l].match(a);if(c===null)continue;if(c[2]!==r)continue;if(s===-1){if(c[1]!=="BEGIN")break;s=l}else{if(c[1]!=="END")break;u=l;break}}if(s===-1||u===-1)throw new Error("PEM section not found for: "+r);var f=n.slice(s+1,u).join("");f.replace(/[^a-z0-9\+\/=]+/gi,"");var d=new i(f,"base64");return o.prototype.decode.call(this,d,t)}},{"./der":154,buffer:79,inherits:277}],157:[function(e,t,n){var r=e("inherits");var i=e("buffer").Buffer;var o=e("../../asn1");var a=o.base;var s=o.constants.der;function u(e){this.enc="der";this.name=e.name;this.entity=e;this.tree=new l;this.tree._init(e.body)}t.exports=u;u.prototype.encode=function d(e,t){return this.tree._encode(e,t).join()};function l(e){a.Node.call(this,"der",e)}r(l,a.Node);l.prototype._encodeComposite=function _(e,t,n,r){var o=f(e,t,n,this.reporter);if(r.length<128){var a=new i(2);a[0]=o;a[1]=r.length;return this._createEncoderBuffer([a,r])}var s=1;for(var u=r.length;u>=256;u>>=8)s++;var a=new i(1+1+s);a[0]=o;a[1]=128|s;for(var u=1+s,l=r.length;l>0;u--,l>>=8)a[u]=l&255;return this._createEncoderBuffer([a,r])};l.prototype._encodeStr=function p(e,t){if(t==="bitstr"){return this._createEncoderBuffer([e.unused|0,e.data])}else if(t==="bmpstr"){var n=new i(e.length*2);for(var r=0;r<e.length;r++){n.writeUInt16BE(e.charCodeAt(r),r*2)}return this._createEncoderBuffer(n)}else if(t==="numstr"){if(!this._isNumstr(e)){return this.reporter.error("Encoding of string type: numstr supports "+"only digits and space")}return this._createEncoderBuffer(e)}else if(t==="printstr"){if(!this._isPrintstr(e)){return this.reporter.error("Encoding of string type: printstr supports "+"only latin upper and lower case letters, "+"digits, space, apostrophe, left and rigth "+"parenthesis, plus sign, comma, hyphen, "+"dot, slash, colon, equal sign, "+"question mark")}return this._createEncoderBuffer(e)}else if(/str$/.test(t)){return this._createEncoderBuffer(e)}else if(t==="objDesc"){return this._createEncoderBuffer(e)}else{return this.reporter.error("Encoding of string type: "+t+" unsupported")}};l.prototype._encodeObjid=function h(e,t,n){if(typeof e==="string"){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s\.]+/g);for(var r=0;r<e.length;r++)e[r]|=0}else if(Array.isArray(e)){e=e.slice();for(var r=0;r<e.length;r++)e[r]|=0}if(!Array.isArray(e)){return this.reporter.error("objid() should be either array or string, "+"got: "+JSON.stringify(e))}if(!n){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,e[0]*40+e[1])}var o=0;for(var r=0;r<e.length;r++){var a=e[r];for(o++;a>=128;a>>=7)o++}var s=new i(o);var u=s.length-1;for(var r=e.length-1;r>=0;r--){var a=e[r];s[u--]=a&127;while((a>>=7)>0)s[u--]=128|a&127}return this._createEncoderBuffer(s)};function c(e){if(e<10)return"0"+e;else return e}l.prototype._encodeTime=function g(e,t){var n;var r=new Date(e);if(t==="gentime"){n=[c(r.getFullYear()),c(r.getUTCMonth()+1),c(r.getUTCDate()),c(r.getUTCHours()),c(r.getUTCMinutes()),c(r.getUTCSeconds()),"Z"].join("")}else if(t==="utctime"){n=[c(r.getFullYear()%100),c(r.getUTCMonth()+1),c(r.getUTCDate()),c(r.getUTCHours()),c(r.getUTCMinutes()),c(r.getUTCSeconds()),"Z"].join("")}else{this.reporter.error("Encoding "+t+" time is not supported yet")}return this._encodeStr(n,"octstr")};l.prototype._encodeNull=function m(){return this._createEncoderBuffer("")};l.prototype._encodeInt=function v(e,t){if(typeof e==="string"){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e)){return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e))}e=t[e]}if(typeof e!=="number"&&!i.isBuffer(e)){var n=e.toArray();if(!e.sign&&n[0]&128){n.unshift(0)}e=new i(n)}if(i.isBuffer(e)){var r=e.length;if(e.length===0)r++;var o=new i(r);e.copy(o);if(e.length===0)o[0]=0;return this._createEncoderBuffer(o)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);var r=1;for(var a=e;a>=256;a>>=8)r++;var o=new Array(r);for(var a=o.length-1;a>=0;a--){o[a]=e&255;e>>=8}if(o[0]&128){o.unshift(0)}return this._createEncoderBuffer(new i(o))};l.prototype._encodeBool=function y(e){return this._createEncoderBuffer(e?255:0)};l.prototype._use=function b(e,t){if(typeof e==="function")e=e(t);return e._getEncoder("der").tree};l.prototype._skipDefault=function w(e,t,n){var r=this._baseState;var i;if(r["default"]===null)return false;var o=e.join();if(r.defaultBuffer===undefined)r.defaultBuffer=this._encodeValue(r["default"],t,n).join();if(o.length!==r.defaultBuffer.length)return false;for(i=0;i<o.length;i++)if(o[i]!==r.defaultBuffer[i])return false;return true};function f(e,t,n,r){var i;if(e==="seqof")e="seq";else if(e==="setof")e="set";if(s.tagByName.hasOwnProperty(e))i=s.tagByName[e];else if(typeof e==="number"&&(e|0)===e)i=e;else return r.error("Unknown tag: "+e);if(i>=31)return r.error("Multi-octet tag encoding unsupported");if(!t)i|=32;i|=s.tagClassByName[n||"universal"]<<6;return i}},{"../../asn1":146,buffer:79,inherits:277}],158:[function(e,t,n){var r=n;r.der=e("./der");r.pem=e("./pem")},{"./der":157,"./pem":159}],159:[function(e,t,n){var r=e("inherits");var i=e("./der");function o(e){i.call(this,e);this.enc="pem"}r(o,i);t.exports=o;o.prototype.encode=function a(e,t){var n=i.prototype.encode.call(this,e);var r=n.toString("base64");var o=["-----BEGIN "+t.label+"-----"];for(var a=0;a<r.length;a+=64)o.push(r.slice(a,a+64));o.push("-----END "+t.label+"-----");return o.join("\n")}},{"./der":157,inherits:277}],160:[function(e,t,n){t.exports=e(111)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-des/node_modules/des.js/node_modules/minimalistic-assert/index.js":111}],161:[function(e,t,n){t.exports=e(85)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/aes.js":85,buffer:79}],162:[function(e,t,n){t.exports=e(86)},{"./aes":161,"./ghash":166,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/authCipher.js":86,buffer:79,"buffer-xor":175,"cipher-base":176,inherits:277}],163:[function(e,t,n){t.exports=e(87)},{"./decrypter":164,"./encrypter":165,"./modes":167,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/browser.js":87}],164:[function(e,t,n){t.exports=e(88)},{"./aes":161,"./authCipher":162,"./modes":167,"./modes/cbc":168,"./modes/cfb":169,"./modes/cfb1":170,"./modes/cfb8":171,"./modes/ctr":172,"./modes/ecb":173,"./modes/ofb":174,"./streamCipher":177,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/decrypter.js":88,buffer:79,"cipher-base":176,evp_bytestokey:178,inherits:277}],165:[function(e,t,n){t.exports=e(89)},{"./aes":161,"./authCipher":162,"./modes":167,"./modes/cbc":168,"./modes/cfb":169,"./modes/cfb1":170,"./modes/cfb8":171,"./modes/ctr":172,"./modes/ecb":173,"./modes/ofb":174,"./streamCipher":177,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/encrypter.js":89,buffer:79,"cipher-base":176,evp_bytestokey:178,inherits:277}],166:[function(e,t,n){t.exports=e(90)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/ghash.js":90,buffer:79}],167:[function(e,t,n){t.exports=e(91)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes.js":91}],168:[function(e,t,n){t.exports=e(92)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/cbc.js":92,"buffer-xor":175}],169:[function(e,t,n){t.exports=e(93)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/cfb.js":93,buffer:79,"buffer-xor":175}],170:[function(e,t,n){t.exports=e(94)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/cfb1.js":94,buffer:79}],171:[function(e,t,n){t.exports=e(95)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/cfb8.js":95,buffer:79}],172:[function(e,t,n){t.exports=e(96)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/ctr.js":96,buffer:79,"buffer-xor":175}],173:[function(e,t,n){t.exports=e(97)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/ecb.js":97}],174:[function(e,t,n){t.exports=e(98)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/ofb.js":98,buffer:79,"buffer-xor":175}],175:[function(e,t,n){t.exports=e(99)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/node_modules/buffer-xor/index.js":99,buffer:79}],176:[function(e,t,n){t.exports=e(100)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/node_modules/cipher-base/index.js":100,buffer:79,inherits:277,stream:297,string_decoder:298}],177:[function(e,t,n){t.exports=e(101)},{"./aes":161,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/streamCipher.js":101,buffer:79,"cipher-base":176,inherits:277}],178:[function(e,t,n){t.exports=e(112)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/evp_bytestokey/index.js":112,buffer:79,"create-hash/md5":209}],179:[function(e,t,n){(function(n){var r=e("create-hmac");var i=e("browserify-rsa");var o=e("./curves");var a=e("elliptic");var s=e("parse-asn1");var u=e("bn.js");var l=a.ec;function c(e,t,n,r){var o=s(t);if(o.curve){if(r!=="ecdsa")throw new Error("wrong private key type");return f(e,o)}else if(o.type==="dsa"){if(r!=="dsa"){throw new Error("wrong private key type")}return d(e,o,n)}else{if(r!=="rsa")throw new Error("wrong private key type")}var a=o.modulus.byteLength();var u=[0,1];while(e.length+u.length+1<a){u.push(255)}u.push(0);var l=-1;while(++l<e.length){u.push(e[l])}var c=i(u,o);return c}function f(e,t){var r=o[t.curve.join(".")];if(!r)throw new Error("unknown curve "+t.curve.join("."));var i=new l(r);var a=i.genKeyPair();a._importPrivate(t.privateKey);var s=a.sign(e);return new n(s.toDER())}function d(e,t,n){var r=t.params.priv_key;var i=t.params.p;var o=t.params.q;var a=t.params.g;var s=new u(0);var l;var c=h(e,o).mod(o);var f=false;var d=p(r,o,e,n);while(f===false){l=m(o,d,n);s=v(a,l,i,o);f=l.invm(o).imul(c.add(r.mul(s))).mod(o);if(!f.cmpn(0)){f=false;s=new u(0)}}return _(s,f)}function _(e,t){e=e.toArray();t=t.toArray();if(e[0]&128){e=[0].concat(e)}if(t[0]&128){t=[0].concat(t)}var r=e.length+t.length+4;var i=[48,r,2,e.length];i=i.concat(e,[2,t.length],t);return new n(i)}function p(e,t,i,o){e=new n(e.toArray());if(e.length<t.byteLength()){var a=new n(t.byteLength()-e.length);a.fill(0);e=n.concat([a,e])}var s=i.length;var u=g(i,t);var l=new n(s);l.fill(1);var c=new n(s);c.fill(0);c=r(o,c).update(l).update(new n([0])).update(e).update(u).digest();l=r(o,c).update(l).digest();c=r(o,c).update(l).update(new n([1])).update(e).update(u).digest();l=r(o,c).update(l).digest();return{k:c,v:l}}function h(e,t){var n=new u(e);var r=(e.length<<3)-t.bitLength();if(r>0){n.ishrn(r)}return n}function g(e,t){e=h(e,t);e=e.mod(t);var r=new n(e.toArray());if(r.length<t.byteLength()){var i=new n(t.byteLength()-r.length);i.fill(0);r=n.concat([i,r])}return r}function m(e,t,i){var o,a;do{o=new n("");while(o.length*8<e.bitLength()){t.v=r(i,t.k).update(t.v).digest();o=n.concat([o,t.v])}a=h(o,e);t.k=r(i,t.k).update(t.v).update(new n([0])).digest();t.v=r(i,t.k).update(t.v).digest()}while(a.cmp(e)!==-1);return a}function v(e,t,n,r){return e.toRed(u.mont(n)).redPow(t).fromRed().mod(r)}t.exports=c;t.exports.getKey=p;t.exports.makeKey=m}).call(this,e("buffer").Buffer)},{"./curves":115,"bn.js":116,"browserify-rsa":117,buffer:79,"create-hmac":220,elliptic:118,"parse-asn1":145}],180:[function(e,t,n){(function(n){var r=e("./curves");var i=e("elliptic");var o=e("parse-asn1");var a=e("bn.js");var s=i.ec;function u(e,t,r,i){var s=o(r);if(s.type==="ec"){if(i!=="ecdsa"){throw new Error("wrong public key type")}return l(e,t,s)}else if(s.type==="dsa"){if(i!=="dsa"){throw new Error("wrong public key type")}return c(e,t,s)}else{if(i!=="rsa"){throw new Error("wrong public key type")}}var u=s.modulus.byteLength();var f=[1];var d=0;while(t.length+f.length+2<u){f.push(255);d++}f.push(0);var _=-1;while(++_<t.length){f.push(t[_])}f=new n(f);var p=a.mont(s.modulus);e=new a(e).toRed(p);e=e.redPow(new a(s.publicExponent));e=new n(e.fromRed().toArray());var h=0;if(d<8){h=1}u=Math.min(e.length,f.length);if(e.length!==f.length){h=1}_=-1;while(++_<u){h|=e[_]^f[_]}return h===0}function l(e,t,n){var i=r[n.data.algorithm.curve.join(".")];if(!i)throw new Error("unknown curve "+n.data.algorithm.curve.join("."));var o=new s(i);var a=n.data.subjectPrivateKey.data;return o.verify(t,e,a)}function c(e,t,n){var r=n.data.p;var i=n.data.q;var s=n.data.g;var u=n.data.pub_key;var l=o.signature.decode(e,"der");var c=l.s;var d=l.r;f(c,i);f(d,i);var _=a.mont(r);var p=c.invm(i);var h=s.toRed(_).redPow(new a(t).mul(p).mod(i)).fromRed().mul(u.toRed(_).redPow(d.mul(p).mod(i)).fromRed()).mod(r).mod(i);return!h.cmp(d)}function f(e,t){if(e.cmpn(0)<=0){throw new Error("invalid sig")}if(e.cmp(t)>=t){throw new Error("invalid sig")}}t.exports=u}).call(this,e("buffer").Buffer)},{"./curves":115,"bn.js":116,buffer:79,elliptic:118,"parse-asn1":145}],181:[function(e,t,n){(function(n){var r=e("elliptic");var i=e("bn.js");t.exports=function u(e){return new a(e)};var o={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};o.p224=o.secp224r1;o.p256=o.secp256r1=o.prime256v1;o.p192=o.secp192r1=o.prime192v1;o.p384=o.secp384r1;o.p521=o.secp521r1;function a(e){this.curveType=o[e];if(!this.curveType){this.curveType={name:e}}this.curve=new r.ec(this.curveType.name);this.keys=void 0}a.prototype.generateKeys=function(e,t){this.keys=this.curve.genKeyPair();return this.getPublicKey(e,t)};a.prototype.computeSecret=function(e,t,r){t=t||"utf8";if(!n.isBuffer(e)){e=new n(e,t)}var i=this.curve.keyFromPublic(e).getPublic();var o=i.mul(this.keys.getPrivate()).getX();return s(o,r,this.curveType.byteLength)};a.prototype.getPublicKey=function(e,t){var n=this.keys.getPublic(t==="compressed",true);if(t==="hybrid"){if(n[n.length-1]%2){n[0]=7}else{n[0]=6}}return s(n,e)};a.prototype.getPrivateKey=function(e){return s(this.keys.getPrivate(),e)};a.prototype.setPublicKey=function(e,t){t=t||"utf8";if(!n.isBuffer(e)){e=new n(e,t)}this.keys._importPublic(e);return this};a.prototype.setPrivateKey=function(e,t){t=t||"utf8";if(!n.isBuffer(e)){e=new n(e,t)}var r=new i(e);r=r.toString(16);this.keys._importPrivate(r);return this};function s(e,t,r){if(!Array.isArray(e)){e=e.toArray()}var i=new n(e);if(r&&i.length<r){var o=new n(r-i.length);o.fill(0);i=n.concat([o,i])}if(!t){return i}else{return i.toString(t)}}}).call(this,e("buffer").Buffer)},{"bn.js":182,buffer:79,elliptic:183}],182:[function(e,t,n){t.exports=e(116)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/bn.js/lib/bn.js":116}],183:[function(e,t,n){t.exports=e(118)},{"../package.json":206,"./elliptic/curve":186,"./elliptic/curves":189,"./elliptic/ec":190,"./elliptic/eddsa":193,"./elliptic/hmac-drbg":196,"./elliptic/utils":198,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic.js":118,brorand:199}],184:[function(e,t,n){t.exports=e(119)},{"../../elliptic":183,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/curve/base.js":119,"bn.js":182}],185:[function(e,t,n){t.exports=e(120)},{"../../elliptic":183,"../curve":186,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/curve/edwards.js":120,"bn.js":182,inherits:277}],186:[function(e,t,n){t.exports=e(121)},{"./base":184,"./edwards":185,"./mont":187,"./short":188,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/curve/index.js":121}],187:[function(e,t,n){t.exports=e(122)},{"../../elliptic":183,"../curve":186,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/curve/mont.js":122,"bn.js":182,inherits:277}],188:[function(e,t,n){t.exports=e(123)},{"../../elliptic":183,"../curve":186,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/curve/short.js":123,"bn.js":182,inherits:277}],189:[function(e,t,n){t.exports=e(124)},{"../elliptic":183,"./precomputed/secp256k1":197,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/curves.js":124,"hash.js":200}],190:[function(e,t,n){t.exports=e(125)},{"../../elliptic":183,"./key":191,"./signature":192,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/ec/index.js":125,"bn.js":182}],191:[function(e,t,n){t.exports=e(126)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/ec/key.js":126,"bn.js":182}],192:[function(e,t,n){t.exports=e(127)},{"../../elliptic":183,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/ec/signature.js":127,"bn.js":182}],193:[function(e,t,n){t.exports=e(128)},{"../../elliptic":183,"./key":194,"./signature":195,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/eddsa/index.js":128,"hash.js":200}],194:[function(e,t,n){t.exports=e(129)},{"../../elliptic":183,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/eddsa/key.js":129}],195:[function(e,t,n){t.exports=e(130)},{"../../elliptic":183,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/eddsa/signature.js":130,"bn.js":182}],196:[function(e,t,n){t.exports=e(131)},{"../elliptic":183,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/hmac-drbg.js":131,"hash.js":200}],197:[function(e,t,n){t.exports=e(132)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/precomputed/secp256k1.js":132}],198:[function(e,t,n){t.exports=e(133)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/lib/elliptic/utils.js":133,"bn.js":182}],199:[function(e,t,n){t.exports=e(134)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/node_modules/brorand/index.js":134,crypto:78}],200:[function(e,t,n){t.exports=e(135)},{"./hash/common":201,"./hash/hmac":202,"./hash/ripemd":203,"./hash/sha":204,"./hash/utils":205,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/node_modules/hash.js/lib/hash.js":135}],201:[function(e,t,n){t.exports=e(136)},{"../hash":200,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/node_modules/hash.js/lib/hash/common.js":136}],202:[function(e,t,n){t.exports=e(137)},{"../hash":200,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/node_modules/hash.js/lib/hash/hmac.js":137}],203:[function(e,t,n){t.exports=e(138)},{"../hash":200,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/node_modules/hash.js/lib/hash/ripemd.js":138}],204:[function(e,t,n){t.exports=e(139)},{"../hash":200,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/node_modules/hash.js/lib/hash/sha.js":139}],205:[function(e,t,n){t.exports=e(140)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/node_modules/hash.js/lib/hash/utils.js":140,inherits:277}],206:[function(e,t,n){t.exports=e(141)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/package.json":141}],207:[function(e,t,n){(function(n){"use strict";var r=e("inherits");var i=e("./md5");var o=e("ripemd160");var a=e("sha.js");var s=e("cipher-base");function u(e){s.call(this,"digest");this._hash=e;this.buffers=[]}r(u,s);u.prototype._update=function(e){this.buffers.push(e)};u.prototype._final=function(){var e=n.concat(this.buffers);var t=this._hash(e);this.buffers=null;return t};function l(e){s.call(this,"digest");this._hash=e}r(l,s);l.prototype._update=function(e){this._hash.update(e)};l.prototype._final=function(){return this._hash.digest()};t.exports=function c(e){e=e.toLowerCase();if("md5"===e)return new u(i);if("rmd160"===e||"ripemd160"===e)return new u(o);return new l(a(e))}}).call(this,e("buffer").Buffer)},{"./md5":209,buffer:79,"cipher-base":210,inherits:277,ripemd160:211,"sha.js":213}],208:[function(e,t,n){(function(e){"use strict";var t=4;var r=new e(t);r.fill(0);var i=8;function o(n,i){if(n.length%t!==0){var o=n.length+(t-n.length%t);n=e.concat([n,r],o)}var a=[];var s=i?n.readInt32BE:n.readInt32LE;for(var u=0;u<n.length;u+=t){a.push(s.call(n,u))}return a}function a(t,n,r){var i=new e(n);var o=r?i.writeInt32BE:i.writeInt32LE;for(var a=0;a<t.length;a++){o.call(i,t[a],a*4,true)}return i}function s(t,n,r,s){if(!e.isBuffer(t))t=new e(t);var u=n(o(t,s),t.length*i);return a(u,r,s)}n.hash=s}).call(this,e("buffer").Buffer)},{buffer:79}],209:[function(e,t,n){"use strict";/*
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.1 Copyright (C) Paul Johnston 1999 - 2002.
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */
var r=e("./helpers");function i(e,t){e[t>>5]|=128<<t%32;e[(t+64>>>9<<4)+14]=t;var n=1732584193;var r=-271733879;var i=-1732584194;var o=271733878;for(var f=0;f<e.length;f+=16){var d=n;var _=r;var p=i;var h=o;n=a(n,r,i,o,e[f+0],7,-680876936);o=a(o,n,r,i,e[f+1],12,-389564586);i=a(i,o,n,r,e[f+2],17,606105819);r=a(r,i,o,n,e[f+3],22,-1044525330);n=a(n,r,i,o,e[f+4],7,-176418897);o=a(o,n,r,i,e[f+5],12,1200080426);i=a(i,o,n,r,e[f+6],17,-1473231341);r=a(r,i,o,n,e[f+7],22,-45705983);n=a(n,r,i,o,e[f+8],7,1770035416);o=a(o,n,r,i,e[f+9],12,-1958414417);i=a(i,o,n,r,e[f+10],17,-42063);r=a(r,i,o,n,e[f+11],22,-1990404162);n=a(n,r,i,o,e[f+12],7,1804603682);o=a(o,n,r,i,e[f+13],12,-40341101);i=a(i,o,n,r,e[f+14],17,-1502002290);r=a(r,i,o,n,e[f+15],22,1236535329);n=s(n,r,i,o,e[f+1],5,-165796510);o=s(o,n,r,i,e[f+6],9,-1069501632);i=s(i,o,n,r,e[f+11],14,643717713);r=s(r,i,o,n,e[f+0],20,-373897302);n=s(n,r,i,o,e[f+5],5,-701558691);o=s(o,n,r,i,e[f+10],9,38016083);i=s(i,o,n,r,e[f+15],14,-660478335);r=s(r,i,o,n,e[f+4],20,-405537848);n=s(n,r,i,o,e[f+9],5,568446438);o=s(o,n,r,i,e[f+14],9,-1019803690);i=s(i,o,n,r,e[f+3],14,-187363961);r=s(r,i,o,n,e[f+8],20,1163531501);n=s(n,r,i,o,e[f+13],5,-1444681467);o=s(o,n,r,i,e[f+2],9,-51403784);i=s(i,o,n,r,e[f+7],14,1735328473);r=s(r,i,o,n,e[f+12],20,-1926607734);n=u(n,r,i,o,e[f+5],4,-378558);o=u(o,n,r,i,e[f+8],11,-2022574463);i=u(i,o,n,r,e[f+11],16,1839030562);r=u(r,i,o,n,e[f+14],23,-35309556);n=u(n,r,i,o,e[f+1],4,-1530992060);o=u(o,n,r,i,e[f+4],11,1272893353);i=u(i,o,n,r,e[f+7],16,-155497632);r=u(r,i,o,n,e[f+10],23,-1094730640);n=u(n,r,i,o,e[f+13],4,681279174);o=u(o,n,r,i,e[f+0],11,-358537222);i=u(i,o,n,r,e[f+3],16,-722521979);r=u(r,i,o,n,e[f+6],23,76029189);n=u(n,r,i,o,e[f+9],4,-640364487);o=u(o,n,r,i,e[f+12],11,-421815835);i=u(i,o,n,r,e[f+15],16,530742520);r=u(r,i,o,n,e[f+2],23,-995338651);n=l(n,r,i,o,e[f+0],6,-198630844);o=l(o,n,r,i,e[f+7],10,1126891415);i=l(i,o,n,r,e[f+14],15,-1416354905);r=l(r,i,o,n,e[f+5],21,-57434055);n=l(n,r,i,o,e[f+12],6,1700485571);o=l(o,n,r,i,e[f+3],10,-1894986606);i=l(i,o,n,r,e[f+10],15,-1051523);r=l(r,i,o,n,e[f+1],21,-2054922799);n=l(n,r,i,o,e[f+8],6,1873313359);o=l(o,n,r,i,e[f+15],10,-30611744);i=l(i,o,n,r,e[f+6],15,-1560198380);r=l(r,i,o,n,e[f+13],21,1309151649);n=l(n,r,i,o,e[f+4],6,-145523070);o=l(o,n,r,i,e[f+11],10,-1120210379);i=l(i,o,n,r,e[f+2],15,718787259);r=l(r,i,o,n,e[f+9],21,-343485551);n=c(n,d);r=c(r,_);i=c(i,p);o=c(o,h)}return Array(n,r,i,o)}function o(e,t,n,r,i,o){return c(f(c(c(t,e),c(r,o)),i),n)}function a(e,t,n,r,i,a,s){return o(t&n|~t&r,e,t,i,a,s)}function s(e,t,n,r,i,a,s){return o(t&r|n&~r,e,t,i,a,s)}function u(e,t,n,r,i,a,s){return o(t^n^r,e,t,i,a,s)}function l(e,t,n,r,i,a,s){return o(n^(t|~r),e,t,i,a,s)}function c(e,t){var n=(e&65535)+(t&65535);var r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function f(e,t){return e<<t|e>>>32-t}t.exports=function d(e){return r.hash(e,i,16)}},{"./helpers":208}],210:[function(e,t,n){t.exports=e(100)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/node_modules/cipher-base/index.js":100,buffer:79,inherits:277,stream:297,string_decoder:298}],211:[function(e,t,n){(function(e){/** @preserve
(c) 2012 by Cédric Mesnil. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
var n=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var r=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var i=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var o=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];var a=[0,1518500249,1859775393,2400959708,2840853838];var s=[1352829926,1548603684,1836072691,2053994217,0];function u(e){var t=[];for(var n=0,r=0;n<e.length;n++,r+=8){t[r>>>5]|=e[n]<<24-r%32}return t}function l(e){var t=[];for(var n=0;n<e.length*32;n+=8){t.push(e[n>>>5]>>>24-n%32&255)}return t}function c(e,t,u){for(var l=0;l<16;l++){var c=u+l;var m=t[c];t[c]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360}var v,y,b,w,x;var k,S,A,E,M;k=v=e[0];S=y=e[1];A=b=e[2];E=w=e[3];M=x=e[4];var T;for(l=0;l<80;l+=1){T=v+t[u+n[l]]|0;if(l<16){T+=f(y,b,w)+a[0]}else if(l<32){T+=d(y,b,w)+a[1]}else if(l<48){T+=_(y,b,w)+a[2]}else if(l<64){T+=p(y,b,w)+a[3]}else{T+=h(y,b,w)+a[4]}T=T|0;T=g(T,i[l]);T=T+x|0;v=x;x=w;w=g(b,10);b=y;y=T;T=k+t[u+r[l]]|0;if(l<16){T+=h(S,A,E)+s[0]}else if(l<32){T+=p(S,A,E)+s[1]}else if(l<48){T+=_(S,A,E)+s[2]}else if(l<64){T+=d(S,A,E)+s[3]}else{T+=f(S,A,E)+s[4]}T=T|0;T=g(T,o[l]);T=T+M|0;k=M;M=E;E=g(A,10);A=S;S=T}T=e[1]+b+E|0;e[1]=e[2]+w+M|0;e[2]=e[3]+x+k|0;e[3]=e[4]+v+S|0;e[4]=e[0]+y+A|0;e[0]=T}function f(e,t,n){return e^t^n}function d(e,t,n){return e&t|~e&n}function _(e,t,n){return(e|~t)^n}function p(e,t,n){return e&n|t&~n}function h(e,t,n){return e^(t|~n)}function g(e,t){return e<<t|e>>>32-t}function m(t){var n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t==="string"){t=new e(t,"utf8")}var r=u(t);var i=t.length*8;var o=t.length*8;r[i>>>5]|=128<<24-i%32;r[(i+64>>>9<<4)+14]=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360;for(var a=0;a<r.length;a+=16){c(n,r,a)}for(a=0;a<5;a++){var s=n[a];n[a]=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360}var f=l(n);return new e(f)}t.exports=m}).call(this,e("buffer").Buffer)},{buffer:79}],212:[function(e,t,n){(function(e){function n(t,n){this._block=new e(t);this._finalSize=n;this._blockSize=t;this._len=0;this._s=0}n.prototype.update=function(t,n){if(typeof t==="string"){n=n||"utf8";t=new e(t,n)}var r=this._len+=t.length;var i=this._s||0;var o=0;var a=this._block;while(i<r){var s=Math.min(t.length,o+this._blockSize-i%this._blockSize);var u=s-o;for(var l=0;l<u;l++){a[i%this._blockSize+l]=t[l+o]}i+=u;o+=u;if(i%this._blockSize===0){this._update(a)}}this._s=i;return this};n.prototype.digest=function(e){var t=this._len*8;this._block[this._len%this._blockSize]=128;this._block.fill(0,this._len%this._blockSize+1);if(t%(this._blockSize*8)>=this._finalSize*8){this._update(this._block);this._block.fill(0)}this._block.writeInt32BE(t,this._blockSize-4);var n=this._update(this._block)||this._hash();return e?n.toString(e):n};n.prototype._update=function(){throw new Error("_update must be implemented by subclass")};t.exports=n}).call(this,e("buffer").Buffer)},{buffer:79}],213:[function(e,t,n){var n=t.exports=function r(e){e=e.toLowerCase();var t=n[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};n.sha=e("./sha");n.sha1=e("./sha1");n.sha224=e("./sha224");n.sha256=e("./sha256");n.sha384=e("./sha384");n.sha512=e("./sha512")},{"./sha":214,"./sha1":215,"./sha224":216,"./sha256":217,"./sha384":218,"./sha512":219}],214:[function(e,t,n){(function(n){var r=e("inherits");var i=e("./hash");var o=[1518500249,1859775393,2400959708|0,3395469782|0];var a=new Array(80);function s(){this.init();this._w=a;i.call(this,64,56)}r(s,i);s.prototype.init=function(){this._a=1732584193;this._b=4023233417;this._c=2562383102;this._d=271733878;this._e=3285377520;return this};function u(e){return e<<5|e>>>27}function l(e){return e<<30|e>>>2}function c(e,t,n,r){if(e===0)return t&n|~t&r;if(e===2)return t&n|t&r|n&r;return t^n^r}s.prototype._update=function(e){var t=this._w;var n=this._a|0;var r=this._b|0;var i=this._c|0;var a=this._d|0;var s=this._e|0;for(var f=0;f<16;++f)t[f]=e.readInt32BE(f*4);for(;f<80;++f)t[f]=t[f-3]^t[f-8]^t[f-14]^t[f-16];for(var d=0;d<80;++d){var _=~~(d/20);var p=u(n)+c(_,r,i,a)+s+t[d]+o[_]|0;s=a;a=i;i=l(r);r=n;n=p}this._a=n+this._a|0;this._b=r+this._b|0;this._c=i+this._c|0;this._d=a+this._d|0;this._e=s+this._e|0};s.prototype._hash=function(){var e=new n(20);e.writeInt32BE(this._a|0,0);e.writeInt32BE(this._b|0,4);e.writeInt32BE(this._c|0,8);e.writeInt32BE(this._d|0,12);e.writeInt32BE(this._e|0,16);return e};t.exports=s}).call(this,e("buffer").Buffer)},{"./hash":212,buffer:79,inherits:277}],215:[function(e,t,n){(function(n){/*
 * A JavaScript implementation of the Secure Hash Algorithm, SHA-1, as defined
 * in FIPS PUB 180-1
 * Version 2.1a Copyright Paul Johnston 2000 - 2002.
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for details.
 */
var r=e("inherits");var i=e("./hash");var o=[1518500249,1859775393,2400959708|0,3395469782|0];var a=new Array(80);function s(){this.init();this._w=a;i.call(this,64,56)}r(s,i);s.prototype.init=function(){this._a=1732584193;this._b=4023233417;this._c=2562383102;this._d=271733878;this._e=3285377520;return this};function u(e){return e<<1|e>>>31}function l(e){return e<<5|e>>>27}function c(e){return e<<30|e>>>2}function f(e,t,n,r){if(e===0)return t&n|~t&r;if(e===2)return t&n|t&r|n&r;return t^n^r}s.prototype._update=function(e){var t=this._w;var n=this._a|0;var r=this._b|0;var i=this._c|0;var a=this._d|0;var s=this._e|0;for(var d=0;d<16;++d)t[d]=e.readInt32BE(d*4);for(;d<80;++d)t[d]=u(t[d-3]^t[d-8]^t[d-14]^t[d-16]);for(var _=0;_<80;++_){var p=~~(_/20);var h=l(n)+f(p,r,i,a)+s+t[_]+o[p]|0;s=a;a=i;i=c(r);r=n;n=h}this._a=n+this._a|0;this._b=r+this._b|0;this._c=i+this._c|0;this._d=a+this._d|0;this._e=s+this._e|0};s.prototype._hash=function(){var e=new n(20);e.writeInt32BE(this._a|0,0);e.writeInt32BE(this._b|0,4);e.writeInt32BE(this._c|0,8);e.writeInt32BE(this._d|0,12);e.writeInt32BE(this._e|0,16);return e};t.exports=s}).call(this,e("buffer").Buffer)},{"./hash":212,buffer:79,inherits:277}],216:[function(e,t,n){(function(n){/**
 * A JavaScript implementation of the Secure Hash Algorithm, SHA-256, as defined
 * in FIPS 180-2
 * Version 2.2-beta Copyright Angel Marin, Paul Johnston 2000 - 2009.
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 *
 */
var r=e("inherits");var i=e("./sha256");var o=e("./hash");var a=new Array(64);function s(){this.init();this._w=a;o.call(this,64,56)}r(s,i);s.prototype.init=function(){this._a=3238371032;this._b=914150663;this._c=812702999;this._d=4144912697;this._e=4290775857;this._f=1750603025;this._g=1694076839;this._h=3204075428;return this};s.prototype._hash=function(){var e=new n(28);e.writeInt32BE(this._a,0);e.writeInt32BE(this._b,4);e.writeInt32BE(this._c,8);e.writeInt32BE(this._d,12);e.writeInt32BE(this._e,16);e.writeInt32BE(this._f,20);e.writeInt32BE(this._g,24);return e};t.exports=s}).call(this,e("buffer").Buffer)},{"./hash":212,"./sha256":217,buffer:79,inherits:277}],217:[function(e,t,n){(function(n){/**
 * A JavaScript implementation of the Secure Hash Algorithm, SHA-256, as defined
 * in FIPS 180-2
 * Version 2.2-beta Copyright Angel Marin, Paul Johnston 2000 - 2009.
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 *
 */
var r=e("inherits");var i=e("./hash");var o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];var a=new Array(64);function s(){this.init();this._w=a;i.call(this,64,56)}r(s,i);s.prototype.init=function(){this._a=1779033703;this._b=3144134277;this._c=1013904242;this._d=2773480762;this._e=1359893119;this._f=2600822924;this._g=528734635;this._h=1541459225;return this};function u(e,t,n){return n^e&(t^n)}function l(e,t,n){return e&t|n&(e|t)}function c(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function f(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function d(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}function _(e){return(e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10}s.prototype._update=function(e){var t=this._w;var n=this._a|0;var r=this._b|0;var i=this._c|0;var a=this._d|0;var s=this._e|0;var p=this._f|0;var h=this._g|0;var g=this._h|0;for(var m=0;m<16;++m)t[m]=e.readInt32BE(m*4);for(;m<64;++m)t[m]=_(t[m-2])+t[m-7]+d(t[m-15])+t[m-16]|0;for(var v=0;v<64;++v){var y=g+f(s)+u(s,p,h)+o[v]+t[v]|0;var b=c(n)+l(n,r,i)|0;g=h;h=p;p=s;s=a+y|0;a=i;i=r;r=n;n=y+b|0}this._a=n+this._a|0;this._b=r+this._b|0;this._c=i+this._c|0;this._d=a+this._d|0;this._e=s+this._e|0;this._f=p+this._f|0;this._g=h+this._g|0;this._h=g+this._h|0};s.prototype._hash=function(){var e=new n(32);e.writeInt32BE(this._a,0);e.writeInt32BE(this._b,4);e.writeInt32BE(this._c,8);e.writeInt32BE(this._d,12);e.writeInt32BE(this._e,16);e.writeInt32BE(this._f,20);e.writeInt32BE(this._g,24);e.writeInt32BE(this._h,28);return e};t.exports=s}).call(this,e("buffer").Buffer)},{"./hash":212,buffer:79,inherits:277}],218:[function(e,t,n){(function(n){var r=e("inherits");var i=e("./sha512");var o=e("./hash");var a=new Array(160);function s(){this.init();this._w=a;o.call(this,128,112)}r(s,i);s.prototype.init=function(){this._ah=3418070365;this._bh=1654270250;this._ch=2438529370;this._dh=355462360;this._eh=1731405415;this._fh=2394180231;this._gh=3675008525;this._hh=1203062813;this._al=3238371032;this._bl=914150663;this._cl=812702999;this._dl=4144912697;this._el=4290775857;this._fl=1750603025;this._gl=1694076839;this._hl=3204075428;return this};s.prototype._hash=function(){var e=new n(48);function t(t,n,r){e.writeInt32BE(t,r);e.writeInt32BE(n,r+4)}t(this._ah,this._al,0);t(this._bh,this._bl,8);t(this._ch,this._cl,16);t(this._dh,this._dl,24);t(this._eh,this._el,32);t(this._fh,this._fl,40);return e};t.exports=s}).call(this,e("buffer").Buffer)},{"./hash":212,"./sha512":219,buffer:79,inherits:277}],219:[function(e,t,n){(function(n){var r=e("inherits");var i=e("./hash");var o=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];var a=new Array(160);function s(){this.init();this._w=a;i.call(this,128,112)}r(s,i);s.prototype.init=function(){this._ah=1779033703;this._bh=3144134277;this._ch=1013904242;this._dh=2773480762;this._eh=1359893119;this._fh=2600822924;this._gh=528734635;this._hh=1541459225;this._al=4089235720;this._bl=2227873595;this._cl=4271175723;this._dl=1595750129;this._el=2917565137;this._fl=725511199;this._gl=4215389547;this._hl=327033209;return this};function u(e,t,n){return n^e&(t^n)}function l(e,t,n){return e&t|n&(e|t)}function c(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function f(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function d(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function _(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function p(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function h(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function g(e,t){return e>>>0<t>>>0?1:0}s.prototype._update=function(e){var t=this._w;var n=this._ah|0;var r=this._bh|0;var i=this._ch|0;var a=this._dh|0;var s=this._eh|0;var m=this._fh|0;var v=this._gh|0;var y=this._hh|0;var b=this._al|0;var w=this._bl|0;var x=this._cl|0;var k=this._dl|0;var S=this._el|0;var A=this._fl|0;var E=this._gl|0;var M=this._hl|0;for(var T=0;T<32;T+=2){t[T]=e.readInt32BE(T*4);t[T+1]=e.readInt32BE(T*4+4)}for(;T<160;T+=2){var C=t[T-15*2];var j=t[T-15*2+1];var D=d(C,j);var O=_(j,C);C=t[T-2*2];j=t[T-2*2+1];var I=p(C,j);var P=h(j,C);var R=t[T-7*2];var z=t[T-7*2+1];var B=t[T-16*2];var N=t[T-16*2+1];var L=O+z|0;var q=D+R+g(L,O)|0;L=L+P|0;q=q+I+g(L,P)|0;L=L+N|0;q=q+B+g(L,N)|0;t[T]=q;t[T+1]=L}for(var U=0;U<160;U+=2){q=t[U];L=t[U+1];var F=l(n,r,i);var W=l(b,w,x);var G=c(n,b);var V=c(b,n);var Y=f(s,S);var H=f(S,s);var $=o[U];var K=o[U+1];var J=u(s,m,v);var X=u(S,A,E);var Z=M+H|0;var Q=y+Y+g(Z,M)|0;Z=Z+X|0;Q=Q+J+g(Z,X)|0;Z=Z+K|0;Q=Q+$+g(Z,K)|0;Z=Z+L|0;Q=Q+q+g(Z,L)|0;var ee=V+W|0;var te=G+F+g(ee,V)|0;y=v;M=E;v=m;E=A;m=s;A=S;S=k+Z|0;s=a+Q+g(S,k)|0;a=i;k=x;i=r;x=w;r=n;w=b;b=Z+ee|0;n=Q+te+g(b,Z)|0}this._al=this._al+b|0;this._bl=this._bl+w|0;this._cl=this._cl+x|0;this._dl=this._dl+k|0;this._el=this._el+S|0;this._fl=this._fl+A|0;this._gl=this._gl+E|0;this._hl=this._hl+M|0;this._ah=this._ah+n+g(this._al,b)|0;this._bh=this._bh+r+g(this._bl,w)|0;this._ch=this._ch+i+g(this._cl,x)|0;this._dh=this._dh+a+g(this._dl,k)|0;this._eh=this._eh+s+g(this._el,S)|0;this._fh=this._fh+m+g(this._fl,A)|0;this._gh=this._gh+v+g(this._gl,E)|0;this._hh=this._hh+y+g(this._hl,M)|0};s.prototype._hash=function(){var e=new n(64);function t(t,n,r){e.writeInt32BE(t,r);e.writeInt32BE(n,r+4)}t(this._ah,this._al,0);t(this._bh,this._bl,8);t(this._ch,this._cl,16);t(this._dh,this._dl,24);t(this._eh,this._el,32);t(this._fh,this._fl,40);t(this._gh,this._gl,48);t(this._hh,this._hl,56);return e};t.exports=s}).call(this,e("buffer").Buffer)},{"./hash":212,buffer:79,inherits:277}],220:[function(e,t,n){(function(n){"use strict";var r=e("create-hash/browser");var i=e("inherits");var o=e("stream").Transform;var a=new n(128);a.fill(0);function s(e,t){o.call(this);e=e.toLowerCase();if(typeof t==="string"){t=new n(t)}var i=e==="sha512"||e==="sha384"?128:64;this._alg=e;this._key=t;if(t.length>i){t=r(e).update(t).digest()}else if(t.length<i){t=n.concat([t,a],i)}var s=this._ipad=new n(i);var u=this._opad=new n(i);for(var l=0;l<i;l++){s[l]=t[l]^54;u[l]=t[l]^92}this._hash=r(e).update(s)}i(s,o);s.prototype.update=function(e,t){this._hash.update(e,t);return this};s.prototype._transform=function(e,t,n){this._hash.update(e);n()};s.prototype._flush=function(e){this.push(this.digest());e()};s.prototype.digest=function(e){var t=this._hash.digest();return r(this._alg).update(this._opad).update(t).digest(e)};t.exports=function u(e,t){return new s(e,t)}}).call(this,e("buffer").Buffer)},{buffer:79,"create-hash/browser":207,inherits:277,stream:297}],221:[function(e,t,n){(function(t){var r=e("./lib/generatePrime");var i=e("./lib/primes.json");var o=e("./lib/dh");function a(e){var n=new t(i[e].prime,"hex");var r=new t(i[e].gen,"hex");return new o(n,r)}var s={binary:true,hex:true,base64:true};function u(e,n,i,a){if(t.isBuffer(n)||s[n]===undefined){return u(e,"binary",n,i)}n=n||"binary";a=a||"binary";i=i||new t([2]);if(!t.isBuffer(i)){i=new t(i,a)}if(typeof e==="number"){return new o(r(e,i),i,true)}if(!t.isBuffer(e)){e=new t(e,n)}return new o(e,i,true)}n.DiffieHellmanGroup=n.createDiffieHellmanGroup=n.getDiffieHellman=a;n.createDiffieHellman=n.DiffieHellman=u}).call(this,e("buffer").Buffer)},{"./lib/dh":222,"./lib/generatePrime":223,"./lib/primes.json":224,buffer:79}],222:[function(e,t,n){(function(n){var r=e("bn.js");var i=e("miller-rabin");var o=new i;var a=new r(24);var s=new r(11);var u=new r(10);var l=new r(3);var c=new r(7);var f=e("./generatePrime");var d=e("randombytes");t.exports=m;function _(e,t){t=t||"utf8";if(!n.isBuffer(e)){e=new n(e,t)}this._pub=new r(e);return this}function p(e,t){t=t||"utf8";if(!n.isBuffer(e)){e=new n(e,t)}this._priv=new r(e);return this}var h={};function g(e,t){var n=t.toString("hex");var r=[n,e.toString(16)].join("_");if(r in h){return h[r]}var i=0;if(e.isEven()||!f.simpleSieve||!f.fermatTest(e)||!o.test(e)){i+=1;if(n==="02"||n==="05"){i+=8}else{i+=4}h[r]=i;return i}if(!o.test(e.shrn(1))){i+=2}var d;switch(n){case"02":if(e.mod(a).cmp(s)){i+=8}break;case"05":d=e.mod(u);if(d.cmp(l)&&d.cmp(c)){i+=8}break;default:i+=4}h[r]=i;return i}function m(e,t,n){this.setGenerator(t);this.__prime=new r(e);this._prime=r.mont(this.__prime);this._primeLen=e.length;this._pub=undefined;this._priv=undefined;this._primeCode=undefined;if(n){this.setPublicKey=_;this.setPrivateKey=p}else{this._primeCode=8}}Object.defineProperty(m.prototype,"verifyError",{enumerable:true,get:function(){if(typeof this._primeCode!=="number"){this._primeCode=g(this.__prime,this.__gen)}return this._primeCode}});m.prototype.generateKeys=function(){if(!this._priv){this._priv=new r(d(this._primeLen))}this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed();return this.getPublicKey()};m.prototype.computeSecret=function(e){e=new r(e);e=e.toRed(this._prime);var t=e.redPow(this._priv).fromRed();var i=new n(t.toArray());var o=this.getPrime();if(i.length<o.length){var a=new n(o.length-i.length);a.fill(0);i=n.concat([a,i])}return i};m.prototype.getPublicKey=function y(e){return v(this._pub,e)};m.prototype.getPrivateKey=function b(e){return v(this._priv,e)};m.prototype.getPrime=function(e){return v(this.__prime,e)};m.prototype.getGenerator=function(e){return v(this._gen,e)};m.prototype.setGenerator=function(e,t){t=t||"utf8";if(!n.isBuffer(e)){e=new n(e,t)}this.__gen=e;this._gen=new r(e);return this};function v(e,t){var r=new n(e.toArray());if(!t){return r}else{return r.toString(t)}}}).call(this,e("buffer").Buffer)},{"./generatePrime":223,"bn.js":225,buffer:79,"miller-rabin":226,randombytes:275}],223:[function(e,t,n){var r=e("randombytes");t.exports=k;k.simpleSieve=w;k.fermatTest=x;var i=e("bn.js");var o=new i(24);var a=e("miller-rabin");var s=new a;var u=new i(1);var l=new i(2);var c=new i(5);var f=new i(16);var d=new i(8);var _=new i(10);var p=new i(3);var h=new i(7);var g=new i(11);var m=new i(4);var v=new i(12);var y=null;function b(){if(y!==null)return y;var e=1048576;var t=[];t[0]=2;for(var n=1,r=3;r<e;r+=2){var i=Math.ceil(Math.sqrt(r));for(var o=0;o<n&&t[o]<=i;o++)if(r%t[o]===0)break;if(n!==o&&t[o]<=i)continue;t[n++]=r}y=t;return t}function w(e){var t=b();for(var n=0;n<t.length;n++)if(e.modn(t[n])===0){if(e.cmpn(t[n])===0){return true}else{return false}}return true}function x(e){var t=i.mont(e);return l.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)===0}function k(e,t){if(e<16){if(t===2||t===5){return new i([140,123])}else{return new i([140,39])}}t=new i(t);var n,a;while(true){n=new i(r(Math.ceil(e/8)));while(n.bitLength()>e){n.ishrn(1)}if(n.isEven()){n.iadd(u)}if(!n.testn(1)){n.iadd(l)}if(!t.cmp(l)){while(n.mod(o).cmp(g)){n.iadd(m)}}else if(!t.cmp(c)){while(n.mod(_).cmp(p)){n.iadd(m)}}a=n.shrn(1);if(w(a)&&w(n)&&x(a)&&x(n)&&s.test(a)&&s.test(n)){return n}}}},{"bn.js":225,"miller-rabin":226,randombytes:275}],224:[function(e,t,n){t.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],225:[function(e,t,n){t.exports=e(116)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/bn.js/lib/bn.js":116}],226:[function(e,t,n){var r=e("bn.js");var i=e("brorand");function o(e){this.rand=e||new i.Rand}t.exports=o;o.create=function a(e){return new o(e)};o.prototype._rand=function s(e){var t=e.bitLength();var n=this.rand.generate(Math.ceil(t/8));n[0]|=3;var i=t&7;if(i!==0)n[n.length-1]>>=7-i;return new r(n)};o.prototype.test=function u(e,t,n){var i=e.bitLength();var o=r.mont(e);var a=new r(1).toRed(o);if(!t)t=Math.max(1,i/48|0);var s=e.subn(1);var u=s.subn(1);for(var l=0;!s.testn(l);l++){}var c=e.shrn(l);var f=s.toRed(o);var d=true;for(;t>0;t--){var _=this._rand(u);if(n)n(_);var p=_.toRed(o).redPow(c);if(p.cmp(a)===0||p.cmp(f)===0)continue;for(var h=1;h<l;h++){p=p.redSqr();if(p.cmp(a)===0)return false;if(p.cmp(f)===0)break}if(h===l)return false}return d};o.prototype.getDivisor=function l(e,t){var n=e.bitLength();var i=r.mont(e);var o=new r(1).toRed(i);if(!t)t=Math.max(1,n/48|0);var a=e.subn(1);var s=a.subn(1);for(var u=0;!a.testn(u);u++){}var l=e.shrn(u);var c=a.toRed(i);for(;t>0;t--){var f=this._rand(s);var d=e.gcd(f);if(d.cmpn(1)!==0)return d;var _=f.toRed(i).redPow(l);if(_.cmp(o)===0||_.cmp(c)===0)continue;for(var p=1;p<u;p++){_=_.redSqr();if(_.cmp(o)===0)return _.fromRed().subn(1).gcd(e);if(_.cmp(c)===0)break}if(p===u){_=_.redSqr();return _.fromRed().subn(1).gcd(e)}}return false}},{"bn.js":225,brorand:227}],227:[function(e,t,n){t.exports=e(134)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/elliptic/node_modules/brorand/index.js":134,crypto:78}],228:[function(e,t,n){(function(t,r){var i=e("create-hmac");var o=e("./precondition");n.pbkdf2=function(e,t,r,i,a,s){if(typeof a==="function"){s=a;a=undefined}o(r,i);if(typeof s!=="function")throw new Error("No callback provided to pbkdf2");setTimeout(function(){s(null,n.pbkdf2Sync(e,t,r,i,a))})};var a;if(t.browser){a="utf-8"}else{var s=parseInt(t.version.split(".")[0].slice(1),10);a=s>=6?"utf-8":"binary"}n.pbkdf2Sync=function(e,t,n,s,u){if(!r.isBuffer(e))e=new r(e,a);if(!r.isBuffer(t))t=new r(t,a);o(n,s);u=u||"sha1";var l;var c=1;var f=new r(s);var d=new r(t.length+4);t.copy(d,0,0,t.length);var _;var p;for(var h=1;h<=c;h++){d.writeUInt32BE(h,t.length);var g=i(u,e).update(d).digest();if(!l){l=g.length;p=new r(l);c=Math.ceil(s/l);_=s-(c-1)*l}g.copy(p,0,0,l);for(var m=1;m<n;m++){g=i(u,e).update(g).digest();for(var v=0;v<l;v++)p[v]^=g[v]}var y=(h-1)*l;var b=h===c?_:l;p.copy(f,y,0,b)}return f}}).call(this,e("_process"),e("buffer").Buffer)},{"./precondition":229,_process:281,buffer:79,"create-hmac":220}],229:[function(e,t,n){var r=Math.pow(2,30)-1;t.exports=function(e,t){if(typeof e!=="number"){throw new TypeError("Iterations not a number")}if(e<0){throw new TypeError("Bad iterations")}if(typeof t!=="number"){throw new TypeError("Key length not a number")}if(t<0||t>r||t!==t){throw new TypeError("Bad key length")}}},{}],230:[function(e,t,n){n.publicEncrypt=e("./publicEncrypt");n.privateDecrypt=e("./privateDecrypt");n.privateEncrypt=function r(e,t){return n.publicEncrypt(e,t,true)};n.publicDecrypt=function i(e,t){return n.privateDecrypt(e,t,true)}},{"./privateDecrypt":271,"./publicEncrypt":272}],231:[function(e,t,n){(function(n){var r=e("create-hash");t.exports=function(e,t){var o=new n("");var a=0,s;while(o.length<t){s=i(a++);o=n.concat([o,r("sha1").update(e).update(s).digest()])}return o.slice(0,t)};function i(e){var t=new n(4);t.writeUInt32BE(e,0);return t}}).call(this,e("buffer").Buffer)},{buffer:79,"create-hash":207}],232:[function(e,t,n){t.exports=e(116)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/bn.js/lib/bn.js":116}],233:[function(e,t,n){t.exports=e(117)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/browserify-rsa/index.js":117,"bn.js":232,buffer:79,randombytes:275}],234:[function(e,t,n){t.exports=e(142)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/aesid.json":142}],235:[function(e,t,n){t.exports=e(143)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/asn1.js":143,"asn1.js":238}],236:[function(e,t,n){t.exports=e(144)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/fixProc.js":144,"browserify-aes":255,buffer:79,evp_bytestokey:270}],237:[function(e,t,n){t.exports=e(145)},{"./aesid.json":234,"./asn1":235,"./fixProc":236,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/index.js":145,"browserify-aes":255,buffer:79,pbkdf2:228}],238:[function(e,t,n){t.exports=e(146)},{"./asn1/api":239,"./asn1/base":241,"./asn1/constants":245,"./asn1/decoders":247,"./asn1/encoders":250,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1.js":146,"bn.js":232}],239:[function(e,t,n){t.exports=e(147)},{"../asn1":238,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/api.js":147,inherits:277,vm:303}],240:[function(e,t,n){t.exports=e(148)},{"../base":241,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/base/buffer.js":148,buffer:79,inherits:277}],241:[function(e,t,n){t.exports=e(149)},{"./buffer":240,"./node":242,"./reporter":243,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/base/index.js":149}],242:[function(e,t,n){t.exports=e(150)},{"../base":241,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/base/node.js":150,"minimalistic-assert":252}],243:[function(e,t,n){t.exports=e(151)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/base/reporter.js":151,inherits:277}],244:[function(e,t,n){t.exports=e(152)},{"../constants":245,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/constants/der.js":152}],245:[function(e,t,n){t.exports=e(153)},{"./der":244,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/constants/index.js":153}],246:[function(e,t,n){t.exports=e(154)},{"../../asn1":238,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/decoders/der.js":154,inherits:277}],247:[function(e,t,n){t.exports=e(155)},{"./der":246,"./pem":248,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/decoders/index.js":155}],248:[function(e,t,n){t.exports=e(156)},{"./der":246,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/decoders/pem.js":156,buffer:79,inherits:277}],249:[function(e,t,n){t.exports=e(157)},{"../../asn1":238,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/encoders/der.js":157,buffer:79,inherits:277}],250:[function(e,t,n){t.exports=e(158)},{"./der":249,"./pem":251,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/encoders/index.js":158}],251:[function(e,t,n){t.exports=e(159)},{"./der":249,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-sign/node_modules/parse-asn1/node_modules/asn1.js/lib/asn1/encoders/pem.js":159,inherits:277}],252:[function(e,t,n){t.exports=e(111)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-des/node_modules/des.js/node_modules/minimalistic-assert/index.js":111}],253:[function(e,t,n){t.exports=e(85)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/aes.js":85,buffer:79}],254:[function(e,t,n){t.exports=e(86)},{"./aes":253,"./ghash":258,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/authCipher.js":86,buffer:79,"buffer-xor":267,"cipher-base":268,inherits:277}],255:[function(e,t,n){t.exports=e(87)},{"./decrypter":256,"./encrypter":257,"./modes":259,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/browser.js":87}],256:[function(e,t,n){t.exports=e(88)},{"./aes":253,"./authCipher":254,"./modes":259,"./modes/cbc":260,"./modes/cfb":261,"./modes/cfb1":262,"./modes/cfb8":263,"./modes/ctr":264,"./modes/ecb":265,"./modes/ofb":266,"./streamCipher":269,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/decrypter.js":88,buffer:79,"cipher-base":268,evp_bytestokey:270,inherits:277}],257:[function(e,t,n){t.exports=e(89)},{"./aes":253,"./authCipher":254,"./modes":259,"./modes/cbc":260,"./modes/cfb":261,"./modes/cfb1":262,"./modes/cfb8":263,"./modes/ctr":264,"./modes/ecb":265,"./modes/ofb":266,"./streamCipher":269,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/encrypter.js":89,buffer:79,"cipher-base":268,evp_bytestokey:270,inherits:277}],258:[function(e,t,n){t.exports=e(90)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/ghash.js":90,buffer:79}],259:[function(e,t,n){t.exports=e(91)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes.js":91}],260:[function(e,t,n){t.exports=e(92)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/cbc.js":92,"buffer-xor":267}],261:[function(e,t,n){t.exports=e(93)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/cfb.js":93,buffer:79,"buffer-xor":267}],262:[function(e,t,n){t.exports=e(94)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/cfb1.js":94,buffer:79}],263:[function(e,t,n){t.exports=e(95)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/cfb8.js":95,buffer:79}],264:[function(e,t,n){t.exports=e(96)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/ctr.js":96,buffer:79,"buffer-xor":267}],265:[function(e,t,n){t.exports=e(97)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/ecb.js":97
}],266:[function(e,t,n){t.exports=e(98)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/modes/ofb.js":98,buffer:79,"buffer-xor":267}],267:[function(e,t,n){t.exports=e(99)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/node_modules/buffer-xor/index.js":99,buffer:79}],268:[function(e,t,n){t.exports=e(100)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/node_modules/cipher-base/index.js":100,buffer:79,inherits:277,stream:297,string_decoder:298}],269:[function(e,t,n){t.exports=e(101)},{"./aes":253,"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/browserify-aes/streamCipher.js":101,buffer:79,"cipher-base":268,inherits:277}],270:[function(e,t,n){t.exports=e(112)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/crypto-browserify/node_modules/browserify-cipher/node_modules/evp_bytestokey/index.js":112,buffer:79,"create-hash/md5":209}],271:[function(e,t,n){(function(n){var r=e("parse-asn1");var i=e("./mgf");var o=e("./xor");var a=e("bn.js");var s=e("browserify-rsa");var u=e("create-hash");var l=e("./withPublic");t.exports=function _(e,t,i){var o;if(e.padding){o=e.padding}else if(i){o=1}else{o=4}var u=r(e);var d=u.modulus.byteLength();if(t.length>d||new a(t).cmp(u.modulus)>=0){throw new Error("decryption error")}var _;if(i){_=l(new a(t),u)}else{_=s(t,u)}var p=new n(d-_.length);p.fill(0);_=n.concat([p,_],d);if(o===4){return c(u,_)}else if(o===1){return f(u,_,i)}else if(o===3){return _}else{throw new Error("unknown padding")}};function c(e,t){var r=e.modulus;var a=e.modulus.byteLength();var s=t.length;var l=u("sha1").update(new n("")).digest();var c=l.length;var f=2*c;if(t[0]!==0){throw new Error("decryption error")}var _=t.slice(1,c+1);var p=t.slice(c+1);var h=o(_,i(p,c));var g=o(p,i(h,a-c-1));if(d(l,g.slice(0,c))){throw new Error("decryption error")}var m=c;while(g[m]===0){m++}if(g[m++]!==1){throw new Error("decryption error")}return g.slice(m)}function f(e,t,n){var r=t.slice(0,2);var i=2;var o=0;while(t[i++]!==0){if(i>=t.length){o++;break}}var a=t.slice(2,i-1);var s=t.slice(i-1,i);if(r.toString("hex")!=="0002"&&!n||r.toString("hex")!=="0001"&&n){o++}if(a.length<8){o++}if(o){throw new Error("decryption error")}return t.slice(i)}function d(e,t){e=new n(e);t=new n(t);var r=0;var i=e.length;if(e.length!==t.length){r++;i=Math.min(e.length,t.length)}var o=-1;while(++o<i){r+=e[o]^t[o]}return r}}).call(this,e("buffer").Buffer)},{"./mgf":231,"./withPublic":273,"./xor":274,"bn.js":232,"browserify-rsa":233,buffer:79,"create-hash":207,"parse-asn1":237}],272:[function(e,t,n){(function(n){var r=e("parse-asn1");var i=e("randombytes");var o=e("create-hash");var a=e("./mgf");var s=e("./xor");var u=e("bn.js");var l=e("./withPublic");var c=e("browserify-rsa");var f={RSA_PKCS1_OAEP_PADDING:4,RSA_PKCS1_PADDIN:1,RSA_NO_PADDING:3};t.exports=function h(e,t,n){var i;if(e.padding){i=e.padding}else if(n){i=1}else{i=4}var o=r(e);var a;if(i===4){a=d(o,t)}else if(i===1){a=_(o,t,n)}else if(i===3){a=new u(t);if(a.cmp(o.modulus)>=0){throw new Error("data too long for modulus")}}else{throw new Error("unknown padding")}if(n){return c(a,o)}else{return l(a,o)}};function d(e,t){var r=e.modulus.byteLength();var l=t.length;var c=o("sha1").update(new n("")).digest();var f=c.length;var d=2*f;if(l>r-d-2){throw new Error("message too long")}var _=new n(r-l-d-2);_.fill(0);var p=r-f-1;var h=i(f);var g=s(n.concat([c,_,new n([1]),t],p),a(h,p));var m=s(h,a(g,f));return new u(n.concat([new n([0]),m,g],r))}function _(e,t,r){var i=t.length;var o=e.modulus.byteLength();if(i>o-11){throw new Error("message too long")}var a;if(r){a=new n(o-i-3);a.fill(255)}else{a=p(o-i-3)}return new u(n.concat([new n([0,r?1:2]),a,new n([0]),t],o))}function p(e,t){var r=new n(e);var o=0;var a=i(e*2);var s=0;var u;while(o<e){if(s===a.length){a=i(e*2);s=0}u=a[s++];if(u){r[o++]=u}}return r}}).call(this,e("buffer").Buffer)},{"./mgf":231,"./withPublic":273,"./xor":274,"bn.js":232,"browserify-rsa":233,buffer:79,"create-hash":207,"parse-asn1":237,randombytes:275}],273:[function(e,t,n){(function(n){var r=e("bn.js");function i(e,t){return new n(e.toRed(r.mont(t.modulus)).redPow(new r(t.publicExponent)).fromRed().toArray())}t.exports=i}).call(this,e("buffer").Buffer)},{"bn.js":232,buffer:79}],274:[function(e,t,n){t.exports=function r(e,t){var n=e.length;var r=-1;while(++r<n){e[r]^=t[r]}return e}},{}],275:[function(e,t,n){(function(e,n,r){"use strict";function i(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var o=n.crypto||n.msCrypto;if(o&&o.getRandomValues){t.exports=a}else{t.exports=i}function a(t,i){if(t>65536)throw new Error("requested too many random bytes");var a=new n.Uint8Array(t);if(t>0){o.getRandomValues(a)}var s=new r(a.buffer);if(typeof i==="function"){return e.nextTick(function(){i(null,s)})}return s}}).call(this,e("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer)},{_process:281,buffer:79}],276:[function(e,t,n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
function r(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}t.exports=r;r.EventEmitter=r;r.prototype._events=undefined;r.prototype._maxListeners=undefined;r.defaultMaxListeners=10;r.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};r.prototype.emit=function(e){var t,n,r,o,u,l;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||a(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}throw TypeError('Uncaught, unspecified "error" event.')}}n=this._events[e];if(s(n))return false;if(i(n)){switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=arguments.length;o=new Array(r-1);for(u=1;u<r;u++)o[u-1]=arguments[u];n.apply(this,o)}}else if(a(n)){r=arguments.length;o=new Array(r-1);for(u=1;u<r;u++)o[u-1]=arguments[u];l=n.slice();r=l.length;for(u=0;u<r;u++)l[u].apply(this,o)}return true};r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,i(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(a(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(a(this._events[e])&&!this._events[e].warned){var n;if(!s(this._maxListeners)){n=this._maxListeners}else{n=r.defaultMaxListeners}if(n&&n>0&&this._events[e].length>n){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};r.prototype.on=r.prototype.addListener;r.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var n=false;function r(){this.removeListener(e,r);if(!n){n=true;t.apply(this,arguments)}}r.listener=t;this.on(e,r);return this};r.prototype.removeListener=function(e,t){var n,r,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;n=this._events[e];o=n.length;r=-1;if(n===t||i(n.listener)&&n.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(a(n)){for(s=o;s-->0;){if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}}if(r<0)return this;if(n.length===1){n.length=0;delete this._events[e]}else{n.splice(r,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}n=this._events[e];if(i(n)){this.removeListener(e,n)}else{while(n.length)this.removeListener(e,n[n.length-1])}delete this._events[e];return this};r.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(i(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};r.listenerCount=function(e,t){var n;if(!e._events||!e._events[t])n=0;else if(i(e._events[t]))n=1;else n=e._events[t].length;return n};function i(e){return typeof e==="function"}function o(e){return typeof e==="number"}function a(e){return typeof e==="object"&&e!==null}function s(e){return e===void 0}},{}],277:[function(e,t,n){if(typeof Object.create==="function"){t.exports=function r(e,t){e.super_=t;e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}else{t.exports=function i(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype;e.prototype=new n;e.prototype.constructor=e}}},{}],278:[function(e,t,n){t.exports=function(e){return e!=null&&(r(e)||i(e)||!!e._isBuffer)};function r(e){return!!e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function i(e){return typeof e.readFloatLE==="function"&&typeof e.slice==="function"&&r(e.slice(0,0))}},{}],279:[function(e,t,n){t.exports=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"}},{}],280:[function(e,t,n){(function(e){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
function t(e,t){var n=0;for(var r=e.length-1;r>=0;r--){var i=e[r];if(i==="."){e.splice(r,1)}else if(i===".."){e.splice(r,1);n++}else if(n){e.splice(r,1);n--}}if(t){for(;n--;n){e.unshift("..")}}return e}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var i=function(e){return r.exec(e).slice(1)};n.resolve=function(){var n="",r=false;for(var i=arguments.length-1;i>=-1&&!r;i--){var a=i>=0?arguments[i]:e.cwd();if(typeof a!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!a){continue}n=a+"/"+n;r=a.charAt(0)==="/"}n=t(o(n.split("/"),function(e){return!!e}),!r).join("/");return(r?"/":"")+n||"."};n.normalize=function(e){var r=n.isAbsolute(e),i=a(e,-1)==="/";e=t(o(e.split("/"),function(e){return!!e}),!r).join("/");if(!e&&!r){e="."}if(e&&i){e+="/"}return(r?"/":"")+e};n.isAbsolute=function(e){return e.charAt(0)==="/"};n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(o(e,function(e,t){if(typeof e!=="string"){throw new TypeError("Arguments to path.join must be strings")}return e}).join("/"))};n.relative=function(e,t){e=n.resolve(e).substr(1);t=n.resolve(t).substr(1);function r(e){var t=0;for(;t<e.length;t++){if(e[t]!=="")break}var n=e.length-1;for(;n>=0;n--){if(e[n]!=="")break}if(t>n)return[];return e.slice(t,n-t+1)}var i=r(e.split("/"));var o=r(t.split("/"));var a=Math.min(i.length,o.length);var s=a;for(var u=0;u<a;u++){if(i[u]!==o[u]){s=u;break}}var l=[];for(var u=s;u<i.length;u++){l.push("..")}l=l.concat(o.slice(s));return l.join("/")};n.sep="/";n.delimiter=":";n.dirname=function(e){var t=i(e),n=t[0],r=t[1];if(!n&&!r){return"."}if(r){r=r.substr(0,r.length-1)}return n+r};n.basename=function(e,t){var n=i(e)[2];if(t&&n.substr(-1*t.length)===t){n=n.substr(0,n.length-t.length)}return n};n.extname=function(e){return i(e)[3]};function o(e,t){if(e.filter)return e.filter(t);var n=[];for(var r=0;r<e.length;r++){if(t(e[r],r,e))n.push(e[r])}return n}var a="ab".substr(-1)==="b"?function(e,t,n){return e.substr(t,n)}:function(e,t,n){if(t<0)t=e.length+t;return e.substr(t,n)}}).call(this,e("_process"))},{_process:281}],281:[function(e,t,n){var r=t.exports={};r.nextTick=function(){var e=typeof window!=="undefined"&&window.setImmediate;var t=typeof window!=="undefined"&&window.MutationObserver;var n=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(e){return function(e){return window.setImmediate(e)}}var r=[];if(t){var i=document.createElement("div");var o=new MutationObserver(function(){var e=r.slice();r.length=0;e.forEach(function(e){e()})});o.observe(i,{attributes:true});return function a(e){if(!r.length){i.setAttribute("yes","no")}r.push(e)}}if(n){window.addEventListener("message",function(e){var t=e.source;if((t===window||t===null)&&e.data==="process-tick"){e.stopPropagation();if(r.length>0){var n=r.shift();n()}}},true);return function s(e){r.push(e);window.postMessage("process-tick","*")}}return function u(e){setTimeout(e,0)}}();r.title="browser";r.browser=true;r.env={};r.argv=[];function i(){}r.on=i;r.addListener=i;r.once=i;r.off=i;r.removeListener=i;r.removeAllListeners=i;r.emit=i;r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],282:[function(e,t,n){(function(e){(function(r){var i=typeof n=="object"&&n;var o=typeof t=="object"&&t&&t.exports==i&&t;var a=typeof e=="object"&&e;if(a.global===a||a.window===a){r=a}var s,u=2147483647,l=36,c=1,f=26,d=38,_=700,p=72,h=128,g="-",m=/^xn--/,v=/[^ -~]/,y=/\x2E|\u3002|\uFF0E|\uFF61/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=l-c,x=Math.floor,k=String.fromCharCode,S;function A(e){throw RangeError(b[e])}function E(e,t){var n=e.length;while(n--){e[n]=t(e[n])}return e}function M(e,t){return E(e.split(y),t).join(".")}function T(e){var t=[],n=0,r=e.length,i,o;while(n<r){i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){o=e.charCodeAt(n++);if((o&64512)==56320){t.push(((i&1023)<<10)+(o&1023)+65536)}else{t.push(i);n--}}else{t.push(i)}}return t}function C(e){return E(e,function(e){var t="";if(e>65535){e-=65536;t+=k(e>>>10&1023|55296);e=56320|e&1023}t+=k(e);return t}).join("")}function j(e){if(e-48<10){return e-22}if(e-65<26){return e-65}if(e-97<26){return e-97}return l}function D(e,t){return e+22+75*(e<26)-((t!=0)<<5)}function O(e,t,n){var r=0;e=n?x(e/_):e>>1;e+=x(e/t);for(;e>w*f>>1;r+=l){e=x(e/w)}return x(r+(w+1)*e/(e+d))}function I(e){var t=[],n=e.length,r,i=0,o=h,a=p,s,d,_,m,v,y,b,w,k;s=e.lastIndexOf(g);if(s<0){s=0}for(d=0;d<s;++d){if(e.charCodeAt(d)>=128){A("not-basic")}t.push(e.charCodeAt(d))}for(_=s>0?s+1:0;_<n;){for(m=i,v=1,y=l;;y+=l){if(_>=n){A("invalid-input")}b=j(e.charCodeAt(_++));if(b>=l||b>x((u-i)/v)){A("overflow")}i+=b*v;w=y<=a?c:y>=a+f?f:y-a;if(b<w){break}k=l-w;if(v>x(u/k)){A("overflow")}v*=k}r=t.length+1;a=O(i-m,r,m==0);if(x(i/r)>u-o){A("overflow")}o+=x(i/r);i%=r;t.splice(i++,0,o)}return C(t)}function P(e){var t,n,r,i,o,a,s,d,_,m,v,y=[],b,w,S,E;e=T(e);b=e.length;t=h;n=0;o=p;for(a=0;a<b;++a){v=e[a];if(v<128){y.push(k(v))}}r=i=y.length;if(i){y.push(g)}while(r<b){for(s=u,a=0;a<b;++a){v=e[a];if(v>=t&&v<s){s=v}}w=r+1;if(s-t>x((u-n)/w)){A("overflow")}n+=(s-t)*w;t=s;for(a=0;a<b;++a){v=e[a];if(v<t&&++n>u){A("overflow")}if(v==t){for(d=n,_=l;;_+=l){m=_<=o?c:_>=o+f?f:_-o;if(d<m){break}E=d-m;S=l-m;y.push(k(D(m+E%S,0)));d=x(E/S)}y.push(k(D(d,0)));o=O(n,w,r==i);n=0;++r}}++n;++t}return y.join("")}function R(e){return M(e,function(e){return m.test(e)?I(e.slice(4).toLowerCase()):e})}function z(e){return M(e,function(e){return v.test(e)?"xn--"+P(e):e})}s={version:"1.2.4",ucs2:{decode:T,encode:C},decode:I,encode:P,toASCII:z,toUnicode:R};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define("punycode",function(){return s})}else if(i&&!i.nodeType){if(o){o.exports=s}else{for(S in s){s.hasOwnProperty(S)&&(i[S]=s[S])}}}else{r.punycode=s}})(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],283:[function(e,t,n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,o){t=t||"&";n=n||"=";var a={};if(typeof e!=="string"||e.length===0){return a}var s=/\+/g;e=e.split(t);var u=1e3;if(o&&typeof o.maxKeys==="number"){u=o.maxKeys}var l=e.length;if(u>0&&l>u){l=u}for(var c=0;c<l;++c){var f=e[c].replace(s,"%20"),d=f.indexOf(n),_,p,h,g;if(d>=0){_=f.substr(0,d);p=f.substr(d+1)}else{_=f;p=""}h=decodeURIComponent(_);g=decodeURIComponent(p);if(!r(a,h)){a[h]=g}else if(i(a[h])){a[h].push(g)}else{a[h]=[a[h],g]}}return a};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}},{}],284:[function(e,t,n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,n,s){t=t||"&";n=n||"=";if(e===null){e=undefined}if(typeof e==="object"){return o(a(e),function(a){var s=encodeURIComponent(r(a))+n;if(i(e[a])){return o(e[a],function(e){return s+encodeURIComponent(r(e))}).join(t)}else{return s+encodeURIComponent(r(e[a]))}}).join(t)}if(!s)return"";return encodeURIComponent(r(s))+n+encodeURIComponent(r(e))};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function o(e,t){if(e.map)return e.map(t);var n=[];for(var r=0;r<e.length;r++){n.push(t(e[r],r))}return n}var a=Object.keys||function(e){var t=[];for(var n in e){if(Object.prototype.hasOwnProperty.call(e,n))t.push(n)}return t}},{}],285:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode");n.encode=n.stringify=e("./encode")},{"./decode":283,"./encode":284}],286:[function(e,t,n){t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":287}],287:[function(e,t,n){(function(n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
t.exports=s;var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};var i=e("core-util-is");i.inherits=e("inherits");var o=e("./_stream_readable");var a=e("./_stream_writable");i.inherits(s,o);l(r(a.prototype),function(e){if(!s.prototype[e])s.prototype[e]=a.prototype[e]});function s(e){if(!(this instanceof s))return new s(e);o.call(this,e);a.call(this,e);if(e&&e.readable===false)this.readable=false;if(e&&e.writable===false)this.writable=false;this.allowHalfOpen=true;if(e&&e.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",u)}function u(){if(this.allowHalfOpen||this._writableState.ended)return;n.nextTick(this.end.bind(this))}function l(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}}}).call(this,e("_process"))},{"./_stream_readable":289,"./_stream_writable":291,_process:281,"core-util-is":292,inherits:277}],288:[function(e,t,n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
t.exports=o;var r=e("./_stream_transform");var i=e("core-util-is");i.inherits=e("inherits");i.inherits(o,r);function o(e){if(!(this instanceof o))return new o(e);r.call(this,e)}o.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":290,"core-util-is":292,inherits:277}],289:[function(e,t,n){(function(n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
t.exports=f;var r=e("isarray");var i=e("buffer").Buffer;f.ReadableState=c;var o=e("events").EventEmitter;if(!o.listenerCount)o.listenerCount=function(e,t){return e.listeners(t).length};var a=e("stream");var s=e("core-util-is");s.inherits=e("inherits");var u;var l=e("util");if(l&&l.debuglog){l=l.debuglog("stream")}else{l=function(){}}s.inherits(f,a);function c(t,n){var r=e("./_stream_duplex");t=t||{};var i=t.highWaterMark;var o=t.objectMode?16:16*1024;this.highWaterMark=i||i===0?i:o;this.highWaterMark=~~this.highWaterMark;this.buffer=[];this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.objectMode=!!t.objectMode;if(n instanceof r)this.objectMode=this.objectMode||!!t.readableObjectMode;this.defaultEncoding=t.defaultEncoding||"utf8";this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(t.encoding){if(!u)u=e("string_decoder/").StringDecoder;this.decoder=new u(t.encoding);this.encoding=t.encoding}}function f(t){var n=e("./_stream_duplex");if(!(this instanceof f))return new f(t);this._readableState=new c(t,this);this.readable=true;a.call(this)}f.prototype.push=function(e,t){var n=this._readableState;if(s.isString(e)&&!n.objectMode){t=t||n.defaultEncoding;if(t!==n.encoding){e=new i(e,t);t=""}}return d(this,n,e,t,false)};f.prototype.unshift=function(e){var t=this._readableState;return d(this,t,e,"",true)};function d(e,t,n,r,i){var o=m(t,n);if(o){e.emit("error",o)}else if(s.isNullOrUndefined(n)){t.reading=false;if(!t.ended)v(e,t)}else if(t.objectMode||n&&n.length>0){if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var a=new Error("stream.unshift() after end event");e.emit("error",a)}else{if(t.decoder&&!i&&!r)n=t.decoder.write(n);if(!i)t.reading=false;if(t.flowing&&t.length===0&&!t.sync){e.emit("data",n);e.read(0)}else{t.length+=t.objectMode?1:n.length;if(i)t.buffer.unshift(n);else t.buffer.push(n);if(t.needReadable)y(e)}w(e,t)}}else if(!i){t.reading=false}return _(t)}function _(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||e.length===0)}f.prototype.setEncoding=function(t){if(!u)u=e("string_decoder/").StringDecoder;this._readableState.decoder=new u(t);this._readableState.encoding=t;return this};var p=8388608;function h(e){if(e>=p){e=p}else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function g(e,t){if(t.length===0&&t.ended)return 0;if(t.objectMode)return e===0?0:1;if(isNaN(e)||s.isNull(e)){if(t.flowing&&t.buffer.length)return t.buffer[0].length;else return t.length}if(e<=0)return 0;if(e>t.highWaterMark)t.highWaterMark=h(e);if(e>t.length){if(!t.ended){t.needReadable=true;return 0}else return t.length}return e}f.prototype.read=function(e){l("read",e);var t=this._readableState;var n=e;if(!s.isNumber(e)||e>0)t.emittedReadable=false;if(e===0&&t.needReadable&&(t.length>=t.highWaterMark||t.ended)){l("read: emitReadable",t.length,t.ended);if(t.length===0&&t.ended)T(this);else y(this);return null}e=g(e,t);if(e===0&&t.ended){if(t.length===0)T(this);return null}var r=t.needReadable;l("need readable",r);if(t.length===0||t.length-e<t.highWaterMark){r=true;l("length less than watermark",r)}if(t.ended||t.reading){r=false;l("reading or ended",r)}if(r){l("do read");t.reading=true;t.sync=true;if(t.length===0)t.needReadable=true;this._read(t.highWaterMark);t.sync=false}if(r&&!t.reading)e=g(n,t);var i;if(e>0)i=M(e,t);else i=null;if(s.isNull(i)){t.needReadable=true;e=0}t.length-=e;if(t.length===0&&!t.ended)t.needReadable=true;if(n!==e&&t.ended&&t.length===0)T(this);if(!s.isNull(i))this.emit("data",i);return i};function m(e,t){var n=null;if(!s.isBuffer(t)&&!s.isString(t)&&!s.isNullOrUndefined(t)&&!e.objectMode){n=new TypeError("Invalid non-string/buffer chunk")}return n}function v(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();if(n&&n.length){t.buffer.push(n);t.length+=t.objectMode?1:n.length}}t.ended=true;y(e)}function y(e){var t=e._readableState;t.needReadable=false;if(!t.emittedReadable){l("emitReadable",t.flowing);t.emittedReadable=true;if(t.sync)n.nextTick(function(){b(e)});else b(e)}}function b(e){l("emit readable");e.emit("readable");E(e)}function w(e,t){if(!t.readingMore){t.readingMore=true;n.nextTick(function(){x(e,t)})}}function x(e,t){var n=t.length;while(!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark){l("maybeReadMore read 0");e.read(0);if(n===t.length)break;else n=t.length}t.readingMore=false}f.prototype._read=function(e){this.emit("error",new Error("not implemented"))};f.prototype.pipe=function(e,t){var i=this;var a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e);break}a.pipesCount+=1;l("pipe count=%d opts=%j",a.pipesCount,t);var s=(!t||t.end!==false)&&e!==n.stdout&&e!==n.stderr;var u=s?f:_;if(a.endEmitted)n.nextTick(u);else i.once("end",u);e.on("unpipe",c);function c(e){l("onunpipe");if(e===i){_()}}function f(){l("onend");e.end()}var d=k(i);e.on("drain",d);function _(){l("cleanup");e.removeListener("close",g);e.removeListener("finish",m);e.removeListener("drain",d);e.removeListener("error",h);e.removeListener("unpipe",c);i.removeListener("end",f);i.removeListener("end",_);i.removeListener("data",p);if(a.awaitDrain&&(!e._writableState||e._writableState.needDrain))d()}i.on("data",p);function p(t){l("ondata");var n=e.write(t);if(false===n){l("false write response, pause",i._readableState.awaitDrain);i._readableState.awaitDrain++;i.pause()}}function h(t){l("onerror",t);v();e.removeListener("error",h);if(o.listenerCount(e,"error")===0)e.emit("error",t)}if(!e._events||!e._events.error)e.on("error",h);else if(r(e._events.error))e._events.error.unshift(h);else e._events.error=[h,e._events.error];function g(){e.removeListener("finish",m);v()}e.once("close",g);function m(){l("onfinish");e.removeListener("close",g);v()}e.once("finish",m);function v(){l("unpipe");i.unpipe(e)}e.emit("pipe",i);if(!a.flowing){l("pipe resume");i.resume()}return e};function k(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain);if(t.awaitDrain)t.awaitDrain--;if(t.awaitDrain===0&&o.listenerCount(e,"data")){t.flowing=true;E(e)}}}f.prototype.unpipe=function(e){var t=this._readableState;if(t.pipesCount===0)return this;if(t.pipesCount===1){if(e&&e!==t.pipes)return this;if(!e)e=t.pipes;t.pipes=null;t.pipesCount=0;t.flowing=false;if(e)e.emit("unpipe",this);return this}if(!e){var n=t.pipes;var r=t.pipesCount;t.pipes=null;t.pipesCount=0;t.flowing=false;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var i=j(t.pipes,e);if(i===-1)return this;t.pipes.splice(i,1);t.pipesCount-=1;if(t.pipesCount===1)t.pipes=t.pipes[0];e.emit("unpipe",this);return this};f.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t);if(e==="data"&&false!==this._readableState.flowing){this.resume()}if(e==="readable"&&this.readable){var i=this._readableState;if(!i.readableListening){i.readableListening=true;i.emittedReadable=false;i.needReadable=true;if(!i.reading){var o=this;n.nextTick(function(){l("readable nexttick read 0");o.read(0)})}else if(i.length){y(this,i)}}}return r};f.prototype.addListener=f.prototype.on;f.prototype.resume=function(){var e=this._readableState;if(!e.flowing){l("resume");e.flowing=true;if(!e.reading){l("resume read 0");this.read(0)}S(this,e)}return this};function S(e,t){if(!t.resumeScheduled){t.resumeScheduled=true;n.nextTick(function(){A(e,t)})}}function A(e,t){t.resumeScheduled=false;e.emit("resume");E(e);if(t.flowing&&!t.reading)e.read(0)}f.prototype.pause=function(){l("call pause flowing=%j",this._readableState.flowing);if(false!==this._readableState.flowing){l("pause");this._readableState.flowing=false;this.emit("pause")}return this};function E(e){var t=e._readableState;l("flow",t.flowing);if(t.flowing){do{var n=e.read()}while(null!==n&&t.flowing)}}f.prototype.wrap=function(e){var t=this._readableState;var n=false;var r=this;e.on("end",function(){l("wrapped end");if(t.decoder&&!t.ended){var e=t.decoder.end();if(e&&e.length)r.push(e)}r.push(null)});e.on("data",function(i){l("wrapped data");if(t.decoder)i=t.decoder.write(i);if(!i||!t.objectMode&&!i.length)return;var o=r.push(i);if(!o){n=true;e.pause()}});for(var i in e){if(s.isFunction(e[i])&&s.isUndefined(this[i])){this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i)}}var o=["error","close","destroy","pause","resume"];C(o,function(t){e.on(t,r.emit.bind(r,t))});r._read=function(t){l("wrapped _read",t);if(n){n=false;e.resume()}};return r};f._fromList=M;function M(e,t){var n=t.buffer;var r=t.length;var o=!!t.decoder;var a=!!t.objectMode;var s;if(n.length===0)return null;if(r===0)s=null;else if(a)s=n.shift();else if(!e||e>=r){if(o)s=n.join("");else s=i.concat(n,r);n.length=0}else{if(e<n[0].length){var u=n[0];s=u.slice(0,e);n[0]=u.slice(e)}else if(e===n[0].length){s=n.shift()}else{if(o)s="";else s=new i(e);var l=0;for(var c=0,f=n.length;c<f&&l<e;c++){var u=n[0];var d=Math.min(e-l,u.length);if(o)s+=u.slice(0,d);else u.copy(s,l,0,d);if(d<u.length)n[0]=u.slice(d);else n.shift();l+=d}}}return s}function T(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");if(!t.endEmitted){t.ended=true;n.nextTick(function(){if(!t.endEmitted&&t.length===0){t.endEmitted=true;e.readable=false;e.emit("end")}})}}function C(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}}function j(e,t){for(var n=0,r=e.length;n<r;n++){if(e[n]===t)return n}return-1}}).call(this,e("_process"))},{"./_stream_duplex":287,_process:281,buffer:79,"core-util-is":292,events:276,inherits:277,isarray:279,stream:297,"string_decoder/":298,util:78}],290:[function(e,t,n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
t.exports=s;var r=e("./_stream_duplex");var i=e("core-util-is");i.inherits=e("inherits");i.inherits(s,r);function o(e,t){this.afterTransform=function(e,n){return a(t,e,n)};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null}function a(e,t,n){var r=e._transformState;r.transforming=false;var o=r.writecb;if(!o)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null;r.writecb=null;if(!i.isNullOrUndefined(n))e.push(n);if(o)o(t);var a=e._readableState;a.reading=false;if(a.needReadable||a.length<a.highWaterMark){e._read(a.highWaterMark)}}function s(e){if(!(this instanceof s))return new s(e);r.call(this,e);this._transformState=new o(e,this);var t=this;this._readableState.needReadable=true;this._readableState.sync=false;this.once("prefinish",function(){if(i.isFunction(this._flush))this._flush(function(e){u(t,e)});else u(t)})}s.prototype.push=function(e,t){this._transformState.needTransform=false;return r.prototype.push.call(this,e,t)};s.prototype._transform=function(e,t,n){throw new Error("not implemented")};s.prototype._write=function(e,t,n){var r=this._transformState;r.writecb=n;r.writechunk=e;r.writeencoding=t;if(!r.transforming){var i=this._readableState;if(r.needTransform||i.needReadable||i.length<i.highWaterMark)this._read(i.highWaterMark)}};s.prototype._read=function(e){var t=this._transformState;if(!i.isNull(t.writechunk)&&t.writecb&&!t.transforming){t.transforming=true;this._transform(t.writechunk,t.writeencoding,t.afterTransform)}else{t.needTransform=true}};function u(e,t){if(t)return e.emit("error",t);var n=e._writableState;var r=e._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}},{"./_stream_duplex":287,"core-util-is":292,inherits:277}],291:[function(e,t,n){(function(n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
t.exports=u;var r=e("buffer").Buffer;u.WritableState=s;var i=e("core-util-is");i.inherits=e("inherits");var o=e("stream");i.inherits(u,o);function a(e,t,n){this.chunk=e;this.encoding=t;this.callback=n}function s(t,n){var r=e("./_stream_duplex");t=t||{};var i=t.highWaterMark;var o=t.objectMode?16:16*1024;this.highWaterMark=i||i===0?i:o;this.objectMode=!!t.objectMode;if(n instanceof r)this.objectMode=this.objectMode||!!t.writableObjectMode;this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var a=t.decodeStrings===false;this.decodeStrings=!a;this.defaultEncoding=t.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(e){g(n,e)};this.writecb=null;this.writelen=0;this.buffer=[];this.pendingcb=0;this.prefinished=false;this.errorEmitted=false}function u(t){var n=e("./_stream_duplex");if(!(this instanceof u)&&!(this instanceof n))return new u(t);this._writableState=new s(t,this);this.writable=true;o.call(this)}u.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))};function l(e,t,r){var i=new Error("write after end");e.emit("error",i);n.nextTick(function(){r(i)})}function c(e,t,r,o){var a=true;if(!i.isBuffer(r)&&!i.isString(r)&&!i.isNullOrUndefined(r)&&!t.objectMode){var s=new TypeError("Invalid non-string/buffer chunk");e.emit("error",s);n.nextTick(function(){o(s)});a=false}return a}u.prototype.write=function(e,t,n){var r=this._writableState;var o=false;if(i.isFunction(t)){n=t;t=null}if(i.isBuffer(e))t="buffer";else if(!t)t=r.defaultEncoding;if(!i.isFunction(n))n=function(){};if(r.ended)l(this,r,n);else if(c(this,r,e,n)){r.pendingcb++;o=d(this,r,e,t,n)}return o};u.prototype.cork=function(){var e=this._writableState;e.corked++};u.prototype.uncork=function(){var e=this._writableState;if(e.corked){e.corked--;if(!e.writing&&!e.corked&&!e.finished&&!e.bufferProcessing&&e.buffer.length)y(this,e)}};function f(e,t,n){if(!e.objectMode&&e.decodeStrings!==false&&i.isString(t)){t=new r(t,n)}return t}function d(e,t,n,r,o){n=f(t,n,r);if(i.isBuffer(n))r="buffer";var s=t.objectMode?1:n.length;t.length+=s;var u=t.length<t.highWaterMark;if(!u)t.needDrain=true;if(t.writing||t.corked)t.buffer.push(new a(n,r,o));else _(e,t,false,s,n,r,o);return u}function _(e,t,n,r,i,o,a){t.writelen=r;t.writecb=a;t.writing=true;t.sync=true;if(n)e._writev(i,t.onwrite);else e._write(i,o,t.onwrite);t.sync=false}function p(e,t,r,i,o){if(r)n.nextTick(function(){t.pendingcb--;o(i)});else{t.pendingcb--;o(i)}e._writableState.errorEmitted=true;e.emit("error",i)}function h(e){e.writing=false;e.writecb=null;e.length-=e.writelen;e.writelen=0}function g(e,t){var r=e._writableState;var i=r.sync;var o=r.writecb;h(r);if(t)p(e,r,i,t,o);else{var a=b(e,r);if(!a&&!r.corked&&!r.bufferProcessing&&r.buffer.length){y(e,r)}if(i){n.nextTick(function(){m(e,r,a,o)})}else{m(e,r,a,o)}}}function m(e,t,n,r){if(!n)v(e,t);t.pendingcb--;r();x(e,t)}function v(e,t){if(t.length===0&&t.needDrain){t.needDrain=false;e.emit("drain")}}function y(e,t){t.bufferProcessing=true;if(e._writev&&t.buffer.length>1){var n=[];for(var r=0;r<t.buffer.length;r++)n.push(t.buffer[r].callback);t.pendingcb++;_(e,t,true,t.length,t.buffer,"",function(e){for(var r=0;r<n.length;r++){t.pendingcb--;n[r](e)}});t.buffer=[]}else{for(var r=0;r<t.buffer.length;r++){var i=t.buffer[r];var o=i.chunk;var a=i.encoding;var s=i.callback;var u=t.objectMode?1:o.length;_(e,t,false,u,o,a,s);if(t.writing){r++;break}}if(r<t.buffer.length)t.buffer=t.buffer.slice(r);else t.buffer.length=0}t.bufferProcessing=false}u.prototype._write=function(e,t,n){n(new Error("not implemented"))};u.prototype._writev=null;u.prototype.end=function(e,t,n){var r=this._writableState;if(i.isFunction(e)){n=e;e=null;t=null}else if(i.isFunction(t)){n=t;t=null}if(!i.isNullOrUndefined(e))this.write(e,t);if(r.corked){r.corked=1;this.uncork()}if(!r.ending&&!r.finished)k(this,r,n)};function b(e,t){return t.ending&&t.length===0&&!t.finished&&!t.writing}function w(e,t){if(!t.prefinished){t.prefinished=true;e.emit("prefinish")}}function x(e,t){var n=b(e,t);if(n){if(t.pendingcb===0){w(e,t);t.finished=true;e.emit("finish")}else w(e,t)}return n}function k(e,t,r){t.ending=true;x(e,t);if(r){if(t.finished)n.nextTick(r);else e.once("finish",r)}t.ended=true}}).call(this,e("_process"))},{"./_stream_duplex":287,_process:281,buffer:79,"core-util-is":292,inherits:277,stream:297}],292:[function(e,t,n){(function(e){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
function t(e){if(Array.isArray){return Array.isArray(e)}return g(e)==="[object Array]"}n.isArray=t;function r(e){return typeof e==="boolean"}n.isBoolean=r;function i(e){return e===null}n.isNull=i;function o(e){return e==null}n.isNullOrUndefined=o;function a(e){return typeof e==="number"}n.isNumber=a;function s(e){return typeof e==="string"}n.isString=s;function u(e){return typeof e==="symbol"}n.isSymbol=u;function l(e){return e===void 0}n.isUndefined=l;function c(e){return g(e)==="[object RegExp]"}n.isRegExp=c;function f(e){return typeof e==="object"&&e!==null}n.isObject=f;function d(e){return g(e)==="[object Date]"}n.isDate=d;function _(e){return g(e)==="[object Error]"||e instanceof Error}n.isError=_;function p(e){return typeof e==="function"}n.isFunction=p;function h(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}n.isPrimitive=h;n.isBuffer=e.isBuffer;function g(e){return Object.prototype.toString.call(e)}}).call(this,{isBuffer:e("../../../../insert-module-globals/node_modules/is-buffer/index.js")})},{"../../../../insert-module-globals/node_modules/is-buffer/index.js":278}],293:[function(e,t,n){t.exports=e("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":288}],294:[function(e,t,n){(function(r){n=t.exports=e("./lib/_stream_readable.js");n.Stream=e("stream");n.Readable=n;n.Writable=e("./lib/_stream_writable.js");n.Duplex=e("./lib/_stream_duplex.js");n.Transform=e("./lib/_stream_transform.js");n.PassThrough=e("./lib/_stream_passthrough.js");if(!r.browser&&r.env.READABLE_STREAM==="disable"){t.exports=e("stream")}}).call(this,e("_process"))},{"./lib/_stream_duplex.js":287,"./lib/_stream_passthrough.js":288,"./lib/_stream_readable.js":289,"./lib/_stream_transform.js":290,"./lib/_stream_writable.js":291,_process:281,stream:297}],295:[function(e,t,n){t.exports=e("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":290}],296:[function(e,t,n){t.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":291}],297:[function(e,t,n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
t.exports=o;var r=e("events").EventEmitter;var i=e("inherits");i(o,r);o.Readable=e("readable-stream/readable.js");o.Writable=e("readable-stream/writable.js");o.Duplex=e("readable-stream/duplex.js");o.Transform=e("readable-stream/transform.js");o.PassThrough=e("readable-stream/passthrough.js");o.Stream=o;function o(){r.call(this)}o.prototype.pipe=function(e,t){var n=this;function i(t){if(e.writable){if(false===e.write(t)&&n.pause){n.pause()}}}n.on("data",i);function o(){if(n.readable&&n.resume){n.resume()}}e.on("drain",o);if(!e._isStdio&&(!t||t.end!==false)){n.on("end",s);n.on("close",u)}var a=false;function s(){if(a)return;a=true;e.end()}function u(){if(a)return;a=true;if(typeof e.destroy==="function")e.destroy()}function l(e){c();if(r.listenerCount(this,"error")===0){throw e}}n.on("error",l);e.on("error",l);function c(){n.removeListener("data",i);e.removeListener("drain",o);n.removeListener("end",s);n.removeListener("close",u);n.removeListener("error",l);e.removeListener("error",l);n.removeListener("end",c);n.removeListener("close",c);e.removeListener("close",c)}n.on("end",c);n.on("close",c);e.on("close",c);e.emit("pipe",n);return e}},{events:276,inherits:277,"readable-stream/duplex.js":286,"readable-stream/passthrough.js":293,"readable-stream/readable.js":294,"readable-stream/transform.js":295,"readable-stream/writable.js":296}],298:[function(e,t,n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
var r=e("buffer").Buffer;var i=r.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function o(e){if(e&&!i(e)){throw new Error("Unknown encoding: "+e)}}var a=n.StringDecoder=function(e){this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,"");o(e);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2;this.detectIncompleteChar=u;break;case"base64":this.surrogateSize=3;this.detectIncompleteChar=l;break;default:this.write=s;return}this.charBuffer=new r(6);this.charReceived=0;this.charLength=0};a.prototype.write=function(e){var t="";while(this.charLength){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;e.copy(this.charBuffer,this.charReceived,0,n);this.charReceived+=n;if(this.charReceived<this.charLength){return""}e=e.slice(n,e.length);t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(r>=55296&&r<=56319){this.charLength+=this.surrogateSize;t="";continue}this.charReceived=this.charLength=0;if(e.length===0){return t}break}this.detectIncompleteChar(e);var i=e.length;if(this.charLength){e.copy(this.charBuffer,0,e.length-this.charReceived,i);i-=this.charReceived}t+=e.toString(this.encoding,0,i);var i=t.length-1;var r=t.charCodeAt(i);if(r>=55296&&r<=56319){var o=this.surrogateSize;this.charLength+=o;this.charReceived+=o;this.charBuffer.copy(this.charBuffer,o,0,o);e.copy(this.charBuffer,0,0,o);return t.substring(0,i)}return t};a.prototype.detectIncompleteChar=function(e){var t=e.length>=3?3:e.length;for(;t>0;t--){var n=e[e.length-t];if(t==1&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t};a.prototype.end=function(e){var t="";if(e&&e.length)t=this.write(e);if(this.charReceived){var n=this.charReceived;var r=this.charBuffer;var i=this.encoding;t+=r.slice(0,n).toString(i)}return t};function s(e){return e.toString(this.encoding)}function u(e){this.charReceived=e.length%2;this.charLength=this.charReceived?2:0}function l(e){this.charReceived=e.length%3;this.charLength=this.charReceived?3:0}},{buffer:79}],299:[function(e,t,n){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
var r=e("punycode");n.parse=y;n.resolve=w;n.resolveObject=x;n.format=b;n.Url=i;function i(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=["<",">",'"',"`"," ","\r","\n","	"],u=["{","}","|","\\","^","`"].concat(s),l=["'"].concat(u),c=["%","/","?",";","#"].concat(l),f=["/","?","#"],d=255,_=/^[a-z0-9A-Z_-]{0,63}$/,p=/^([a-z0-9A-Z_-]{0,63})(.*)$/,h={javascript:true,"javascript:":true},g={javascript:true,"javascript:":true},m={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},v=e("querystring");function y(e,t,n){if(e&&S(e)&&e instanceof i)return e;var r=new i;r.parse(e,t,n);return r}i.prototype.parse=function(e,t,n){if(!k(e)){throw new TypeError("Parameter 'url' must be a string, not "+typeof e)}var i=e;i=i.trim();var a=o.exec(i);if(a){a=a[0];var s=a.toLowerCase();this.protocol=s;i=i.substr(a.length)}if(n||a||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var u=i.substr(0,2)==="//";if(u&&!(a&&g[a])){i=i.substr(2);this.slashes=true}}if(!g[a]&&(u||a&&!m[a])){var y=-1;for(var b=0;b<f.length;b++){var w=i.indexOf(f[b]);if(w!==-1&&(y===-1||w<y))y=w}var x,S;if(y===-1){S=i.lastIndexOf("@")}else{S=i.lastIndexOf("@",y)}if(S!==-1){x=i.slice(0,S);i=i.slice(S+1);this.auth=decodeURIComponent(x)}y=-1;for(var b=0;b<c.length;b++){var w=i.indexOf(c[b]);if(w!==-1&&(y===-1||w<y))y=w}if(y===-1)y=i.length;this.host=i.slice(0,y);i=i.slice(y);this.parseHost();this.hostname=this.hostname||"";var A=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!A){var E=this.hostname.split(/\./);for(var b=0,M=E.length;b<M;b++){var T=E[b];if(!T)continue;if(!T.match(_)){var C="";for(var j=0,D=T.length;j<D;j++){if(T.charCodeAt(j)>127){C+="x"}else{C+=T[j]}}if(!C.match(_)){var O=E.slice(0,b);var I=E.slice(b+1);var P=T.match(p);if(P){O.push(P[1]);I.unshift(P[2])}if(I.length){i="/"+I.join(".")+i}this.hostname=O.join(".");break}}}}if(this.hostname.length>d){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!A){var R=this.hostname.split(".");var z=[];for(var b=0;b<R.length;++b){var B=R[b];z.push(B.match(/[^A-Za-z0-9_-]/)?"xn--"+r.encode(B):B)}this.hostname=z.join(".")}var N=this.port?":"+this.port:"";var L=this.hostname||"";this.host=L+N;this.href+=this.host;if(A){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(i[0]!=="/"){i="/"+i}}}if(!h[s]){for(var b=0,M=l.length;b<M;b++){var q=l[b];var U=encodeURIComponent(q);if(U===q){U=escape(q)}i=i.split(q).join(U)}}var F=i.indexOf("#");if(F!==-1){this.hash=i.substr(F);i=i.slice(0,F)}var W=i.indexOf("?");if(W!==-1){this.search=i.substr(W);this.query=i.substr(W+1);if(t){this.query=v.parse(this.query)}i=i.slice(0,W)}else if(t){this.search="";this.query={}}if(i)this.pathname=i;if(m[s]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var N=this.pathname||"";var B=this.search||"";this.path=N+B}this.href=this.format();return this};function b(e){if(k(e))e=y(e);if(!(e instanceof i))return i.prototype.format.call(e);return e.format()}i.prototype.format=function(){var e=this.auth||"";if(e){e=encodeURIComponent(e);e=e.replace(/%3A/i,":");e+="@"}var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=false,o="";if(this.host){i=e+this.host}else if(this.hostname){i=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){i+=":"+this.port}}if(this.query&&S(this.query)&&Object.keys(this.query).length){o=v.stringify(this.query)}var a=this.search||o&&"?"+o||"";if(t&&t.substr(-1)!==":")t+=":";if(this.slashes||(!t||m[t])&&i!==false){i="//"+(i||"");if(n&&n.charAt(0)!=="/")n="/"+n}else if(!i){i=""}if(r&&r.charAt(0)!=="#")r="#"+r;if(a&&a.charAt(0)!=="?")a="?"+a;n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)});a=a.replace("#","%23");return t+i+n+a+r};function w(e,t){return y(e,false,true).resolve(t)}i.prototype.resolve=function(e){return this.resolveObject(y(e,false,true)).format()};function x(e,t){if(!e)return t;return y(e,false,true).resolveObject(t)}i.prototype.resolveObject=function(e){if(k(e)){var t=new i;t.parse(e,false,true);e=t}var n=new i;Object.keys(this).forEach(function(e){n[e]=this[e]},this);n.hash=e.hash;if(e.href===""){n.href=n.format();return n}if(e.slashes&&!e.protocol){Object.keys(e).forEach(function(t){if(t!=="protocol")n[t]=e[t]});if(m[n.protocol]&&n.hostname&&!n.pathname){n.path=n.pathname="/"}n.href=n.format();return n}if(e.protocol&&e.protocol!==n.protocol){if(!m[e.protocol]){Object.keys(e).forEach(function(t){n[t]=e[t]});n.href=n.format();return n}n.protocol=e.protocol;if(!e.host&&!g[e.protocol]){var r=(e.pathname||"").split("/");while(r.length&&!(e.host=r.shift()));if(!e.host)e.host="";if(!e.hostname)e.hostname="";if(r[0]!=="")r.unshift("");if(r.length<2)r.unshift("");n.pathname=r.join("/")}else{n.pathname=e.pathname}n.search=e.search;n.query=e.query;n.host=e.host||"";n.auth=e.auth;n.hostname=e.hostname||e.host;n.port=e.port;if(n.pathname||n.search){var o=n.pathname||"";var a=n.search||"";n.path=o+a}n.slashes=n.slashes||e.slashes;n.href=n.format();return n}var s=n.pathname&&n.pathname.charAt(0)==="/",u=e.host||e.pathname&&e.pathname.charAt(0)==="/",l=u||s||n.host&&e.pathname,c=l,f=n.pathname&&n.pathname.split("/")||[],r=e.pathname&&e.pathname.split("/")||[],d=n.protocol&&!m[n.protocol];if(d){n.hostname="";n.port=null;if(n.host){if(f[0]==="")f[0]=n.host;else f.unshift(n.host)}n.host="";if(e.protocol){e.hostname=null;e.port=null;if(e.host){if(r[0]==="")r[0]=e.host;else r.unshift(e.host)}e.host=null}l=l&&(r[0]===""||f[0]==="")}if(u){n.host=e.host||e.host===""?e.host:n.host;n.hostname=e.hostname||e.hostname===""?e.hostname:n.hostname;n.search=e.search;n.query=e.query;f=r}else if(r.length){if(!f)f=[];f.pop();f=f.concat(r);n.search=e.search;n.query=e.query}else if(!E(e.search)){if(d){n.hostname=n.host=f.shift();var _=n.host&&n.host.indexOf("@")>0?n.host.split("@"):false;if(_){n.auth=_.shift();n.host=n.hostname=_.shift()}}n.search=e.search;n.query=e.query;if(!A(n.pathname)||!A(n.search)){n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")}n.href=n.format();return n}if(!f.length){n.pathname=null;if(n.search){n.path="/"+n.search}else{n.path=null}n.href=n.format();return n}var p=f.slice(-1)[0];var h=(n.host||e.host)&&(p==="."||p==="..")||p==="";var v=0;for(var y=f.length;y>=0;y--){p=f[y];if(p=="."){f.splice(y,1)}else if(p===".."){f.splice(y,1);v++}else if(v){f.splice(y,1);v--}}if(!l&&!c){for(;v--;v){f.unshift("..")}}if(l&&f[0]!==""&&(!f[0]||f[0].charAt(0)!=="/")){f.unshift("")}if(h&&f.join("/").substr(-1)!=="/"){f.push("")}var b=f[0]===""||f[0]&&f[0].charAt(0)==="/";if(d){n.hostname=n.host=b?"":f.length?f.shift():"";var _=n.host&&n.host.indexOf("@")>0?n.host.split("@"):false;if(_){n.auth=_.shift();n.host=n.hostname=_.shift()}}l=l||n.host&&f.length;if(l&&!b){f.unshift("")}if(!f.length){n.pathname=null;n.path=null}else{n.pathname=f.join("/")}if(!A(n.pathname)||!A(n.search)){n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")}n.auth=e.auth||n.auth;n.slashes=n.slashes||e.slashes;n.href=n.format();return n};i.prototype.parseHost=function(){var e=this.host;var t=a.exec(e);if(t){t=t[0];if(t!==":"){this.port=t.substr(1)}e=e.substr(0,e.length-t.length)}if(e)this.hostname=e};function k(e){return typeof e==="string"}function S(e){return typeof e==="object"&&e!==null}function A(e){return e===null}function E(e){return e==null}},{punycode:282,querystring:285}],300:[function(e,t,n){t.exports=e(277)},{"/home/ec2-user/bubble/node_modules/browserify/node_modules/inherits/inherits_browser.js":277}],301:[function(e,t,n){t.exports=function r(e){return e&&typeof e==="object"&&typeof e.copy==="function"&&typeof e.fill==="function"&&typeof e.readUInt8==="function"}},{}],302:[function(e,t,n){(function(t,r){
// Copyright Joyent, Inc. and other Node contributors.
// The above copyright notice and this permission notice shall be included
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
var i=/%[sdj%]/g;n.format=function(e){if(!x(e)){var t=[];for(var n=0;n<arguments.length;n++){t.push(s(arguments[n]))}return t.join(" ")}var n=1;var r=arguments;var o=r.length;var a=String(e).replace(i,function(e){if(e==="%%")return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}});for(var u=r[n];n<o;u=r[++n]){if(y(u)||!E(u)){a+=" "+u}else{a+=" "+s(u)}}return a};n.deprecate=function(e,i){if(S(r.process)){return function(){return n.deprecate(e,i).apply(this,arguments)}}if(t.noDeprecation===true){return e}var o=false;function a(){if(!o){if(t.throwDeprecation){throw new Error(i)}else if(t.traceDeprecation){console.trace(i)}else{console.error(i)}o=true}return e.apply(this,arguments)}return a};var o={};var a;n.debuglog=function(e){if(S(a))a=t.env.NODE_DEBUG||"";e=e.toUpperCase();if(!o[e]){if(new RegExp("\\b"+e+"\\b","i").test(a)){var r=t.pid;o[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else{o[e]=function(){}}}return o[e]};function s(e,t){var r={seen:[],stylize:l};if(arguments.length>=3)r.depth=arguments[2];if(arguments.length>=4)r.colors=arguments[3];if(v(t)){r.showHidden=t}else if(t){n._extend(r,t)}if(S(r.showHidden))r.showHidden=false;if(S(r.depth))r.depth=2;if(S(r.colors))r.colors=false;if(S(r.customInspect))r.customInspect=true;if(r.colors)r.stylize=u;return f(r,e,r.depth)}n.inspect=s;s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};s.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};function u(e,t){var n=s.styles[t];if(n){return"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m"}else{return e}}function l(e,t){return e}function c(e){var t={};e.forEach(function(e,n){t[e]=true});return t}function f(e,t,r){if(e.customInspect&&t&&C(t.inspect)&&t.inspect!==n.inspect&&!(t.constructor&&t.constructor.prototype===t)){var i=t.inspect(r,e);if(!x(i)){i=f(e,i,r)}return i}var o=d(e,t);if(o){return o}var a=Object.keys(t);var s=c(a);if(e.showHidden){a=Object.getOwnPropertyNames(t)}if(T(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0)){return _(t)}if(a.length===0){if(C(t)){var u=t.name?": "+t.name:"";return e.stylize("[Function"+u+"]","special")}if(A(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}if(M(t)){return e.stylize(Date.prototype.toString.call(t),"date")}if(T(t)){return _(t)}}var l="",v=false,y=["{","}"];if(m(t)){v=true;y=["[","]"]}if(C(t)){var b=t.name?": "+t.name:"";l=" [Function"+b+"]"}if(A(t)){l=" "+RegExp.prototype.toString.call(t)}if(M(t)){l=" "+Date.prototype.toUTCString.call(t)}if(T(t)){l=" "+_(t)}if(a.length===0&&(!v||t.length==0)){return y[0]+l+y[1]}if(r<0){if(A(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}else{return e.stylize("[Object]","special")}}e.seen.push(t);var w;if(v){w=p(e,t,r,s,a)}else{w=a.map(function(n){return h(e,t,r,s,n,v)})}e.seen.pop();return g(w,l,y)}function d(e,t){if(S(t))return e.stylize("undefined","undefined");if(x(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(w(t))return e.stylize(""+t,"number");if(v(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}function _(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,n,r,i){var o=[];for(var a=0,s=t.length;a<s;++a){if(R(t,String(a))){o.push(h(e,t,n,r,String(a),true))}else{o.push("")}}i.forEach(function(i){if(!i.match(/^\d+$/)){o.push(h(e,t,n,r,i,true))}});return o}function h(e,t,n,r,i,o){var a,s,u;u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]};if(u.get){if(u.set){s=e.stylize("[Getter/Setter]","special")}else{s=e.stylize("[Getter]","special")}}else{if(u.set){s=e.stylize("[Setter]","special")}}if(!R(r,i)){a="["+i+"]"}if(!s){if(e.seen.indexOf(u.value)<0){if(y(n)){s=f(e,u.value,null)}else{s=f(e,u.value,n-1)}if(s.indexOf("\n")>-1){if(o){s=s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2)}else{s="\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")}}}else{s=e.stylize("[Circular]","special")}}if(S(a)){if(o&&i.match(/^\d+$/)){return s}a=JSON.stringify(""+i);if(a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){a=a.substr(1,a.length-2);a=e.stylize(a,"name")}else{a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");a=e.stylize(a,"string")}}return a+": "+s}function g(e,t,n){var r=0;var i=e.reduce(function(e,t){r++;if(t.indexOf("\n")>=0)r++;return e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(i>60){return n[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]}return n[0]+t+" "+e.join(", ")+" "+n[1]}function m(e){return Array.isArray(e)}n.isArray=m;function v(e){return typeof e==="boolean"}n.isBoolean=v;function y(e){return e===null}n.isNull=y;function b(e){return e==null}n.isNullOrUndefined=b;function w(e){return typeof e==="number"}n.isNumber=w;function x(e){return typeof e==="string"}n.isString=x;function k(e){return typeof e==="symbol"}n.isSymbol=k;function S(e){return e===void 0}n.isUndefined=S;function A(e){return E(e)&&D(e)==="[object RegExp]"}n.isRegExp=A;function E(e){return typeof e==="object"&&e!==null}n.isObject=E;function M(e){return E(e)&&D(e)==="[object Date]"}n.isDate=M;function T(e){return E(e)&&(D(e)==="[object Error]"||e instanceof Error)}n.isError=T;function C(e){return typeof e==="function"}n.isFunction=C;function j(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}n.isPrimitive=j;n.isBuffer=e("./support/isBuffer");function D(e){return Object.prototype.toString.call(e)}function O(e){return e<10?"0"+e.toString(10):e.toString(10)}var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(){var e=new Date;var t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),I[e.getMonth()],t].join(" ")}n.log=function(){console.log("%s - %s",P(),n.format.apply(n,arguments))};n.inherits=e("inherits");n._extend=function(e,t){if(!t||!E(t))return e;var n=Object.keys(t);var r=n.length;while(r--){e[n[r]]=t[n[r]]}return e};function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}).call(this,e("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":301,_process:281,inherits:300}],303:[function(require,module,exports){var indexOf=require("indexof");var Object_keys=function(e){if(Object.keys)return Object.keys(e);else{var t=[];for(var n in e)t.push(n);return t}};var forEach=function(e,t){if(e.forEach)return e.forEach(t);else for(var n=0;n<e.length;n++){t(e[n],n,e)}};var defineProp=function(){try{Object.defineProperty({},"_",{});return function(e,t,n){Object.defineProperty(e,t,{writable:true,enumerable:false,configurable:true,value:n})}}catch(e){return function(e,t,n){e[t]=n}}}();var globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function e(t){if(!(this instanceof Script))return new Script(t);this.code=t};Script.prototype.runInContext=function(e){if(!(e instanceof Context)){throw new TypeError("needs a 'context' argument.")}var t=document.createElement("iframe");if(!t.style)t.style={};t.style.display="none";document.body.appendChild(t);var n=t.contentWindow;var r=n.eval,i=n.execScript;if(!r&&i){i.call(n,"null");r=n.eval}forEach(Object_keys(e),function(t){n[t]=e[t]});forEach(globals,function(t){if(e[t]){n[t]=e[t]}});var o=Object_keys(n);var a=r.call(n,this.code);forEach(Object_keys(n),function(t){if(t in e||indexOf(o,t)===-1){e[t]=n[t]}});forEach(globals,function(t){if(!(t in e)){defineProp(e,t,n[t])}});document.body.removeChild(t);return a};Script.prototype.runInThisContext=function(){return eval(this.code)};Script.prototype.runInNewContext=function(e){var t=Script.createContext(e);var n=this.runInContext(t);forEach(Object_keys(t),function(n){e[n]=t[n]});return n};forEach(Object_keys(Script.prototype),function(e){exports[e]=Script[e]=function(t){var n=Script(t);return n[e].apply(n,[].slice.call(arguments,1))}});exports.createScript=function(e){return exports.Script(e)};exports.createContext=Script.createContext=function(e){var t=new Context;if(typeof e==="object"){forEach(Object_keys(e),function(n){t[n]=e[n]})}return t}},{indexof:304}],304:[function(e,t,n){var r=[].indexOf;t.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n){if(e[n]===t)return n}return-1}},{}],305:[function(e,t,n){(function(n,r){if(n.fiberLib){return t.exports=n.fiberLib}var i=e("fs"),o=e("path");Math.random();var a="v8-"+/[0-9]+\.[0-9]+/.exec(n.versions.v8)[0];var s=o.join(r,"bin",n.platform+"-"+n.arch+"-"+a,"fibers");try{i.statSync(s+".node")}catch(u){throw new Error("`"+s+".node` is missing. Try reinstalling `node-fibers`?")}n.fiberLib=t.exports=e(s).Fiber}).call(this,e("_process"),"/node_modules/fibers")},{_process:281,fs:77,path:280}],306:[function(e,t,n){/**
 * Copyright (c) 2011, Sun Ning.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
var r="0123456789bcdefghjkmnpqrstuvwxyz";var i={};for(var o=0;o<r.length;o++){i[r.charAt(o)]=o}var a=function(e,t,n){var i=[],o=0,a=0,s=0,u=90,l=-90,c=180,f=-180,d;while(i.length<n){if(a%2===0){d=(c+f)/2;if(t>d){s=(s<<1)+1;f=d}else{s=(s<<1)+0;c=d}}else{d=(u+l)/2;if(e>d){s=(s<<1)+1;l=d}else{s=(s<<1)+0;u=d}}o++;a++;if(o===5){var _=r[s];i.push(_);o=0;s=0}}return i.join("")};var s=function(e,t,n){n=n||52;var r=0,i=90,o=-90,a=180,s=-180,u,l=0;while(r<n){l*=2;if(r%2===0){u=(a+s)/2;if(t>u){l+=1;s=u}else{a=u}}else{u=(i+o)/2;if(e>u){l+=1;o=u}else{i=u}}r++}return l};var u=function(e){var t=true;var n=90,r=-90;var o=180,a=-180;var s=0;for(var u=0,l=e.length;u<l;u++){var c=e[u].toLowerCase();s=i[c];for(var f=4;f>=0;f--){var d=s>>f&1;if(t){var _=(o+a)/2;if(d===1){a=_}else{o=_}}else{var _=(n+r)/2;if(d===1){r=_}else{n=_}}t=!t}}return[r,a,n,o]};var l=function(e,t){t=t||52;var n=0;var r=90,i=-90;var o=180,a=-180;var s=0,u=0;var l=t/2;for(var f=0;f<l;f++){u=c(e,(l-f)*2-1);s=c(e,(l-f)*2-2);if(s===0){r=(r+i)/2}else{i=(r+i)/2}if(u===0){o=(o+a)/2}else{a=(o+a)/2}}return[i,a,r,o]};function c(e,t){return e/Math.pow(2,t)&1}var f=function(e){var t=u(e);var n=(t[0]+t[2])/2;var r=(t[1]+t[3])/2;var i=t[2]-n;var o=t[3]-r;return{latitude:n,longitude:r,error:{latitude:i,longitude:o}}};var d=function(e,t){var n=l(e,t);var r=(n[0]+n[2])/2;var i=(n[1]+n[3])/2;var o=n[2]-r;var a=n[3]-i;return{latitude:r,longitude:i,error:{latitude:o,longitude:a}}};var _=function(e,t){var n=f(e);var r=n.latitude+t[0]*n.error.latitude*2;var i=n.longitude+t[1]*n.error.longitude*2;return a(r,i,e.length)};var p=function(e,t,n,r,i){i=i||9;var o=a(e,t,i);var s=a(n,r,i);var l=f(o);var c=l.error.latitude*2;var d=l.error.longitude*2;var p=u(o);var h=u(s);var g=Math.round((h[0]-p[0])/c);var m=Math.round((h[1]-p[1])/d);var v=[];for(var y=0;y<=g;y++){for(var b=0;b<=m;b++){v.push(_(o,[y,b]))}}return v};var h={encode:a,encode_uint64:s,decode:f,decode_uint64:d,decode_bbox:u,decode_bbox_uint64:l,neighbor:_,bboxes:p};t.exports=h},{}],307:[function(e,t,n){(function(){var e=this;var r=e._;var i={};var o=Array.prototype,a=Object.prototype,s=Function.prototype;var u=o.push,l=o.slice,c=o.concat,f=a.toString,d=a.hasOwnProperty;var _=o.forEach,p=o.map,h=o.reduce,g=o.reduceRight,m=o.filter,v=o.every,y=o.some,b=o.indexOf,w=o.lastIndexOf,x=Array.isArray,k=Object.keys,S=s.bind;var A=function(e){if(e instanceof A)return e;if(!(this instanceof A))return new A(e);this._wrapped=e};if(typeof n!=="undefined"){if(typeof t!=="undefined"&&t.exports){n=t.exports=A}n._=A}else{e._=A}A.VERSION="1.4.4";var E=A.each=A.forEach=function(e,t,n){if(e==null)return;if(_&&e.forEach===_){e.forEach(t,n)}else if(e.length===+e.length){for(var r=0,o=e.length;r<o;r++){if(t.call(n,e[r],r,e)===i)return}}else{for(var a in e){if(A.has(e,a)){if(t.call(n,e[a],a,e)===i)return}}}};A.map=A.collect=function(e,t,n){var r=[];if(e==null)return r;if(p&&e.map===p)return e.map(t,n);E(e,function(e,i,o){r[r.length]=t.call(n,e,i,o)});return r};var M="Reduce of empty array with no initial value";A.reduce=A.foldl=A.inject=function(e,t,n,r){var i=arguments.length>2;if(e==null)e=[];if(h&&e.reduce===h){if(r)t=A.bind(t,r);return i?e.reduce(t,n):e.reduce(t)}E(e,function(e,o,a){if(!i){n=e;i=true}else{n=t.call(r,n,e,o,a)}});if(!i)throw new TypeError(M);return n};A.reduceRight=A.foldr=function(e,t,n,r){var i=arguments.length>2;if(e==null)e=[];if(g&&e.reduceRight===g){if(r)t=A.bind(t,r);return i?e.reduceRight(t,n):e.reduceRight(t)}var o=e.length;if(o!==+o){var a=A.keys(e);o=a.length}E(e,function(s,u,l){u=a?a[--o]:--o;if(!i){n=e[u];i=true}else{n=t.call(r,n,e[u],u,l)}});if(!i)throw new TypeError(M);return n};A.find=A.detect=function(e,t,n){var r;T(e,function(e,i,o){if(t.call(n,e,i,o)){r=e;return true}});return r};A.filter=A.select=function(e,t,n){var r=[];if(e==null)return r;if(m&&e.filter===m)return e.filter(t,n);E(e,function(e,i,o){if(t.call(n,e,i,o))r[r.length]=e});return r};A.reject=function(e,t,n){return A.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)};A.every=A.all=function(e,t,n){t||(t=A.identity);var r=true;if(e==null)return r;if(v&&e.every===v)return e.every(t,n);E(e,function(e,o,a){if(!(r=r&&t.call(n,e,o,a)))return i});return!!r};var T=A.some=A.any=function(e,t,n){t||(t=A.identity);var r=false;if(e==null)return r;if(y&&e.some===y)return e.some(t,n);E(e,function(e,o,a){if(r||(r=t.call(n,e,o,a)))return i});return!!r};A.contains=A.include=function(e,t){if(e==null)return false;if(b&&e.indexOf===b)return e.indexOf(t)!=-1;return T(e,function(e){return e===t})};A.invoke=function(e,t){var n=l.call(arguments,2);var r=A.isFunction(t);return A.map(e,function(e){return(r?t:e[t]).apply(e,n)})};A.pluck=function(e,t){return A.map(e,function(e){return e[t]})};A.where=function(e,t,n){if(A.isEmpty(t))return n?null:[];return A[n?"find":"filter"](e,function(e){for(var n in t){if(t[n]!==e[n])return false}return true})};A.findWhere=function(e,t){return A.where(e,t,true)};A.max=function(e,t,n){if(!t&&A.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.max.apply(Math,e)}if(!t&&A.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};E(e,function(e,i,o){var a=t?t.call(n,e,i,o):e;a>=r.computed&&(r={value:e,computed:a})});return r.value};A.min=function(e,t,n){if(!t&&A.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.min.apply(Math,e)}if(!t&&A.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};E(e,function(e,i,o){var a=t?t.call(n,e,i,o):e;a<r.computed&&(r={value:e,computed:a})});return r.value};A.shuffle=function(e){var t;var n=0;var r=[];E(e,function(e){t=A.random(n++);r[n-1]=r[t];r[t]=e});return r};var C=function(e){return A.isFunction(e)?e:function(t){return t[e]}};A.sortBy=function(e,t,n){var r=C(t);return A.pluck(A.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria;var r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var j=function(e,t,n,r){var i={};var o=C(t||A.identity);E(e,function(t,a){var s=o.call(n,t,a,e);r(i,s,t)});return i};A.groupBy=function(e,t,n){return j(e,t,n,function(e,t,n){(A.has(e,t)?e[t]:e[t]=[]).push(n)})};A.countBy=function(e,t,n){return j(e,t,n,function(e,t){if(!A.has(e,t))e[t]=0;e[t]++})};A.sortedIndex=function(e,t,n,r){n=n==null?A.identity:C(n);var i=n.call(r,t);var o=0,a=e.length;while(o<a){var s=o+a>>>1;n.call(r,e[s])<i?o=s+1:a=s}return o};A.toArray=function(e){if(!e)return[];if(A.isArray(e))return l.call(e);if(e.length===+e.length)return A.map(e,A.identity);return A.values(e)};A.size=function(e){if(e==null)return 0;return e.length===+e.length?e.length:A.keys(e).length};A.first=A.head=A.take=function(e,t,n){if(e==null)return void 0;return t!=null&&!n?l.call(e,0,t):e[0]};A.initial=function(e,t,n){return l.call(e,0,e.length-(t==null||n?1:t))};A.last=function(e,t,n){if(e==null)return void 0;if(t!=null&&!n){return l.call(e,Math.max(e.length-t,0))}else{return e[e.length-1]}};A.rest=A.tail=A.drop=function(e,t,n){return l.call(e,t==null||n?1:t)};A.compact=function(e){return A.filter(e,A.identity)};var D=function(e,t,n){E(e,function(e){if(A.isArray(e)){t?u.apply(n,e):D(e,t,n)}else{n.push(e)}});return n};A.flatten=function(e,t){return D(e,t,[])};A.without=function(e){return A.difference(e,l.call(arguments,1))};A.uniq=A.unique=function(e,t,n,r){if(A.isFunction(t)){r=n;n=t;t=false}var i=n?A.map(e,n,r):e;var o=[];var a=[];E(i,function(n,r){if(t?!r||a[a.length-1]!==n:!A.contains(a,n)){a.push(n);o.push(e[r])}});return o};A.union=function(){return A.uniq(c.apply(o,arguments))};A.intersection=function(e){var t=l.call(arguments,1);return A.filter(A.uniq(e),function(e){return A.every(t,function(t){return A.indexOf(t,e)>=0})})};A.difference=function(e){var t=c.apply(o,l.call(arguments,1));return A.filter(e,function(e){return!A.contains(t,e)})};A.zip=function(){var e=l.call(arguments);var t=A.max(A.pluck(e,"length"));var n=new Array(t);for(var r=0;r<t;r++){n[r]=A.pluck(e,""+r)}return n};A.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++){if(t){n[e[r]]=t[r]}else{n[e[r][0]]=e[r][1]}}return n};A.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n=="number"){r=n<0?Math.max(0,i+n):n}else{r=A.sortedIndex(e,t);return e[r]===t?r:-1}}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1};A.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(w&&e.lastIndexOf===w){return r?e.lastIndexOf(t,n):e.lastIndexOf(t)}var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1};A.range=function(e,t,n){if(arguments.length<=1){t=e||0;e=0}n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0);var i=0;var o=new Array(r);while(i<r){o[i++]=e;e+=n}return o};A.bind=function(e,t){if(e.bind===S&&S)return S.apply(e,l.call(arguments,1));var n=l.call(arguments,2);return function(){return e.apply(t,n.concat(l.call(arguments)))}};A.partial=function(e){var t=l.call(arguments,1);return function(){return e.apply(this,t.concat(l.call(arguments)))}};A.bindAll=function(e){var t=l.call(arguments,1);if(t.length===0)t=A.functions(e);E(t,function(t){e[t]=A.bind(e[t],e)});return e};A.memoize=function(e,t){var n={};t||(t=A.identity);return function(){var r=t.apply(this,arguments);return A.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}};A.delay=function(e,t){var n=l.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)};A.defer=function(e){return A.delay.apply(A,[e,1].concat(l.call(arguments,1)))};A.throttle=function(e,t){var n,r,i,o;var a=0;var s=function(){a=new Date;i=null;o=e.apply(n,r)};return function(){var u=new Date;var l=t-(u-a);n=this;r=arguments;if(l<=0){clearTimeout(i);i=null;a=u;o=e.apply(n,r)}else if(!i){i=setTimeout(s,l)}return o}};A.debounce=function(e,t,n){var r,i;return function(){var o=this,a=arguments;var s=function(){r=null;if(!n)i=e.apply(o,a)};var u=n&&!r;clearTimeout(r);r=setTimeout(s,t);if(u)i=e.apply(o,a);return i}};A.once=function(e){var t=false,n;return function(){if(t)return n;t=true;n=e.apply(this,arguments);e=null;return n}};A.wrap=function(e,t){return function(){var n=[e];u.apply(n,arguments);return t.apply(this,n)}};A.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--){t=[e[n].apply(this,t)]}return t[0]}};A.after=function(e,t){if(e<=0)return t();return function(){if(--e<1){return t.apply(this,arguments)}}};A.keys=k||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)if(A.has(e,n))t[t.length]=n;return t};A.values=function(e){var t=[];for(var n in e)if(A.has(e,n))t.push(e[n]);return t};A.pairs=function(e){var t=[];for(var n in e)if(A.has(e,n))t.push([n,e[n]]);return t};A.invert=function(e){var t={};for(var n in e)if(A.has(e,n))t[e[n]]=n;return t};A.functions=A.methods=function(e){var t=[];for(var n in e){if(A.isFunction(e[n]))t.push(n)}return t.sort()};A.extend=function(e){E(l.call(arguments,1),function(t){if(t){for(var n in t){e[n]=t[n]}}});return e};A.pick=function(e){var t={};var n=c.apply(o,l.call(arguments,1));E(n,function(n){if(n in e)t[n]=e[n]});return t};A.omit=function(e){var t={};var n=c.apply(o,l.call(arguments,1));for(var r in e){if(!A.contains(n,r))t[r]=e[r]}return t};A.defaults=function(e){E(l.call(arguments,1),function(t){if(t){for(var n in t){if(e[n]==null)e[n]=t[n]}}});return e};A.clone=function(e){if(!A.isObject(e))return e;return A.isArray(e)?e.slice():A.extend({},e)};A.tap=function(e,t){t(e);return e};var O=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;if(e instanceof A)e=e._wrapped;if(t instanceof A)t=t._wrapped;var i=f.call(e);if(i!=f.call(t))return false;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return false;var o=n.length;while(o--){if(n[o]==e)return r[o]==t}n.push(e);r.push(t);var a=0,s=true;if(i=="[object Array]"){a=e.length;s=a==t.length;if(s){while(a--){if(!(s=O(e[a],t[a],n,r)))break}}}else{var u=e.constructor,l=t.constructor;if(u!==l&&!(A.isFunction(u)&&u instanceof u&&A.isFunction(l)&&l instanceof l)){return false}for(var c in e){if(A.has(e,c)){a++;if(!(s=A.has(t,c)&&O(e[c],t[c],n,r)))break}}if(s){for(c in t){if(A.has(t,c)&&!a--)break}s=!a}}n.pop();r.pop();return s};A.isEqual=function(e,t){return O(e,t,[],[])};A.isEmpty=function(e){if(e==null)return true;if(A.isArray(e)||A.isString(e))return e.length===0;for(var t in e)if(A.has(e,t))return false;return true};A.isElement=function(e){return!!(e&&e.nodeType===1)};A.isArray=x||function(e){return f.call(e)=="[object Array]"};A.isObject=function(e){return e===Object(e)};E(["Arguments","Function","String","Number","Date","RegExp"],function(e){A["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}});if(!A.isArguments(arguments)){A.isArguments=function(e){return!!(e&&A.has(e,"callee"))}}if(typeof/./!=="function"){A.isFunction=function(e){return typeof e==="function"}}A.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))};A.isNaN=function(e){return A.isNumber(e)&&e!=+e};A.isBoolean=function(e){return e===true||e===false||f.call(e)=="[object Boolean]"};A.isNull=function(e){return e===null};A.isUndefined=function(e){return e===void 0};A.has=function(e,t){return d.call(e,t)};A.noConflict=function(){e._=r;return this};A.identity=function(e){return e};A.times=function(e,t,n){var r=Array(e);for(var i=0;i<e;i++)r[i]=t.call(n,i);return r};A.random=function(e,t){if(t==null){t=e;e=0}return e+Math.floor(Math.random()*(t-e+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=A.invert(I.escape);var P={escape:new RegExp("["+A.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+A.keys(I.unescape).join("|")+")","g")};A.each(["escape","unescape"],function(e){A[e]=function(t){if(t==null)return"";return(""+t).replace(P[e],function(t){return I[e][t]})}});A.result=function(e,t){if(e==null)return null;var n=e[t];return A.isFunction(n)?n.call(e):n};A.mixin=function(e){E(A.functions(e),function(t){var n=A[t]=e[t];A.prototype[t]=function(){var e=[this._wrapped];u.apply(e,arguments);return L.call(this,n.apply(A,e))}})};var R=0;A.uniqueId=function(e){var t=++R+"";return e?e+t:t};A.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var z=/(.)^/;var B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"};var N=/\\|'|\r|\n|\t|\u2028|\u2029/g;A.template=function(e,t,n){var r;n=A.defaults({},n,A.templateSettings);var i=new RegExp([(n.escape||z).source,(n.interpolate||z).source,(n.evaluate||z).source].join("|")+"|$","g");var o=0;var a="__p+='";e.replace(i,function(t,n,r,i,s){a+=e.slice(o,s).replace(N,function(e){return"\\"+B[e]});if(n){a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"}if(r){a+="'+\n((__t=("+r+"))==null?'':__t)+\n'"}if(i){a+="';\n"+i+"\n__p+='"}o=s+t.length;return t});a+="';\n";if(!n.variable)a="with(obj||{}){\n"+a+"}\n";a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{r=new Function(n.variable||"obj","_",a)}catch(s){s.source=a;throw s}if(t)return r(t,A);var u=function(e){return r.call(this,e,A)};u.source="function("+(n.variable||"obj")+"){\n"+a+"}";return u};A.chain=function(e){return A(e).chain()};var L=function(e){return this._chain?A(e).chain():e};A.mixin(A);E(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];A.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);if((e=="shift"||e=="splice")&&n.length===0)delete n[0];return L.call(this,n)}});E(["concat","join","slice"],function(e){var t=o[e];A.prototype[e]=function(){return L.call(this,t.apply(this._wrapped,arguments))}});A.extend(A.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this)},{}]},{},[1]);